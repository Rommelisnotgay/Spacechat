var Ja=Object.defineProperty;var es=(e,n,t)=>n in e?Ja(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t;var qe=(e,n,t)=>(es(e,typeof n!="symbol"?n+"":n,t),t);import{r as N,o as Ve,a as xt,g as ua,d as He,c as j,b as Je,u as ts,e as U,R as ns,s as jn,w as Re,f as Ee,h as os,T as rs,i,n as se,t as Y,j as ne,F as Be,k as We,l as Oo,m as Pt,v as Xt,p as da,q as ze,x as ft,y as as,z as gn,A as No,B as Lo,C as ss,D as is,E as ls,G as cs,H as us}from"./vue-vendor-cc684da0.js";import{l as ds}from"./socket-vendor-d9998155.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const fs=()=>window.location.origin,te=N(null),dn=N(null),Rt=N(!1);let $t=null;const Ht=N("idle"),Et=N(""),qt=N(0),tr=10,nr=1e3,or=1e4,xs=45e3,vs=3e4;function Me(){const e=!!ua();te.value||n(),e&&(Ve(()=>{te.value||n()}),xt(()=>{te.value&&r(),$t&&(clearInterval($t),$t=null)}));function n(){const l=fs(),u=localStorage.getItem("spacechat_user_id");te.value=ds(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:tr,reconnectionDelay:nr,reconnectionDelayMax:or,timeout:vs,transports:["websocket","polling"],extraHeaders:{"X-Client-Version":"1.0.0"},query:u?{userId:u}:void 0,forceNew:!1,withCredentials:!0}),o(),t()}function t(){$t&&clearInterval($t),$t=setInterval(()=>{te.value&&Rt.value&&te.value.emit("heartbeat")},xs)}function o(){te.value&&(te.value.on("connect",()=>{var u,d;console.log("Socket connected"),Rt.value=!0;const l=localStorage.getItem("spacechat_user_id");(u=te.value)==null||u.emit("user:identify",{prevUserId:l||void 0},s=>{console.log("Identified with server, user ID:",s),dn.value=s,localStorage.setItem("spacechat_user_id",s)}),(d=te.value)==null||d.emit("get-online-count")}),te.value.on("disconnect",()=>{console.log("Socket disconnected"),Rt.value=!1}),te.value.on("reconnect",l=>{var d;console.log(`Socket reconnected after ${l} attempts`),Rt.value=!0;const u=localStorage.getItem("spacechat_user_id");u&&((d=te.value)==null||d.emit("user:identify",{prevUserId:u},s=>{var c;console.log("Re-identified with server after reconnection, user ID:",s),dn.value=s,s!==u&&localStorage.setItem("spacechat_user_id",s),(c=te.value)==null||c.emit("get-online-count")}))}),te.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),te.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),te.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{Rt.value||(console.log("Attempting to reinitialize socket connection..."),r(),n())},5e3)}),te.value.on("error",l=>{console.error("Socket error:",l)}),te.value.on("pong",()=>{}),te.value.on("user-id",l=>{console.log("Received user ID from server:",l),dn.value=l,localStorage.setItem("spacechat_user_id",l)}),te.value.on("queue-timeout",l=>{console.log("Queue timeout:",l),Ht.value="timeout",Et.value="We couldn't find a suitable match in the allotted time. Please try again.",qt.value=l.waitTime,window.dispatchEvent(new CustomEvent("queue-status-changed",{detail:{status:"timeout",message:Et.value,waitTime:l.waitTime}}))}),te.value.on("queue-waiting",l=>{console.log("Queue waiting notification:",l),Ht.value="waiting",Et.value="We're still looking for a match for you. Please wait...",qt.value=l.waitTime,window.dispatchEvent(new CustomEvent("queue-status-changed",{detail:{status:"waiting",message:Et.value,waitTime:l.waitTime}}))}),te.value.on("matched",()=>{Ht.value="matched",Et.value="",qt.value=0}),te.value.on("join-queue",()=>{Ht.value="waiting",Et.value="Looking for someone matching your preferences...",qt.value=0}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&te.value&&te.value.connected&&(te.value.emit("heartbeat"),console.log("Tab became visible, sending heartbeat"))}))}function r(){te.value&&(te.value.off("connect"),te.value.off("disconnect"),te.value.off("reconnect"),te.value.off("reconnect_attempt"),te.value.off("reconnect_error"),te.value.off("reconnect_failed"),te.value.off("error"),te.value.off("user-id"),te.value.off("pong"),te.value.off("queue-timeout"),te.value.off("queue-waiting"))}function a(){te.value?(console.log("Forcing socket reconnection..."),te.value.io.opts.reconnection=!1,te.value.disconnect(),setTimeout(()=>{te.value?(te.value.io.opts.reconnection=!0,te.value.io.opts.reconnectionAttempts=tr,te.value.io.opts.reconnectionDelay=nr,te.value.io.opts.reconnectionDelayMax=or,te.value.connect(),console.log("Reconnection attempt initiated")):n()},1e3)):n()}return{socket:te,userId:dn,isConnected:Rt,queueStatus:Ht,queueMessage:Et,queueWaitTime:qt,reconnect:a,isInSetupContext:e}}function gs(){const{socket:e}=Me(),n=!!ua(),t=N(!0),o=N(Date.now()),r=3e4,a=3e5;let l=0,u=null;const d=()=>{const f=Date.now();o.value=f,t.value=!0,f-l>r&&(l=f,e.value&&e.value.connected&&(e.value.emit("user-activity"),console.log("[ActivityTracker] تم إرسال تحديث النشاط للخادم"))),s()},s=()=>{u&&clearTimeout(u),u=window.setTimeout(()=>{t.value=!1,console.log("[ActivityTracker] المستخدم غير نشط الآن")},a)},c=()=>{["mousedown","mousemove","keydown","scroll","touchstart","click","touchmove"].forEach(y=>{document.addEventListener(y,d,{passive:!0})}),document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&d()}),d()},v=()=>{["mousedown","mousemove","keydown","scroll","touchstart","click","touchmove"].forEach(y=>{document.removeEventListener(y,d)}),document.removeEventListener("visibilitychange",d),u&&(clearTimeout(u),u=null)};return n?(Ve(()=>{c()}),xt(()=>{v()})):c(),{isActive:t,lastActivity:o,updateActivity:d,setupEventListeners:c,cleanupEventListeners:v}}const ms={class:"app-container"},ps=He({__name:"App",setup(e){return gs(),(n,t)=>(U(),j("div",ms,[Je(ts(ns))]))}});function fa(e,n){return function(){return e.apply(n,arguments)}}const{toString:hs}=Object.prototype,{getPrototypeOf:Uo}=Object,{iterator:_n,toStringTag:xa}=Symbol,An=(e=>n=>{const t=hs.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),tt=e=>(e=e.toLowerCase(),n=>An(n)===e),Bn=e=>n=>typeof n===e,{isArray:Mt}=Array,Qt=Bn("undefined");function bs(e){return e!==null&&!Qt(e)&&e.constructor!==null&&!Qt(e.constructor)&&Ge(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const va=tt("ArrayBuffer");function ys(e){let n;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?n=ArrayBuffer.isView(e):n=e&&e.buffer&&va(e.buffer),n}const Cs=Bn("string"),Ge=Bn("function"),ga=Bn("number"),Tn=e=>e!==null&&typeof e=="object",ws=e=>e===!0||e===!1,mn=e=>{if(An(e)!=="object")return!1;const n=Uo(e);return(n===null||n===Object.prototype||Object.getPrototypeOf(n)===null)&&!(xa in e)&&!(_n in e)},Es=tt("Date"),_s=tt("File"),As=tt("Blob"),Bs=tt("FileList"),Ts=e=>Tn(e)&&Ge(e.pipe),ks=e=>{let n;return e&&(typeof FormData=="function"&&e instanceof FormData||Ge(e.append)&&((n=An(e))==="formdata"||n==="object"&&Ge(e.toString)&&e.toString()==="[object FormData]"))},Ds=tt("URLSearchParams"),[Fs,Ss,Rs,$s]=["ReadableStream","Request","Response","Headers"].map(tt),Is=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Zt(e,n,{allOwnKeys:t=!1}={}){if(e===null||typeof e>"u")return;let o,r;if(typeof e!="object"&&(e=[e]),Mt(e))for(o=0,r=e.length;o<r;o++)n.call(null,e[o],o,e);else{const a=t?Object.getOwnPropertyNames(e):Object.keys(e),l=a.length;let u;for(o=0;o<l;o++)u=a[o],n.call(null,e[u],u,e)}}function ma(e,n){n=n.toLowerCase();const t=Object.keys(e);let o=t.length,r;for(;o-- >0;)if(r=t[o],n===r.toLowerCase())return r;return null}const Tt=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),pa=e=>!Qt(e)&&e!==Tt;function Ro(){const{caseless:e}=pa(this)&&this||{},n={},t=(o,r)=>{const a=e&&ma(n,r)||r;mn(n[a])&&mn(o)?n[a]=Ro(n[a],o):mn(o)?n[a]=Ro({},o):Mt(o)?n[a]=o.slice():n[a]=o};for(let o=0,r=arguments.length;o<r;o++)arguments[o]&&Zt(arguments[o],t);return n}const Ps=(e,n,t,{allOwnKeys:o}={})=>(Zt(n,(r,a)=>{t&&Ge(r)?e[a]=fa(r,t):e[a]=r},{allOwnKeys:o}),e),Ms=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Ws=(e,n,t,o)=>{e.prototype=Object.create(n.prototype,o),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},Os=(e,n,t,o)=>{let r,a,l;const u={};if(n=n||{},e==null)return n;do{for(r=Object.getOwnPropertyNames(e),a=r.length;a-- >0;)l=r[a],(!o||o(l,e,n))&&!u[l]&&(n[l]=e[l],u[l]=!0);e=t!==!1&&Uo(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},Ns=(e,n,t)=>{e=String(e),(t===void 0||t>e.length)&&(t=e.length),t-=n.length;const o=e.indexOf(n,t);return o!==-1&&o===t},Ls=e=>{if(!e)return null;if(Mt(e))return e;let n=e.length;if(!ga(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},Us=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&Uo(Uint8Array)),js=(e,n)=>{const o=(e&&e[_n]).call(e);let r;for(;(r=o.next())&&!r.done;){const a=r.value;n.call(e,a[0],a[1])}},Hs=(e,n)=>{let t;const o=[];for(;(t=e.exec(n))!==null;)o.push(t);return o},qs=tt("HTMLFormElement"),zs=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,o,r){return o.toUpperCase()+r}),rr=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),Gs=tt("RegExp"),ha=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),o={};Zt(t,(r,a)=>{let l;(l=n(r,a,e))!==!1&&(o[a]=l||r)}),Object.defineProperties(e,o)},Vs=e=>{ha(e,(n,t)=>{if(Ge(e)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const o=e[t];if(Ge(o)){if(n.enumerable=!1,"writable"in n){n.writable=!1;return}n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Ks=(e,n)=>{const t={},o=r=>{r.forEach(a=>{t[a]=!0})};return Mt(e)?o(e):o(String(e).split(n)),t},Ys=()=>{},Xs=(e,n)=>e!=null&&Number.isFinite(e=+e)?e:n;function Qs(e){return!!(e&&Ge(e.append)&&e[xa]==="FormData"&&e[_n])}const Zs=e=>{const n=new Array(10),t=(o,r)=>{if(Tn(o)){if(n.indexOf(o)>=0)return;if(!("toJSON"in o)){n[r]=o;const a=Mt(o)?[]:{};return Zt(o,(l,u)=>{const d=t(l,r+1);!Qt(d)&&(a[u]=d)}),n[r]=void 0,a}}return o};return t(e,0)},Js=tt("AsyncFunction"),e0=e=>e&&(Tn(e)||Ge(e))&&Ge(e.then)&&Ge(e.catch),ba=((e,n)=>e?setImmediate:n?((t,o)=>(Tt.addEventListener("message",({source:r,data:a})=>{r===Tt&&a===t&&o.length&&o.shift()()},!1),r=>{o.push(r),Tt.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Ge(Tt.postMessage)),t0=typeof queueMicrotask<"u"?queueMicrotask.bind(Tt):typeof process<"u"&&process.nextTick||ba,n0=e=>e!=null&&Ge(e[_n]),O={isArray:Mt,isArrayBuffer:va,isBuffer:bs,isFormData:ks,isArrayBufferView:ys,isString:Cs,isNumber:ga,isBoolean:ws,isObject:Tn,isPlainObject:mn,isReadableStream:Fs,isRequest:Ss,isResponse:Rs,isHeaders:$s,isUndefined:Qt,isDate:Es,isFile:_s,isBlob:As,isRegExp:Gs,isFunction:Ge,isStream:Ts,isURLSearchParams:Ds,isTypedArray:Us,isFileList:Bs,forEach:Zt,merge:Ro,extend:Ps,trim:Is,stripBOM:Ms,inherits:Ws,toFlatObject:Os,kindOf:An,kindOfTest:tt,endsWith:Ns,toArray:Ls,forEachEntry:js,matchAll:Hs,isHTMLForm:qs,hasOwnProperty:rr,hasOwnProp:rr,reduceDescriptors:ha,freezeMethods:Vs,toObjectSet:Ks,toCamelCase:zs,noop:Ys,toFiniteNumber:Xs,findKey:ma,global:Tt,isContextDefined:pa,isSpecCompliantForm:Qs,toJSONObject:Zs,isAsyncFn:Js,isThenable:e0,setImmediate:ba,asap:t0,isIterable:n0};function ce(e,n,t,o,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),o&&(this.request=o),r&&(this.response=r,this.status=r.status?r.status:null)}O.inherits(ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:O.toJSONObject(this.config),code:this.code,status:this.status}}});const ya=ce.prototype,Ca={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ca[e]={value:e}});Object.defineProperties(ce,Ca);Object.defineProperty(ya,"isAxiosError",{value:!0});ce.from=(e,n,t,o,r,a)=>{const l=Object.create(ya);return O.toFlatObject(e,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError"),ce.call(l,e.message,n,t,o,r),l.cause=e,l.name=e.name,a&&Object.assign(l,a),l};const o0=null;function $o(e){return O.isPlainObject(e)||O.isArray(e)}function wa(e){return O.endsWith(e,"[]")?e.slice(0,-2):e}function ar(e,n,t){return e?e.concat(n).map(function(r,a){return r=wa(r),!t&&a?"["+r+"]":r}).join(t?".":""):n}function r0(e){return O.isArray(e)&&!e.some($o)}const a0=O.toFlatObject(O,{},null,function(n){return/^is[A-Z]/.test(n)});function kn(e,n,t){if(!O.isObject(e))throw new TypeError("target must be an object");n=n||new FormData,t=O.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,x){return!O.isUndefined(x[h])});const o=t.metaTokens,r=t.visitor||c,a=t.dots,l=t.indexes,d=(t.Blob||typeof Blob<"u"&&Blob)&&O.isSpecCompliantForm(n);if(!O.isFunction(r))throw new TypeError("visitor must be a function");function s(g){if(g===null)return"";if(O.isDate(g))return g.toISOString();if(!d&&O.isBlob(g))throw new ce("Blob is not supported. Use a Buffer instead.");return O.isArrayBuffer(g)||O.isTypedArray(g)?d&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,h,x){let p=g;if(g&&!x&&typeof g=="object"){if(O.endsWith(h,"{}"))h=o?h:h.slice(0,-2),g=JSON.stringify(g);else if(O.isArray(g)&&r0(g)||(O.isFileList(g)||O.endsWith(h,"[]"))&&(p=O.toArray(g)))return h=wa(h),p.forEach(function(b,C){!(O.isUndefined(b)||b===null)&&n.append(l===!0?ar([h],C,a):l===null?h:h+"[]",s(b))}),!1}return $o(g)?!0:(n.append(ar(x,h,a),s(g)),!1)}const v=[],f=Object.assign(a0,{defaultVisitor:c,convertValue:s,isVisitable:$o});function y(g,h){if(!O.isUndefined(g)){if(v.indexOf(g)!==-1)throw Error("Circular reference detected in "+h.join("."));v.push(g),O.forEach(g,function(p,m){(!(O.isUndefined(p)||p===null)&&r.call(n,p,O.isString(m)?m.trim():m,h,f))===!0&&y(p,h?h.concat(m):[m])}),v.pop()}}if(!O.isObject(e))throw new TypeError("data must be an object");return y(e),n}function sr(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(o){return n[o]})}function jo(e,n){this._pairs=[],e&&kn(e,this,n)}const Ea=jo.prototype;Ea.append=function(n,t){this._pairs.push([n,t])};Ea.toString=function(n){const t=n?function(o){return n.call(this,o,sr)}:sr;return this._pairs.map(function(r){return t(r[0])+"="+t(r[1])},"").join("&")};function s0(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function _a(e,n,t){if(!n)return e;const o=t&&t.encode||s0;O.isFunction(t)&&(t={serialize:t});const r=t&&t.serialize;let a;if(r?a=r(n,t):a=O.isURLSearchParams(n)?n.toString():new jo(n,t).toString(o),a){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class i0{constructor(){this.handlers=[]}use(n,t,o){return this.handlers.push({fulfilled:n,rejected:t,synchronous:o?o.synchronous:!1,runWhen:o?o.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){O.forEach(this.handlers,function(o){o!==null&&n(o)})}}const ir=i0,Aa={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},l0=typeof URLSearchParams<"u"?URLSearchParams:jo,c0=typeof FormData<"u"?FormData:null,u0=typeof Blob<"u"?Blob:null,d0={isBrowser:!0,classes:{URLSearchParams:l0,FormData:c0,Blob:u0},protocols:["http","https","file","blob","url","data"]},Ho=typeof window<"u"&&typeof document<"u",Io=typeof navigator=="object"&&navigator||void 0,f0=Ho&&(!Io||["ReactNative","NativeScript","NS"].indexOf(Io.product)<0),x0=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),v0=Ho&&window.location.href||"http://localhost",g0=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ho,hasStandardBrowserEnv:f0,hasStandardBrowserWebWorkerEnv:x0,navigator:Io,origin:v0},Symbol.toStringTag,{value:"Module"})),Ne={...g0,...d0};function m0(e,n){return kn(e,new Ne.classes.URLSearchParams,Object.assign({visitor:function(t,o,r,a){return Ne.isNode&&O.isBuffer(t)?(this.append(o,t.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},n))}function p0(e){return O.matchAll(/\w+|\[(\w*)]/g,e).map(n=>n[0]==="[]"?"":n[1]||n[0])}function h0(e){const n={},t=Object.keys(e);let o;const r=t.length;let a;for(o=0;o<r;o++)a=t[o],n[a]=e[a];return n}function Ba(e){function n(t,o,r,a){let l=t[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=a>=t.length;return l=!l&&O.isArray(r)?r.length:l,d?(O.hasOwnProp(r,l)?r[l]=[r[l],o]:r[l]=o,!u):((!r[l]||!O.isObject(r[l]))&&(r[l]=[]),n(t,o,r[l],a)&&O.isArray(r[l])&&(r[l]=h0(r[l])),!u)}if(O.isFormData(e)&&O.isFunction(e.entries)){const t={};return O.forEachEntry(e,(o,r)=>{n(p0(o),r,t,0)}),t}return null}function b0(e,n,t){if(O.isString(e))try{return(n||JSON.parse)(e),O.trim(e)}catch(o){if(o.name!=="SyntaxError")throw o}return(t||JSON.stringify)(e)}const qo={transitional:Aa,adapter:["xhr","http","fetch"],transformRequest:[function(n,t){const o=t.getContentType()||"",r=o.indexOf("application/json")>-1,a=O.isObject(n);if(a&&O.isHTMLForm(n)&&(n=new FormData(n)),O.isFormData(n))return r?JSON.stringify(Ba(n)):n;if(O.isArrayBuffer(n)||O.isBuffer(n)||O.isStream(n)||O.isFile(n)||O.isBlob(n)||O.isReadableStream(n))return n;if(O.isArrayBufferView(n))return n.buffer;if(O.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let u;if(a){if(o.indexOf("application/x-www-form-urlencoded")>-1)return m0(n,this.formSerializer).toString();if((u=O.isFileList(n))||o.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return kn(u?{"files[]":n}:n,d&&new d,this.formSerializer)}}return a||r?(t.setContentType("application/json",!1),b0(n)):n}],transformResponse:[function(n){const t=this.transitional||qo.transitional,o=t&&t.forcedJSONParsing,r=this.responseType==="json";if(O.isResponse(n)||O.isReadableStream(n))return n;if(n&&O.isString(n)&&(o&&!this.responseType||r)){const l=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(n)}catch(u){if(l)throw u.name==="SyntaxError"?ce.from(u,ce.ERR_BAD_RESPONSE,this,null,this.response):u}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ne.classes.FormData,Blob:Ne.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};O.forEach(["delete","get","head","post","put","patch"],e=>{qo.headers[e]={}});const zo=qo,y0=O.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),C0=e=>{const n={};let t,o,r;return e&&e.split(`
`).forEach(function(l){r=l.indexOf(":"),t=l.substring(0,r).trim().toLowerCase(),o=l.substring(r+1).trim(),!(!t||n[t]&&y0[t])&&(t==="set-cookie"?n[t]?n[t].push(o):n[t]=[o]:n[t]=n[t]?n[t]+", "+o:o)}),n},lr=Symbol("internals");function zt(e){return e&&String(e).trim().toLowerCase()}function pn(e){return e===!1||e==null?e:O.isArray(e)?e.map(pn):String(e)}function w0(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let o;for(;o=t.exec(e);)n[o[1]]=o[2];return n}const E0=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Hn(e,n,t,o,r){if(O.isFunction(o))return o.call(this,n,t);if(r&&(n=t),!!O.isString(n)){if(O.isString(o))return n.indexOf(o)!==-1;if(O.isRegExp(o))return o.test(n)}}function _0(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,o)=>t.toUpperCase()+o)}function A0(e,n){const t=O.toCamelCase(" "+n);["get","set","has"].forEach(o=>{Object.defineProperty(e,o+t,{value:function(r,a,l){return this[o].call(this,n,r,a,l)},configurable:!0})})}class Dn{constructor(n){n&&this.set(n)}set(n,t,o){const r=this;function a(u,d,s){const c=zt(d);if(!c)throw new Error("header name must be a non-empty string");const v=O.findKey(r,c);(!v||r[v]===void 0||s===!0||s===void 0&&r[v]!==!1)&&(r[v||d]=pn(u))}const l=(u,d)=>O.forEach(u,(s,c)=>a(s,c,d));if(O.isPlainObject(n)||n instanceof this.constructor)l(n,t);else if(O.isString(n)&&(n=n.trim())&&!E0(n))l(C0(n),t);else if(O.isObject(n)&&O.isIterable(n)){let u={},d,s;for(const c of n){if(!O.isArray(c))throw TypeError("Object iterator must return a key-value pair");u[s=c[0]]=(d=u[s])?O.isArray(d)?[...d,c[1]]:[d,c[1]]:c[1]}l(u,t)}else n!=null&&a(t,n,o);return this}get(n,t){if(n=zt(n),n){const o=O.findKey(this,n);if(o){const r=this[o];if(!t)return r;if(t===!0)return w0(r);if(O.isFunction(t))return t.call(this,r,o);if(O.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=zt(n),n){const o=O.findKey(this,n);return!!(o&&this[o]!==void 0&&(!t||Hn(this,this[o],o,t)))}return!1}delete(n,t){const o=this;let r=!1;function a(l){if(l=zt(l),l){const u=O.findKey(o,l);u&&(!t||Hn(o,o[u],u,t))&&(delete o[u],r=!0)}}return O.isArray(n)?n.forEach(a):a(n),r}clear(n){const t=Object.keys(this);let o=t.length,r=!1;for(;o--;){const a=t[o];(!n||Hn(this,this[a],a,n,!0))&&(delete this[a],r=!0)}return r}normalize(n){const t=this,o={};return O.forEach(this,(r,a)=>{const l=O.findKey(o,a);if(l){t[l]=pn(r),delete t[a];return}const u=n?_0(a):String(a).trim();u!==a&&delete t[a],t[u]=pn(r),o[u]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return O.forEach(this,(o,r)=>{o!=null&&o!==!1&&(t[r]=n&&O.isArray(o)?o.join(", "):o)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const o=new this(n);return t.forEach(r=>o.set(r)),o}static accessor(n){const o=(this[lr]=this[lr]={accessors:{}}).accessors,r=this.prototype;function a(l){const u=zt(l);o[u]||(A0(r,l),o[u]=!0)}return O.isArray(n)?n.forEach(a):a(n),this}}Dn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);O.reduceDescriptors(Dn.prototype,({value:e},n)=>{let t=n[0].toUpperCase()+n.slice(1);return{get:()=>e,set(o){this[t]=o}}});O.freezeMethods(Dn);const et=Dn;function qn(e,n){const t=this||zo,o=n||t,r=et.from(o.headers);let a=o.data;return O.forEach(e,function(u){a=u.call(t,a,r.normalize(),n?n.status:void 0)}),r.normalize(),a}function Ta(e){return!!(e&&e.__CANCEL__)}function Wt(e,n,t){ce.call(this,e??"canceled",ce.ERR_CANCELED,n,t),this.name="CanceledError"}O.inherits(Wt,ce,{__CANCEL__:!0});function ka(e,n,t){const o=t.config.validateStatus;!t.status||!o||o(t.status)?e(t):n(new ce("Request failed with status code "+t.status,[ce.ERR_BAD_REQUEST,ce.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function B0(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}function T0(e,n){e=e||10;const t=new Array(e),o=new Array(e);let r=0,a=0,l;return n=n!==void 0?n:1e3,function(d){const s=Date.now(),c=o[a];l||(l=s),t[r]=d,o[r]=s;let v=a,f=0;for(;v!==r;)f+=t[v++],v=v%e;if(r=(r+1)%e,r===a&&(a=(a+1)%e),s-l<n)return;const y=c&&s-c;return y?Math.round(f*1e3/y):void 0}}function k0(e,n){let t=0,o=1e3/n,r,a;const l=(s,c=Date.now())=>{t=c,r=null,a&&(clearTimeout(a),a=null),e.apply(null,s)};return[(...s)=>{const c=Date.now(),v=c-t;v>=o?l(s,c):(r=s,a||(a=setTimeout(()=>{a=null,l(r)},o-v)))},()=>r&&l(r)]}const yn=(e,n,t=3)=>{let o=0;const r=T0(50,250);return k0(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,d=l-o,s=r(d),c=l<=u;o=l;const v={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:s||void 0,estimated:s&&u&&c?(u-l)/s:void 0,event:a,lengthComputable:u!=null,[n?"download":"upload"]:!0};e(v)},t)},cr=(e,n)=>{const t=e!=null;return[o=>n[0]({lengthComputable:t,total:e,loaded:o}),n[1]]},ur=e=>(...n)=>O.asap(()=>e(...n)),D0=Ne.hasStandardBrowserEnv?((e,n)=>t=>(t=new URL(t,Ne.origin),e.protocol===t.protocol&&e.host===t.host&&(n||e.port===t.port)))(new URL(Ne.origin),Ne.navigator&&/(msie|trident)/i.test(Ne.navigator.userAgent)):()=>!0,F0=Ne.hasStandardBrowserEnv?{write(e,n,t,o,r,a){const l=[e+"="+encodeURIComponent(n)];O.isNumber(t)&&l.push("expires="+new Date(t).toGMTString()),O.isString(o)&&l.push("path="+o),O.isString(r)&&l.push("domain="+r),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const n=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return n?decodeURIComponent(n[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function S0(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function R0(e,n){return n?e.replace(/\/?\/$/,"")+"/"+n.replace(/^\/+/,""):e}function Da(e,n,t){let o=!S0(n);return e&&(o||t==!1)?R0(e,n):n}const dr=e=>e instanceof et?{...e}:e;function kt(e,n){n=n||{};const t={};function o(s,c,v,f){return O.isPlainObject(s)&&O.isPlainObject(c)?O.merge.call({caseless:f},s,c):O.isPlainObject(c)?O.merge({},c):O.isArray(c)?c.slice():c}function r(s,c,v,f){if(O.isUndefined(c)){if(!O.isUndefined(s))return o(void 0,s,v,f)}else return o(s,c,v,f)}function a(s,c){if(!O.isUndefined(c))return o(void 0,c)}function l(s,c){if(O.isUndefined(c)){if(!O.isUndefined(s))return o(void 0,s)}else return o(void 0,c)}function u(s,c,v){if(v in n)return o(s,c);if(v in e)return o(void 0,s)}const d={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(s,c,v)=>r(dr(s),dr(c),v,!0)};return O.forEach(Object.keys(Object.assign({},e,n)),function(c){const v=d[c]||r,f=v(e[c],n[c],c);O.isUndefined(f)&&v!==u||(t[c]=f)}),t}const Fa=e=>{const n=kt({},e);let{data:t,withXSRFToken:o,xsrfHeaderName:r,xsrfCookieName:a,headers:l,auth:u}=n;n.headers=l=et.from(l),n.url=_a(Da(n.baseURL,n.url,n.allowAbsoluteUrls),e.params,e.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let d;if(O.isFormData(t)){if(Ne.hasStandardBrowserEnv||Ne.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((d=l.getContentType())!==!1){const[s,...c]=d?d.split(";").map(v=>v.trim()).filter(Boolean):[];l.setContentType([s||"multipart/form-data",...c].join("; "))}}if(Ne.hasStandardBrowserEnv&&(o&&O.isFunction(o)&&(o=o(n)),o||o!==!1&&D0(n.url))){const s=r&&a&&F0.read(a);s&&l.set(r,s)}return n},$0=typeof XMLHttpRequest<"u",I0=$0&&function(e){return new Promise(function(t,o){const r=Fa(e);let a=r.data;const l=et.from(r.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:s}=r,c,v,f,y,g;function h(){y&&y(),g&&g(),r.cancelToken&&r.cancelToken.unsubscribe(c),r.signal&&r.signal.removeEventListener("abort",c)}let x=new XMLHttpRequest;x.open(r.method.toUpperCase(),r.url,!0),x.timeout=r.timeout;function p(){if(!x)return;const b=et.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),w={data:!u||u==="text"||u==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:b,config:e,request:x};ka(function(T){t(T),h()},function(T){o(T),h()},w),x=null}"onloadend"in x?x.onloadend=p:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(p)},x.onabort=function(){x&&(o(new ce("Request aborted",ce.ECONNABORTED,e,x)),x=null)},x.onerror=function(){o(new ce("Network Error",ce.ERR_NETWORK,e,x)),x=null},x.ontimeout=function(){let C=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const w=r.transitional||Aa;r.timeoutErrorMessage&&(C=r.timeoutErrorMessage),o(new ce(C,w.clarifyTimeoutError?ce.ETIMEDOUT:ce.ECONNABORTED,e,x)),x=null},a===void 0&&l.setContentType(null),"setRequestHeader"in x&&O.forEach(l.toJSON(),function(C,w){x.setRequestHeader(w,C)}),O.isUndefined(r.withCredentials)||(x.withCredentials=!!r.withCredentials),u&&u!=="json"&&(x.responseType=r.responseType),s&&([f,g]=yn(s,!0),x.addEventListener("progress",f)),d&&x.upload&&([v,y]=yn(d),x.upload.addEventListener("progress",v),x.upload.addEventListener("loadend",y)),(r.cancelToken||r.signal)&&(c=b=>{x&&(o(!b||b.type?new Wt(null,e,x):b),x.abort(),x=null)},r.cancelToken&&r.cancelToken.subscribe(c),r.signal&&(r.signal.aborted?c():r.signal.addEventListener("abort",c)));const m=B0(r.url);if(m&&Ne.protocols.indexOf(m)===-1){o(new ce("Unsupported protocol "+m+":",ce.ERR_BAD_REQUEST,e));return}x.send(a||null)})},P0=(e,n)=>{const{length:t}=e=e?e.filter(Boolean):[];if(n||t){let o=new AbortController,r;const a=function(s){if(!r){r=!0,u();const c=s instanceof Error?s:this.reason;o.abort(c instanceof ce?c:new Wt(c instanceof Error?c.message:c))}};let l=n&&setTimeout(()=>{l=null,a(new ce(`timeout ${n} of ms exceeded`,ce.ETIMEDOUT))},n);const u=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(s=>{s.unsubscribe?s.unsubscribe(a):s.removeEventListener("abort",a)}),e=null)};e.forEach(s=>s.addEventListener("abort",a));const{signal:d}=o;return d.unsubscribe=()=>O.asap(u),d}},M0=P0,W0=function*(e,n){let t=e.byteLength;if(!n||t<n){yield e;return}let o=0,r;for(;o<t;)r=o+n,yield e.slice(o,r),o=r},O0=async function*(e,n){for await(const t of N0(e))yield*W0(t,n)},N0=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const n=e.getReader();try{for(;;){const{done:t,value:o}=await n.read();if(t)break;yield o}}finally{await n.cancel()}},fr=(e,n,t,o)=>{const r=O0(e,n);let a=0,l,u=d=>{l||(l=!0,o&&o(d))};return new ReadableStream({async pull(d){try{const{done:s,value:c}=await r.next();if(s){u(),d.close();return}let v=c.byteLength;if(t){let f=a+=v;t(f)}d.enqueue(new Uint8Array(c))}catch(s){throw u(s),s}},cancel(d){return u(d),r.return()}},{highWaterMark:2})},Fn=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Sa=Fn&&typeof ReadableStream=="function",L0=Fn&&(typeof TextEncoder=="function"?(e=>n=>e.encode(n))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Ra=(e,...n)=>{try{return!!e(...n)}catch{return!1}},U0=Sa&&Ra(()=>{let e=!1;const n=new Request(Ne.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!n}),xr=64*1024,Po=Sa&&Ra(()=>O.isReadableStream(new Response("").body)),Cn={stream:Po&&(e=>e.body)};Fn&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(n=>{!Cn[n]&&(Cn[n]=O.isFunction(e[n])?t=>t[n]():(t,o)=>{throw new ce(`Response type '${n}' is not supported`,ce.ERR_NOT_SUPPORT,o)})})})(new Response);const j0=async e=>{if(e==null)return 0;if(O.isBlob(e))return e.size;if(O.isSpecCompliantForm(e))return(await new Request(Ne.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(O.isArrayBufferView(e)||O.isArrayBuffer(e))return e.byteLength;if(O.isURLSearchParams(e)&&(e=e+""),O.isString(e))return(await L0(e)).byteLength},H0=async(e,n)=>{const t=O.toFiniteNumber(e.getContentLength());return t??j0(n)},q0=Fn&&(async e=>{let{url:n,method:t,data:o,signal:r,cancelToken:a,timeout:l,onDownloadProgress:u,onUploadProgress:d,responseType:s,headers:c,withCredentials:v="same-origin",fetchOptions:f}=Fa(e);s=s?(s+"").toLowerCase():"text";let y=M0([r,a&&a.toAbortSignal()],l),g;const h=y&&y.unsubscribe&&(()=>{y.unsubscribe()});let x;try{if(d&&U0&&t!=="get"&&t!=="head"&&(x=await H0(c,o))!==0){let w=new Request(n,{method:"POST",body:o,duplex:"half"}),A;if(O.isFormData(o)&&(A=w.headers.get("content-type"))&&c.setContentType(A),w.body){const[T,F]=cr(x,yn(ur(d)));o=fr(w.body,xr,T,F)}}O.isString(v)||(v=v?"include":"omit");const p="credentials"in Request.prototype;g=new Request(n,{...f,signal:y,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:o,duplex:"half",credentials:p?v:void 0});let m=await fetch(g);const b=Po&&(s==="stream"||s==="response");if(Po&&(u||b&&h)){const w={};["status","statusText","headers"].forEach(z=>{w[z]=m[z]});const A=O.toFiniteNumber(m.headers.get("content-length")),[T,F]=u&&cr(A,yn(ur(u),!0))||[];m=new Response(fr(m.body,xr,T,()=>{F&&F(),h&&h()}),w)}s=s||"text";let C=await Cn[O.findKey(Cn,s)||"text"](m,e);return!b&&h&&h(),await new Promise((w,A)=>{ka(w,A,{data:C,headers:et.from(m.headers),status:m.status,statusText:m.statusText,config:e,request:g})})}catch(p){throw h&&h(),p&&p.name==="TypeError"&&/Load failed|fetch/i.test(p.message)?Object.assign(new ce("Network Error",ce.ERR_NETWORK,e,g),{cause:p.cause||p}):ce.from(p,p&&p.code,e,g)}}),Mo={http:o0,xhr:I0,fetch:q0};O.forEach(Mo,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const vr=e=>`- ${e}`,z0=e=>O.isFunction(e)||e===null||e===!1,$a={getAdapter:e=>{e=O.isArray(e)?e:[e];const{length:n}=e;let t,o;const r={};for(let a=0;a<n;a++){t=e[a];let l;if(o=t,!z0(t)&&(o=Mo[(l=String(t)).toLowerCase()],o===void 0))throw new ce(`Unknown adapter '${l}'`);if(o)break;r[l||"#"+a]=o}if(!o){const a=Object.entries(r).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=n?a.length>1?`since :
`+a.map(vr).join(`
`):" "+vr(a[0]):"as no adapter specified";throw new ce("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return o},adapters:Mo};function zn(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Wt(null,e)}function gr(e){return zn(e),e.headers=et.from(e.headers),e.data=qn.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),$a.getAdapter(e.adapter||zo.adapter)(e).then(function(o){return zn(e),o.data=qn.call(e,e.transformResponse,o),o.headers=et.from(o.headers),o},function(o){return Ta(o)||(zn(e),o&&o.response&&(o.response.data=qn.call(e,e.transformResponse,o.response),o.response.headers=et.from(o.response.headers))),Promise.reject(o)})}const Ia="1.9.0",Sn={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Sn[e]=function(o){return typeof o===e||"a"+(n<1?"n ":" ")+e}});const mr={};Sn.transitional=function(n,t,o){function r(a,l){return"[Axios v"+Ia+"] Transitional option '"+a+"'"+l+(o?". "+o:"")}return(a,l,u)=>{if(n===!1)throw new ce(r(l," has been removed"+(t?" in "+t:"")),ce.ERR_DEPRECATED);return t&&!mr[l]&&(mr[l]=!0,console.warn(r(l," has been deprecated since v"+t+" and will be removed in the near future"))),n?n(a,l,u):!0}};Sn.spelling=function(n){return(t,o)=>(console.warn(`${o} is likely a misspelling of ${n}`),!0)};function G0(e,n,t){if(typeof e!="object")throw new ce("options must be an object",ce.ERR_BAD_OPTION_VALUE);const o=Object.keys(e);let r=o.length;for(;r-- >0;){const a=o[r],l=n[a];if(l){const u=e[a],d=u===void 0||l(u,a,e);if(d!==!0)throw new ce("option "+a+" must be "+d,ce.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ce("Unknown option "+a,ce.ERR_BAD_OPTION)}}const hn={assertOptions:G0,validators:Sn},it=hn.validators;class wn{constructor(n){this.defaults=n||{},this.interceptors={request:new ir,response:new ir}}async request(n,t){try{return await this._request(n,t)}catch(o){if(o instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{o.stack?a&&!String(o.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(o.stack+=`
`+a):o.stack=a}catch{}}throw o}}_request(n,t){typeof n=="string"?(t=t||{},t.url=n):t=n||{},t=kt(this.defaults,t);const{transitional:o,paramsSerializer:r,headers:a}=t;o!==void 0&&hn.assertOptions(o,{silentJSONParsing:it.transitional(it.boolean),forcedJSONParsing:it.transitional(it.boolean),clarifyTimeoutError:it.transitional(it.boolean)},!1),r!=null&&(O.isFunction(r)?t.paramsSerializer={serialize:r}:hn.assertOptions(r,{encode:it.function,serialize:it.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),hn.assertOptions(t,{baseUrl:it.spelling("baseURL"),withXsrfToken:it.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let l=a&&O.merge(a.common,a[t.method]);a&&O.forEach(["delete","get","head","post","put","patch","common"],g=>{delete a[g]}),t.headers=et.concat(l,a);const u=[];let d=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(t)===!1||(d=d&&h.synchronous,u.unshift(h.fulfilled,h.rejected))});const s=[];this.interceptors.response.forEach(function(h){s.push(h.fulfilled,h.rejected)});let c,v=0,f;if(!d){const g=[gr.bind(this),void 0];for(g.unshift.apply(g,u),g.push.apply(g,s),f=g.length,c=Promise.resolve(t);v<f;)c=c.then(g[v++],g[v++]);return c}f=u.length;let y=t;for(v=0;v<f;){const g=u[v++],h=u[v++];try{y=g(y)}catch(x){h.call(this,x);break}}try{c=gr.call(this,y)}catch(g){return Promise.reject(g)}for(v=0,f=s.length;v<f;)c=c.then(s[v++],s[v++]);return c}getUri(n){n=kt(this.defaults,n);const t=Da(n.baseURL,n.url,n.allowAbsoluteUrls);return _a(t,n.params,n.paramsSerializer)}}O.forEach(["delete","get","head","options"],function(n){wn.prototype[n]=function(t,o){return this.request(kt(o||{},{method:n,url:t,data:(o||{}).data}))}});O.forEach(["post","put","patch"],function(n){function t(o){return function(a,l,u){return this.request(kt(u||{},{method:n,headers:o?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}wn.prototype[n]=t(),wn.prototype[n+"Form"]=t(!0)});const bn=wn;class Go{constructor(n){if(typeof n!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(a){t=a});const o=this;this.promise.then(r=>{if(!o._listeners)return;let a=o._listeners.length;for(;a-- >0;)o._listeners[a](r);o._listeners=null}),this.promise.then=r=>{let a;const l=new Promise(u=>{o.subscribe(u),a=u}).then(r);return l.cancel=function(){o.unsubscribe(a)},l},n(function(a,l,u){o.reason||(o.reason=new Wt(a,l,u),t(o.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){if(this.reason){n(this.reason);return}this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const n=new AbortController,t=o=>{n.abort(o)};return this.subscribe(t),n.signal.unsubscribe=()=>this.unsubscribe(t),n.signal}static source(){let n;return{token:new Go(function(r){n=r}),cancel:n}}}const V0=Go;function K0(e){return function(t){return e.apply(null,t)}}function Y0(e){return O.isObject(e)&&e.isAxiosError===!0}const Wo={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wo).forEach(([e,n])=>{Wo[n]=e});const X0=Wo;function Pa(e){const n=new bn(e),t=fa(bn.prototype.request,n);return O.extend(t,bn.prototype,n,{allOwnKeys:!0}),O.extend(t,n,null,{allOwnKeys:!0}),t.create=function(r){return Pa(kt(e,r))},t}const Te=Pa(zo);Te.Axios=bn;Te.CanceledError=Wt;Te.CancelToken=V0;Te.isCancel=Ta;Te.VERSION=Ia;Te.toFormData=kn;Te.AxiosError=ce;Te.Cancel=Te.CanceledError;Te.all=function(n){return Promise.all(n)};Te.spread=K0;Te.isAxiosError=Y0;Te.mergeConfig=kt;Te.AxiosHeaders=et;Te.formToJSON=e=>Ba(O.isHTMLForm(e)?new FormData(e):e);Te.getAdapter=$a.getAdapter;Te.HttpStatusCode=X0;Te.default=Te;const pr=Te,Vo="d2e4870307a7be95c6173111",Ko="hmmLdoyJSvJe2KV2",Q0="5d6664673bdb0b63f8da4ed1dd055a57a702";let Yo=!1;async function Z0(){try{const e=await fetch(`https://spacetalk.metered.live/api/v1/turn/credentials?apiKey=${Q0}`);if(!e.ok)return console.error("Failed to fetch TURN credentials from API:",e.status,e.statusText),null;const n=await e.json();return n&&Array.isArray(n)?(Yo=!0,console.log("Successfully fetched TURN credentials from Metered API"),{iceServers:n,iceCandidatePoolSize:15,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"}):(console.warn("API returned invalid TURN credentials format, using fallback"),null)}catch(e){return console.error("Failed to fetch TURN credentials from API, using fallback:",e),null}}async function J0(){try{const e=window.location.origin;console.log(`Fetching TURN credentials from ${e}/api/turn-credentials`);const n=new AbortController,t=setTimeout(()=>n.abort(),8e3),o=await pr.get(`${e}/api/turn-credentials`,{signal:n.signal,timeout:8e3});return clearTimeout(t),o.data&&o.data.success&&o.data.rtcConfig?(Yo=!0,console.log("Successfully fetched TURN credentials from server"),o.data.rtcConfig):(console.warn("Server returned invalid TURN credentials format, using fallback"),null)}catch(e){return pr.isAxiosError(e)?e.code==="ECONNABORTED"||e.message.includes("timeout")?console.error("TURN credentials request timed out"):e.response?console.error(`TURN credentials request failed with status ${e.response.status}`):e.request?console.error("TURN credentials request made but no response received"):console.error("Failed to fetch TURN credentials:",e.message):console.error("Failed to fetch TURN credentials, using fallback:",e),null}}const Xo={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun.cloudflare.com:3478"},{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp","turns:openrelay.metered.ca:443","turns:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:global.relay.metered.ca:80","turn:global.relay.metered.ca:80?transport=tcp","turn:global.relay.metered.ca:443","turn:global.relay.metered.ca:443?transport=tcp","turns:global.relay.metered.ca:443","turns:global.relay.metered.ca:443?transport=tcp"],username:Vo,credential:Ko}],iceCandidatePoolSize:15,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},ut={iceServers:[{urls:["turn:openrelay.metered.ca:443?transport=tcp","turns:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:global.relay.metered.ca:443?transport=tcp","turns:global.relay.metered.ca:443?transport=tcp","turn:a.relay.metered.ca:443?transport=tcp","turns:a.relay.metered.ca:443?transport=tcp","turn:b.relay.metered.ca:443?transport=tcp","turns:b.relay.metered.ca:443?transport=tcp"],username:Vo,credential:Ko},{urls:["turn:64.233.165.127:19305?transport=tcp","turn:74.125.140.127:19305?transport=tcp"],username:"CKjCuLwFEgahxNRjE/s6Hc/UfSPmPSFvbTfnGd+KaGg=",credential:"VJwbRpc3PlU0jP+nKCjNF+AE0to="}],iceCandidatePoolSize:15,iceTransportPolicy:"relay",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},hr={iceServers:[{urls:"stun:stun.relay.metered.ca:80"},{urls:"stun:stun.l.google.com:19302"},{urls:"turn:global.relay.metered.ca:80",username:Vo,credential:Ko}],iceCandidatePoolSize:8,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};async function ei(){try{const e=await Z0();if(e)return e;if(!Yo){const n=await J0();if(n)return n}}catch(e){console.error("Error fetching optimal configuration:",e)}return Xo}function ti(){const e="test";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(n){return console.error("localStorage is not available:",n),!1}}function Ma(){const e=N(ti());function n(a,l){if(!e.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(a,l)}catch(u){console.error("Failed to set localStorage item:",u)}}function t(a){if(!e.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(a)}catch(l){return console.error("Failed to get localStorage item:",l),null}}function o(a){if(!e.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(a)}catch(l){console.error("Failed to remove localStorage item:",l)}}function r(){if(!e.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(a){console.error("Failed to clear localStorage:",a)}}return{isAvailable:e,setItem:n,getItem:t,removeItem:o,clear:r}}function Vt(){const{getItem:e,setItem:n}=Ma(),t="spacechat_microphone_muted";function o(l){n(t,l?"true":"false")}function r(){const l=e(t);return l===null?null:l==="true"}function a(l){return new Promise(async u=>{try{const d=r();d!==null&&(console.log(`[Storage] Found saved microphone state: ${d?"muted":"unmuted"}`),d===!0&&await l())}catch(d){console.error("[Storage] Error applying saved microphone state:",d)}u()})}return{saveMicrophoneState:o,getSavedMicrophoneState:r,applySavedMicrophoneState:a}}let Bt=Xo;const dt=N(Bt);let Wa=!1;ei().then(e=>{Bt=e,dt.value=e,Wa=!0,console.log("Loaded optimal WebRTC configuration from server")}).catch(e=>{console.error("Failed to load optimal configuration, using fallback:",e)});let Q=null,ae=null,le=null;const Ae=N("new"),Ye=N(!1),Se=N(null),re=!0;let je="",pt="",br=null,Oe=!1,Kt=!1,_e=0;const At=15;let Xe=[],It=null;const ni=8e3,oi=1e3,ri=3e4;let _t=null,Qe=0;const fn=10,ai=1e3;let Yt=null;const si=1e4;let xn=0;const yr=3;async function ii(e,n,t={}){var o,r,a;if(e)try{const l=await e.getStats(),u={};l.forEach(s=>{u[s.id]={type:s.type,timestamp:s.timestamp,...s}});const d={event:n,timestamp:Date.now(),connectionState:e.connectionState,iceConnectionState:e.iceConnectionState,iceGatheringState:e.iceGatheringState,signalingState:e.signalingState,localCandidates:((o=window.__localIceCandidates)==null?void 0:o.length)||0,remoteCandidates:((r=window.__remoteIceCandidates)==null?void 0:r.length)||0,iceCandidatePairsCount:((a=window.__iceCandidatePairs)==null?void 0:a.length)||0,rtcConfiguration:dt.value,hasDynamicConfig:Wa,details:t,statsData:u};fetch("/api/webrtc-diagnostics",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)}).catch(s=>{console.error("Failed to send diagnostic data:",s)})}catch(l){console.error("Error collecting diagnostic data:",l)}}async function Oa(){if(!Q)return{error:"No peer connection available"};try{const e={};return(await Q.getStats()).forEach(t=>{t.type==="transport"?e.transport={bytesReceived:t.bytesReceived,bytesSent:t.bytesSent,dtlsState:t.dtlsState,selectedCandidatePairId:t.selectedCandidatePairId}:t.type==="candidate-pair"&&t.selected?e.selectedCandidatePair={localCandidateId:t.localCandidateId,remoteCandidateId:t.remoteCandidateId,state:t.state,availableOutgoingBitrate:t.availableOutgoingBitrate}:t.type==="local-candidate"||t.type==="remote-candidate"?(e.candidates||(e.candidates=[]),e.candidates.push({type:t.type,id:t.id,ip:t.ip,port:t.port,protocol:t.protocol,candidateType:t.candidateType})):(t.type==="media-source"||t.type==="track"||t.type==="media-playout")&&(e.media||(e.media=[]),e.media.push({type:t.type,id:t.id,kind:t.kind,audioLevel:t.audioLevel,trackIdentifier:t.trackIdentifier}))}),e}catch(e){return console.error("[WebRTC] Error getting stats:",e),{error:"Failed to get stats: "+e}}}function Cr(){En();const e=setInterval(async()=>{Q&&(Ae.value==="connected"||Ae.value==="connecting")?(br=await Oa(),console.log("[WebRTC] Connection stats:",br)):En()},5e3);window.__webrtcStatsTimer=e}function En(){const e=window.__webrtcStatsTimer;e&&(clearInterval(e),window.__webrtcStatsTimer=null)}async function li(e){if(!e)return!1;try{const n=await e.getStats();let t=!1,o=!1;return n.forEach(r=>{if((r.type==="local-candidate"||r.type==="remote-candidate")&&r.candidateType==="relay"&&(t=!0,console.log(`[WebRTC] Found TURN candidate: ${r.candidateType} at ${r.address}:${r.port}`)),r.type==="candidate-pair"&&r.state==="succeeded"){const a=r.localCandidateId,l=r.remoteCandidateId;n.forEach(u=>{(u.id===a||u.id===l)&&u.candidateType==="relay"&&(o=!0,console.log("[WebRTC] Found successful TURN candidate pair"),window.localStorage.setItem("last_conn_required_turn","true"),window.localStorage.setItem("last_turn_timestamp",Date.now().toString()))})}}),t?(console.log("[WebRTC] Connection using TURN candidates"),!0):(t||(console.log("[WebRTC] No TURN candidates found in connection"),e.connectionState==="connected"&&(window.localStorage.removeItem("last_conn_required_turn"),console.log("[WebRTC] Connection succeeded without TURN, removed flag"))),o)}catch(n){return console.error("[WebRTC] Error checking for TURN candidates:",n),!1}}function Na(){const{socket:e,userId:n,isInSetupContext:t}=Me(),o=jn(Q),r=jn(ae),a=jn(le),l=Ae,u=Ye,d=Se;N({echoCancellation:!0,noiseSuppression:!0});const s=async()=>{if(ae&&ae.getAudioTracks().length>0)return console.log("[WebRTC] Reusing existing local stream"),ae;try{re&&console.log("[WebRTC] Requesting microphone access");const $=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1}),k=$.getAudioTracks();if(k.length===0)throw new Error("No audio tracks available in media stream");re&&(console.log(`[WebRTC] Got local stream with ${k.length} audio tracks`),console.log("[WebRTC] Audio track settings:",k[0].getSettings())),ae=$,r.value=$;const{getSavedMicrophoneState:S}=Vt();return S()===!0?(re&&console.log("[WebRTC] Applying saved mute state to new stream (muted)"),k.forEach(I=>{I.enabled=!1}),Ye.value=!0,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:!0}}))):(k.forEach(I=>{I.enabled=!0}),Ye.value=!1),$}catch($){throw console.error("[WebRTC] Error accessing microphone:",$),pt=`Failed to access microphone: ${$}`,$}},c=()=>{if(Q)try{Q.close(),Q=null,le&&(le.getTracks().forEach($=>{$.stop()}),le=null)}catch($){console.error("[WebRTC] Error cleaning up old peer connection:",$)}try{const $=di();re&&console.log("[WebRTC] ICE configuration:",$);const k=new RTCPeerConnection($);return k.onnegotiationneeded=async S=>{if(re&&console.log("[WebRTC] Negotiation needed event",S),!ci(k)||Oe){re&&console.log("[WebRTC] Skipping negotiation - already in progress or not in stable state");return}Oe=!0;try{re&&console.log("[WebRTC] Starting negotiation"),B()}catch(R){console.error("[WebRTC] Negotiation error:",R),pt=`Negotiation error: ${R}`,Oe=!1}},k.oniceconnectionstatechange=()=>{re&&console.log("[WebRTC] ICE Connection state changed to:",k.iceConnectionState),k.iceConnectionState==="connected"||k.iceConnectionState==="completed"?(pt="",_e=0,A(),Cr()):(k.iceConnectionState==="disconnected"||k.iceConnectionState==="failed"||k.iceConnectionState==="closed")&&(Ze(k.iceConnectionState),re&&console.log("[WebRTC] ICE Connection terminated:",k.iceConnectionState),Se.value&&e.value&&e.value.emit("webrtc-connection-state",{to:Se.value,state:k.iceConnectionState,reason:"ice-connection-state-change"}),(k.iceConnectionState==="failed"||k.iceConnectionState==="closed")&&setTimeout(()=>{(k.iceConnectionState==="failed"||k.iceConnectionState==="closed")&&Ze("failed")},2e3))},k.onicecandidate=S=>{var R;S.candidate?(re&&console.log("[WebRTC] New ICE candidate:",S.candidate),window.__localIceCandidates||(window.__localIceCandidates=[]),window.__localIceCandidates.push(S.candidate),d.value?(R=e.value)==null||R.emit("webrtc-signal",{type:"ice-candidate",candidate:S.candidate,to:d.value}):(Xe.push(S.candidate),re&&console.log("[WebRTC] Storing ICE candidate for later. Total pending:",Xe.length))):(re&&console.log("[WebRTC] ICE gathering complete"),Xe.length>0&&d.value&&(Xe.forEach(I=>{var L;(L=e.value)==null||L.emit("webrtc-signal",{type:"ice-candidate",candidate:I,to:d.value})}),re&&console.log(`[WebRTC] Sent ${Xe.length} pending ICE candidates`),Xe=[]))},k.onicegatheringstatechange=()=>{re&&console.log("[WebRTC] ICE gathering state changed to:",k.iceGatheringState),k.iceGatheringState==="complete"&&setTimeout(async()=>{!await li(k)&&dt.value!==ut&&_e>1&&(console.log("[WebRTC] 🔄 No TURN candidates found, switching to TURN-only configuration"),dt.value=ut,Se.value&&setTimeout(()=>{(Q==null?void 0:Q.connectionState)!=="connected"&&(console.log("[WebRTC] 🔄 Reconnecting with TURN-only configuration"),p(),E(Se.value).then(B))},2e3))},1e3)},k.onconnectionstatechange=S=>{switch(re&&console.log(`[WebRTC] Connection state changed: ${k.connectionState}`),Ze(k.connectionState),k.connectionState){case"connected":console.log("[WebRTC] Connection established successfully"),_e=0,Qe=0,fi(k),ii(k,"connection-established"),Cr();break;case"failed":console.warn("[WebRTC] Connection failed"),Ze("failed");break;case"disconnected":console.warn("[WebRTC] Connection disconnected"),Ze("disconnected");break;case"closed":console.warn("[WebRTC] Connection closed"),Ze("closed");break}},k.onsignalingstatechange=()=>{re&&console.log("[WebRTC] Signaling state changed to:",k.signalingState),k.signalingState==="stable"&&(Oe=!1)},k.ontrack=S=>{re&&console.log("[WebRTC] Track received:",S.track),le||(le=new MediaStream,a.value=le,console.log("[WebRTC] Created new remote stream")),le.addTrack(S.track),console.log(`[WebRTC] Added ${S.track.kind} track to remote stream, now has ${le.getTracks().length} tracks`),setTimeout(()=>{if(le){const R=le.getTracks();console.log(`[WebRTC] Remote stream has ${R.length} tracks after adding`),R.forEach(I=>{console.log(`[WebRTC] Track: ${I.kind}, enabled: ${I.enabled}, muted: ${I.muted}, readyState: ${I.readyState}`),I.kind==="audio"&&(!I.enabled||I.muted)&&(console.log("[WebRTC] 🔴 Found disabled or muted audio track, enabling it"),I.enabled=!0)})}},500),re&&(S.track.onunmute=()=>{console.log("[WebRTC] Track unmuted:",S.track.kind)},S.track.onmute=()=>{console.log("[WebRTC] Track muted:",S.track.kind),S.track.enabled=!0},S.track.onended=()=>{console.log("[WebRTC] Track ended:",S.track.kind)})},F(k),Q=k,k}catch($){throw console.error("[WebRTC] Error creating peer connection:",$),je=`Creation error: ${$}`,pt="Failed to create connection",Ze("failed"),$}},v=async $=>{if(!$||!e.value){const k="لا يمكن إنشاء الاتصال: معرّف الشريك أو الاتصال غير متوفر";return console.error(`[WebRTC] ${k}`),je=k,{error:k}}Se.value=$,d.value=$;try{ae||await s();const k=c();if(ae)ae.getTracks().forEach(S=>{k.addTrack(S,ae)});else throw new Error("لا يمكن الوصول للميكروفون");return Ze("connecting"),k}catch(k){return console.error("[WebRTC] Error establishing connection:",k),je=`خطأ في إنشاء الاتصال: ${k}`,{error:je}}},f=async $=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),Oe)return console.warn("[WebRTC] مفاوضة جارية بالفعل، تأجيل العرض الجديد"),new Promise(k=>{setTimeout(async()=>{k(Oe?{waiting:"Negotiation in progress"}:await f($))},1e3)});Oe=!0;try{const k=await v($);if(k.error)return k;re&&console.log("[WebRTC] Creating offer");const S=await k.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return re&&console.log("[WebRTC] Setting local description"),await k.setLocalDescription(S),e.value&&$&&(e.value.emit("voice-offer",{offer:k.localDescription,to:$}),e.value.emit("webrtc-signal",{type:"offer",offer:k.localDescription,to:$})),F(k),A(),re&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(k){return console.error("[WebRTC] Error creating offer:",k),je=`Error creating offer: ${k}`,Oe=!1,{error:`Failed to create offer: ${k}`}}finally{setTimeout(()=>{Oe=!1},2e3)}},y=$=>{if(console.log("Waiting for ICE gathering to complete..."),$.iceGatheringState==="complete")return console.log("ICE gathering already complete"),Promise.resolve();const k=6e3,S=500,R=Math.ceil(k/S);let I=0,L=0;return new Promise(K=>{const V=()=>{if(I++,$.iceGatheringState==="complete"){console.log(`ICE gathering complete after ${I} attempts`),K();return}if(window.__localIceCandidates&&window.__localIceCandidates.length>L&&(L=window.__localIceCandidates.length,console.log(`ICE candidates collected so far: ${L}`)),L>=3&&I>R/2){console.log(`Sufficient ICE candidates (${L}) collected after ${I} attempts`),K();return}if(I>=R){console.log(`Reached maximum attempts (${R}), proceeding with ${L} ICE candidates`),K();return}setTimeout(V,S)};$.addEventListener("icegatheringstatechange",()=>{console.log("ICE gathering state changed:",$.iceGatheringState),$.iceGatheringState==="complete"&&K()}),setTimeout(V,0)})},g=async($,k)=>{if(!e.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",k),console.log("[WebRTC] Offer SDP:",$.sdp),Se.value=k,d.value=k;try{ae||(re&&console.log("[WebRTC] Initializing local stream before handling offer"),await s());const S=c();if(ae&&(S.getSenders().length===0?(re&&console.log("[WebRTC] Adding local tracks to connection"),ae.getTracks().forEach(L=>{S.addTrack(L,ae)})):re&&console.log("[WebRTC] Senders already exist, not adding tracks again")),Ae.value="connecting",l.value="connecting",re&&console.log("[WebRTC] Setting remote description (offer)"),await S.setRemoteDescription(new RTCSessionDescription($)),Xe.length>0){re&&console.log(`[WebRTC] Adding ${Xe.length} pending ICE candidates`);for(const I of Xe)try{await S.addIceCandidate(I)}catch(L){console.error("[WebRTC] Error adding pending ICE candidate:",L)}Xe=[]}re&&console.log("[WebRTC] Creating answer");const R=await S.createAnswer({offerToReceiveAudio:!0});re&&console.log("[WebRTC] Answer SDP:",R.sdp),re&&console.log("[WebRTC] Setting local description (answer)"),await S.setLocalDescription(R),S.getTransceivers().forEach(I=>{if(I.receiver.track.kind==="audio"&&(console.log("[WebRTC] Ensuring audio transceiver is set to receive"),I.direction!=="sendrecv"&&I.direction!=="recvonly"))try{I.direction="sendrecv"}catch(L){console.error("[WebRTC] Could not update transceiver direction:",L)}}),await y(S),re&&console.log("[WebRTC] Sending answer to:",k),e.value.emit("voice-answer",{answer:S.localDescription,to:k}),e.value.emit("webrtc-signal",{type:"answer",answer:S.localDescription,to:k}),F(S),A(),re&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(S){console.error("[WebRTC] Error handling offer:",S),je=`Error handling offer: ${S}`,setTimeout(()=>{e.value&&d.value&&(console.log("[WebRTC] Re-negotiating after offer error"),f(d.value))},2e3)}},h=async $=>{try{if(!Q){re&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const k=Q.signalingState;if(re&&console.log(`[WebRTC] Current signaling state before handling answer: ${k}`),k==="have-local-offer"){re&&console.log("[WebRTC] Setting remote description from answer");try{await Q.setRemoteDescription(new RTCSessionDescription($)),re&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+Q.signalingState)}catch(S){if(console.error("[WebRTC] Error setting remote description:",S),S.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(R=>setTimeout(R,1e3)),Q.signalingState==="have-local-offer")try{re&&console.log("[WebRTC] Retrying set remote description after delay"),await Q.setRemoteDescription(new RTCSessionDescription($)),re&&console.log("[WebRTC] Remote description set successfully on retry")}catch(R){console.error("[WebRTC] Final error setting remote description:",R)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${Q.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${k}`),k==="stable"?re&&console.log("[WebRTC] Already in stable state, ignoring answer"):k==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),_e<At&&(_e++,re&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${_e}/${At})`),p(),setTimeout(()=>{d.value&&f(d.value)},2e3)))}catch(k){console.error("[WebRTC] Error handling answer:",k),je=`Error handling answer: ${k}`,console.log("[WebRTC] Attempting to recover from answer error"),_e<At&&await C()}},x=async()=>{const $=!Ye.value,{saveMicrophoneState:k}=Vt();if(k($),$)return console.log("[WebRTC] Muting microphone - stopping all tracks"),ae&&ae.getAudioTracks().forEach(S=>{S.enabled=!1}),Ye.value=!0,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:!0}})),!0;console.log("[WebRTC] Unmuting microphone");try{if(ae&&ae.getAudioTracks().length>0)return ae.getAudioTracks().forEach(R=>{R.enabled=!0}),Ye.value=!1,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:!1}})),!0;const S=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(S.getAudioTracks().length===0)throw new Error("No audio tracks available");if(ae=S,r.value=S,Q&&S)try{const I=Q.getSenders().find(L=>L.track&&L.track.kind==="audio");if(I){const L=S.getAudioTracks()[0];L&&I.replaceTrack(L)}else S.getAudioTracks().length>0&&S.getAudioTracks().forEach(L=>{Q&&Q.addTrack(L,S)})}catch(R){console.error("[WebRTC] Error adding audio tracks:",R)}return Ye.value=!1,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:!1}})),!0}catch(S){console.error("[WebRTC] Error unmuting microphone:",S);try{const R=await navigator.mediaDevices.getUserMedia({audio:!0});return ae=R,r.value=R,Ye.value=!1,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:!1}})),!0}catch(R){return console.error("[WebRTC] Fallback microphone access also failed:",R),!1}}},p=()=>{if(console.log("[WebRTC] Closing connection"),T(),La(),En(),Q){try{Q.ontrack=null,Q.onicecandidate=null,Q.oniceconnectionstatechange=null,Q.onicegatheringstatechange=null,Q.onsignalingstatechange=null,Q.onconnectionstatechange=null;try{Q.getTransceivers&&Q.getTransceivers().forEach($=>{$.stop&&$.stop()})}catch{}Q.close(),re&&console.log("[WebRTC] Peer connection closed")}catch($){console.error("[WebRTC] Error closing peer connection:",$)}Q=null}le&&(le.getTracks().forEach($=>{$.stop()}),le=new MediaStream,a.value=le),Ae.value="closed",l.value="closed",window.dispatchEvent(new CustomEvent("connection-closed",{detail:{timestamp:Date.now()}}))},m=()=>{p(),H(),ae&&(ae.getTracks().forEach($=>{$.stop()}),ae=null,r.value=null),le&&(le.getTracks().forEach($=>{$.stop()}),le=new MediaStream,a.value=le),Q=null,o.value=null,Ae.value="closed",l.value="closed",Qe=0};function b(){var $,k;if(!e.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),e.value.off("webrtc-signal"),e.value.off("ice-candidate"),e.value.off("partner-disconnected"),e.value.off("webrtc-connection-failed"),e.value.off("connection-timeout"),e.value.off("webrtc-connection-state"),e.value.off("voice-offer"),e.value.off("voice-answer"),e.value.on("webrtc-signal",async S=>{if(console.log(`[WebRTC] Received ${S.type} signal from ${S.from}`),Se.value=S.from,d.value=S.from,S.type==="offer"&&S.offer)try{await g(S.offer,S.from)}catch(R){console.error("[WebRTC] Error handling offer:",R),je=`Error handling offer: ${R}`,e.value&&e.value.emit("webrtc-connection-failed",{to:S.from,reason:`Failed to handle offer: ${R}`})}else if(S.type==="answer"&&S.answer)try{await h(S.answer)}catch(R){console.error("[WebRTC] Error handling answer:",R),je=`Error handling answer: ${R}`,e.value&&e.value.emit("webrtc-connection-failed",{to:S.from,reason:`Failed to handle answer: ${R}`})}}),e.value.on("ice-candidate",async S=>{if(console.log(`[WebRTC] Received ICE candidate from ${S.from}`),S.from!==d.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await z(S.candidate)}catch(R){console.error("[WebRTC] Error handling ICE candidate:",R),je=`Error handling ICE candidate: ${R}`}}),e.value.on("webrtc-connection-failed",S=>{console.log(`[WebRTC] Connection failed notification from ${S.from}: ${S.reason}`),_e<At?(_e++,console.log(`[WebRTC] Partner reported connection failure. Retry ${_e}/${At}`),S.from===d.value&&setTimeout(()=>{d.value&&e.value&&f(S.from)},oi)):(Ae.value="failed",je=`Partner reported failure: ${S.reason}`)}),e.value.on("partner-disconnected",(S={})=>{console.log("[WebRTC] Partner disconnected event:",S),p(),T(),En(),Se.value=null,d.value=null,Ae.value="closed",l.value="closed",S&&S.reason&&console.log(`[WebRTC] Disconnection reason: ${S.reason}`),console.log("[WebRTC] WebRTC connection fully closed due to partner disconnection"),window.dispatchEvent(new CustomEvent("connection-state-changed",{detail:{state:"disconnected",reason:S.reason||"partner-left"}}))}),e.value.on("webrtc-connection-state",S=>{console.log(`[WebRTC] Received connection state update from partner: ${S.state} (reason: ${S.reason})`),(S.state==="failed"||S.state==="closed"||S.state==="disconnected")&&(S.state==="failed"||S.state==="closed"?(Ze("failed"),window.dispatchEvent(new CustomEvent("connection-state-changed",{detail:{state:"failed",reason:S.reason||"connection-failed"}})),Q&&Q.connectionState!=="closed"&&(console.log("[WebRTC] Closing local connection due to remote state:",S.state),p())):(console.log("[WebRTC] Partner connection state is disconnected, waiting to see if it recovers"),window.dispatchEvent(new CustomEvent("connection-state-changed",{detail:{state:"disconnected",reason:"network-disconnect",temporary:!0}}))))}),e.value.on("disconnect-partner",()=>{console.log("[WebRTC] Disconnect partner event received - preserving mic mute state");const S=Ye.value;console.log(`[WebRTC] Current mute state before disconnect: ${S?"muted":"unmuted"}`)}),e.value.on("matched",async S=>{if(console.log("[WebRTC] Matched event received - ensuring mic state is correct"),S&&S.partnerId&&(d.value=S.partnerId,Se.value=S.partnerId),ae&&ae.getAudioTracks().length>0){const{getSavedMicrophoneState:R}=Vt(),I=R();I!==null&&(console.log(`[WebRTC] Applying saved mic state to active stream: ${I?"muted":"unmuted"}`),ae.getAudioTracks().forEach(L=>{L.enabled=!I}),Ye.value=I,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:I}})))}else try{await s()}catch(R){console.error("[WebRTC] Error initializing stream after match:",R)}}),($=e.value)==null||$.on("disconnect",()=>{console.log("[WebRTC] Socket disconnected, cleaning up WebRTC connection"),H()}),(k=e.value)==null||k.on("reconnect",()=>{console.log("[WebRTC] Socket reconnected, attempting to recover WebRTC connection"),Se.value&&_t===null&&P(Se.value)})}b(),xt(()=>{H()});async function C(){if(!(!Q||!d.value)){console.log("[WebRTC] Attempting connection recovery");try{if(Kt=!0,Bt===Xo?(Bt=hr,console.log("[WebRTC] Switching to fast configuration for quicker connection")):_e>5&&(Bt=ut,console.log("[WebRTC] Switching to TURN-only configuration")),Q.restartIce){Q.restartIce();const $=await Q.createOffer({iceRestart:!0,offerToReceiveAudio:!0});await Q.setLocalDescription($),e.value&&(e.value.emit("offer",{offer:Q.localDescription,to:d.value}),e.value.emit("webrtc-signal",{type:"offer",offer:Q.localDescription,to:d.value}))}setTimeout(()=>{Kt=!1},500)}catch($){console.error("[WebRTC] Recovery attempt failed:",$),Kt=!1,_e<At&&setTimeout(()=>{p(),d.value&&f(d.value)},200)}}}function w(){typeof window<"u"&&(window.__webrtc_debug={connectionState:Ae.value,connectionRetryCount:_e,lastConnectionError:je,failureReason:pt,isNegotiating:Oe,isRestartingIce:Kt,pendingCandidates:Xe.length,hasLocalTracks:ae?ae.getAudioTracks().length>0:!1,hasRemoteTracks:le?le.getAudioTracks().length>0:!1})}Re(()=>Ae.value,()=>{w()});function A(){It&&clearInterval(It),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),Q&&(Q.onicecandidate=$=>{$.candidate&&(console.log("[WebRTC] ICE candidate generated:",$.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:$.candidate.candidate,timestamp:Date.now()})),e.value&&Se.value&&e.value.emit("ice-candidate",{candidate:$.candidate,to:Se.value}))}),It=window.setInterval(()=>{if(!Q||Ae.value!=="connecting"&&Ae.value!=="connected"){T();return}try{Z(),Oa().then($=>{$&&$.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=$.iceCandidatePairs)})}catch($){console.error("[WebRTC] Error monitoring connection:",$)}},ni)}function T(){It&&(clearInterval(It),It=null)}function F($){if(!d.value)return;window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout);const k=5e3;window.__webrtcConnectionTimeout=setTimeout(()=>{($.connectionState==="connecting"||$.connectionState==="new")&&(console.log(`[WebRTC] Connection not established after ${k/1e3} seconds, trying fast config`),Bt=hr,d.value&&!Oe&&f(d.value),window.__webrtcConnectionTimeout=setTimeout(()=>{var S,R,I;if($.connectionState==="connecting"||$.connectionState==="new"){console.log("[WebRTC] Connection still not established, trying TURN-only config");const L={localCandidates:((S=window.__localIceCandidates)==null?void 0:S.length)||0,remoteCandidates:((R=window.__remoteIceCandidates)==null?void 0:R.length)||0,iceCandidatePairsCount:((I=window.__iceCandidatePairs)==null?void 0:I.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(L)),Bt=ut,p(),d.value&&setTimeout(()=>{f(d.value)},200)}},5e3))},k)}const z=async $=>{if(!Q){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(re&&console.log("[WebRTC] Adding received ICE candidate:",$.candidate),window.__remoteIceCandidates||(window.__remoteIceCandidates=[]),window.__remoteIceCandidates.push($),!Q.remoteDescription||!Q.localDescription){re&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(Q&&Q.remoteDescription){re&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await Q.addIceCandidate($)}catch(k){console.error("[WebRTC] Error adding delayed ICE candidate:",k)}}},1e3);return}await Q.addIceCandidate($),re&&console.log("[WebRTC] Successfully added ICE candidate")}catch(k){console.error("[WebRTC] Error adding ICE candidate:",k),je=`Error adding ICE candidate: ${k}`,setTimeout(async()=>{if(Q&&Q.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await Q.addIceCandidate($),re&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(S){console.error("[WebRTC] Error adding ICE candidate on retry:",S)}}},2e3)}};function B(){if(!Q||!d.value||Oe){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),Oe=!0;try{Q.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then($=>{if(Q)return Q.setLocalDescription($)}).then(()=>{!Q||!e.value||!d.value||(e.value.emit("voice-offer",{offer:Q.localDescription,to:d.value}),re&&console.log("[WebRTC] Sent renegotiation offer"))}).catch($=>{console.error("[WebRTC] Error during negotiation:",$)}).finally(()=>{setTimeout(()=>{Oe=!1},2e3)})}catch($){console.error("[WebRTC] Failed to start negotiation:",$),Oe=!1}}const _={connectionState:Ae.value,iceCandidatesGenerated:Xe.length,localStreamActive:!!ae&&ae.active,remoteStreamActive:!!le&&le.active,localTracks:ae?ae.getAudioTracks().length:0,remoteTracks:le?le.getAudioTracks().length:0,connectionRetries:_e,lastError:je||pt||"",isAudioMuted:Ye.value,forceReconnect:()=>Q&&Ae.value!=="new"?(C(),!0):!1},W=async()=>{if(!ae){console.log("[WebRTC] No local stream to restore microphone state on");return}const{getSavedMicrophoneState:$}=Vt(),k=$();if(k===null){console.log("[WebRTC] No saved microphone state found");return}console.log(`[WebRTC] Restoring saved microphone state: ${k?"muted":"unmuted"}`),ae&&ae.getAudioTracks().length>0&&(ae.getAudioTracks().forEach(S=>{console.log(`[WebRTC] Setting track '${S.label}' enabled = ${!k}`),S.enabled=!k}),Ye.value=k,window.dispatchEvent(new CustomEvent("microphone-state-changed",{detail:{isMuted:k}})))},E=async($=null)=>{var k;console.log(`[WebRTC] Initializing connection with partner ${$||"unknown"}`);try{Se.value=$,Qe=0,ae||await s(),await W(),Q&&p(),c(),A(),Q&&F(Q),$&&((k=e.value)==null||k.emit("ready-for-call",{to:$})),console.log("[WebRTC] Connection initialized successfully")}catch(S){throw console.error("[WebRTC] Failed to initialize connection:",S),Z(),S}};function P($){if(_t!==null&&clearTimeout(_t),Qe>=fn){console.log(`[WebRTC] Max reconnection attempts (${fn}) reached. Giving up.`),Ze("failed");return}Qe++;const k=Math.min(ai*Math.pow(1.5,Qe-1),ri);Qe>=2&&(console.log("[WebRTC] Using TURN-only config for reconnection attempt"),dt.value=ut,window.localStorage.setItem("last_conn_required_turn","true")),console.log(`[WebRTC] Attempting reconnection in ${k}ms (attempt ${Qe}/${fn})`),_t=setTimeout(async()=>{if(Ae.value==="connected"||Ae.value==="completed"){console.log("[WebRTC] Connection already established, cancelling reconnection attempt"),Qe=0;return}try{console.log(`[WebRTC] Executing reconnection attempt ${Qe}`),p(),await E($)}catch(S){console.error("[WebRTC] Reconnection attempt failed:",S),Qe<fn?P($):Ze("failed")}},k)}function H(){_t!==null&&(clearTimeout(_t),_t=null)}function Z(){if(console.log("[WebRTC] 🔍 Diagnosing connection issues"),!Q)return console.log("[WebRTC] 🔴 No connection exists"),!1;if(console.log(`[WebRTC] Connection state: ${Q.connectionState}`),console.log(`[WebRTC] ICE connection state: ${Q.iceConnectionState}`),console.log(`[WebRTC] Signaling state: ${Q.signalingState}`),Q.iceConnectionState==="checking"&&_e>3||Q.iceConnectionState==="failed"||Ae.value==="failed"||_e>3&&Q.connectionState!=="connected")return console.log("[WebRTC] 🔄 Switching to TURN-only mode for better connectivity"),dt.value=ut,p(),Se.value&&(console.log("[WebRTC] 🔄 Attempting reconnection with TURN-only mode"),setTimeout(()=>{E(Se.value).then(()=>{console.log("[WebRTC] 🟢 Reconnected with TURN-only mode"),B()}).catch(k=>{console.error("[WebRTC] 🔴 Failed to reconnect with TURN-only mode:",k)})},1e3)),!0;if(!ae||ae.getAudioTracks().length===0){console.log("[WebRTC] 🔴 No local audio stream");try{s().catch(k=>console.error("[WebRTC] Failed to reinitialize local stream:",k))}catch(k){console.error("[WebRTC] Error initializing stream:",k)}return!1}if(!le||le.getAudioTracks().length===0){console.log("[WebRTC] 🔴 No remote audio stream");const S=Q.getReceivers().filter(R=>R.track&&R.track.kind==="audio");if(S.length>0&&(le||(le=new MediaStream),S.forEach(R=>{R.track&&(console.log("[WebRTC] Adding track from receiver to remote stream:",R.track.id),le.addTrack(R.track))}),a.value=le),!le||le.getAudioTracks().length===0)return!Oe&&Se.value&&B(),!1}return setTimeout(()=>{const k=document.querySelectorAll("audio");k.length>0&&le&&(console.log(`[WebRTC] Found ${k.length} audio elements, ensuring they use remote stream`),Array.from(k).forEach((S,R)=>{S.srcObject!==le&&(console.log(`[WebRTC] Audio element ${R} not using correct stream, updating`),S.srcObject=le,S.muted=!1,S.volume=1,S.play().catch(I=>console.log("[WebRTC] Error playing audio:",I)))}))},100),[...(ae==null?void 0:ae.getTracks())||[],...(le==null?void 0:le.getTracks())||[]].every(k=>k.kind!=="audio"||k.kind==="audio"&&k.enabled)||(console.log("[WebRTC] 🟠 Found disabled tracks, enabling them"),le==null||le.getAudioTracks().forEach(k=>{k.enabled=!0}),Ye.value||ae==null||ae.getAudioTracks().forEach(k=>{k.enabled=!0})),!0}return{socket:e,peerConnection:o,remoteStream:a,localStream:r,connectionState:l,isAudioMuted:u,partnerId:d,createOffer:f,handleOffer:g,handleAnswer:h,handleIceCandidate:z,toggleMicrophone:x,closeConnection:p,initializeLocalStream:s,cleanup:m,diagnosticReport:_,restoreMicrophoneState:W,initializeConnection:E,diagnoseAndFixConnection:Z,startNegotiation:B,attemptReconnection:P}}function ci(e){return e.signalingState==="stable"||e.signalingState==="have-remote-offer"}function Ze(e){Ae.value!==e&&(console.log(`[WebRTC] Connection state changing from ${Ae.value} to ${e}`),Ae.value=e,e==="connected"||e==="completed"?(pt="",je="",_e=0,console.log("[WebRTC] Connection established successfully")):(e==="failed"||e==="disconnected")&&(console.warn(`[WebRTC] Connection ${e}: ${pt||"Unknown reason"}`),e==="failed"&&(_e++,console.log(`[WebRTC] Connection failure count: ${_e}/${At}`))))}function ui(){const e=window.localStorage.getItem("last_conn_required_turn")==="true",n=parseInt(window.localStorage.getItem("last_turn_timestamp")||"0",10),t=e&&n>0&&Date.now()-n<60*60*1e3,o=_e>=2,r=navigator.connection;let a=!1;if(r){const u=r.effectiveType,d=r.downlink;a=u==="2g"||u==="slow-2g"||d&&d<1.5,console.log(`[WebRTC] Network conditions: type=${u}, downlink=${d}Mbps`)}const l=t||o||a;return console.log(`[WebRTC] Network conditions assessment: ${l?"DIFFICULT":"NORMAL"}`,{lastConnRequiredTurn:e,isRecentTurnUse:t,isConnectionUnstable:o,isWeakConnection:a,connectionRetryCount:_e}),l}function di(){return ui()?(console.log("[WebRTC] Using TURN-only configuration due to difficult network conditions"),window.localStorage.setItem("using_turn_only","true"),ut):(console.log("[WebRTC] Using standard configuration for normal network conditions"),window.localStorage.setItem("using_turn_only","false"),dt.value)}function fi(e){Yt&&La(),console.log("[WebRTC] Started connection quality monitoring"),Yt=window.setInterval(async()=>{e&&e.connectionState==="connected"?await xi(e):console.log("[WebRTC] Skipping quality check - connection not active:",e==null?void 0:e.connectionState)},si)}function La(){Yt&&(clearInterval(Yt),Yt=null,console.log("[WebRTC] Stopped connection quality monitoring"))}async function xi(e){try{const n=await e.getStats();let t=0,o=0,r=0,a=!1;if(n.forEach(l=>{if(l.type==="inbound-rtp"&&l.kind==="audio"){if(l.packetsLost!==void 0&&l.packetsReceived!==void 0){const u=l.packetsLost+l.packetsReceived;u>0&&(t=l.packetsLost/u*100)}l.jitter!==void 0&&(o=l.jitter*1e3),a=!0}l.type==="candidate-pair"&&l.currentRoundTripTime!==void 0&&l.selected&&(r=l.currentRoundTripTime*1e3)}),a){const l=t>10||o>50||r>500;if(console.log(`[WebRTC] Connection quality metrics: packet loss=${t.toFixed(2)}%, jitter=${o.toFixed(2)}ms, RTT=${r.toFixed(2)}ms - Quality: ${l?"POOR":"GOOD"}`),l){if(xn++,console.log(`[WebRTC] Poor connection quality detected (${xn}/${yr})`),xn>=yr&&!(window.localStorage.getItem("using_turn_only")==="true")&&(console.log("[WebRTC] Switching to TURN-only mode due to poor connection quality"),window.localStorage.setItem("last_conn_required_turn","true"),window.localStorage.setItem("last_turn_timestamp",Date.now().toString()),e&&e.iceConnectionState!=="closed")){console.log("[WebRTC] Renegotiating with TURN-only configuration"),dt.value=ut;try{if(Kt=!0,console.log("[WebRTC] Switching to TURN-only mode due to poor quality"),dt.value=ut,console.log("[WebRTC] Updated configuration to TURN-only for next connection attempt"),e&&e.iceConnectionState!=="failed"&&e.iceConnectionState!=="disconnected"&&e.restartIce){console.log("[WebRTC] Attempting to restart ICE with TURN-only config");try{e.restartIce()}catch(d){console.error("[WebRTC] Failed to restart ICE:",d)}}}catch(d){console.error("[WebRTC] Failed to update to TURN-only configuration:",d)}}}else xn=0}}catch(n){console.error("[WebRTC] Error monitoring connection quality:",n)}}const Pe=[];for(let e=0;e<256;++e)Pe.push((e+256).toString(16).slice(1));function vi(e,n=0){return(Pe[e[n+0]]+Pe[e[n+1]]+Pe[e[n+2]]+Pe[e[n+3]]+"-"+Pe[e[n+4]]+Pe[e[n+5]]+"-"+Pe[e[n+6]]+Pe[e[n+7]]+"-"+Pe[e[n+8]]+Pe[e[n+9]]+"-"+Pe[e[n+10]]+Pe[e[n+11]]+Pe[e[n+12]]+Pe[e[n+13]]+Pe[e[n+14]]+Pe[e[n+15]]).toLowerCase()}let Gn;const gi=new Uint8Array(16);function mi(){if(!Gn){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Gn=crypto.getRandomValues.bind(crypto)}return Gn(gi)}const pi=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wr={randomUUID:pi};function Ua(e,n,t){var r;if(wr.randomUUID&&!n&&!e)return wr.randomUUID();e=e||{};const o=e.random??((r=e.rng)==null?void 0:r.call(e))??mi();if(o.length<16)throw new Error("Random bytes length must be >= 16");if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){if(t=t||0,t<0||t+16>n.length)throw new RangeError(`UUID byte range ${t}:${t+15} is out of buffer bounds`);for(let a=0;a<16;++a)n[t+a]=o[a];return n}return vi(o)}var ue=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hi(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function bi(e){if(e.__esModule)return e;var n=e.default;if(typeof n=="function"){var t=function o(){return this instanceof o?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};t.prototype=n.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var r=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,r.get?r:{enumerable:!0,get:function(){return e[o]}})}),t}var ja={exports:{}};function yi(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Vn={exports:{}};const Ci={},wi=Object.freeze(Object.defineProperty({__proto__:null,default:Ci},Symbol.toStringTag,{value:"Module"})),Ei=bi(wi);var Er;function fe(){return Er||(Er=1,function(e,n){(function(t,o){e.exports=o()})(ue,function(){var t=t||function(o,r){var a;if(typeof window<"u"&&window.crypto&&(a=window.crypto),typeof self<"u"&&self.crypto&&(a=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window<"u"&&window.msCrypto&&(a=window.msCrypto),!a&&typeof ue<"u"&&ue.crypto&&(a=ue.crypto),!a&&typeof yi=="function")try{a=Ei}catch{}var l=function(){if(a){if(typeof a.getRandomValues=="function")try{return a.getRandomValues(new Uint32Array(1))[0]}catch{}if(typeof a.randomBytes=="function")try{return a.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},u=Object.create||function(){function m(){}return function(b){var C;return m.prototype=b,C=new m,m.prototype=null,C}}(),d={},s=d.lib={},c=s.Base=function(){return{extend:function(m){var b=u(this);return m&&b.mixIn(m),(!b.hasOwnProperty("init")||this.init===b.init)&&(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var m=this.extend();return m.init.apply(m,arguments),m},init:function(){},mixIn:function(m){for(var b in m)m.hasOwnProperty(b)&&(this[b]=m[b]);m.hasOwnProperty("toString")&&(this.toString=m.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),v=s.WordArray=c.extend({init:function(m,b){m=this.words=m||[],b!=r?this.sigBytes=b:this.sigBytes=m.length*4},toString:function(m){return(m||y).stringify(this)},concat:function(m){var b=this.words,C=m.words,w=this.sigBytes,A=m.sigBytes;if(this.clamp(),w%4)for(var T=0;T<A;T++){var F=C[T>>>2]>>>24-T%4*8&255;b[w+T>>>2]|=F<<24-(w+T)%4*8}else for(var z=0;z<A;z+=4)b[w+z>>>2]=C[z>>>2];return this.sigBytes+=A,this},clamp:function(){var m=this.words,b=this.sigBytes;m[b>>>2]&=4294967295<<32-b%4*8,m.length=o.ceil(b/4)},clone:function(){var m=c.clone.call(this);return m.words=this.words.slice(0),m},random:function(m){for(var b=[],C=0;C<m;C+=4)b.push(l());return new v.init(b,m)}}),f=d.enc={},y=f.Hex={stringify:function(m){for(var b=m.words,C=m.sigBytes,w=[],A=0;A<C;A++){var T=b[A>>>2]>>>24-A%4*8&255;w.push((T>>>4).toString(16)),w.push((T&15).toString(16))}return w.join("")},parse:function(m){for(var b=m.length,C=[],w=0;w<b;w+=2)C[w>>>3]|=parseInt(m.substr(w,2),16)<<24-w%8*4;return new v.init(C,b/2)}},g=f.Latin1={stringify:function(m){for(var b=m.words,C=m.sigBytes,w=[],A=0;A<C;A++){var T=b[A>>>2]>>>24-A%4*8&255;w.push(String.fromCharCode(T))}return w.join("")},parse:function(m){for(var b=m.length,C=[],w=0;w<b;w++)C[w>>>2]|=(m.charCodeAt(w)&255)<<24-w%4*8;return new v.init(C,b)}},h=f.Utf8={stringify:function(m){try{return decodeURIComponent(escape(g.stringify(m)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(m){return g.parse(unescape(encodeURIComponent(m)))}},x=s.BufferedBlockAlgorithm=c.extend({reset:function(){this._data=new v.init,this._nDataBytes=0},_append:function(m){typeof m=="string"&&(m=h.parse(m)),this._data.concat(m),this._nDataBytes+=m.sigBytes},_process:function(m){var b,C=this._data,w=C.words,A=C.sigBytes,T=this.blockSize,F=T*4,z=A/F;m?z=o.ceil(z):z=o.max((z|0)-this._minBufferSize,0);var B=z*T,_=o.min(B*4,A);if(B){for(var W=0;W<B;W+=T)this._doProcessBlock(w,W);b=w.splice(0,B),C.sigBytes-=_}return new v.init(b,_)},clone:function(){var m=c.clone.call(this);return m._data=this._data.clone(),m},_minBufferSize:0});s.Hasher=x.extend({cfg:c.extend(),init:function(m){this.cfg=this.cfg.extend(m),this.reset()},reset:function(){x.reset.call(this),this._doReset()},update:function(m){return this._append(m),this._process(),this},finalize:function(m){m&&this._append(m);var b=this._doFinalize();return b},blockSize:16,_createHelper:function(m){return function(b,C){return new m.init(C).finalize(b)}},_createHmacHelper:function(m){return function(b,C){return new p.HMAC.init(m,C).finalize(b)}}});var p=d.algo={};return d}(Math);return t})}(Vn)),Vn.exports}var Kn={exports:{}},_r;function Rn(){return _r||(_r=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(o){var r=t,a=r.lib,l=a.Base,u=a.WordArray,d=r.x64={};d.Word=l.extend({init:function(s,c){this.high=s,this.low=c}}),d.WordArray=l.extend({init:function(s,c){s=this.words=s||[],c!=o?this.sigBytes=c:this.sigBytes=s.length*8},toX32:function(){for(var s=this.words,c=s.length,v=[],f=0;f<c;f++){var y=s[f];v.push(y.high),v.push(y.low)}return u.create(v,this.sigBytes)},clone:function(){for(var s=l.clone.call(this),c=s.words=this.words.slice(0),v=c.length,f=0;f<v;f++)c[f]=c[f].clone();return s}})}(),t})}(Kn)),Kn.exports}var Yn={exports:{}},Ar;function _i(){return Ar||(Ar=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(){if(typeof ArrayBuffer=="function"){var o=t,r=o.lib,a=r.WordArray,l=a.init,u=a.init=function(d){if(d instanceof ArrayBuffer&&(d=new Uint8Array(d)),(d instanceof Int8Array||typeof Uint8ClampedArray<"u"&&d instanceof Uint8ClampedArray||d instanceof Int16Array||d instanceof Uint16Array||d instanceof Int32Array||d instanceof Uint32Array||d instanceof Float32Array||d instanceof Float64Array)&&(d=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)),d instanceof Uint8Array){for(var s=d.byteLength,c=[],v=0;v<s;v++)c[v>>>2]|=d[v]<<24-v%4*8;l.call(this,c,s)}else l.apply(this,arguments)};u.prototype=a}}(),t.lib.WordArray})}(Yn)),Yn.exports}var Xn={exports:{}},Br;function Ai(){return Br||(Br=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=o.enc;l.Utf16=l.Utf16BE={stringify:function(d){for(var s=d.words,c=d.sigBytes,v=[],f=0;f<c;f+=2){var y=s[f>>>2]>>>16-f%4*8&65535;v.push(String.fromCharCode(y))}return v.join("")},parse:function(d){for(var s=d.length,c=[],v=0;v<s;v++)c[v>>>1]|=d.charCodeAt(v)<<16-v%2*16;return a.create(c,s*2)}},l.Utf16LE={stringify:function(d){for(var s=d.words,c=d.sigBytes,v=[],f=0;f<c;f+=2){var y=u(s[f>>>2]>>>16-f%4*8&65535);v.push(String.fromCharCode(y))}return v.join("")},parse:function(d){for(var s=d.length,c=[],v=0;v<s;v++)c[v>>>1]|=u(d.charCodeAt(v)<<16-v%2*16);return a.create(c,s*2)}};function u(d){return d<<8&4278255360|d>>>8&16711935}}(),t.enc.Utf16})}(Xn)),Xn.exports}var Qn={exports:{}},Tr;function Dt(){return Tr||(Tr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=o.enc;l.Base64={stringify:function(d){var s=d.words,c=d.sigBytes,v=this._map;d.clamp();for(var f=[],y=0;y<c;y+=3)for(var g=s[y>>>2]>>>24-y%4*8&255,h=s[y+1>>>2]>>>24-(y+1)%4*8&255,x=s[y+2>>>2]>>>24-(y+2)%4*8&255,p=g<<16|h<<8|x,m=0;m<4&&y+m*.75<c;m++)f.push(v.charAt(p>>>6*(3-m)&63));var b=v.charAt(64);if(b)for(;f.length%4;)f.push(b);return f.join("")},parse:function(d){var s=d.length,c=this._map,v=this._reverseMap;if(!v){v=this._reverseMap=[];for(var f=0;f<c.length;f++)v[c.charCodeAt(f)]=f}var y=c.charAt(64);if(y){var g=d.indexOf(y);g!==-1&&(s=g)}return u(d,s,v)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function u(d,s,c){for(var v=[],f=0,y=0;y<s;y++)if(y%4){var g=c[d.charCodeAt(y-1)]<<y%4*2,h=c[d.charCodeAt(y)]>>>6-y%4*2,x=g|h;v[f>>>2]|=x<<24-f%4*8,f++}return a.create(v,f)}}(),t.enc.Base64})}(Qn)),Qn.exports}var Zn={exports:{}},kr;function Bi(){return kr||(kr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=o.enc;l.Base64url={stringify:function(d,s){s===void 0&&(s=!0);var c=d.words,v=d.sigBytes,f=s?this._safe_map:this._map;d.clamp();for(var y=[],g=0;g<v;g+=3)for(var h=c[g>>>2]>>>24-g%4*8&255,x=c[g+1>>>2]>>>24-(g+1)%4*8&255,p=c[g+2>>>2]>>>24-(g+2)%4*8&255,m=h<<16|x<<8|p,b=0;b<4&&g+b*.75<v;b++)y.push(f.charAt(m>>>6*(3-b)&63));var C=f.charAt(64);if(C)for(;y.length%4;)y.push(C);return y.join("")},parse:function(d,s){s===void 0&&(s=!0);var c=d.length,v=s?this._safe_map:this._map,f=this._reverseMap;if(!f){f=this._reverseMap=[];for(var y=0;y<v.length;y++)f[v.charCodeAt(y)]=y}var g=v.charAt(64);if(g){var h=d.indexOf(g);h!==-1&&(c=h)}return u(d,c,f)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function u(d,s,c){for(var v=[],f=0,y=0;y<s;y++)if(y%4){var g=c[d.charCodeAt(y-1)]<<y%4*2,h=c[d.charCodeAt(y)]>>>6-y%4*2,x=g|h;v[f>>>2]|=x<<24-f%4*8,f++}return a.create(v,f)}}(),t.enc.Base64url})}(Zn)),Zn.exports}var Jn={exports:{}},Dr;function Ft(){return Dr||(Dr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(o){var r=t,a=r.lib,l=a.WordArray,u=a.Hasher,d=r.algo,s=[];(function(){for(var h=0;h<64;h++)s[h]=o.abs(o.sin(h+1))*4294967296|0})();var c=d.MD5=u.extend({_doReset:function(){this._hash=new l.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,x){for(var p=0;p<16;p++){var m=x+p,b=h[m];h[m]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}var C=this._hash.words,w=h[x+0],A=h[x+1],T=h[x+2],F=h[x+3],z=h[x+4],B=h[x+5],_=h[x+6],W=h[x+7],E=h[x+8],P=h[x+9],H=h[x+10],Z=h[x+11],$=h[x+12],k=h[x+13],S=h[x+14],R=h[x+15],I=C[0],L=C[1],K=C[2],V=C[3];I=v(I,L,K,V,w,7,s[0]),V=v(V,I,L,K,A,12,s[1]),K=v(K,V,I,L,T,17,s[2]),L=v(L,K,V,I,F,22,s[3]),I=v(I,L,K,V,z,7,s[4]),V=v(V,I,L,K,B,12,s[5]),K=v(K,V,I,L,_,17,s[6]),L=v(L,K,V,I,W,22,s[7]),I=v(I,L,K,V,E,7,s[8]),V=v(V,I,L,K,P,12,s[9]),K=v(K,V,I,L,H,17,s[10]),L=v(L,K,V,I,Z,22,s[11]),I=v(I,L,K,V,$,7,s[12]),V=v(V,I,L,K,k,12,s[13]),K=v(K,V,I,L,S,17,s[14]),L=v(L,K,V,I,R,22,s[15]),I=f(I,L,K,V,A,5,s[16]),V=f(V,I,L,K,_,9,s[17]),K=f(K,V,I,L,Z,14,s[18]),L=f(L,K,V,I,w,20,s[19]),I=f(I,L,K,V,B,5,s[20]),V=f(V,I,L,K,H,9,s[21]),K=f(K,V,I,L,R,14,s[22]),L=f(L,K,V,I,z,20,s[23]),I=f(I,L,K,V,P,5,s[24]),V=f(V,I,L,K,S,9,s[25]),K=f(K,V,I,L,F,14,s[26]),L=f(L,K,V,I,E,20,s[27]),I=f(I,L,K,V,k,5,s[28]),V=f(V,I,L,K,T,9,s[29]),K=f(K,V,I,L,W,14,s[30]),L=f(L,K,V,I,$,20,s[31]),I=y(I,L,K,V,B,4,s[32]),V=y(V,I,L,K,E,11,s[33]),K=y(K,V,I,L,Z,16,s[34]),L=y(L,K,V,I,S,23,s[35]),I=y(I,L,K,V,A,4,s[36]),V=y(V,I,L,K,z,11,s[37]),K=y(K,V,I,L,W,16,s[38]),L=y(L,K,V,I,H,23,s[39]),I=y(I,L,K,V,k,4,s[40]),V=y(V,I,L,K,w,11,s[41]),K=y(K,V,I,L,F,16,s[42]),L=y(L,K,V,I,_,23,s[43]),I=y(I,L,K,V,P,4,s[44]),V=y(V,I,L,K,$,11,s[45]),K=y(K,V,I,L,R,16,s[46]),L=y(L,K,V,I,T,23,s[47]),I=g(I,L,K,V,w,6,s[48]),V=g(V,I,L,K,W,10,s[49]),K=g(K,V,I,L,S,15,s[50]),L=g(L,K,V,I,B,21,s[51]),I=g(I,L,K,V,$,6,s[52]),V=g(V,I,L,K,F,10,s[53]),K=g(K,V,I,L,H,15,s[54]),L=g(L,K,V,I,A,21,s[55]),I=g(I,L,K,V,E,6,s[56]),V=g(V,I,L,K,R,10,s[57]),K=g(K,V,I,L,_,15,s[58]),L=g(L,K,V,I,k,21,s[59]),I=g(I,L,K,V,z,6,s[60]),V=g(V,I,L,K,Z,10,s[61]),K=g(K,V,I,L,T,15,s[62]),L=g(L,K,V,I,P,21,s[63]),C[0]=C[0]+I|0,C[1]=C[1]+L|0,C[2]=C[2]+K|0,C[3]=C[3]+V|0},_doFinalize:function(){var h=this._data,x=h.words,p=this._nDataBytes*8,m=h.sigBytes*8;x[m>>>5]|=128<<24-m%32;var b=o.floor(p/4294967296),C=p;x[(m+64>>>9<<4)+15]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,x[(m+64>>>9<<4)+14]=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,h.sigBytes=(x.length+1)*4,this._process();for(var w=this._hash,A=w.words,T=0;T<4;T++){var F=A[T];A[T]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360}return w},clone:function(){var h=u.clone.call(this);return h._hash=this._hash.clone(),h}});function v(h,x,p,m,b,C,w){var A=h+(x&p|~x&m)+b+w;return(A<<C|A>>>32-C)+x}function f(h,x,p,m,b,C,w){var A=h+(x&m|p&~m)+b+w;return(A<<C|A>>>32-C)+x}function y(h,x,p,m,b,C,w){var A=h+(x^p^m)+b+w;return(A<<C|A>>>32-C)+x}function g(h,x,p,m,b,C,w){var A=h+(p^(x|~m))+b+w;return(A<<C|A>>>32-C)+x}r.MD5=u._createHelper(c),r.HmacMD5=u._createHmacHelper(c)}(Math),t.MD5})}(Jn)),Jn.exports}var eo={exports:{}},Fr;function Ha(){return Fr||(Fr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=r.Hasher,u=o.algo,d=[],s=u.SHA1=l.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(c,v){for(var f=this._hash.words,y=f[0],g=f[1],h=f[2],x=f[3],p=f[4],m=0;m<80;m++){if(m<16)d[m]=c[v+m]|0;else{var b=d[m-3]^d[m-8]^d[m-14]^d[m-16];d[m]=b<<1|b>>>31}var C=(y<<5|y>>>27)+p+d[m];m<20?C+=(g&h|~g&x)+1518500249:m<40?C+=(g^h^x)+1859775393:m<60?C+=(g&h|g&x|h&x)-1894007588:C+=(g^h^x)-899497514,p=x,x=h,h=g<<30|g>>>2,g=y,y=C}f[0]=f[0]+y|0,f[1]=f[1]+g|0,f[2]=f[2]+h|0,f[3]=f[3]+x|0,f[4]=f[4]+p|0},_doFinalize:function(){var c=this._data,v=c.words,f=this._nDataBytes*8,y=c.sigBytes*8;return v[y>>>5]|=128<<24-y%32,v[(y+64>>>9<<4)+14]=Math.floor(f/4294967296),v[(y+64>>>9<<4)+15]=f,c.sigBytes=v.length*4,this._process(),this._hash},clone:function(){var c=l.clone.call(this);return c._hash=this._hash.clone(),c}});o.SHA1=l._createHelper(s),o.HmacSHA1=l._createHmacHelper(s)}(),t.SHA1})}(eo)),eo.exports}var to={exports:{}},Sr;function Qo(){return Sr||(Sr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){return function(o){var r=t,a=r.lib,l=a.WordArray,u=a.Hasher,d=r.algo,s=[],c=[];(function(){function y(p){for(var m=o.sqrt(p),b=2;b<=m;b++)if(!(p%b))return!1;return!0}function g(p){return(p-(p|0))*4294967296|0}for(var h=2,x=0;x<64;)y(h)&&(x<8&&(s[x]=g(o.pow(h,1/2))),c[x]=g(o.pow(h,1/3)),x++),h++})();var v=[],f=d.SHA256=u.extend({_doReset:function(){this._hash=new l.init(s.slice(0))},_doProcessBlock:function(y,g){for(var h=this._hash.words,x=h[0],p=h[1],m=h[2],b=h[3],C=h[4],w=h[5],A=h[6],T=h[7],F=0;F<64;F++){if(F<16)v[F]=y[g+F]|0;else{var z=v[F-15],B=(z<<25|z>>>7)^(z<<14|z>>>18)^z>>>3,_=v[F-2],W=(_<<15|_>>>17)^(_<<13|_>>>19)^_>>>10;v[F]=B+v[F-7]+W+v[F-16]}var E=C&w^~C&A,P=x&p^x&m^p&m,H=(x<<30|x>>>2)^(x<<19|x>>>13)^(x<<10|x>>>22),Z=(C<<26|C>>>6)^(C<<21|C>>>11)^(C<<7|C>>>25),$=T+Z+E+c[F]+v[F],k=H+P;T=A,A=w,w=C,C=b+$|0,b=m,m=p,p=x,x=$+k|0}h[0]=h[0]+x|0,h[1]=h[1]+p|0,h[2]=h[2]+m|0,h[3]=h[3]+b|0,h[4]=h[4]+C|0,h[5]=h[5]+w|0,h[6]=h[6]+A|0,h[7]=h[7]+T|0},_doFinalize:function(){var y=this._data,g=y.words,h=this._nDataBytes*8,x=y.sigBytes*8;return g[x>>>5]|=128<<24-x%32,g[(x+64>>>9<<4)+14]=o.floor(h/4294967296),g[(x+64>>>9<<4)+15]=h,y.sigBytes=g.length*4,this._process(),this._hash},clone:function(){var y=u.clone.call(this);return y._hash=this._hash.clone(),y}});r.SHA256=u._createHelper(f),r.HmacSHA256=u._createHmacHelper(f)}(Math),t.SHA256})}(to)),to.exports}var no={exports:{}},Rr;function Ti(){return Rr||(Rr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Qo())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=o.algo,u=l.SHA256,d=l.SHA224=u.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var s=u._doFinalize.call(this);return s.sigBytes-=4,s}});o.SHA224=u._createHelper(d),o.HmacSHA224=u._createHmacHelper(d)}(),t.SHA224})}(no)),no.exports}var oo={exports:{}},$r;function qa(){return $r||($r=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Rn())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.Hasher,l=o.x64,u=l.Word,d=l.WordArray,s=o.algo;function c(){return u.create.apply(u,arguments)}var v=[c(1116352408,3609767458),c(1899447441,602891725),c(3049323471,3964484399),c(3921009573,2173295548),c(961987163,4081628472),c(1508970993,3053834265),c(2453635748,2937671579),c(2870763221,3664609560),c(3624381080,2734883394),c(310598401,1164996542),c(607225278,1323610764),c(1426881987,3590304994),c(1925078388,4068182383),c(2162078206,991336113),c(2614888103,633803317),c(3248222580,3479774868),c(3835390401,2666613458),c(4022224774,944711139),c(264347078,2341262773),c(604807628,2007800933),c(770255983,1495990901),c(1249150122,1856431235),c(1555081692,3175218132),c(1996064986,2198950837),c(2554220882,3999719339),c(2821834349,766784016),c(2952996808,2566594879),c(3210313671,3203337956),c(3336571891,1034457026),c(3584528711,2466948901),c(113926993,3758326383),c(338241895,168717936),c(666307205,1188179964),c(773529912,1546045734),c(1294757372,1522805485),c(1396182291,2643833823),c(1695183700,2343527390),c(1986661051,1014477480),c(2177026350,1206759142),c(2456956037,344077627),c(2730485921,1290863460),c(2820302411,3158454273),c(3259730800,3505952657),c(3345764771,106217008),c(3516065817,3606008344),c(3600352804,1432725776),c(4094571909,1467031594),c(275423344,851169720),c(430227734,3100823752),c(506948616,1363258195),c(659060556,3750685593),c(883997877,3785050280),c(958139571,3318307427),c(1322822218,3812723403),c(1537002063,2003034995),c(1747873779,3602036899),c(1955562222,1575990012),c(2024104815,1125592928),c(2227730452,2716904306),c(2361852424,442776044),c(2428436474,593698344),c(2756734187,3733110249),c(3204031479,2999351573),c(3329325298,3815920427),c(3391569614,3928383900),c(3515267271,566280711),c(3940187606,3454069534),c(4118630271,4000239992),c(116418474,1914138554),c(174292421,2731055270),c(289380356,3203993006),c(460393269,320620315),c(685471733,587496836),c(852142971,1086792851),c(1017036298,365543100),c(1126000580,2618297676),c(1288033470,3409855158),c(1501505948,4234509866),c(1607167915,987167468),c(1816402316,1246189591)],f=[];(function(){for(var g=0;g<80;g++)f[g]=c()})();var y=s.SHA512=a.extend({_doReset:function(){this._hash=new d.init([new u.init(1779033703,4089235720),new u.init(3144134277,2227873595),new u.init(1013904242,4271175723),new u.init(2773480762,1595750129),new u.init(1359893119,2917565137),new u.init(2600822924,725511199),new u.init(528734635,4215389547),new u.init(1541459225,327033209)])},_doProcessBlock:function(g,h){for(var x=this._hash.words,p=x[0],m=x[1],b=x[2],C=x[3],w=x[4],A=x[5],T=x[6],F=x[7],z=p.high,B=p.low,_=m.high,W=m.low,E=b.high,P=b.low,H=C.high,Z=C.low,$=w.high,k=w.low,S=A.high,R=A.low,I=T.high,L=T.low,K=F.high,V=F.low,me=z,xe=B,ye=_,ie=W,lt=E,ot=P,rt=H,at=Z,Le=$,ke=k,vt=S,ee=R,X=I,oe=L,de=K,pe=V,he=0;he<80;he++){var be,ve,J=f[he];if(he<16)ve=J.high=g[h+he*2]|0,be=J.low=g[h+he*2+1]|0;else{var De=f[he-15],Ie=De.high,bt=De.low,St=(Ie>>>1|bt<<31)^(Ie>>>8|bt<<24)^Ie>>>7,Jt=(bt>>>1|Ie<<31)^(bt>>>8|Ie<<24)^(bt>>>7|Ie<<25),en=f[he-2],gt=en.high,yt=en.low,$n=(gt>>>19|yt<<13)^(gt<<3|yt>>>29)^gt>>>6,tn=(yt>>>19|gt<<13)^(yt<<3|gt>>>29)^(yt>>>6|gt<<26),nn=f[he-7],In=nn.high,Pn=nn.low,on=f[he-16],rn=on.high,Ct=on.low;be=Jt+Pn,ve=St+In+(be>>>0<Jt>>>0?1:0),be=be+tn,ve=ve+$n+(be>>>0<tn>>>0?1:0),be=be+Ct,ve=ve+rn+(be>>>0<Ct>>>0?1:0),J.high=ve,J.low=be}var Mn=Le&vt^~Le&X,Ot=ke&ee^~ke&oe,wt=me&ye^me&lt^ye&lt,Wn=xe&ie^xe&ot^ie&ot,On=(me>>>28|xe<<4)^(me<<30|xe>>>2)^(me<<25|xe>>>7),an=(xe>>>28|me<<4)^(xe<<30|me>>>2)^(xe<<25|me>>>7),Nt=(Le>>>14|ke<<18)^(Le>>>18|ke<<14)^(Le<<23|ke>>>9),Lt=(ke>>>14|Le<<18)^(ke>>>18|Le<<14)^(ke<<23|Le>>>9),mt=v[he],sn=mt.high,ln=mt.low,Ue=pe+Lt,st=de+Nt+(Ue>>>0<pe>>>0?1:0),Ue=Ue+Ot,st=st+Mn+(Ue>>>0<Ot>>>0?1:0),Ue=Ue+ln,st=st+sn+(Ue>>>0<ln>>>0?1:0),Ue=Ue+be,st=st+ve+(Ue>>>0<be>>>0?1:0),cn=an+Wn,Nn=On+wt+(cn>>>0<an>>>0?1:0);de=X,pe=oe,X=vt,oe=ee,vt=Le,ee=ke,ke=at+Ue|0,Le=rt+st+(ke>>>0<at>>>0?1:0)|0,rt=lt,at=ot,lt=ye,ot=ie,ye=me,ie=xe,xe=Ue+cn|0,me=st+Nn+(xe>>>0<Ue>>>0?1:0)|0}B=p.low=B+xe,p.high=z+me+(B>>>0<xe>>>0?1:0),W=m.low=W+ie,m.high=_+ye+(W>>>0<ie>>>0?1:0),P=b.low=P+ot,b.high=E+lt+(P>>>0<ot>>>0?1:0),Z=C.low=Z+at,C.high=H+rt+(Z>>>0<at>>>0?1:0),k=w.low=k+ke,w.high=$+Le+(k>>>0<ke>>>0?1:0),R=A.low=R+ee,A.high=S+vt+(R>>>0<ee>>>0?1:0),L=T.low=L+oe,T.high=I+X+(L>>>0<oe>>>0?1:0),V=F.low=V+pe,F.high=K+de+(V>>>0<pe>>>0?1:0)},_doFinalize:function(){var g=this._data,h=g.words,x=this._nDataBytes*8,p=g.sigBytes*8;h[p>>>5]|=128<<24-p%32,h[(p+128>>>10<<5)+30]=Math.floor(x/4294967296),h[(p+128>>>10<<5)+31]=x,g.sigBytes=h.length*4,this._process();var m=this._hash.toX32();return m},clone:function(){var g=a.clone.call(this);return g._hash=this._hash.clone(),g},blockSize:1024/32});o.SHA512=a._createHelper(y),o.HmacSHA512=a._createHmacHelper(y)}(),t.SHA512})}(oo)),oo.exports}var ro={exports:{}},Ir;function ki(){return Ir||(Ir=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Rn(),qa())})(ue,function(t){return function(){var o=t,r=o.x64,a=r.Word,l=r.WordArray,u=o.algo,d=u.SHA512,s=u.SHA384=d.extend({_doReset:function(){this._hash=new l.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var c=d._doFinalize.call(this);return c.sigBytes-=16,c}});o.SHA384=d._createHelper(s),o.HmacSHA384=d._createHmacHelper(s)}(),t.SHA384})}(ro)),ro.exports}var ao={exports:{}},Pr;function Di(){return Pr||(Pr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Rn())})(ue,function(t){return function(o){var r=t,a=r.lib,l=a.WordArray,u=a.Hasher,d=r.x64,s=d.Word,c=r.algo,v=[],f=[],y=[];(function(){for(var x=1,p=0,m=0;m<24;m++){v[x+5*p]=(m+1)*(m+2)/2%64;var b=p%5,C=(2*x+3*p)%5;x=b,p=C}for(var x=0;x<5;x++)for(var p=0;p<5;p++)f[x+5*p]=p+(2*x+3*p)%5*5;for(var w=1,A=0;A<24;A++){for(var T=0,F=0,z=0;z<7;z++){if(w&1){var B=(1<<z)-1;B<32?F^=1<<B:T^=1<<B-32}w&128?w=w<<1^113:w<<=1}y[A]=s.create(T,F)}})();var g=[];(function(){for(var x=0;x<25;x++)g[x]=s.create()})();var h=c.SHA3=u.extend({cfg:u.cfg.extend({outputLength:512}),_doReset:function(){for(var x=this._state=[],p=0;p<25;p++)x[p]=new s.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(x,p){for(var m=this._state,b=this.blockSize/2,C=0;C<b;C++){var w=x[p+2*C],A=x[p+2*C+1];w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,A=(A<<8|A>>>24)&16711935|(A<<24|A>>>8)&4278255360;var T=m[C];T.high^=A,T.low^=w}for(var F=0;F<24;F++){for(var z=0;z<5;z++){for(var B=0,_=0,W=0;W<5;W++){var T=m[z+5*W];B^=T.high,_^=T.low}var E=g[z];E.high=B,E.low=_}for(var z=0;z<5;z++)for(var P=g[(z+4)%5],H=g[(z+1)%5],Z=H.high,$=H.low,B=P.high^(Z<<1|$>>>31),_=P.low^($<<1|Z>>>31),W=0;W<5;W++){var T=m[z+5*W];T.high^=B,T.low^=_}for(var k=1;k<25;k++){var B,_,T=m[k],S=T.high,R=T.low,I=v[k];I<32?(B=S<<I|R>>>32-I,_=R<<I|S>>>32-I):(B=R<<I-32|S>>>64-I,_=S<<I-32|R>>>64-I);var L=g[f[k]];L.high=B,L.low=_}var K=g[0],V=m[0];K.high=V.high,K.low=V.low;for(var z=0;z<5;z++)for(var W=0;W<5;W++){var k=z+5*W,T=m[k],me=g[k],xe=g[(z+1)%5+5*W],ye=g[(z+2)%5+5*W];T.high=me.high^~xe.high&ye.high,T.low=me.low^~xe.low&ye.low}var T=m[0],ie=y[F];T.high^=ie.high,T.low^=ie.low}},_doFinalize:function(){var x=this._data,p=x.words;this._nDataBytes*8;var m=x.sigBytes*8,b=this.blockSize*32;p[m>>>5]|=1<<24-m%32,p[(o.ceil((m+1)/b)*b>>>5)-1]|=128,x.sigBytes=p.length*4,this._process();for(var C=this._state,w=this.cfg.outputLength/8,A=w/8,T=[],F=0;F<A;F++){var z=C[F],B=z.high,_=z.low;B=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360,_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,T.push(_),T.push(B)}return new l.init(T,w)},clone:function(){for(var x=u.clone.call(this),p=x._state=this._state.slice(0),m=0;m<25;m++)p[m]=p[m].clone();return x}});r.SHA3=u._createHelper(h),r.HmacSHA3=u._createHmacHelper(h)}(Math),t.SHA3})}(ao)),ao.exports}var so={exports:{}},Mr;function Fi(){return Mr||(Mr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){/** @preserve
			(c) 2012 by Cédric Mesnil. All rights reserved.

			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
			*/return function(o){var r=t,a=r.lib,l=a.WordArray,u=a.Hasher,d=r.algo,s=l.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),c=l.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),v=l.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),f=l.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),y=l.create([0,1518500249,1859775393,2400959708,2840853838]),g=l.create([1352829926,1548603684,1836072691,2053994217,0]),h=d.RIPEMD160=u.extend({_doReset:function(){this._hash=l.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(A,T){for(var F=0;F<16;F++){var z=T+F,B=A[z];A[z]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}var _=this._hash.words,W=y.words,E=g.words,P=s.words,H=c.words,Z=v.words,$=f.words,k,S,R,I,L,K,V,me,xe,ye;K=k=_[0],V=S=_[1],me=R=_[2],xe=I=_[3],ye=L=_[4];for(var ie,F=0;F<80;F+=1)ie=k+A[T+P[F]]|0,F<16?ie+=x(S,R,I)+W[0]:F<32?ie+=p(S,R,I)+W[1]:F<48?ie+=m(S,R,I)+W[2]:F<64?ie+=b(S,R,I)+W[3]:ie+=C(S,R,I)+W[4],ie=ie|0,ie=w(ie,Z[F]),ie=ie+L|0,k=L,L=I,I=w(R,10),R=S,S=ie,ie=K+A[T+H[F]]|0,F<16?ie+=C(V,me,xe)+E[0]:F<32?ie+=b(V,me,xe)+E[1]:F<48?ie+=m(V,me,xe)+E[2]:F<64?ie+=p(V,me,xe)+E[3]:ie+=x(V,me,xe)+E[4],ie=ie|0,ie=w(ie,$[F]),ie=ie+ye|0,K=ye,ye=xe,xe=w(me,10),me=V,V=ie;ie=_[1]+R+xe|0,_[1]=_[2]+I+ye|0,_[2]=_[3]+L+K|0,_[3]=_[4]+k+V|0,_[4]=_[0]+S+me|0,_[0]=ie},_doFinalize:function(){var A=this._data,T=A.words,F=this._nDataBytes*8,z=A.sigBytes*8;T[z>>>5]|=128<<24-z%32,T[(z+64>>>9<<4)+14]=(F<<8|F>>>24)&16711935|(F<<24|F>>>8)&4278255360,A.sigBytes=(T.length+1)*4,this._process();for(var B=this._hash,_=B.words,W=0;W<5;W++){var E=_[W];_[W]=(E<<8|E>>>24)&16711935|(E<<24|E>>>8)&4278255360}return B},clone:function(){var A=u.clone.call(this);return A._hash=this._hash.clone(),A}});function x(A,T,F){return A^T^F}function p(A,T,F){return A&T|~A&F}function m(A,T,F){return(A|~T)^F}function b(A,T,F){return A&F|T&~F}function C(A,T,F){return A^(T|~F)}function w(A,T){return A<<T|A>>>32-T}r.RIPEMD160=u._createHelper(h),r.HmacRIPEMD160=u._createHmacHelper(h)}(),t.RIPEMD160})}(so)),so.exports}var io={exports:{}},Wr;function Zo(){return Wr||(Wr=1,function(e,n){(function(t,o){e.exports=o(fe())})(ue,function(t){(function(){var o=t,r=o.lib,a=r.Base,l=o.enc,u=l.Utf8,d=o.algo;d.HMAC=a.extend({init:function(s,c){s=this._hasher=new s.init,typeof c=="string"&&(c=u.parse(c));var v=s.blockSize,f=v*4;c.sigBytes>f&&(c=s.finalize(c)),c.clamp();for(var y=this._oKey=c.clone(),g=this._iKey=c.clone(),h=y.words,x=g.words,p=0;p<v;p++)h[p]^=1549556828,x[p]^=909522486;y.sigBytes=g.sigBytes=f,this.reset()},reset:function(){var s=this._hasher;s.reset(),s.update(this._iKey)},update:function(s){return this._hasher.update(s),this},finalize:function(s){var c=this._hasher,v=c.finalize(s);c.reset();var f=c.finalize(this._oKey.clone().concat(v));return f}})})()})}(io)),io.exports}var lo={exports:{}},Or;function Si(){return Or||(Or=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Qo(),Zo())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.Base,l=r.WordArray,u=o.algo,d=u.SHA256,s=u.HMAC,c=u.PBKDF2=a.extend({cfg:a.extend({keySize:128/32,hasher:d,iterations:25e4}),init:function(v){this.cfg=this.cfg.extend(v)},compute:function(v,f){for(var y=this.cfg,g=s.create(y.hasher,v),h=l.create(),x=l.create([1]),p=h.words,m=x.words,b=y.keySize,C=y.iterations;p.length<b;){var w=g.update(f).finalize(x);g.reset();for(var A=w.words,T=A.length,F=w,z=1;z<C;z++){F=g.finalize(F),g.reset();for(var B=F.words,_=0;_<T;_++)A[_]^=B[_]}h.concat(w),m[0]++}return h.sigBytes=b*4,h}});o.PBKDF2=function(v,f,y){return c.create(y).compute(v,f)}}(),t.PBKDF2})}(lo)),lo.exports}var co={exports:{}},Nr;function ht(){return Nr||(Nr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Ha(),Zo())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.Base,l=r.WordArray,u=o.algo,d=u.MD5,s=u.EvpKDF=a.extend({cfg:a.extend({keySize:128/32,hasher:d,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(c,v){for(var f,y=this.cfg,g=y.hasher.create(),h=l.create(),x=h.words,p=y.keySize,m=y.iterations;x.length<p;){f&&g.update(f),f=g.update(c).finalize(v),g.reset();for(var b=1;b<m;b++)f=g.finalize(f),g.reset();h.concat(f)}return h.sigBytes=p*4,h}});o.EvpKDF=function(c,v,f){return s.create(f).compute(c,v)}}(),t.EvpKDF})}(co)),co.exports}var uo={exports:{}},Lr;function $e(){return Lr||(Lr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),ht())})(ue,function(t){t.lib.Cipher||function(o){var r=t,a=r.lib,l=a.Base,u=a.WordArray,d=a.BufferedBlockAlgorithm,s=r.enc;s.Utf8;var c=s.Base64,v=r.algo,f=v.EvpKDF,y=a.Cipher=d.extend({cfg:l.extend(),createEncryptor:function(B,_){return this.create(this._ENC_XFORM_MODE,B,_)},createDecryptor:function(B,_){return this.create(this._DEC_XFORM_MODE,B,_)},init:function(B,_,W){this.cfg=this.cfg.extend(W),this._xformMode=B,this._key=_,this.reset()},reset:function(){d.reset.call(this),this._doReset()},process:function(B){return this._append(B),this._process()},finalize:function(B){B&&this._append(B);var _=this._doFinalize();return _},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function B(_){return typeof _=="string"?z:A}return function(_){return{encrypt:function(W,E,P){return B(E).encrypt(_,W,E,P)},decrypt:function(W,E,P){return B(E).decrypt(_,W,E,P)}}}}()});a.StreamCipher=y.extend({_doFinalize:function(){var B=this._process(!0);return B},blockSize:1});var g=r.mode={},h=a.BlockCipherMode=l.extend({createEncryptor:function(B,_){return this.Encryptor.create(B,_)},createDecryptor:function(B,_){return this.Decryptor.create(B,_)},init:function(B,_){this._cipher=B,this._iv=_}}),x=g.CBC=function(){var B=h.extend();B.Encryptor=B.extend({processBlock:function(W,E){var P=this._cipher,H=P.blockSize;_.call(this,W,E,H),P.encryptBlock(W,E),this._prevBlock=W.slice(E,E+H)}}),B.Decryptor=B.extend({processBlock:function(W,E){var P=this._cipher,H=P.blockSize,Z=W.slice(E,E+H);P.decryptBlock(W,E),_.call(this,W,E,H),this._prevBlock=Z}});function _(W,E,P){var H,Z=this._iv;Z?(H=Z,this._iv=o):H=this._prevBlock;for(var $=0;$<P;$++)W[E+$]^=H[$]}return B}(),p=r.pad={},m=p.Pkcs7={pad:function(B,_){for(var W=_*4,E=W-B.sigBytes%W,P=E<<24|E<<16|E<<8|E,H=[],Z=0;Z<E;Z+=4)H.push(P);var $=u.create(H,E);B.concat($)},unpad:function(B){var _=B.words[B.sigBytes-1>>>2]&255;B.sigBytes-=_}};a.BlockCipher=y.extend({cfg:y.cfg.extend({mode:x,padding:m}),reset:function(){var B;y.reset.call(this);var _=this.cfg,W=_.iv,E=_.mode;this._xformMode==this._ENC_XFORM_MODE?B=E.createEncryptor:(B=E.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==B?this._mode.init(this,W&&W.words):(this._mode=B.call(E,this,W&&W.words),this._mode.__creator=B)},_doProcessBlock:function(B,_){this._mode.processBlock(B,_)},_doFinalize:function(){var B,_=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(_.pad(this._data,this.blockSize),B=this._process(!0)):(B=this._process(!0),_.unpad(B)),B},blockSize:128/32});var b=a.CipherParams=l.extend({init:function(B){this.mixIn(B)},toString:function(B){return(B||this.formatter).stringify(this)}}),C=r.format={},w=C.OpenSSL={stringify:function(B){var _,W=B.ciphertext,E=B.salt;return E?_=u.create([1398893684,1701076831]).concat(E).concat(W):_=W,_.toString(c)},parse:function(B){var _,W=c.parse(B),E=W.words;return E[0]==1398893684&&E[1]==1701076831&&(_=u.create(E.slice(2,4)),E.splice(0,4),W.sigBytes-=16),b.create({ciphertext:W,salt:_})}},A=a.SerializableCipher=l.extend({cfg:l.extend({format:w}),encrypt:function(B,_,W,E){E=this.cfg.extend(E);var P=B.createEncryptor(W,E),H=P.finalize(_),Z=P.cfg;return b.create({ciphertext:H,key:W,iv:Z.iv,algorithm:B,mode:Z.mode,padding:Z.padding,blockSize:B.blockSize,formatter:E.format})},decrypt:function(B,_,W,E){E=this.cfg.extend(E),_=this._parse(_,E.format);var P=B.createDecryptor(W,E).finalize(_.ciphertext);return P},_parse:function(B,_){return typeof B=="string"?_.parse(B,this):B}}),T=r.kdf={},F=T.OpenSSL={execute:function(B,_,W,E,P){if(E||(E=u.random(64/8)),P)var H=f.create({keySize:_+W,hasher:P}).compute(B,E);else var H=f.create({keySize:_+W}).compute(B,E);var Z=u.create(H.words.slice(_),W*4);return H.sigBytes=_*4,b.create({key:H,iv:Z,salt:E})}},z=a.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:F}),encrypt:function(B,_,W,E){E=this.cfg.extend(E);var P=E.kdf.execute(W,B.keySize,B.ivSize,E.salt,E.hasher);E.iv=P.iv;var H=A.encrypt.call(this,B,_,P.key,E);return H.mixIn(P),H},decrypt:function(B,_,W,E){E=this.cfg.extend(E),_=this._parse(_,E.format);var P=E.kdf.execute(W,B.keySize,B.ivSize,_.salt,E.hasher);E.iv=P.iv;var H=A.decrypt.call(this,B,_,P.key,E);return H}})}()})}(uo)),uo.exports}var fo={exports:{}},Ur;function Ri(){return Ur||(Ur=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.mode.CFB=function(){var o=t.lib.BlockCipherMode.extend();o.Encryptor=o.extend({processBlock:function(a,l){var u=this._cipher,d=u.blockSize;r.call(this,a,l,d,u),this._prevBlock=a.slice(l,l+d)}}),o.Decryptor=o.extend({processBlock:function(a,l){var u=this._cipher,d=u.blockSize,s=a.slice(l,l+d);r.call(this,a,l,d,u),this._prevBlock=s}});function r(a,l,u,d){var s,c=this._iv;c?(s=c.slice(0),this._iv=void 0):s=this._prevBlock,d.encryptBlock(s,0);for(var v=0;v<u;v++)a[l+v]^=s[v]}return o}(),t.mode.CFB})}(fo)),fo.exports}var xo={exports:{}},jr;function $i(){return jr||(jr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.mode.CTR=function(){var o=t.lib.BlockCipherMode.extend(),r=o.Encryptor=o.extend({processBlock:function(a,l){var u=this._cipher,d=u.blockSize,s=this._iv,c=this._counter;s&&(c=this._counter=s.slice(0),this._iv=void 0);var v=c.slice(0);u.encryptBlock(v,0),c[d-1]=c[d-1]+1|0;for(var f=0;f<d;f++)a[l+f]^=v[f]}});return o.Decryptor=r,o}(),t.mode.CTR})}(xo)),xo.exports}var vo={exports:{}},Hr;function Ii(){return Hr||(Hr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var o=t.lib.BlockCipherMode.extend();function r(u){if((u>>24&255)===255){var d=u>>16&255,s=u>>8&255,c=u&255;d===255?(d=0,s===255?(s=0,c===255?c=0:++c):++s):++d,u=0,u+=d<<16,u+=s<<8,u+=c}else u+=1<<24;return u}function a(u){return(u[0]=r(u[0]))===0&&(u[1]=r(u[1])),u}var l=o.Encryptor=o.extend({processBlock:function(u,d){var s=this._cipher,c=s.blockSize,v=this._iv,f=this._counter;v&&(f=this._counter=v.slice(0),this._iv=void 0),a(f);var y=f.slice(0);s.encryptBlock(y,0);for(var g=0;g<c;g++)u[d+g]^=y[g]}});return o.Decryptor=l,o}(),t.mode.CTRGladman})}(vo)),vo.exports}var go={exports:{}},qr;function Pi(){return qr||(qr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.mode.OFB=function(){var o=t.lib.BlockCipherMode.extend(),r=o.Encryptor=o.extend({processBlock:function(a,l){var u=this._cipher,d=u.blockSize,s=this._iv,c=this._keystream;s&&(c=this._keystream=s.slice(0),this._iv=void 0),u.encryptBlock(c,0);for(var v=0;v<d;v++)a[l+v]^=c[v]}});return o.Decryptor=r,o}(),t.mode.OFB})}(go)),go.exports}var mo={exports:{}},zr;function Mi(){return zr||(zr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.mode.ECB=function(){var o=t.lib.BlockCipherMode.extend();return o.Encryptor=o.extend({processBlock:function(r,a){this._cipher.encryptBlock(r,a)}}),o.Decryptor=o.extend({processBlock:function(r,a){this._cipher.decryptBlock(r,a)}}),o}(),t.mode.ECB})}(mo)),mo.exports}var po={exports:{}},Gr;function Wi(){return Gr||(Gr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.pad.AnsiX923={pad:function(o,r){var a=o.sigBytes,l=r*4,u=l-a%l,d=a+u-1;o.clamp(),o.words[d>>>2]|=u<<24-d%4*8,o.sigBytes+=u},unpad:function(o){var r=o.words[o.sigBytes-1>>>2]&255;o.sigBytes-=r}},t.pad.Ansix923})}(po)),po.exports}var ho={exports:{}},Vr;function Oi(){return Vr||(Vr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.pad.Iso10126={pad:function(o,r){var a=r*4,l=a-o.sigBytes%a;o.concat(t.lib.WordArray.random(l-1)).concat(t.lib.WordArray.create([l<<24],1))},unpad:function(o){var r=o.words[o.sigBytes-1>>>2]&255;o.sigBytes-=r}},t.pad.Iso10126})}(ho)),ho.exports}var bo={exports:{}},Kr;function Ni(){return Kr||(Kr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.pad.Iso97971={pad:function(o,r){o.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(o,r)},unpad:function(o){t.pad.ZeroPadding.unpad(o),o.sigBytes--}},t.pad.Iso97971})}(bo)),bo.exports}var yo={exports:{}},Yr;function Li(){return Yr||(Yr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.pad.ZeroPadding={pad:function(o,r){var a=r*4;o.clamp(),o.sigBytes+=a-(o.sigBytes%a||a)},unpad:function(o){for(var r=o.words,a=o.sigBytes-1,a=o.sigBytes-1;a>=0;a--)if(r[a>>>2]>>>24-a%4*8&255){o.sigBytes=a+1;break}}},t.pad.ZeroPadding})}(yo)),yo.exports}var Co={exports:{}},Xr;function Ui(){return Xr||(Xr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(Co)),Co.exports}var wo={exports:{}},Qr;function ji(){return Qr||(Qr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),$e())})(ue,function(t){return function(o){var r=t,a=r.lib,l=a.CipherParams,u=r.enc,d=u.Hex,s=r.format;s.Hex={stringify:function(c){return c.ciphertext.toString(d)},parse:function(c){var v=d.parse(c);return l.create({ciphertext:v})}}}(),t.format.Hex})}(wo)),wo.exports}var Eo={exports:{}},Zr;function Hi(){return Zr||(Zr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.BlockCipher,l=o.algo,u=[],d=[],s=[],c=[],v=[],f=[],y=[],g=[],h=[],x=[];(function(){for(var b=[],C=0;C<256;C++)C<128?b[C]=C<<1:b[C]=C<<1^283;for(var w=0,A=0,C=0;C<256;C++){var T=A^A<<1^A<<2^A<<3^A<<4;T=T>>>8^T&255^99,u[w]=T,d[T]=w;var F=b[w],z=b[F],B=b[z],_=b[T]*257^T*16843008;s[w]=_<<24|_>>>8,c[w]=_<<16|_>>>16,v[w]=_<<8|_>>>24,f[w]=_;var _=B*16843009^z*65537^F*257^w*16843008;y[T]=_<<24|_>>>8,g[T]=_<<16|_>>>16,h[T]=_<<8|_>>>24,x[T]=_,w?(w=F^b[b[b[B^F]]],A^=b[b[A]]):w=A=1}})();var p=[0,1,2,4,8,16,32,64,128,27,54],m=l.AES=a.extend({_doReset:function(){var b;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var C=this._keyPriorReset=this._key,w=C.words,A=C.sigBytes/4,T=this._nRounds=A+6,F=(T+1)*4,z=this._keySchedule=[],B=0;B<F;B++)B<A?z[B]=w[B]:(b=z[B-1],B%A?A>6&&B%A==4&&(b=u[b>>>24]<<24|u[b>>>16&255]<<16|u[b>>>8&255]<<8|u[b&255]):(b=b<<8|b>>>24,b=u[b>>>24]<<24|u[b>>>16&255]<<16|u[b>>>8&255]<<8|u[b&255],b^=p[B/A|0]<<24),z[B]=z[B-A]^b);for(var _=this._invKeySchedule=[],W=0;W<F;W++){var B=F-W;if(W%4)var b=z[B];else var b=z[B-4];W<4||B<=4?_[W]=b:_[W]=y[u[b>>>24]]^g[u[b>>>16&255]]^h[u[b>>>8&255]]^x[u[b&255]]}}},encryptBlock:function(b,C){this._doCryptBlock(b,C,this._keySchedule,s,c,v,f,u)},decryptBlock:function(b,C){var w=b[C+1];b[C+1]=b[C+3],b[C+3]=w,this._doCryptBlock(b,C,this._invKeySchedule,y,g,h,x,d);var w=b[C+1];b[C+1]=b[C+3],b[C+3]=w},_doCryptBlock:function(b,C,w,A,T,F,z,B){for(var _=this._nRounds,W=b[C]^w[0],E=b[C+1]^w[1],P=b[C+2]^w[2],H=b[C+3]^w[3],Z=4,$=1;$<_;$++){var k=A[W>>>24]^T[E>>>16&255]^F[P>>>8&255]^z[H&255]^w[Z++],S=A[E>>>24]^T[P>>>16&255]^F[H>>>8&255]^z[W&255]^w[Z++],R=A[P>>>24]^T[H>>>16&255]^F[W>>>8&255]^z[E&255]^w[Z++],I=A[H>>>24]^T[W>>>16&255]^F[E>>>8&255]^z[P&255]^w[Z++];W=k,E=S,P=R,H=I}var k=(B[W>>>24]<<24|B[E>>>16&255]<<16|B[P>>>8&255]<<8|B[H&255])^w[Z++],S=(B[E>>>24]<<24|B[P>>>16&255]<<16|B[H>>>8&255]<<8|B[W&255])^w[Z++],R=(B[P>>>24]<<24|B[H>>>16&255]<<16|B[W>>>8&255]<<8|B[E&255])^w[Z++],I=(B[H>>>24]<<24|B[W>>>16&255]<<16|B[E>>>8&255]<<8|B[P&255])^w[Z++];b[C]=k,b[C+1]=S,b[C+2]=R,b[C+3]=I},keySize:256/32});o.AES=a._createHelper(m)}(),t.AES})}(Eo)),Eo.exports}var _o={exports:{}},Jr;function qi(){return Jr||(Jr=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.WordArray,l=r.BlockCipher,u=o.algo,d=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],c=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],v=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],f=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],y=u.DES=l.extend({_doReset:function(){for(var p=this._key,m=p.words,b=[],C=0;C<56;C++){var w=d[C]-1;b[C]=m[w>>>5]>>>31-w%32&1}for(var A=this._subKeys=[],T=0;T<16;T++){for(var F=A[T]=[],z=c[T],C=0;C<24;C++)F[C/6|0]|=b[(s[C]-1+z)%28]<<31-C%6,F[4+(C/6|0)]|=b[28+(s[C+24]-1+z)%28]<<31-C%6;F[0]=F[0]<<1|F[0]>>>31;for(var C=1;C<7;C++)F[C]=F[C]>>>(C-1)*4+3;F[7]=F[7]<<5|F[7]>>>27}for(var B=this._invSubKeys=[],C=0;C<16;C++)B[C]=A[15-C]},encryptBlock:function(p,m){this._doCryptBlock(p,m,this._subKeys)},decryptBlock:function(p,m){this._doCryptBlock(p,m,this._invSubKeys)},_doCryptBlock:function(p,m,b){this._lBlock=p[m],this._rBlock=p[m+1],g.call(this,4,252645135),g.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),g.call(this,1,1431655765);for(var C=0;C<16;C++){for(var w=b[C],A=this._lBlock,T=this._rBlock,F=0,z=0;z<8;z++)F|=v[z][((T^w[z])&f[z])>>>0];this._lBlock=T,this._rBlock=A^F}var B=this._lBlock;this._lBlock=this._rBlock,this._rBlock=B,g.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),g.call(this,16,65535),g.call(this,4,252645135),p[m]=this._lBlock,p[m+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function g(p,m){var b=(this._lBlock>>>p^this._rBlock)&m;this._rBlock^=b,this._lBlock^=b<<p}function h(p,m){var b=(this._rBlock>>>p^this._lBlock)&m;this._lBlock^=b,this._rBlock^=b<<p}o.DES=l._createHelper(y);var x=u.TripleDES=l.extend({_doReset:function(){var p=this._key,m=p.words;if(m.length!==2&&m.length!==4&&m.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var b=m.slice(0,2),C=m.length<4?m.slice(0,2):m.slice(2,4),w=m.length<6?m.slice(0,2):m.slice(4,6);this._des1=y.createEncryptor(a.create(b)),this._des2=y.createEncryptor(a.create(C)),this._des3=y.createEncryptor(a.create(w))},encryptBlock:function(p,m){this._des1.encryptBlock(p,m),this._des2.decryptBlock(p,m),this._des3.encryptBlock(p,m)},decryptBlock:function(p,m){this._des3.decryptBlock(p,m),this._des2.encryptBlock(p,m),this._des1.decryptBlock(p,m)},keySize:192/32,ivSize:64/32,blockSize:64/32});o.TripleDES=l._createHelper(x)}(),t.TripleDES})}(_o)),_o.exports}var Ao={exports:{}},ea;function zi(){return ea||(ea=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.StreamCipher,l=o.algo,u=l.RC4=a.extend({_doReset:function(){for(var c=this._key,v=c.words,f=c.sigBytes,y=this._S=[],g=0;g<256;g++)y[g]=g;for(var g=0,h=0;g<256;g++){var x=g%f,p=v[x>>>2]>>>24-x%4*8&255;h=(h+y[g]+p)%256;var m=y[g];y[g]=y[h],y[h]=m}this._i=this._j=0},_doProcessBlock:function(c,v){c[v]^=d.call(this)},keySize:256/32,ivSize:0});function d(){for(var c=this._S,v=this._i,f=this._j,y=0,g=0;g<4;g++){v=(v+1)%256,f=(f+c[v])%256;var h=c[v];c[v]=c[f],c[f]=h,y|=c[(c[v]+c[f])%256]<<24-g*8}return this._i=v,this._j=f,y}o.RC4=a._createHelper(u);var s=l.RC4Drop=u.extend({cfg:u.cfg.extend({drop:192}),_doReset:function(){u._doReset.call(this);for(var c=this.cfg.drop;c>0;c--)d.call(this)}});o.RC4Drop=a._createHelper(s)}(),t.RC4})}(Ao)),Ao.exports}var Bo={exports:{}},ta;function Gi(){return ta||(ta=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.StreamCipher,l=o.algo,u=[],d=[],s=[],c=l.Rabbit=a.extend({_doReset:function(){for(var f=this._key.words,y=this.cfg.iv,g=0;g<4;g++)f[g]=(f[g]<<8|f[g]>>>24)&16711935|(f[g]<<24|f[g]>>>8)&4278255360;var h=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],x=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var g=0;g<4;g++)v.call(this);for(var g=0;g<8;g++)x[g]^=h[g+4&7];if(y){var p=y.words,m=p[0],b=p[1],C=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,A=C>>>16|w&4294901760,T=w<<16|C&65535;x[0]^=C,x[1]^=A,x[2]^=w,x[3]^=T,x[4]^=C,x[5]^=A,x[6]^=w,x[7]^=T;for(var g=0;g<4;g++)v.call(this)}},_doProcessBlock:function(f,y){var g=this._X;v.call(this),u[0]=g[0]^g[5]>>>16^g[3]<<16,u[1]=g[2]^g[7]>>>16^g[5]<<16,u[2]=g[4]^g[1]>>>16^g[7]<<16,u[3]=g[6]^g[3]>>>16^g[1]<<16;for(var h=0;h<4;h++)u[h]=(u[h]<<8|u[h]>>>24)&16711935|(u[h]<<24|u[h]>>>8)&4278255360,f[y+h]^=u[h]},blockSize:128/32,ivSize:64/32});function v(){for(var f=this._X,y=this._C,g=0;g<8;g++)d[g]=y[g];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var g=0;g<8;g++){var h=f[g]+y[g],x=h&65535,p=h>>>16,m=((x*x>>>17)+x*p>>>15)+p*p,b=((h&4294901760)*h|0)+((h&65535)*h|0);s[g]=m^b}f[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,f[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,f[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,f[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,f[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,f[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,f[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,f[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}o.Rabbit=a._createHelper(c)}(),t.Rabbit})}(Bo)),Bo.exports}var To={exports:{}},na;function Vi(){return na||(na=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.StreamCipher,l=o.algo,u=[],d=[],s=[],c=l.RabbitLegacy=a.extend({_doReset:function(){var f=this._key.words,y=this.cfg.iv,g=this._X=[f[0],f[3]<<16|f[2]>>>16,f[1],f[0]<<16|f[3]>>>16,f[2],f[1]<<16|f[0]>>>16,f[3],f[2]<<16|f[1]>>>16],h=this._C=[f[2]<<16|f[2]>>>16,f[0]&4294901760|f[1]&65535,f[3]<<16|f[3]>>>16,f[1]&4294901760|f[2]&65535,f[0]<<16|f[0]>>>16,f[2]&4294901760|f[3]&65535,f[1]<<16|f[1]>>>16,f[3]&4294901760|f[0]&65535];this._b=0;for(var x=0;x<4;x++)v.call(this);for(var x=0;x<8;x++)h[x]^=g[x+4&7];if(y){var p=y.words,m=p[0],b=p[1],C=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,w=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,A=C>>>16|w&4294901760,T=w<<16|C&65535;h[0]^=C,h[1]^=A,h[2]^=w,h[3]^=T,h[4]^=C,h[5]^=A,h[6]^=w,h[7]^=T;for(var x=0;x<4;x++)v.call(this)}},_doProcessBlock:function(f,y){var g=this._X;v.call(this),u[0]=g[0]^g[5]>>>16^g[3]<<16,u[1]=g[2]^g[7]>>>16^g[5]<<16,u[2]=g[4]^g[1]>>>16^g[7]<<16,u[3]=g[6]^g[3]>>>16^g[1]<<16;for(var h=0;h<4;h++)u[h]=(u[h]<<8|u[h]>>>24)&16711935|(u[h]<<24|u[h]>>>8)&4278255360,f[y+h]^=u[h]},blockSize:128/32,ivSize:64/32});function v(){for(var f=this._X,y=this._C,g=0;g<8;g++)d[g]=y[g];y[0]=y[0]+1295307597+this._b|0,y[1]=y[1]+3545052371+(y[0]>>>0<d[0]>>>0?1:0)|0,y[2]=y[2]+886263092+(y[1]>>>0<d[1]>>>0?1:0)|0,y[3]=y[3]+1295307597+(y[2]>>>0<d[2]>>>0?1:0)|0,y[4]=y[4]+3545052371+(y[3]>>>0<d[3]>>>0?1:0)|0,y[5]=y[5]+886263092+(y[4]>>>0<d[4]>>>0?1:0)|0,y[6]=y[6]+1295307597+(y[5]>>>0<d[5]>>>0?1:0)|0,y[7]=y[7]+3545052371+(y[6]>>>0<d[6]>>>0?1:0)|0,this._b=y[7]>>>0<d[7]>>>0?1:0;for(var g=0;g<8;g++){var h=f[g]+y[g],x=h&65535,p=h>>>16,m=((x*x>>>17)+x*p>>>15)+p*p,b=((h&4294901760)*h|0)+((h&65535)*h|0);s[g]=m^b}f[0]=s[0]+(s[7]<<16|s[7]>>>16)+(s[6]<<16|s[6]>>>16)|0,f[1]=s[1]+(s[0]<<8|s[0]>>>24)+s[7]|0,f[2]=s[2]+(s[1]<<16|s[1]>>>16)+(s[0]<<16|s[0]>>>16)|0,f[3]=s[3]+(s[2]<<8|s[2]>>>24)+s[1]|0,f[4]=s[4]+(s[3]<<16|s[3]>>>16)+(s[2]<<16|s[2]>>>16)|0,f[5]=s[5]+(s[4]<<8|s[4]>>>24)+s[3]|0,f[6]=s[6]+(s[5]<<16|s[5]>>>16)+(s[4]<<16|s[4]>>>16)|0,f[7]=s[7]+(s[6]<<8|s[6]>>>24)+s[5]|0}o.RabbitLegacy=a._createHelper(c)}(),t.RabbitLegacy})}(To)),To.exports}var ko={exports:{}},oa;function Ki(){return oa||(oa=1,function(e,n){(function(t,o,r){e.exports=o(fe(),Dt(),Ft(),ht(),$e())})(ue,function(t){return function(){var o=t,r=o.lib,a=r.BlockCipher,l=o.algo;const u=16,d=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var c={pbox:[],sbox:[]};function v(x,p){let m=p>>24&255,b=p>>16&255,C=p>>8&255,w=p&255,A=x.sbox[0][m]+x.sbox[1][b];return A=A^x.sbox[2][C],A=A+x.sbox[3][w],A}function f(x,p,m){let b=p,C=m,w;for(let A=0;A<u;++A)b=b^x.pbox[A],C=v(x,b)^C,w=b,b=C,C=w;return w=b,b=C,C=w,C=C^x.pbox[u],b=b^x.pbox[u+1],{left:b,right:C}}function y(x,p,m){let b=p,C=m,w;for(let A=u+1;A>1;--A)b=b^x.pbox[A],C=v(x,b)^C,w=b,b=C,C=w;return w=b,b=C,C=w,C=C^x.pbox[1],b=b^x.pbox[0],{left:b,right:C}}function g(x,p,m){for(let T=0;T<4;T++){x.sbox[T]=[];for(let F=0;F<256;F++)x.sbox[T][F]=s[T][F]}let b=0;for(let T=0;T<u+2;T++)x.pbox[T]=d[T]^p[b],b++,b>=m&&(b=0);let C=0,w=0,A=0;for(let T=0;T<u+2;T+=2)A=f(x,C,w),C=A.left,w=A.right,x.pbox[T]=C,x.pbox[T+1]=w;for(let T=0;T<4;T++)for(let F=0;F<256;F+=2)A=f(x,C,w),C=A.left,w=A.right,x.sbox[T][F]=C,x.sbox[T][F+1]=w;return!0}var h=l.Blowfish=a.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var x=this._keyPriorReset=this._key,p=x.words,m=x.sigBytes/4;g(c,p,m)}},encryptBlock:function(x,p){var m=f(c,x[p],x[p+1]);x[p]=m.left,x[p+1]=m.right},decryptBlock:function(x,p){var m=y(c,x[p],x[p+1]);x[p]=m.left,x[p+1]=m.right},blockSize:64/32,keySize:128/32,ivSize:64/32});o.Blowfish=a._createHelper(h)}(),t.Blowfish})}(ko)),ko.exports}(function(e,n){(function(t,o,r){e.exports=o(fe(),Rn(),_i(),Ai(),Dt(),Bi(),Ft(),Ha(),Qo(),Ti(),qa(),ki(),Di(),Fi(),Zo(),Si(),ht(),$e(),Ri(),$i(),Ii(),Pi(),Mi(),Wi(),Oi(),Ni(),Li(),Ui(),ji(),Hi(),qi(),zi(),Gi(),Vi(),Ki())})(ue,function(t){return t})})(ja);var Yi=ja.exports;const Do=hi(Yi);var ct=(e=>(e.SENDING="sending",e.SENT="sent",e.DELIVERED="delivered",e.READ="read",e.FAILED="failed",e))(ct||{});const ra="spacetalk-secure-key-2023";class Xi{constructor(n){qe(this,"messages",N({}));qe(this,"pendingMessages",N({}));qe(this,"unreadMessages",N({}));qe(this,"messageExpiryDays",30);this.storageProvider=n,this.loadAllChats(),this.setupAutoCleanup(),Re(this.messages,()=>{this.saveAllChats()},{deep:!0}),Re(this.pendingMessages,()=>{this.savePendingMessages()},{deep:!0})}createMessage(n,t,o){const r=this.encryptMessage(n);return{id:Ua(),sender:o?"me":"partner",text:r,originalText:o?n:void 0,timestamp:Date.now(),status:o?"sending":"delivered",retryCount:0,expiresAt:Date.now()+this.messageExpiryDays*24*60*60*1e3}}addMessage(n,t){const o=this.getConversationKey(t);this.messages.value[o]||(this.messages.value[o]=[]),this.messages.value[o].push(n),this.saveAllChats()}updateMessageStatus(n,t){let o=!1;return Object.keys(this.messages.value).forEach(r=>{const a=this.messages.value[r],l=a.findIndex(u=>u.id===n);l!==-1&&(a[l].status=t,o=!0)}),o&&this.saveAllChats(),o}addToPendingMessages(n,t){this.pendingMessages.value[t]||(this.pendingMessages.value[t]=[]),this.pendingMessages.value[t].push(n),this.savePendingMessages()}removeFromPendingMessages(n,t){if(!this.pendingMessages.value[t])return!1;const o=this.pendingMessages.value[t].length;return this.pendingMessages.value[t]=this.pendingMessages.value[t].filter(r=>r.id!==n),o!==this.pendingMessages.value[t].length?(this.savePendingMessages(),!0):!1}getPendingMessages(n){return this.pendingMessages.value[n]||[]}getAllPendingMessages(){return this.pendingMessages.value}getMessages(n){const t=this.getConversationKey(n);return(this.messages.value[t]||[]).map(r=>r.sender==="partner"?{...r,text:this.decryptMessage(r.text)}:{...r,text:r.originalText||this.decryptMessage(r.text)})}markAsRead(n){this.unreadMessages.value[n]=!1;const t=this.getConversationKey(n),o=this.messages.value[t]||[];let r=!1;o.forEach(a=>{a.sender==="partner"&&a.status==="delivered"&&(a.status="read",r=!0)}),r&&this.saveAllChats()}hasUnreadMessages(n){return!!this.unreadMessages.value[n]}setUnread(n,t){this.unreadMessages.value[n]=t}clearChat(n){const t=this.getConversationKey(n);this.messages.value[t]&&(this.messages.value[t]=[],this.saveAllChats()),this.pendingMessages.value[n]&&(this.pendingMessages.value[n]=[],this.savePendingMessages())}clearAllChats(){this.messages.value={},this.unreadMessages.value={},this.pendingMessages.value={},this.saveAllChats(),this.savePendingMessages()}encryptMessage(n){try{return Do.AES.encrypt(n,ra).toString()}catch(t){return console.error("Failed to encrypt message:",t),n}}decryptMessage(n){try{return Do.AES.decrypt(n,ra).toString(Do.enc.Utf8)}catch(t){return console.error("Failed to decrypt message:",t),n}}getConversationKey(n){return`chat_${n}`}saveAllChats(){if(this.storageProvider.isAvailable)try{this.storageProvider.setItem("chat_messages",JSON.stringify(this.messages.value)),this.storageProvider.setItem("chat_unread",JSON.stringify(this.unreadMessages.value))}catch(n){console.error("Failed to save chats:",n)}}loadAllChats(){if(this.storageProvider.isAvailable)try{const n=this.storageProvider.getItem("chat_messages");n&&(this.messages.value=JSON.parse(n));const t=this.storageProvider.getItem("chat_unread");t&&(this.unreadMessages.value=JSON.parse(t))}catch(n){console.error("Failed to load chats:",n)}}savePendingMessages(){if(this.storageProvider.isAvailable)try{this.storageProvider.setItem("chat_pending_messages",JSON.stringify(this.pendingMessages.value))}catch(n){console.error("Failed to save pending messages:",n)}}loadPendingMessages(){if(this.storageProvider.isAvailable)try{const n=this.storageProvider.getItem("chat_pending_messages");n&&(this.pendingMessages.value=JSON.parse(n))}catch(n){console.error("Failed to load pending messages:",n)}}setupAutoCleanup(){setInterval(()=>this.cleanupExpiredMessages(),24*60*60*1e3),this.cleanupExpiredMessages()}cleanupExpiredMessages(){const n=Date.now();let t=!1;Object.keys(this.messages.value).forEach(o=>{const r=this.messages.value[o].length;this.messages.value[o]=this.messages.value[o].filter(a=>!a.expiresAt||a.expiresAt>n),r!==this.messages.value[o].length&&(t=!0)}),t&&this.saveAllChats()}}class Qi{constructor(n){qe(this,"currentPartnerId",null);qe(this,"isListening",!1);qe(this,"retryTimeout",null);qe(this,"typingTimeout",null);qe(this,"DEBUG",!0);this.model=n,this.setupSocketListeners(),this.scheduleRetryCheck()}setupSocketListeners(){const{socket:n}=Me();if(!n.value){this.DEBUG&&console.log("[ChatController] No socket available, cannot set up listeners");return}this.isListening&&(n.value.off("chat-message"),n.value.off("message-received"),n.value.off("message-read"),n.value.off("typing"),n.value.off("check-pending-messages"),this.isListening=!1),n.value.on("check-pending-messages",()=>{var t;this.DEBUG&&console.log("[ChatController] Server requested to check pending messages"),(t=n.value)==null||t.emit("get-pending-messages")}),n.value.on("chat-message",t=>{this.DEBUG&&(console.log("[ChatController] Received chat message:",t),console.log("[ChatController] Current partner ID:",this.currentPartnerId));const o=this.model.createMessage(t.text,t.from,!1);o.id=t.id,o.timestamp=t.timestamp,this.model.addMessage(o,t.from),t.from!==this.currentPartnerId?(this.DEBUG&&console.log(`[ChatController] Message from ${t.from} marked as unread (not current partner)`),this.model.setUnread(t.from,!0)):(this.DEBUG&&console.log(`[ChatController] Message from current partner ${t.from}, marking as read`),this.sendReadReceipt(t.id,t.from)),this.sendDeliveryReceipt(t.id,t.from)}),n.value.on("message-received",t=>{this.DEBUG&&console.log("[ChatController] Message delivery receipt:",t),this.model.updateMessageStatus(t.id,ct.DELIVERED)}),n.value.on("message-read",t=>{this.DEBUG&&console.log("[ChatController] Message read receipt:",t),this.model.updateMessageStatus(t.id,ct.READ)}),n.value.on("typing",t=>{this.DEBUG&&console.log("[ChatController] Typing indicator:",t),window.dispatchEvent(new CustomEvent("chat:typing",{detail:{partnerId:t.from,isTyping:t.isTyping}}))}),this.isListening=!0,this.DEBUG&&console.log("[ChatController] Chat listeners setup complete")}setCurrentPartner(n){this.currentPartnerId=n,n&&this.model.markAsRead(n)}sendMessage(n,t){if(!n.trim()||!t)return!1;const o=this.model.createMessage(n,t,!0);this.model.addMessage(o,t);const{socket:r,isConnected:a}=Me();return r.value&&a.value?this.sendMessageToServer(o,t):(o.status=ct.FAILED,this.model.addToPendingMessages(o,t)),!0}sendMessageToServer(n,t){const{socket:o}=Me();if(!o.value){n.status=ct.FAILED,this.model.addToPendingMessages(n,t);return}this.model.updateMessageStatus(n.id,ct.SENDING),this.DEBUG&&console.log(`[ChatController] Sending message to server: ID=${n.id}, to=${t}, text=${n.originalText||n.text}`),o.value.emit("chat-message",{id:n.id,text:n.originalText||n.text,to:t,timestamp:n.timestamp},r=>{r&&r.success?(this.DEBUG&&console.log(`[ChatController] Server acknowledged message ${n.id}`),this.model.updateMessageStatus(n.id,ct.SENT)):(this.DEBUG&&console.log(`[ChatController] Server rejected message ${n.id}: ${(r==null?void 0:r.error)||"Unknown error"}`),this.model.updateMessageStatus(n.id,ct.FAILED),this.model.addToPendingMessages(n,t))})}resendMessage(n,t){const r=this.model.getPendingMessages(t).find(a=>a.id===n);if(!r){this.DEBUG&&console.log(`[ChatController] Message ${n} not found in pending messages`);const l=this.model.getMessages(t).find(u=>u.id===n&&u.status===ct.FAILED);return l?l.retryCount>=3?(this.DEBUG&&console.log(`[ChatController] Message ${n} has reached maximum retry attempts`),!1):(l.retryCount++,this.sendMessageToServer(l,t),!0):(this.DEBUG&&console.log(`[ChatController] Message ${n} not found in regular messages either`),!1)}return r.retryCount>=3?(this.DEBUG&&console.log(`[ChatController] Message ${n} has reached maximum retry attempts`),!1):(r.retryCount++,this.model.removeFromPendingMessages(n,t),this.sendMessageToServer(r,t),!0)}retryPendingMessages(){const{isConnected:n}=Me();if(!n.value){this.DEBUG&&console.log("[ChatController] Not connected, skipping retry of pending messages");return}const t=this.model.getAllPendingMessages();Object.keys(t).forEach(o=>{const r=[...t[o]];this.DEBUG&&console.log(`[ChatController] Retrying ${r.length} pending messages for partner ${o}`),r.forEach(a=>{a.retryCount<3&&(this.model.removeFromPendingMessages(a.id,o),this.sendMessageToServer(a,o))})})}scheduleRetryCheck(){this.retryTimeout=setInterval(()=>{this.DEBUG&&console.log("[ChatController] Running scheduled retry check for pending messages"),this.retryPendingMessages()},3e4)}sendDeliveryReceipt(n,t){const{socket:o,isConnected:r}=Me();if(!o.value||!r.value){this.DEBUG&&console.log("[ChatController] Cannot send delivery receipt: not connected");return}this.DEBUG&&console.log(`[ChatController] Sending delivery receipt for message ${n} to ${t}`),o.value.emit("message-received",{id:n,to:t})}sendReadReceipt(n,t){const{socket:o,isConnected:r}=Me();if(!o.value||!r.value){this.DEBUG&&console.log("[ChatController] Cannot send read receipt: not connected");return}this.DEBUG&&console.log(`[ChatController] Sending read receipt for message ${n} to ${t}`),o.value.emit("message-read",{id:n,to:t})}sendTypingIndicator(n){const{socket:t,isConnected:o}=Me();!t.value||!o.value||!n||(this.typingTimeout&&clearTimeout(this.typingTimeout),t.value.emit("typing",{to:n,isTyping:!0}),this.typingTimeout=setTimeout(()=>{t.value&&o.value&&t.value.emit("typing",{to:n,isTyping:!1})},3e3))}getMessages(n){return this.model.getMessages(n)}hasUnreadMessages(n){return this.model.hasUnreadMessages(n)}markAsRead(n){this.model.markAsRead(n)}clearChat(n){this.model.clearChat(n)}clearAllChats(){this.model.clearAllChats()}cleanup(){const{socket:n}=Me();n.value&&(n.value.off("chat-message"),n.value.off("message-received"),n.value.off("message-read"),n.value.off("typing")),this.retryTimeout&&clearInterval(this.retryTimeout),this.typingTimeout&&clearTimeout(this.typingTimeout),this.isListening=!1}}N({});const Fo=N(null);N({});N(!1);N({});let aa=null,Fe=null,sa=!1;function Zi(){const e=Ma();Me(),sa||(console.log("[ChatService] Initializing chat service with MVC architecture"),aa=new Xi(e),Fe=new Qi(aa),sa=!0);function n(c){Fo.value=c,Fe&&Fe.setCurrentPartner(c)}function t(c,v=null){const f=v||Fo.value;return!f||!c.trim()||!Fe?!1:Fe.sendMessage(c,f)}function o(c,v){return Fe?Fe.resendMessage(c,v):!1}function r(c){return!c||!Fe?[]:Fe.getMessages(c)}function a(c){return!c||!Fe?!1:Fe.hasUnreadMessages(c)}function l(c){!c||!Fe||Fe.markAsRead(c)}function u(c){!c||!Fe||Fe.sendTypingIndicator(c)}function d(c){Fe&&Fe.clearChat(c)}function s(){Fe&&Fe.clearAllChats()}return{currentPartnerId:Fo,setCurrentPartner:n,sendMessage:t,resendMessage:o,getMessages:r,hasUnreadMessages:a,markAsRead:l,handleTyping:u,clearChat:d,clearAllChats:s}}const Gt="/assets/Circle-e098ae42.png",Ji={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-4 sm:p-6 text-center border border-white/10"},el={key:"disconnected"},tl={key:"disconnecting"},nl={class:"text-base sm:text-lg font-semibold mb-1 sm:mb-2 text-white"},ol={class:"text-xs sm:text-sm text-red-300"},rl={key:"searching"},al={key:"matched"},sl={class:"text-base sm:text-lg font-semibold mb-1 sm:mb-2 text-white"},il={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},ll={class:"text-lg sm:text-xl"},cl={class:"text-xs sm:text-sm font-medium"},ul={key:"connected"},dl={class:"text-base sm:text-lg font-semibold mb-1 sm:mb-2 text-white"},fl={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},xl={class:"text-lg sm:text-xl"},vl={class:"text-xs sm:text-sm font-medium"},gl={key:0,class:"mt-3 sm:mt-4 text-xs"},ml={class:"flex items-center justify-center gap-1 sm:gap-2"},pl={class:"text-gray-300"},hl={key:0,class:"text-red-400 mt-1 text-xs"},bl=He({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0},disconnectReason:{type:String,default:""}},setup(e){const n=e,t=N(n.status),o=Ee(()=>{switch(n.disconnectReason){case"skip":return"Skipped";case"network-disconnect":return"Connection Lost";case"inactivity":return"Inactive Connection";case"matching":return"Finding New Partner";default:return"Disconnected"}}),r=Ee(()=>{switch(n.disconnectReason){case"skip":return"The conversation has been skipped";case"network-disconnect":return"The connection with your partner was lost";case"inactivity":return"The call ended due to inactivity";case"matching":return"Looking for a new partner...";default:return"The call has been ended"}});Re(()=>n.partnerInfo,(v,f)=>{console.log("PartnerInfo changed in connection-card:",{new:v?"Present":"Null",old:f?"Present":"Null",status:n.status})},{deep:!0}),Re(()=>n.status,(v,f)=>{console.log("Status changed in connection-card:",{new:v,old:f}),t.value=f,v==="disconnected"&&n.partnerInfo!==null&&console.warn("Warning: Partner info still present when status is disconnected")});const a=Ee(()=>t.value==="disconnected"&&n.status==="searching"?"idle-to-search":t.value==="searching"&&n.status==="matched"?"search-to-match":t.value==="matched"&&n.status==="connected"?"match-to-connect":n.status==="disconnected"?"to-idle":n.status==="disconnecting"?"to-disconnecting":"fade"),l=v=>{},u=(v,f)=>{},d=v=>{},s=Ee(()=>{switch(n.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";case"disconnecting":return"Call ended";default:return"Disconnected"}}),c=v=>{switch(v.toLowerCase()){case"any":return"Go With the Flow";case"chill":return"Chill";case"fun":return"Fun";case"curious":return"Curious";case"creative":return"Creative";default:return v}};return Ve(()=>{window.addEventListener("connection-closed",()=>{console.log("Connection-closed event received in connection-card")})}),(v,f)=>(U(),j("div",Ji,[Je(rs,{name:a.value,mode:"out-in",onBeforeLeave:l,onEnter:u,onAfterEnter:d},{default:os(()=>{var y,g;return[e.status==="disconnected"?(U(),j("div",el,f[0]||(f[0]=[i("div",{class:"status-container"},[i("div",{class:"status-circle"},[i("img",{src:Gt,alt:"Connection Circle",class:"circle-image"}),i("div",{class:"thin-ring idle-ring"})])],-1),i("h2",{class:"text-base sm:text-lg font-semibold mb-1 sm:mb-2 text-white"},"Ready to Connect",-1),i("p",{class:"text-xs sm:text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))):e.status==="disconnecting"?(U(),j("div",tl,[f[1]||(f[1]=i("div",{class:"status-container"},[i("div",{class:"status-circle"},[i("img",{src:Gt,alt:"Connection Circle",class:"circle-image pulse-effect"}),i("div",{class:"thin-ring disconnecting-ring"})])],-1)),i("h2",nl,Y(o.value),1),i("p",ol,Y(r.value),1)])):e.status==="searching"?(U(),j("div",rl,f[2]||(f[2]=[i("div",{class:"status-container"},[i("div",{class:"status-circle"},[i("img",{src:Gt,alt:"Connection Circle",class:"circle-image pulse-effect"}),i("div",{class:"thin-ring search-ring"})])],-1),i("h2",{class:"text-base sm:text-lg font-semibold mb-1 sm:mb-2 text-white"},"Searching...",-1),i("p",{class:"text-xs sm:text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):e.status==="matched"?(U(),j("div",al,[f[3]||(f[3]=i("div",{class:"status-container"},[i("div",{class:"status-circle"},[i("img",{src:Gt,alt:"Connection Circle",class:"circle-image fast-rotate"}),i("div",{class:"thin-ring match-ring"})])],-1)),i("h2",sl,Y((y=e.partnerInfo)!=null&&y.vibe?c(e.partnerInfo.vibe):"Match Found!"),1),e.partnerInfo?(U(),j("div",il,[i("span",ll,Y(e.partnerInfo.flag||"🌍"),1),i("span",cl,Y(e.partnerInfo.country),1)])):ne("",!0),f[4]||(f[4]=i("p",{class:"text-xs sm:text-sm text-yellow-400 mt-1 sm:mt-2"},"Setting up voice connection...",-1))])):e.status==="connected"?(U(),j("div",ul,[f[5]||(f[5]=i("div",{class:"status-container"},[i("div",{class:"status-circle"},[i("img",{src:Gt,alt:"Connection Circle",class:"circle-image"}),i("div",{class:"thin-ring connect-ring"})])],-1)),i("h2",dl,Y((g=e.partnerInfo)!=null&&g.vibe?c(e.partnerInfo.vibe):"Connected!"),1),e.partnerInfo?(U(),j("div",fl,[i("span",xl,Y(e.partnerInfo.flag||"🌍"),1),i("span",vl,Y(e.partnerInfo.country),1)])):ne("",!0),f[6]||(f[6]=i("p",{class:"text-xs sm:text-sm text-green-400 mt-1 sm:mt-2"},"You can talk now",-1))])):ne("",!0)]}),_:1},8,["name"]),e.showStatus&&e.status!=="disconnected"?(U(),j("div",gl,[i("div",ml,[i("span",{class:se({"text-green-400":e.status==="connected","text-yellow-400":e.status==="matched","text-blue-400":e.status==="searching","text-red-400":e.status==="disconnecting"})},"●",2),i("span",pl,Y(s.value),1)]),e.errorMessage?(U(),j("p",hl,Y(e.errorMessage),1)):ne("",!0)])):ne("",!0)]))}});const nt=(e,n)=>{const t=e.__vccOpts||e;for(const[o,r]of n)t[o]=r;return t},yl=nt(bl,[["__scopeId","data-v-f2f75ee4"]]),Cl={class:"space-y-2 sm:space-y-3 md:space-y-4 px-1 sm:px-2"},wl={class:"flex justify-center items-center gap-2 sm:gap-3 md:gap-4"},El=["disabled"],_l={class:"relative"},Al={key:0,class:"text-white text-base sm:text-lg md:text-xl"},Bl={key:1,class:"text-white text-base sm:text-lg md:text-xl"},Tl={key:2,class:"absolute -top-1 -right-1 w-2 h-2 sm:w-3 sm:h-3 bg-yellow-300 rounded-full animate-pulse"},kl=["disabled"],Dl={class:"flex flex-wrap justify-center gap-1 sm:gap-2 md:gap-3"},Fl=He({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(e,{emit:n}){const t=e,o=n,r=N(!1),a=N(t.isMuted);Re(()=>t.isMuted,d=>{a.value=d});function l(d){const{isMuted:s}=d.detail;a.value=s}function u(){r.value||(r.value=!0,o("toggle-mute"),setTimeout(()=>{r.value=!1},200),setTimeout(()=>{try{const d=document.querySelector("audio");d&&d.paused&&d.play().catch(s=>{console.warn("Could not auto-play audio after mute toggle:",s)})}catch(d){console.error("Error trying to auto-play:",d)}},300))}return Ve(()=>{const{getSavedMicrophoneState:d}=Vt(),s=d();s!==null&&(a.value=s),window.addEventListener("microphone-state-changed",l)}),xt(()=>{window.removeEventListener("microphone-state-changed",l)}),(d,s)=>(U(),j("div",Cl,[i("div",wl,[i("button",{onClick:u,class:se(["w-11 h-11 sm:w-14 sm:h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",a.value?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:r.value},[i("div",_l,[a.value?(U(),j("span",Bl,"🔇")):(U(),j("span",Al,"🎤")),r.value?(U(),j("span",Tl)):ne("",!0)])],10,El),i("button",{onClick:s[0]||(s[0]=c=>d.$emit("find-next")),class:"w-12 h-12 sm:w-16 sm:h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},s[5]||(s[5]=[i("span",{class:"text-white text-xl sm:text-2xl md:text-3xl"},"📞",-1)])),i("button",{onClick:s[1]||(s[1]=c=>d.$emit("toggle-chat")),disabled:e.isDisabled,class:se(["w-11 h-11 sm:w-14 sm:h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",e.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},s[6]||(s[6]=[i("span",{class:"text-white text-base sm:text-lg md:text-xl"},"💬",-1)]),10,kl)]),i("div",Dl,[i("button",{onClick:s[2]||(s[2]=c=>d.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110 whitespace-nowrap"}," 🎮 Games "),i("button",{onClick:s[3]||(s[3]=c=>d.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110 whitespace-nowrap"}," 📞 History "),i("button",{onClick:s[4]||(s[4]=c=>d.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110 whitespace-nowrap"}," ❤️ Support ")])]))}}),Sl={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Rl={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},$l={class:"flex items-center justify-between p-4 border-b border-gray-700"},Il={key:0,class:"h-full flex items-center justify-center text-gray-500"},Pl={key:1,class:"space-y-2"},Ml={class:"flex justify-between gap-2"},Wl={class:"text-xs text-gray-400"},Ol={class:"mt-1 text-white break-words"},Nl={class:"p-3 border-t border-gray-700"},Ll=["disabled"],Ul=["disabled"],jl=He({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(e,{emit:n}){const t=e,o=n,r=N(""),a=N(null),l=()=>{r.value.trim()&&t.isConnected&&(o("send-message",r.value),r.value="")},u=async()=>{await da(),a.value&&(a.value.scrollTop=a.value.scrollHeight)},d=s=>new Date(s).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return Re(()=>t.messages,()=>{u()},{deep:!0}),Re(()=>t.isOpen,s=>{s&&u()}),Ve(()=>{t.isOpen&&u()}),(s,c)=>e.isOpen?(U(),j("div",Sl,[i("div",Rl,[i("div",$l,[c[2]||(c[2]=i("div",{class:"flex items-center"},[i("span",{class:"text-white text-lg font-medium"},"💬 Chat")],-1)),i("button",{onClick:c[0]||(c[0]=v=>s.$emit("close")),class:"text-gray-400 hover:text-white"}," ✕ ")]),i("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:a},[e.messages.length===0?(U(),j("div",Il,c[3]||(c[3]=[i("div",{class:"text-center"},[i("p",null,"No messages yet"),i("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(U(),j("div",Pl,[(U(!0),j(Be,null,We(e.messages,v=>(U(),j("div",{key:v.id,class:se(["rounded-lg p-3 max-w-[80%]",v.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[i("div",Ml,[i("span",{class:se(["text-sm",v.isOwn?"text-blue-200":"text-gray-200"])},Y(v.isOwn?"You":"Partner"),3),i("span",Wl,Y(d(v.timestamp)),1)]),i("p",Ol,Y(v.text||v.message),1)],2))),128))]))],512),i("div",Nl,[i("form",{onSubmit:Oo(l,["prevent"]),class:"flex gap-2"},[Pt(i("input",{"onUpdate:modelValue":c[1]||(c[1]=v=>r.value=v),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!e.isConnected},null,8,Ll),[[Xt,r.value]]),i("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e.isConnected||!r.value.trim()}," Send ",8,Ul)],32)])])])):ne("",!0)}});class Hl{constructor(n=[]){qe(this,"sounds",new Map);qe(this,"isMuted",!1);qe(this,"defaultVolume",.5);qe(this,"soundPaths",{click:"/sounds/click.mp3",win:"/sounds/win.mp3",lose:"/sounds/lose.mp3",draw:"/sounds/draw.mp3",move:"/sounds/move.mp3",notification:"/sounds/notification.mp3",countdown:"/sounds/countdown.mp3",gameStart:"/sounds/game-start.mp3",gameOver:"/sounds/game-over.mp3",correct:"/sounds/correct.mp3",incorrect:"/sounds/incorrect.mp3",button:"/sounds/button.mp3"});n.length>0&&n.forEach(r=>{r in this.soundPaths&&this.preloadSound(r)});const t=localStorage.getItem("gameSoundMuted");t&&(this.isMuted=t==="true");const o=localStorage.getItem("gameSoundVolume");o&&(this.defaultVolume=parseFloat(o))}preloadSound(n){if(this.soundPaths[n]){const t=new Audio(this.soundPaths[n]);t.preload="auto",this.sounds.set(n,t)}}playSound(n,t={}){if(this.isMuted)return;this.sounds.has(n)||this.preloadSound(n);const o=this.sounds.get(n);o&&(o.pause(),o.currentTime=0,o.volume=t.volume!==void 0?t.volume:this.defaultVolume,o.loop=t.loop||!1,o.play().catch(r=>{console.warn(`Failed to play sound ${n}:`,r)}))}toggleMute(){return this.isMuted=!this.isMuted,localStorage.setItem("gameSoundMuted",this.isMuted.toString()),this.isMuted&&this.stopAllSounds(),this.isMuted}isSoundMuted(){return this.isMuted}setVolume(n){this.defaultVolume=Math.max(0,Math.min(1,n)),localStorage.setItem("gameSoundVolume",this.defaultVolume.toString())}stopAllSounds(){this.sounds.forEach(n=>{n.pause(),n.currentTime=0})}stopSound(n){const t=this.sounds.get(n);t&&(t.pause(),t.currentTime=0)}}class vn{static addWinEffect(n,t=2e3){n.classList.add("win-effect"),setTimeout(()=>{n.classList.remove("win-effect")},t)}static addLoseEffect(n,t=1e3){n.classList.add("lose-effect"),setTimeout(()=>{n.classList.remove("lose-effect")},t)}static addDrawEffect(n,t=1500){n.classList.add("draw-effect"),setTimeout(()=>{n.classList.remove("draw-effect")},t)}static addPulseEffect(n,t="rgba(139, 92, 246, 0.5)",o=1e3){const r=n.style.border,a=n.style.boxShadow;n.style.border=`2px solid ${t}`,n.style.boxShadow=`0 0 10px ${t}`,n.style.transition="all 0.3s ease",setTimeout(()=>{n.style.border=r,n.style.boxShadow=a},o)}static addMoveEffect(n,t,o=10,r=300){const a=n.style.position,l=n.style.transform;a!=="relative"&&a!=="absolute"&&(n.style.position="relative");let u="";switch(t){case"up":u=`translateY(-${o}px)`;break;case"down":u=`translateY(${o}px)`;break;case"left":u=`translateX(-${o}px)`;break;case"right":u=`translateX(${o}px)`;break}n.style.transform=u,n.style.transition=`transform ${r}ms ease`,setTimeout(()=>{n.style.transform=l},r)}}const ge=new Hl(["click","win","lose","move","notification"]),ql={class:"w-full p-2"},zl={class:"flex justify-between items-center mb-4 game-header"},Gl={key:0,class:"text-yellow-300 animate-pulse"},Vl={key:1},Kl={key:2},Yl={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 mb-4 game-board"},Xl={class:"mb-4 w-full"},Ql={class:"flex items-center justify-between gap-4 mb-2"},Zl={class:"flex items-center"},Jl={class:"text-center ml-2"},ec={key:0,class:"flex items-center"},tc={class:"flex items-center justify-center p-1 bg-gray-700/50 rounded-lg"},nc={class:"ml-2 text-sm text-gray-300"},oc={class:"flex items-center"},rc={class:"text-center mr-2"},ac={key:0,class:"bg-gray-700/40 rounded-lg p-2 text-sm text-gray-300 mb-3"},sc={class:"flex justify-between mb-1"},ic={class:"flex justify-between mb-1"},lc={class:"flex justify-between"},cc={class:"grid grid-cols-3 gap-3 mb-4"},uc=["onClick","disabled"],dc={key:0,class:"text-blue-400"},fc={key:1,class:"text-green-400"},xc={key:0,class:"text-center mt-4 animate__animated animate__fadeIn"},vc={key:1,class:"text-center mt-4 animate__animated animate__fadeIn"},gc={key:2,class:"text-center mt-4"},mc={key:0,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50"},pc={class:"bg-gray-800 p-4 rounded-lg max-w-xs w-full text-center"},hc={class:"flex justify-center gap-3"},bc=6e4,yc=He({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},isFirstPlayer:{type:Boolean,default:!0},partnerReady:{type:Boolean,default:!1}},emits:["back","error"],setup(e,{emit:n}){const t=e,o=n,{socket:r}=Me(),a=N("waiting"),l=N(["","","","","","","","",""]),u=N(t.isFirstPlayer?"X":"O"),d=N(t.isFirstPlayer?"O":"X"),s=N("X"),c=N(null),v=N(null),f=N(Date.now()),y=N([]),g=N([]);N(ge.isSoundMuted());const h=N(!1),x=N({moves:0,movesByPlayer:{},gameTime:0,gameStartTime:Date.now()}),p=Ee(()=>s.value===u.value),m=E=>{const P=Math.floor(E/60),H=E%60;return`${P}:${H<10?"0":""}${H}`},b=E=>{var P;if(!(a.value!=="playing"||l.value[E]!==""||!p.value||c.value!==null))try{ge.playSound("move"),l.value[E]=u.value,s.value=d.value,f.value=Date.now(),g.value[E]&&vn.addPulseEffect(g.value[E],u.value==="X"?"rgba(59, 130, 246, 0.5)":"rgba(16, 185, 129, 0.5)");const H={index:E};(P=r.value)==null||P.emit("game-move",{gameType:"tic-tac-toe",move:H,to:t.partnerId}),C(),w()}catch{F("Failed to make a move. Please try again.")}},C=()=>{const E=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const P of E){const[H,Z,$]=P;if(l.value[H]!==""&&l.value[H]===l.value[Z]&&l.value[H]===l.value[$])return a.value="finished",c.value=l.value[H],y.value=P,setTimeout(()=>{P.forEach(k=>{g.value[k]&&vn.addWinEffect(g.value[k])})},100),c.value===u.value?ge.playSound("win"):ge.playSound("lose"),!0}return l.value.every(P=>P!=="")?(a.value="finished",c.value="tie",ge.playSound("draw"),!0):!1},w=()=>{v.value&&clearTimeout(v.value),v.value=window.setTimeout(()=>{var E;a.value==="playing"&&c.value===null&&((E=r.value)==null||E.emit("game-ping",{to:t.partnerId,gameType:"tic-tac-toe"}),setTimeout(()=>{a.value==="playing"&&c.value===null&&A()},5e3))},bc)},A=()=>{a.value==="playing"&&(a.value="finished",F("Lost connection with your partner. The game has ended."),ge.playSound("notification"))},T=()=>{var E;try{ge.playSound("click"),l.value=["","","","","","","","",""],c.value=null,a.value="playing",y.value=[];const P=u.value;u.value=d.value,d.value=P,s.value="X",(E=r.value)==null||E.emit("game-reset",{gameType:"tic-tac-toe",to:t.partnerId,swapRoles:!0}),w()}catch{F("Failed to reset the game. Please try again.")}},F=E=>{o("error",E),console.error(E)},z=E=>{var P,H,Z;if(console.log("Received server state update:",E),E.board&&(l.value=E.board.map($=>$===null?"":$)),E.currentSymbol?s.value=E.currentSymbol:E.currentTurn&&E.marks&&(s.value=E.marks[E.currentTurn]||"X"),E.playerSymbols){const $=(P=r.value)==null?void 0:P.id,k=t.partnerId;$&&E.playerSymbols[$]&&(u.value=E.playerSymbols[$],d.value=E.playerSymbols[k])}else if(E.marks){const $=((H=r.value)==null?void 0:H.id)||"";u.value=E.marks[$]||"X";const k=Object.keys(E.marks).filter(S=>S!==$);k.length>0&&(d.value=E.marks[k[0]]||"O")}if(E.gameOver)if(a.value="finished",E.winner){const $=((Z=r.value)==null?void 0:Z.id)||"";E.winner===$?(c.value=u.value,ge.playSound("win")):(c.value=d.value,ge.playSound("lose"))}else E.isDraw&&(c.value="tie",ge.playSound("draw"));else a.value="playing";E.winningLine&&(y.value=E.winningLine,y.value.length>0&&setTimeout(()=>{y.value.forEach($=>{g.value[$]&&vn.addWinEffect(g.value[$])})},100)),E.stats&&(x.value=E.stats),E.gameOver||C()};Ve(()=>{if(!r.value){F("Socket connection not available");return}r.value.on("game-move",E=>{if(E.gameType==="tic-tac-toe"&&E.from===t.partnerId)try{if(E.gameState){z(E.gameState),ge.playSound("move"),w();return}let P=-1;if(typeof E.move=="object"&&E.move!==null?typeof E.move.index=="number"?P=E.move.index:typeof E.move.row=="number"&&typeof E.move.col=="number"&&(P=E.move.row*3+E.move.col):typeof E.move=="number"&&(P=E.move),P<0||P>=9){F("Received invalid move from partner");return}l.value[P]=d.value,s.value=u.value,f.value=Date.now(),ge.playSound("move"),g.value[P]&&vn.addPulseEffect(g.value[P],d.value==="X"?"rgba(59, 130, 246, 0.5)":"rgba(16, 185, 129, 0.5)"),C(),w()}catch{F("Error processing partner's move")}}),r.value.on("game-reset",E=>{if(E.gameType==="tic-tac-toe"&&E.from===t.partnerId)try{if(E.gameState){z(E.gameState),ge.playSound("gameStart"),w();return}if(l.value=["","","","","","","","",""],c.value=null,a.value="playing",y.value=[],E.swapRoles){const P=u.value;u.value=d.value,d.value=P}s.value="X",ge.playSound("gameStart"),w(),console.log(`Game reset received. My symbol is now ${u.value}, partner's symbol is ${d.value}`)}catch{F("Error resetting the game")}}),r.value.on("game-state",E=>{if(E.gameType==="tic-tac-toe")try{z(E)}catch{F("Error updating game state")}}),r.value.on("game-ping",E=>{var P;E.from===t.partnerId&&((P=r.value)==null||P.emit("game-pong",{to:t.partnerId,gameType:"tic-tac-toe"}),f.value=Date.now())}),r.value.on("game-pong",E=>{E.from===t.partnerId&&(f.value=Date.now(),console.log("Received pong from partner, connection is active"))}),r.value.on("game-notification",E=>{E.from===t.partnerId&&(E.type==="leave"?console.log("Partner is leaving the game"):console.log(`Game notification from partner: ${E.message}`))}),r.value.on("game-partner-joined",E=>{E.from===t.partnerId&&(a.value="playing",ge.playSound("gameStart"),w())}),r.value.on("game-partner-left",E=>{if(E.from===t.partnerId){a.value="finished";const P=document.createElement("div");P.className="fixed top-4 right-4 bg-yellow-600/80 text-white px-4 py-2 rounded-lg shadow-lg z-50",P.innerHTML=`
        <div class="flex items-center gap-2">
          <span>⚠️</span>
          <span>Your partner has left the game</span>
        </div>
      `,document.body.appendChild(P),setTimeout(()=>{document.body.removeChild(P),o("back")},3e3),ge.playSound("click"),v.value&&(clearTimeout(v.value),v.value=null)}}),t.isFirstPlayer||(a.value="playing",ge.playSound("gameStart"),w())}),xt(()=>{r.value&&(r.value.off("game-move"),r.value.off("game-reset"),r.value.off("game-partner-joined"),r.value.off("game-partner-left"),r.value.off("game-state"),r.value.off("game-notification"),r.value.off("game-ping"),r.value.off("game-pong"),t.partnerId&&(r.value.emit("game-notification",{to:t.partnerId,message:"Your partner has left the game",type:"leave"}),setTimeout(()=>{var E;(E=r.value)==null||E.emit("game-leave-room",{roomId:`tictactoe-${t.partnerId}`,to:t.partnerId})},200))),v.value&&(clearTimeout(v.value),v.value=null)});const B=N(!1),_=()=>{B.value=!1,r.value&&t.partnerId?(r.value.emit("game-notification",{to:t.partnerId,message:"Your partner has left the game",type:"leave"}),setTimeout(()=>{var E;(E=r.value)==null||E.emit("game-leave-room",{roomId:`tictactoe-${t.partnerId}`,to:t.partnerId}),o("back")},200)):o("back")},W=()=>{ge.playSound("click"),B.value=!0};return(E,P)=>(U(),j(Be,null,[i("div",ql,[i("div",zl,[P[2]||(P[2]=i("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),i("div",{class:se(["text-white text-sm px-3 py-1 rounded-full game-status",{"bg-yellow-600/30":a.value==="waiting","bg-green-600/30":p.value&&a.value==="playing","bg-red-600/30":!p.value&&a.value==="playing","bg-purple-600/30":c.value}])},[a.value==="waiting"?(U(),j("span",Gl," Waiting for partner... ")):c.value?(U(),j("span",Vl,Y(c.value===u.value?"You Won! 🎉":c.value==="tie"?"It's a Tie! 🤝":"You Lost! 😢"),1)):(U(),j("span",Kl,Y(p.value?"Your Turn":"Partner's Turn"),1))],2)]),i("div",Yl,[i("div",{class:se(["flex flex-col items-center",[{"opacity-70":a.value==="waiting"||!p.value&&!c.value}]])},[i("div",Xl,[i("div",Ql,[i("div",Zl,[i("div",{class:se([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":u.value==="X"},"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-lg font-bold"])}," X ",2),i("div",Jl,[P[3]||(P[3]=i("p",{class:"text-gray-300 text-sm"},"You",-1)),i("p",{class:se(["font-bold text-lg",{"text-blue-400":u.value==="X","text-green-400":u.value==="O"}])},Y(u.value),3)])]),a.value==="playing"?(U(),j("div",ec,[i("div",tc,[i("div",{class:se(["w-2 h-2 rounded-full",{"bg-green-400 animate-pulse":p.value,"bg-red-400":!p.value}])},null,2),i("span",nc,Y(p.value?"Your Turn":"Partner's Turn"),1)])])):ne("",!0),i("div",oc,[i("div",rc,[P[4]||(P[4]=i("p",{class:"text-gray-300 text-sm"},"Partner",-1)),i("p",{class:se(["font-bold text-lg",{"text-blue-400":d.value==="X","text-green-400":d.value==="O"}])},Y(d.value),3)]),i("div",{class:se([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":u.value==="O"},"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-lg font-bold"])}," O ",2)])]),h.value?(U(),j("div",ac,[i("div",sc,[P[5]||(P[5]=i("span",null,"Moves:",-1)),i("span",null,Y(x.value.moves),1)]),i("div",ic,[P[6]||(P[6]=i("span",null,"Your Moves:",-1)),i("span",null,Y(x.value.movesByPlayer[t.partnerId]||0),1)]),i("div",lc,[P[7]||(P[7]=i("span",null,"Game Time:",-1)),i("span",null,Y(m(x.value.gameTime)),1)])])):ne("",!0),i("button",{onClick:P[0]||(P[0]=H=>h.value=!h.value),class:"w-full text-xs bg-gray-700/30 hover:bg-gray-700/50 py-1 rounded-lg transition-colors text-gray-400"},Y(h.value?"Hide Stats":"Show Stats"),1)]),i("div",cc,[(U(!0),j(Be,null,We(l.value,(H,Z)=>(U(),j("button",{key:Z,onClick:$=>b(Z),disabled:H!==""||!p.value||c.value!==null||a.value==="waiting",ref_for:!0,ref:$=>{$&&(g.value[Z]=$)},class:se(["w-20 h-20 rounded-lg flex items-center justify-center text-3xl font-bold transition-all duration-300 game-cell game-transition",{"game-interactive bg-gray-700 hover:bg-gray-600":H===""&&p.value&&!c.value&&a.value!=="waiting","bg-gray-700/50":H===""&&(!p.value||c.value!==null||a.value==="waiting"),"bg-blue-600/20":H==="X","bg-green-600/20":H==="O","cursor-not-allowed":H!==""||!p.value||c.value!==null||a.value==="waiting","hover:bg-purple-700/50":p.value&&H===""&&!c.value&&a.value==="playing","win-effect":y.value.includes(Z)}])},[H==="X"?(U(),j("span",dc,"X")):H==="O"?(U(),j("span",fc,"O")):ne("",!0)],10,uc))),128))]),c.value?(U(),j("div",xc,[i("button",{onClick:T,class:"game-button bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2 game-interactive"}," Play Again "),P[8]||(P[8]=i("p",{class:"text-sm text-gray-400 mt-1"}," In the next round, symbols (X/O) will be swapped ",-1))])):a.value==="finished"?(U(),j("div",vc,[i("button",{onClick:T,class:"game-button bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2 game-interactive"}," Play Again "),P[9]||(P[9]=i("p",{class:"text-sm text-gray-400 mt-1"}," In the next round, symbols (X/O) will be swapped ",-1))])):ne("",!0),a.value==="waiting"?(U(),j("div",gc,P[10]||(P[10]=[i("div",{class:"bg-yellow-600/20 rounded-lg p-4 animate-pulse"},[i("p",{class:"text-yellow-300 mb-1"},"Waiting for your partner to join..."),i("p",{class:"text-sm text-gray-300"},[ze(" You'll play as "),i("span",{class:"font-bold text-blue-400"},"X")])],-1)]))):ne("",!0)],2)]),i("div",{class:"flex justify-end mb-4"},[i("button",{onClick:W,class:"game-button bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors game-interactive"}," Back to Games ")])]),B.value?(U(),j("div",mc,[i("div",pc,[P[11]||(P[11]=i("h3",{class:"text-lg font-semibold mb-3 text-white"},"Are you sure?",-1)),P[12]||(P[12]=i("p",{class:"text-sm text-gray-300 mb-4"}," Leaving the game will end it for your partner too. ",-1)),i("div",hc,[i("button",{onClick:P[1]||(P[1]=H=>B.value=!1),class:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm"}," Cancel "),i("button",{onClick:_,class:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm"}," Leave ")])])])):ne("",!0)],64))}});const Cc=nt(yc,[["__scopeId","data-v-9065bc8e"]]),wc={class:"w-full p-2"},Ec={class:"flex justify-between items-center mb-4"},_c={key:0,class:"text-yellow-300 animate-pulse flex items-center"},Ac={key:1,class:"flex items-center"},Bc={key:2,class:"flex items-center"},Tc={key:3,class:"flex items-center"},kc={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 md:p-6 mb-4 border border-gray-700/50 shadow-xl"},Dc={class:"flex justify-center items-center gap-4 md:gap-8 mb-6 w-full"},Fc={class:"text-center p-2 bg-blue-900/20 rounded-lg backdrop-blur-sm border border-blue-800/30 min-w-[70px]"},Sc={class:"text-2xl font-bold text-blue-400"},Rc={class:"text-center px-4 py-2 bg-gray-700/50 rounded-lg border border-gray-600/30"},$c={class:"text-xl font-bold text-white"},Ic={class:"text-center p-2 bg-green-900/20 rounded-lg backdrop-blur-sm border border-green-800/30 min-w-[70px]"},Pc={class:"text-2xl font-bold text-green-400"},Mc={class:"w-full mb-4"},Wc={key:0,class:"flex flex-col items-center mb-6 animate__animated animate__fadeIn"},Oc={class:"flex justify-center items-center gap-6 md:gap-10 mb-6"},Nc={class:"text-center"},Lc={class:"text-center"},Uc={key:1,class:"animate__animated animate__fadeIn"},jc={class:"text-center mb-6"},Hc={class:"inline-block px-3 py-1 rounded-full bg-gray-700/70 text-sm text-gray-300 mb-2"},qc={class:"flex justify-center items-center gap-3 md:gap-6"},zc=["onClick"],Gc={class:"text-4xl mb-2"},Vc={class:"text-xs text-gray-300"},Kc={key:2,class:"text-center"},Yc={key:3,class:"text-center"},Xc={key:0,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50"},Qc={class:"bg-gray-800 p-4 rounded-lg max-w-xs w-full text-center"},Zc={class:"flex justify-center gap-3"},ia=10,Jc=He({__name:"RockPaperScissors",props:{partnerId:{type:String,required:!0},partnerReady:{type:Boolean,default:!1}},emits:["back","error"],setup(e,{emit:n}){const t=e,o=n,{socket:r}=Me(),a=[{value:"rock",name:"Rock",emoji:"👊"},{value:"paper",name:"Paper",emoji:"✋"},{value:"scissors",name:"Scissors",emoji:"✌️"}],l=N("waiting"),u=N(null),d=N(null),s=N(0),c=N(0),v=N(1),f=N(null),y=N(ia),g=N(null),h=N(!1),x=Ee(()=>f.value==="win"?"You Win!":f.value==="lose"?"You Lose!":f.value==="tie"?"It's a Tie!":""),p=B=>{if(!B)return"❓";const _=a.find(W=>W.value===B);return _?_.emoji:"❓"},m=()=>{var B;l.value="choosing",u.value=null,d.value=null,f.value=null,A(),(B=r.value)==null||B.emit("game-start-round",{gameType:"rock-paper-scissors",to:t.partnerId,round:v.value})},b=B=>{var _;u.value=B,(_=r.value)==null||_.emit("game-move",{gameType:"rock-paper-scissors",move:{choice:B,round:v.value},to:t.partnerId}),console.log(`Sent move to server: ${B}, round: ${v.value}`),d.value&&C()},C=()=>{!u.value||!d.value||(T(),l.value="result",u.value===d.value?f.value="tie":u.value==="rock"&&d.value==="scissors"||u.value==="paper"&&d.value==="rock"||u.value==="scissors"&&d.value==="paper"?(f.value="win",s.value++):(f.value="lose",c.value++),v.value++)},w=()=>{m()},A=()=>{y.value=ia,g.value&&clearInterval(g.value),g.value=window.setInterval(()=>{if(y.value--,y.value<=0&&(T(),!u.value)){const B=Math.floor(Math.random()*a.length);b(a[B].value)}},1e3)},T=()=>{g.value&&(clearInterval(g.value),g.value=null)},F=()=>{h.value=!0},z=()=>{h.value=!1,r.value&&t.partnerId?(r.value.emit("game-notification",{to:t.partnerId,message:"Your partner has left the game",type:"leave"}),setTimeout(()=>{var B;(B=r.value)==null||B.emit("game-leave-room",{roomId:`rps-${t.partnerId}`,to:t.partnerId}),o("back")},200)):o("back")};return Ve(()=>{var B,_,W,E,P;t.partnerReady&&(l.value="ready"),(B=r.value)==null||B.on("game-move",H=>{if(H.from===t.partnerId&&H.gameType==="rock-paper-scissors"){let Z=null;if(typeof H.move=="string"?Z=H.move:typeof H.move=="object"&&H.move!==null&&(Z=H.move.choice),!Z||!["rock","paper","scissors"].includes(Z)){console.error("Received invalid move from partner:",H.move);return}console.log(`Received move from partner: ${Z}`),d.value=Z,u.value&&C()}}),(_=r.value)==null||_.on("game-start-round",H=>{H.from===t.partnerId&&H.gameType==="rock-paper-scissors"&&(l.value="choosing",u.value=null,d.value=null,f.value=null,v.value=H.round,A())}),(W=r.value)==null||W.on("game-partner-joined",H=>{H.from===t.partnerId&&(l.value="ready")}),(E=r.value)==null||E.on("game-partner-left",H=>{if(H.from===t.partnerId){T(),l.value="waiting";const Z=document.createElement("div");Z.className="fixed top-4 right-4 bg-yellow-600/80 text-white px-4 py-2 rounded-lg shadow-lg z-50",Z.innerHTML=`
        <div class="flex items-center gap-2">
          <span>⚠️</span>
          <span>Your partner has left the game</span>
        </div>
      `,document.body.appendChild(Z),setTimeout(()=>{document.body.removeChild(Z),handleBackToGames()},3e3)}}),(P=r.value)==null||P.on("game-reset",H=>{H.from===t.partnerId&&H.gameType==="rock-paper-scissors"&&(s.value=0,c.value=0,v.value=1,l.value="ready")})}),xt(()=>{var B,_,W,E,P;T(),r.value&&t.partnerId&&(r.value.emit("game-notification",{to:t.partnerId,message:"Your partner has left the game",type:"leave"}),setTimeout(()=>{var H;(H=r.value)==null||H.emit("game-leave-room",{roomId:`rps-${t.partnerId}`,to:t.partnerId})},200)),(B=r.value)==null||B.off("game-move"),(_=r.value)==null||_.off("game-start-round"),(W=r.value)==null||W.off("game-partner-joined"),(E=r.value)==null||E.off("game-partner-left"),(P=r.value)==null||P.off("game-reset")}),(B,_)=>(U(),j(Be,null,[i("div",wc,[i("div",Ec,[_[5]||(_[5]=i("h2",{class:"text-xl font-bold text-purple-400"},[i("span",{class:"hidden sm:inline"},"Rock Paper Scissors"),i("span",{class:"sm:hidden"},"RPS Game")],-1)),i("div",{class:se(["text-white text-sm px-3 py-1 rounded-full backdrop-blur-sm shadow-lg",{"bg-yellow-600/40 border border-yellow-500/30":l.value==="waiting","bg-green-600/40 border border-green-500/30":l.value==="ready","bg-blue-600/40 border border-blue-500/30":l.value==="choosing","bg-purple-600/40 border border-purple-500/30":l.value==="result"}])},[l.value==="waiting"?(U(),j("span",_c,_[1]||(_[1]=[i("span",{class:"inline-block w-2 h-2 bg-yellow-400 rounded-full mr-2 animate-ping"},null,-1),ze(" Waiting... ")]))):l.value==="ready"?(U(),j("span",Ac,_[2]||(_[2]=[i("span",{class:"inline-block w-2 h-2 bg-green-400 rounded-full mr-2"},null,-1),ze(" Ready! ")]))):l.value==="choosing"?(U(),j("span",Bc,_[3]||(_[3]=[i("span",{class:"inline-block w-2 h-2 bg-blue-400 rounded-full mr-2"},null,-1),ze(" Choose ")]))):l.value==="result"?(U(),j("span",Tc,[_[4]||(_[4]=i("span",{class:"inline-block w-2 h-2 bg-purple-400 rounded-full mr-2"},null,-1)),ze(" "+Y(x.value),1)])):ne("",!0)],2)]),i("div",kc,[i("div",{class:se(["flex flex-col items-center",{"opacity-70":l.value==="waiting"}])},[i("div",Dc,[i("div",Fc,[_[6]||(_[6]=i("div",{class:"text-sm text-gray-300 mb-1"},"You",-1)),i("div",Sc,Y(s.value),1)]),i("div",Rc,[_[7]||(_[7]=i("div",{class:"text-sm text-gray-300"},"Round",-1)),i("div",$c,Y(v.value),1)]),i("div",Ic,[_[8]||(_[8]=i("div",{class:"text-sm text-gray-300 mb-1"},"Partner",-1)),i("div",Pc,Y(c.value),1)])]),i("div",Mc,[l.value==="result"?(U(),j("div",Wc,[i("div",Oc,[i("div",Nc,[i("div",{class:se(["w-20 h-20 md:w-24 md:h-24 bg-blue-500/20 rounded-full flex items-center justify-center text-4xl md:text-5xl mb-2 shadow-lg border border-blue-400/30 transform transition-all",{"scale-110 ring-2 ring-blue-400 ring-opacity-50":f.value==="win"}])},Y(p(u.value)),3),_[9]||(_[9]=i("div",{class:"text-sm text-blue-400"},"You",-1))]),_[11]||(_[11]=i("div",{class:"text-2xl font-bold text-white bg-gray-700/50 rounded-full h-10 w-10 flex items-center justify-center"},"VS",-1)),i("div",Lc,[i("div",{class:se(["w-20 h-20 md:w-24 md:h-24 bg-green-500/20 rounded-full flex items-center justify-center text-4xl md:text-5xl mb-2 shadow-lg border border-green-400/30 transform transition-all",{"scale-110 ring-2 ring-green-400 ring-opacity-50":f.value==="lose"}])},Y(p(d.value)),3),_[10]||(_[10]=i("div",{class:"text-sm text-green-400"},"Partner",-1))])]),i("div",{class:se(["text-xl font-bold mb-4 py-2 px-4 rounded-lg",{"bg-yellow-500/10 text-yellow-400 border border-yellow-500/30":f.value==="tie","bg-green-500/10 text-green-400 border border-green-500/30":f.value==="win","bg-red-500/10 text-red-400 border border-red-500/30":f.value==="lose"}])},Y(x.value),3),i("button",{onClick:w,class:"mt-2 px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95"}," Play Again ")])):l.value==="choosing"?(U(),j("div",Uc,[i("div",jc,[_[13]||(_[13]=i("p",{class:"text-lg text-white mb-1"},"Choose your move:",-1)),i("div",Hc,[_[12]||(_[12]=ze(" Time: ")),i("span",{class:se(["font-mono text-white",{"text-red-400":y.value<=3}])},Y(y.value)+"s",3)])]),i("div",qc,[(U(),j(Be,null,We(a,W=>i("button",{key:W.value,onClick:E=>b(W.value),class:se(["w-[90px] h-[90px] md:w-24 md:h-24 rounded-lg flex flex-col items-center justify-center transition-all shadow-lg hover:shadow-xl",{"bg-blue-600/30 border border-blue-500/30 scale-105":u.value===W.value,"bg-gray-800/80 border border-gray-700/50 hover:bg-gray-700/70 hover:scale-105 active:scale-95":u.value!==W.value}])},[i("span",Gc,Y(W.emoji),1),i("span",Vc,Y(W.name),1)],10,zc)),64))])])):l.value==="waiting"?(U(),j("div",Kc,_[14]||(_[14]=[ft('<div class="bg-yellow-600/20 rounded-lg p-4 border border-yellow-500/30 shadow-lg animate-pulse" data-v-27a86712><div class="w-16 h-16 mx-auto mb-3 relative" data-v-27a86712><div class="absolute inset-0 bg-yellow-500/20 rounded-full animate-ping" data-v-27a86712></div><div class="absolute inset-2 bg-yellow-500/30 rounded-full animate-ping animation-delay-300" data-v-27a86712></div><div class="absolute inset-4 bg-yellow-500/40 rounded-full animate-ping animation-delay-600" data-v-27a86712></div><div class="absolute inset-0 flex items-center justify-center" data-v-27a86712><span class="text-2xl" data-v-27a86712>👥</span></div></div><p class="text-yellow-300 mb-1 font-medium" data-v-27a86712>Waiting for your partner to join...</p><p class="text-sm text-gray-300" data-v-27a86712>Game will start automatically</p></div>',1)]))):l.value==="ready"?(U(),j("div",Yc,[_[15]||(_[15]=ft('<div class="bg-green-600/20 rounded-lg p-4 border border-green-500/30 shadow-lg mb-4" data-v-27a86712><div class="w-16 h-16 mx-auto mb-3 flex items-center justify-center bg-green-500/30 rounded-full" data-v-27a86712><span class="text-2xl" data-v-27a86712>🎮</span></div><p class="text-lg text-white mb-1" data-v-27a86712>Both players are ready!</p><p class="text-sm text-gray-300 mb-4" data-v-27a86712>Prepare for an epic battle</p></div>',1)),i("button",{onClick:m,class:"px-8 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95"}," Start Game ")])):ne("",!0)])],2)]),i("div",{class:"flex justify-between"},[i("button",{onClick:F,class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-all shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95"}," Back to Games ")])]),h.value?(U(),j("div",Xc,[i("div",Qc,[_[16]||(_[16]=i("h3",{class:"text-lg font-semibold mb-3 text-white"},"Are you sure?",-1)),_[17]||(_[17]=i("p",{class:"text-sm text-gray-300 mb-4"}," Leaving the game will end it for your partner too. ",-1)),i("div",Zc,[i("button",{onClick:_[0]||(_[0]=W=>h.value=!1),class:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm"}," Cancel "),i("button",{onClick:z,class:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm"}," Leave ")])])])):ne("",!0)],64))}});const eu=nt(Jc,[["__scopeId","data-v-27a86712"]]),tu={class:"w-full p-2",dir:"auto"},nu={class:"flex justify-between items-center mb-4"},ou={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 md:p-6 mb-4 border border-gray-700/50 shadow-xl"},ru={class:"flex justify-center items-center gap-4 md:gap-8 mb-6 w-full"},au={class:"text-center p-2 bg-blue-900/20 rounded-lg backdrop-blur-sm border border-blue-800/30 min-w-[80px]"},su={class:"text-2xl font-bold text-blue-400"},iu={key:0,class:"text-center px-4 py-2 bg-gray-700/50 rounded-lg border border-gray-600/30"},lu={class:"text-center p-2 bg-green-900/20 rounded-lg backdrop-blur-sm border border-green-800/30 min-w-[80px]"},cu={class:"text-2xl font-bold text-green-400"},uu={class:"text-center p-2 bg-purple-900/20 rounded-lg backdrop-blur-sm border border-purple-800/30 min-w-[80px]"},du={class:"text-2xl font-bold text-purple-400"},fu={class:"w-full mb-4"},xu={key:0,class:"animate__animated animate__fadeIn"},vu={class:"bg-gray-700/50 rounded-lg p-4 mb-4"},gu={class:"mb-4"},mu=["dir","disabled"],pu={key:0,class:"text-xs text-red-400 mt-1"},hu={key:1,class:"text-xs text-gray-400 mt-1"},bu={class:"mb-4"},yu={class:"flex gap-2"},Cu={class:"text-center"},wu=["disabled"],Eu={key:1,class:"animate__animated animate__fadeIn"},_u={key:2,class:"animate__animated animate__fadeIn"},Au={class:"mb-6"},Bu={class:"bg-gray-700/50 rounded-lg p-4 shadow-inner mb-4"},Tu={class:"flex justify-between items-center mb-2"},ku={class:"text-xs text-gray-400"},Du=["dir"],Fu={class:"mb-4"},Su={class:"flex gap-2"},Ru=["dir","maxlength"],$u=["disabled"],Iu={key:0,class:"text-xs text-red-400 mt-1"},Pu={key:1,class:"text-xs text-gray-400 mt-1"},Mu={class:"bg-gray-700/30 rounded-lg p-3 max-h-28 overflow-y-auto"},Wu={key:0,class:"text-gray-400 italic text-sm"},Ou={class:"text-gray-400 w-5"},Nu=["dir"],Lu={key:3,class:"animate__animated animate__fadeIn"},Uu={class:"bg-gray-700/50 rounded-lg p-4 mb-4"},ju={class:"flex justify-between items-center mb-2"},Hu=["dir"],qu=["dir"],zu={class:"mt-4 text-sm text-gray-300"},Gu={key:0},Vu={class:"mt-2"},Ku={class:"bg-gray-700/30 rounded-lg p-3 max-h-36 overflow-y-auto"},Yu={key:0,class:"text-gray-400 italic text-sm"},Xu={class:"text-gray-400 w-5"},Qu=["dir"],Zu={key:4,class:"animate__animated animate__fadeIn"},Ju={class:"text-center mb-6"},ed={class:"w-20 h-20 mx-auto mb-4 flex items-center justify-center bg-purple-500/30 rounded-full"},td={class:"text-3xl"},nd={class:"text-2xl font-bold text-white mb-2"},od={class:"bg-gray-700/50 rounded-lg p-4 mb-4"},rd={class:"text-2xl font-bold text-purple-400 mb-2",dir:"rtl"},ad={key:0,class:"text-green-400 mt-4"},sd={key:1,class:"text-yellow-400 mt-4"},id={class:"bg-gray-700/50 rounded-lg p-4 mb-4"},ld={class:"flex justify-between items-center"},cd={class:"text-xl font-bold text-green-400"},ud={class:"text-xl font-bold text-blue-400"},dd={key:5,class:"text-center"},fd={key:0,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50"},xd={class:"bg-gray-800 p-4 rounded-lg max-w-xs w-full text-center"},vd={class:"text-lg font-semibold mb-3 text-white"},gd={class:"text-sm text-gray-300 mb-4"},md={class:"flex justify-center gap-3"},pd=He({__name:"WordGalaxy",props:{partnerId:{type:String,required:!0},partnerReady:{type:Boolean,default:!1}},emits:["back","error"],setup(e,{emit:n}){const t=e,o=n,{socket:r,userId:a}=Me(),l=N(""),u=N(""),d=N(!1),s=N("waiting"),c=N(!1),v=N(""),f=N(0),y=N([]),g=N([]),h=N(0),x=N("medium"),p=N(""),m=N([]),b=N(0),C=N(!1),w=N(0),A=N("Watching you set up the game..."),T=N(0),F=N(0),z=N(1),B=N([]),_=N(0),W=N(null),E=N(!1),P={easy:{attempts:10,time:60,multiplier:1},medium:{attempts:8,time:45,multiplier:1.5},hard:{attempts:6,time:30,multiplier:2}};N(ge.isSoundMuted());const H=ee=>/[\u0600-\u06FF]/.test(ee),Z=ee=>/^[a-zA-Z\u0600-\u06FF]+$/.test(ee),$=Ee(()=>v.value&&H(v.value)?"rtl":"ltr"),k=()=>{if(l.value="",v.value.length>0&&v.value.length<3){l.value="The word must be at least 3 letters";return}v.value.length>0&&!Z(v.value)&&(v.value=v.value.replace(/[^a-zA-Z\u0600-\u06FF]/g,""),l.value="Only Arabic or English letters are allowed")},S=()=>{if(u.value="",p.value.length>0&&p.value.length!==f.value){u.value=`The word must be ${f.value} letters long`;return}p.value.length>0&&!Z(p.value)&&(p.value=p.value.replace(/[^a-zA-Z\u0600-\u06FF]/g,""),u.value="Only Arabic or English letters are allowed")},R=Ee(()=>P[x.value].attempts),I=Ee(()=>P[x.value].time),L=Ee(()=>R.value-b.value),K=Ee(()=>v.value.length>=3&&v.value.length<=15&&Z(v.value)&&!l.value),V=()=>{var ee;K.value&&(v.value=v.value.trim(),ge.playSound("gameStart"),(ee=r.value)==null||ee.emit("game-word-setup",{gameType:"word-galaxy",to:t.partnerId,wordLength:v.value.length,difficulty:x.value}),s.value="guessing",f.value=v.value.length,me())},me=()=>{y.value=Array(f.value).fill("_"),g.value=[],h.value=0},xe=()=>{W.value&&clearInterval(W.value),_.value=I.value,E.value=!0,W.value=window.setInterval(()=>{var ee;_.value--,_.value<=0&&(ye(),c.value||(s.value="complete",C.value=!1,(ee=r.value)==null||ee.emit("game-move",{gameType:"word-galaxy",move:"timeout",to:t.partnerId})))},1e3)},ye=()=>{W.value&&(clearInterval(W.value),W.value=null)},ie=()=>{var X,oe;if(!p.value||p.value.length!==f.value)return;if(!Z(p.value)){p.value=p.value.replace(/[^a-zA-Z\u0600-\u06FF]/g,""),u.value="Only Arabic or English letters are allowed";return}const ee=p.value.trim();u.value="",ge.playSound("move"),(X=r.value)==null||X.emit("game-move",{gameType:"word-galaxy",move:ee,to:t.partnerId}),p.value="",b.value++,b.value>=R.value&&(s.value="complete",C.value=!1,ye(),ge.playSound("lose"),(oe=r.value)==null||oe.emit("game-move",{gameType:"word-galaxy",move:"out-of-attempts",to:t.partnerId}))},lt=ee=>{var be;const X=v.value,oe=ee;let de=0;const pe=[...g.value];if(H(X))for(let ve=0;ve<X.length;ve++)oe[ve]===X[ve]&&(de++,pe.includes(ve)||pe.push(ve));else for(let ve=0;ve<X.length;ve++)oe[ve]===X[ve]&&(de++,pe.includes(ve)||pe.push(ve));if(g.value=pe,h.value=pe.length,m.value.push({word:oe,matches:de}),A.value=`Made guess: "${oe}" (${de} matches)`,de<X.length){const ve=10*P[x.value].multiplier;F.value+=Math.round(ve),de>0?ge.playSound("correct"):ge.playSound("incorrect")}else ge.playSound("win");(be=r.value)==null||be.emit("game-guess-result",{gameType:"word-galaxy",to:t.partnerId,result:{word:X,originalGuess:oe,matches:de,revealedPositions:pe,isCorrect:de===X.length,creatorEarnedPoints:de<X.length?Math.round(10*P[x.value].multiplier):0}}),de===X.length&&(y.value=X.split(""),h.value=f.value,s.value="complete",C.value=!1,v.value=X,ye(),rt())},ot=ee=>{m.value.push({word:ee.originalGuess||p.value,matches:ee.matches}),ee.creatorEarnedPoints&&(F.value+=ee.creatorEarnedPoints);for(let X=0;X<f.value;X++)ee.revealedPositions.includes(X)&&(y.value[X]=ee.word[X]);h.value=ee.revealedPositions.length,ee.isCorrect?(y.value=ee.word.split(""),h.value=f.value,s.value="complete",C.value=!0,v.value=ee.word,ye(),ge.playSound("win"),rt()):ee.matches>0?ge.playSound("correct"):ge.playSound("incorrect")},rt=()=>{var ee,X;if(C.value){if(!c.value){const de=P[x.value].multiplier,pe=(R.value-b.value)*5,he=Math.round(_.value/3),be=Math.round((50+pe+he)*de);T.value+=be,(ee=r.value)==null||ee.emit("game-score-update",{gameType:"word-galaxy",to:t.partnerId,guesserScore:T.value,creatorScore:F.value})}}else if(c.value){const de=P[x.value].multiplier,pe=Math.round(30*de);F.value+=pe,(X=r.value)==null||X.emit("game-score-update",{gameType:"word-galaxy",to:t.partnerId,guesserScore:T.value,creatorScore:F.value})}B.value.push({creator:c.value&&!C.value?Math.round(30*P[x.value].multiplier):0,guesser:!c.value&&C.value?Math.round((50+(R.value-b.value)*5+Math.round(_.value/3))*P[x.value].multiplier):0})},at=ee=>ee===0?"bg-red-500/30 text-red-300":ee===f.value?"bg-green-500/30 text-green-300":ee>=f.value/2?"bg-yellow-500/30 text-yellow-300":"bg-blue-500/30 text-blue-300",Le=()=>{var X;s.value="setup",v.value="",y.value=[],g.value=[],h.value=0,p.value="",m.value=[],b.value=0,C.value=!1,w.value=0,E.value=!1,z.value++;const ee=c.value;c.value=!ee,console.log(`Play Again clicked: Round ${z.value}, Swapping roles - I was ${ee?"creator":"guesser"}, now I am ${c.value?"creator":"guesser"}`),(X=r.value)==null||X.emit("game-reset",{gameType:"word-galaxy",to:t.partnerId,swapRoles:!1,shouldBeCreator:!c.value,roundCount:z.value,guesserScore:T.value,creatorScore:F.value})},ke=()=>{d.value=!0,ge.playSound("button")},vt=()=>{var ee;d.value=!1,(ee=r.value)==null||ee.emit("game-leave",{gameType:"word-galaxy",to:t.partnerId}),o("back")};return Ve(()=>{var ee,X,oe,de,pe,he,be,ve;if(t.partnerReady){if(s.value="setup",z.value===1){const J=a.value||"",De=t.partnerId||"";c.value=J<De,console.log(`Role assignment: My ID ${J}, Partner ID ${De}, I am ${c.value?"word creator":"guesser"}`)}ge.playSound("gameStart")}(ee=r.value)==null||ee.on("game-word-setup",J=>{J.from===t.partnerId&&J.gameType==="word-galaxy"&&(f.value=J.wordLength,x.value=J.difficulty,s.value="guessing",c.value=!1,me(),xe())}),(X=r.value)==null||X.on("game-score-update",J=>{J.from===t.partnerId&&J.gameType==="word-galaxy"&&(J.guesserScore!==void 0&&(T.value=J.guesserScore),J.creatorScore!==void 0&&(F.value=J.creatorScore))}),(oe=r.value)==null||oe.on("game-move",J=>{if(J.from===t.partnerId&&J.gameType==="word-galaxy"){const De=J.move;typeof De=="string"&&(De==="timeout"?(s.value="complete",C.value=!0,A.value="Ran out of time!",rt()):De==="out-of-attempts"?(s.value="complete",C.value=!0,A.value="Ran out of attempts!",rt()):lt(De))}}),(de=r.value)==null||de.on("game-guess-result",J=>{J.from===t.partnerId&&J.gameType==="word-galaxy"&&ot(J.result)}),(pe=r.value)==null||pe.on("game-partner-joined",J=>{if(J.from===t.partnerId&&(s.value="setup",z.value===1)){const De=a.value||"",Ie=t.partnerId||"";c.value=De<Ie,console.log(`Partner joined: My ID ${De}, Partner ID ${Ie}, I am ${c.value?"word creator":"guesser"}`)}}),(he=r.value)==null||he.on("game-partner-left",()=>{s.value="waiting",ye(),ge.playSound("notification");const J=document.createElement("div");J.className="fixed top-4 right-4 bg-yellow-600/80 text-white px-4 py-2 rounded-lg shadow-lg z-50",J.innerHTML=`
      <div class="flex items-center gap-2">
        <span>⚠️</span>
        <span>Your partner has left the game</span>
      </div>
    `,document.body.appendChild(J),setTimeout(()=>{document.body.removeChild(J),o("back")},3e3)}),(be=r.value)==null||be.on("game-reset",J=>{if(J.from===t.partnerId&&J.gameType==="word-galaxy"&&(console.log("Received game-reset from partner with data:",JSON.stringify({roundCount:J.roundCount,shouldBeCreator:J.shouldBeCreator})),s.value="setup",v.value="",y.value=[],g.value=[],h.value=0,p.value="",m.value=[],b.value=0,C.value=!1,w.value=0,ye(),E.value=!1,J.roundCount&&(z.value=J.roundCount),J.guesserScore!==void 0&&(T.value=J.guesserScore),J.creatorScore!==void 0&&(F.value=J.creatorScore),J.shouldBeCreator!==void 0)){const De=c.value;c.value=J.shouldBeCreator,console.log(`Reset from partner: Round ${z.value}, Changing role from ${De?"creator":"guesser"} to ${c.value?"creator":"guesser"}`)}}),(ve=r.value)==null||ve.on("game-notification",J=>{J.from===t.partnerId&&J.gameType==="word-galaxy"&&console.log(`Game notification from partner: ${J.message}`)})}),xt(()=>{var ee,X,oe,de,pe,he,be,ve;ye(),ge.stopAllSounds(),(ee=r.value)==null||ee.off("game-word-setup"),(X=r.value)==null||X.off("game-move"),(oe=r.value)==null||oe.off("game-guess-result"),(de=r.value)==null||de.off("game-score-update"),(pe=r.value)==null||pe.off("game-partner-joined"),(he=r.value)==null||he.off("game-partner-left"),(be=r.value)==null||be.off("game-reset"),(ve=r.value)==null||ve.off("game-notification")}),Ee(()=>s.value!=="complete"?null:c.value?C.value?"failed":"guessed":C.value?"guessed":"failed"),(ee,X)=>(U(),j(Be,null,[i("div",tu,[i("div",nu,[X[6]||(X[6]=i("h2",{class:"text-xl font-bold text-purple-400"},[i("span",{class:"hidden sm:inline"},"Word Galaxy"),i("span",{class:"sm:hidden"},"Word Game")],-1)),i("div",{class:se(["text-white text-sm px-3 py-1 rounded-full backdrop-blur-sm shadow-lg",{"bg-yellow-600/40 border border-yellow-500/30":s.value==="waiting","bg-green-600/40 border border-green-500/30":s.value==="setup","bg-blue-600/40 border border-blue-500/30":s.value==="guessing","bg-purple-600/40 border border-purple-500/30":s.value==="complete"}])},Y(ee.gameStateLabel),3)]),i("div",ou,[i("div",{class:se(["flex flex-col items-center",{"opacity-70":s.value==="waiting"}])},[i("div",ru,[i("div",au,[X[7]||(X[7]=i("div",{class:"text-sm text-gray-300 mb-1"},"Attempts",-1)),i("div",su,Y(b.value)+"/"+Y(R.value),1)]),s.value==="guessing"&&!c.value?(U(),j("div",iu,[X[8]||(X[8]=i("div",{class:"text-sm text-gray-300"},"Time",-1)),i("div",{class:se(["text-xl font-bold",{"text-red-400":_.value<10,"text-yellow-400":_.value<20,"text-white":_.value>=20}])},Y(_.value)+"s",3)])):ne("",!0),i("div",lu,[X[9]||(X[9]=i("div",{class:"text-sm text-gray-300 mb-1"},"Score",-1)),i("div",cu,Y(c.value?F.value:T.value),1)]),i("div",uu,[X[10]||(X[10]=i("div",{class:"text-sm text-gray-300 mb-1"},"Round",-1)),i("div",du,Y(z.value),1)])]),i("div",fu,[s.value==="setup"&&c.value?(U(),j("div",xu,[X[13]||(X[13]=ft('<div class="text-center mb-6" data-v-f9483a22><div class="w-16 h-16 mx-auto mb-3 flex items-center justify-center bg-green-500/30 rounded-full" data-v-f9483a22><span class="text-2xl" data-v-f9483a22>💬</span></div><h3 class="text-xl font-bold text-white mb-2" data-v-f9483a22>Create a Word</h3><p class="text-gray-300 mb-4" data-v-f9483a22>Enter a word for your partner to guess</p></div>',1)),i("div",vu,[i("div",gu,[X[11]||(X[11]=i("label",{class:"block text-gray-300 text-sm mb-2"},"Your Word:",-1)),Pt(i("input",{"onUpdate:modelValue":X[0]||(X[0]=oe=>v.value=oe),dir:H(v.value)?"rtl":"ltr",class:"w-full bg-gray-900 text-white px-4 py-2 rounded border border-gray-600 focus:border-purple-500 focus:outline-none",placeholder:"Enter a word...",maxlength:"15",disabled:s.value!=="setup",onInput:k},null,40,mu),[[Xt,v.value]]),l.value?(U(),j("p",pu,Y(l.value),1)):(U(),j("p",hu,"The word should be 3-15 letters long"))]),i("div",bu,[X[12]||(X[12]=i("label",{class:"block text-gray-300 text-sm mb-2"},"Difficulty:",-1)),i("div",yu,[i("button",{onClick:X[1]||(X[1]=oe=>x.value="easy"),class:se(["flex-1 px-4 py-2 rounded-lg text-sm transition-all",x.value==="easy"?"bg-green-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"])}," Easy ",2),i("button",{onClick:X[2]||(X[2]=oe=>x.value="medium"),class:se(["flex-1 px-4 py-2 rounded-lg text-sm transition-all",x.value==="medium"?"bg-yellow-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"])}," Medium ",2),i("button",{onClick:X[3]||(X[3]=oe=>x.value="hard"),class:se(["flex-1 px-4 py-2 rounded-lg text-sm transition-all",x.value==="hard"?"bg-red-600 text-white":"bg-gray-800 text-gray-300 hover:bg-gray-700"])}," Hard ",2)])])]),i("div",Cu,[i("button",{onClick:V,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95 disabled:opacity-50 disabled:pointer-events-none",disabled:!K.value}," Start Game ",8,wu)])])):s.value==="setup"&&!c.value?(U(),j("div",Eu,X[14]||(X[14]=[ft('<div class="text-center mb-6" data-v-f9483a22><div class="w-16 h-16 mx-auto mb-3 relative" data-v-f9483a22><div class="absolute inset-0 bg-blue-500/20 rounded-full animate-ping" data-v-f9483a22></div><div class="absolute inset-2 bg-blue-500/30 rounded-full animate-ping animation-delay-300" data-v-f9483a22></div><div class="absolute inset-0 flex items-center justify-center" data-v-f9483a22><span class="text-2xl" data-v-f9483a22>🔤</span></div></div><h3 class="text-xl font-bold text-white mb-2" data-v-f9483a22>Get Ready!</h3><p class="text-gray-300" data-v-f9483a22>Your partner is creating a word for you to guess...</p></div><div class="bg-gray-700/50 rounded-lg p-4 mb-4" data-v-f9483a22><h4 class="font-bold text-white mb-2" data-v-f9483a22>How to Play:</h4><ul class="text-gray-300 text-sm space-y-2 list-disc pl-4" data-v-f9483a22><li data-v-f9483a22>Your partner will create a secret word</li><li data-v-f9483a22>You&#39;ll see a blurred version of the word</li><li data-v-f9483a22>Type guesses to reveal more letters</li><li data-v-f9483a22>You need to guess the word before the timer runs out</li><li data-v-f9483a22>You win if you guess correctly, your partner wins if you don&#39;t</li></ul></div>',2)]))):s.value==="guessing"&&!c.value?(U(),j("div",_u,[i("div",Au,[i("div",Bu,[i("div",Tu,[X[15]||(X[15]=i("span",{class:"text-sm text-gray-400"},"The Secret Word:",-1)),i("span",ku,Y(h.value)+"/"+Y(f.value)+" letters revealed",1)]),i("div",{class:"flex justify-center gap-1 md:gap-2 flex-wrap",dir:$.value},[(U(!0),j(Be,null,We(y.value,(oe,de)=>(U(),j("div",{key:de,class:se(["w-8 h-10 md:w-10 md:h-12 flex items-center justify-center rounded bg-gray-800/80 border text-lg md:text-xl font-bold",oe==="_"?"border-gray-700 text-gray-500":"border-purple-500 text-white"])},Y(oe),3))),128))],8,Du)]),i("div",Fu,[X[16]||(X[16]=i("label",{class:"block text-gray-300 text-sm mb-2"},"Your Guess:",-1)),i("div",Su,[Pt(i("input",{"onUpdate:modelValue":X[4]||(X[4]=oe=>p.value=oe),dir:H(p.value)||H(v.value.value)?"rtl":"ltr",class:"flex-1 bg-gray-900 text-white px-4 py-2 rounded-l border border-gray-600 focus:border-purple-500 focus:outline-none",placeholder:"Type your guess...",maxlength:f.value,onKeyup:as(ie,["enter"]),onInput:S},null,40,Ru),[[Xt,p.value]]),i("button",{onClick:ie,class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-r transition-all",disabled:!p.value||p.value.length!==f.value}," Submit ",8,$u)]),u.value?(U(),j("p",Iu,Y(u.value),1)):(U(),j("p",Pu,Y(L.value)+" attempts remaining ",1))]),i("div",Mu,[m.value.length===0?(U(),j("p",Wu,"Your previous guesses will appear here...")):ne("",!0),(U(!0),j(Be,null,We(m.value,(oe,de)=>(U(),j("div",{key:de,class:"text-sm flex items-center mb-1"},[i("span",Ou,Y(de+1)+".",1),i("span",{dir:H(oe.word)||H(v.value.value)?"rtl":"ltr",class:"text-gray-300 mr-2"},Y(oe.word),9,Nu),i("span",{class:se(["text-xs px-1.5 py-0.5 rounded",at(oe.matches)])},Y(oe.matches)+" matching ",3)]))),128))])])])):s.value==="guessing"&&c.value?(U(),j("div",Lu,[i("div",Uu,[i("div",ju,[X[17]||(X[17]=i("span",{class:"text-gray-300"},"Your Secret Word:",-1)),i("span",{class:"text-white font-bold",dir:H(v.value)?"rtl":"ltr"},Y(v.value),9,Hu)]),i("div",{class:"flex justify-center gap-1 md:gap-2 flex-wrap",dir:$.value},[(U(!0),j(Be,null,We(v.value,(oe,de)=>(U(),j("div",{key:de,class:se(["w-8 h-10 md:w-10 md:h-12 flex items-center justify-center rounded border border-purple-500 text-lg md:text-xl font-bold",g.value.includes(de)?"bg-purple-600/30 text-white":"bg-gray-800 text-gray-500"])},Y(oe),3))),128))],8,qu),i("div",zu,[E.value?(U(),j("p",Gu,[X[18]||(X[18]=i("span",{class:"text-yellow-400 font-bold"},"Time remaining:",-1)),ze(" "+Y(_.value)+"s ",1)])):ne("",!0),i("p",Vu,[X[19]||(X[19]=i("span",{class:"text-purple-400 font-bold"},"Status:",-1)),ze(" "+Y(A.value),1)])])]),i("div",Ku,[m.value.length===0?(U(),j("p",Yu,"Partner's guesses will appear here...")):ne("",!0),(U(!0),j(Be,null,We(m.value,(oe,de)=>(U(),j("div",{key:de,class:"text-sm flex items-center mb-1"},[i("span",Xu,Y(de+1)+".",1),i("span",{dir:H(oe.word)||H(v.value)?"rtl":"ltr",class:"text-gray-300 mr-2"},Y(oe.word),9,Qu),i("span",{class:se(["text-xs px-1.5 py-0.5 rounded",at(oe.matches)])},Y(oe.matches)+" matching ",3)]))),128))])])):s.value==="complete"?(U(),j("div",Zu,[i("div",Ju,[i("div",ed,[i("span",td,Y(C.value?"🎉":"🔍"),1)]),i("h3",nd,Y(C.value?"You Won!":"You Lost!"),1),i("div",od,[X[20]||(X[20]=i("p",{class:"text-gray-300 mb-2"},"The secret word was:",-1)),i("div",rd,Y(v.value),1),C.value?(U(),j("p",ad,Y(c.value?"Your partner couldn't solve it!":"Solved in "+b.value+" attempts!"),1)):(U(),j("p",sd,Y(c.value?"Your partner solved it!":"Better luck next time!"),1))]),i("div",id,[X[23]||(X[23]=i("h4",{class:"text-lg font-bold text-white mb-2"},"Scores",-1)),i("div",ld,[i("div",null,[X[21]||(X[21]=i("p",{class:"text-gray-300"},"You:",-1)),i("p",cd,Y(c.value?F.value:T.value),1)]),i("div",null,[X[22]||(X[22]=i("p",{class:"text-gray-300"},"Partner:",-1)),i("p",ud,Y(c.value?T.value:F.value),1)])]),X[24]||(X[24]=i("p",{class:"text-xs text-gray-400 mt-2"},"Points are saved until you exit the game",-1))]),i("button",{onClick:Le,class:"px-6 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-all shadow-lg hover:shadow-xl transform hover:scale-105 active:scale-95"}," Play Again ")])])):s.value==="waiting"?(U(),j("div",dd,X[25]||(X[25]=[ft('<div class="bg-yellow-600/20 rounded-lg p-4 border border-yellow-500/30 shadow-lg animate-pulse" data-v-f9483a22><div class="w-16 h-16 mx-auto mb-3 relative" data-v-f9483a22><div class="absolute inset-0 bg-yellow-500/20 rounded-full animate-ping" data-v-f9483a22></div><div class="absolute inset-2 bg-yellow-500/30 rounded-full animate-ping animation-delay-300" data-v-f9483a22></div><div class="absolute inset-4 bg-yellow-500/40 rounded-full animate-ping animation-delay-600" data-v-f9483a22></div><div class="absolute inset-0 flex items-center justify-center" data-v-f9483a22><span class="text-2xl" data-v-f9483a22>👥</span></div></div><p class="text-yellow-300 mb-1 font-medium" data-v-f9483a22>Waiting for your partner to join...</p><p class="text-sm text-gray-300" data-v-f9483a22>Game will start automatically</p></div>',1)]))):ne("",!0)])],2)]),i("div",{class:"flex justify-between"},[i("button",{onClick:ke,class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-all shadow-md hover:shadow-lg transform hover:scale-105 active:scale-95"}," Back to Games ")])]),d.value?(U(),j("div",fd,[i("div",xd,[i("h3",vd,Y(H(v.value)?"هل أنت متأكد؟":"Are you sure?"),1),i("p",gd,Y(H(v.value)?"مغادرة اللعبة ستنهيها لشريكك أيضًا.":"Leaving the game will end it for your partner too."),1),i("div",md,[i("button",{onClick:X[5]||(X[5]=oe=>d.value=!1),class:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm"},Y(H(v.value)?"إلغاء":"Cancel"),1),i("button",{onClick:vt,class:"px-4 py-2 bg-red-600 hover:bg-red-700 rounded-lg text-sm"},Y(H(v.value)?"مغادرة":"Leave"),1)])])])):ne("",!0)],64))}});const hd=nt(pd,[["__scopeId","data-v-f9483a22"]]),bd={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-2 sm:p-4"},yd={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},Cd={class:"flex items-center justify-between p-2 sm:p-3 border-b border-gray-800"},wd={key:1,class:"p-3 sm:p-4"},Ed={class:"grid grid-cols-2 gap-2 sm:gap-4 mb-3 sm:mb-4"},_d=["disabled"],Ad=["disabled"],Bd=["disabled"],Td={key:2,class:"text-center p-4 sm:p-6"},kd={class:"mb-4"},Dd={class:"text-sm sm:text-base text-gray-300"},Fd={key:3},Sd=He({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:n}){const{socket:t,userId:o}=Me(),r=e,a=N(null),l=N(null),u=N(!0),d=N(null),s=N(!1),c=N(""),v=x=>{console.log(`[Game Debug] ${x}`),c.value=x},f=x=>{var m;if(!r.isConnected)return;v(`Starting game: ${x} with partner: ${r.partnerId}`),l.value=null,a.value=x,u.value=!0,s.value=!1;const p=[o.value,r.partnerId].sort();if(d.value=`${x}-${p[0]}-${p[1]}`,v(`Created game room: ${d.value}`),(m=t.value)==null||m.emit("game-join-room",{gameType:x,roomId:d.value,to:r.partnerId,isFirstPlayer:!0}),t.value&&r.partnerId){const b=`invite-${Date.now()}-${Math.floor(Math.random()*1e4)}`;t.value.emit("game-invite",{gameType:x,to:r.partnerId,inviteId:b}),console.log(`Sent game invitation for ${x} to ${r.partnerId}`),h("Invitation sent! Waiting for response...","info")}},y=()=>{var x;r.partnerId?((x=t.value)==null||x.emit("game-leave-notification",{gameType:a.value||"unknown",to:r.partnerId,message:"Your partner returned to the game menu"}),t.value&&t.value.emit("game-notification",{gameType:a.value||"unknown",to:r.partnerId,message:"Your partner has left the game",type:"leave"}),setTimeout(()=>{d.value&&t.value&&t.value.emit("game-leave-room",{roomId:d.value,to:r.partnerId}),a.value=null,l.value=null,u.value=!0,d.value=null,s.value=!1},100)):(a.value=null,l.value=null,u.value=!0,d.value=null,s.value=!1)},g=x=>{l.value=x,v(`Error: ${x}`)};Ve(()=>{var x,p,m,b,C;v("Setting up game events"),document.addEventListener("select-game",w=>{const{gameType:A,partnerId:T}=w.detail;if(A&&T&&T===r.partnerId){v(`Received direct game selection: ${A}`),a.value=A,l.value=null,u.value=!1,s.value=!0;const F=[o.value,r.partnerId].sort();d.value=`${A}-${F[0]}-${F[1]}`,v(`Created game room: ${d.value}`)}}),(x=t.value)==null||x.on("game-room-invite",w=>{var A;w.from===r.partnerId&&(v(`Received invitation to join game room: ${w.roomId}`),d.value=w.roomId,a.value=w.gameType,u.value=!1,(A=t.value)==null||A.emit("game-join-room",{gameType:w.gameType,roomId:w.roomId,to:r.partnerId,isFirstPlayer:!1}))}),(p=t.value)==null||p.on("game-partner-joined",w=>{w.from===r.partnerId&&(v(`Partner joined the game: ${w.gameType}`),s.value=!0)}),(m=t.value)==null||m.on("game-error",w=>{(w.from==="system"||w.from===r.partnerId)&&(l.value=w.message||"An error occurred in the game.",v(`Game error: ${w.message}`))}),(b=t.value)==null||b.on("game-partner-left",w=>{a.value&&(v("Partner left the game - closing silently"),a.value=null,d.value=null,s.value=!1,l.value=null)}),(C=t.value)==null||C.on("game-notification",w=>{w.from===r.partnerId&&v(`Notification from partner: ${w.message}`)})}),xt(()=>{var x,p,m,b,C,w;(x=t.value)==null||x.off("game-room-invite"),(p=t.value)==null||p.off("game-partner-joined"),(m=t.value)==null||m.off("game-error"),(b=t.value)==null||b.off("game-partner-left"),(C=t.value)==null||C.off("game-notification"),d.value&&((w=t.value)==null||w.emit("game-leave-room",{roomId:d.value,to:r.partnerId})),document.removeEventListener("select-game",()=>{})}),Re(()=>r.isOpen,x=>{x||y()});const h=(x,p="info")=>{const m=document.createElement("div");let b="bg-blue-600";p==="success"&&(b="bg-emerald-600"),p==="error"&&(b="bg-red-600"),m.className=`fixed bottom-4 right-4 ${b} text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in`,m.style.animationDuration="0.3s",m.innerHTML=x,document.body.appendChild(m),setTimeout(()=>{m.style.opacity="0",m.style.transition="opacity 0.3s ease",setTimeout(()=>{document.body.removeChild(m)},300)},3e3)};return(x,p)=>e.isOpen?(U(),j("div",bd,[i("div",yd,[i("div",Cd,[p[4]||(p[4]=i("div",{class:"flex items-center gap-2"},[i("span",{class:"text-purple-400 text-lg sm:text-xl"},"🎮"),i("h2",{class:"text-lg sm:text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),i("button",{onClick:p[0]||(p[0]=m=>x.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),ne("",!0),a.value?l.value?(U(),j("div",Td,[i("div",kd,[p[10]||(p[10]=i("div",{class:"w-12 h-12 sm:w-16 sm:h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[i("span",{class:"text-xl sm:text-2xl"},"⚠️")],-1)),p[11]||(p[11]=i("h3",{class:"text-lg sm:text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),i("p",Dd,Y(l.value),1)]),i("button",{onClick:y,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):(U(),j("div",Fd,[a.value==="tic-tac-toe"?(U(),gn(Cc,{key:0,partnerId:e.partnerId,isFirstPlayer:u.value,partnerReady:s.value,onBack:y,onError:g},null,8,["partnerId","isFirstPlayer","partnerReady"])):ne("",!0),a.value==="rock-paper-scissors"?(U(),gn(eu,{key:1,partnerId:e.partnerId,partnerReady:s.value,onBack:y,onError:g},null,8,["partnerId","partnerReady"])):ne("",!0),a.value==="word-galaxy"?(U(),gn(hd,{key:2,partnerId:e.partnerId,partnerReady:s.value,onBack:y,onError:g},null,8,["partnerId","partnerReady"])):ne("",!0)])):(U(),j("div",wd,[i("div",Ed,[i("button",{class:se(["bg-[#2e2e42] p-2 sm:p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!e.isConnected}]),disabled:!e.isConnected,onClick:p[1]||(p[1]=m=>f("rock-paper-scissors"))},p[5]||(p[5]=[i("div",{class:"bg-yellow-500 text-white w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center mb-2 sm:mb-3 text-base sm:text-xl"},"👊",-1),i("div",{class:"text-white text-xs sm:text-sm font-medium"},"Rock Paper Scissors",-1),i("div",{class:"text-xs text-gray-400 hidden sm:block"},"vs Partner",-1)]),10,_d),i("button",{class:se(["bg-[#2e2e42] p-2 sm:p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!e.isConnected}]),disabled:!e.isConnected,onClick:p[2]||(p[2]=m=>f("word-galaxy"))},p[6]||(p[6]=[i("div",{class:"bg-white text-gray-800 w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center mb-2 sm:mb-3 text-base sm:text-xl"},"💬",-1),i("div",{class:"text-white text-xs sm:text-sm font-medium"},"Word Galaxy",-1),i("div",{class:"text-xs text-gray-400 hidden sm:block"},"Word Guessing Game",-1)]),10,Ad),i("button",{class:se(["bg-[#2e2e42] p-2 sm:p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!e.isConnected}]),disabled:!e.isConnected,onClick:p[3]||(p[3]=m=>f("tic-tac-toe"))},p[7]||(p[7]=[i("div",{class:"bg-red-600 text-white w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center mb-2 sm:mb-3 text-base sm:text-xl"},"⭕",-1),i("div",{class:"text-white text-xs sm:text-sm font-medium"},"Tic-Tac-Toe",-1),i("div",{class:"text-xs text-gray-400 hidden sm:block"},"vs Partner",-1)]),10,Bd),i("button",{class:se(["bg-[#2e2e42] p-2 sm:p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},p[8]||(p[8]=[ft('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-d5876d55><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-d5876d55>Coming Soon</span></div><div class="bg-purple-600 text-white w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center mb-2 sm:mb-3 text-base sm:text-xl" data-v-d5876d55>🎲</div><div class="text-white text-xs sm:text-sm font-medium" data-v-d5876d55>Mystery Game</div><div class="text-xs text-gray-400 hidden sm:block" data-v-d5876d55>More Fun Ahead</div>',4)]))]),p[9]||(p[9]=i("p",{class:"text-center text-xs sm:text-sm text-gray-400 mt-2"}," Connect to play with others ",-1))]))])])):ne("",!0)}});const Rd=nt(Sd,[["__scopeId","data-v-d5876d55"]]),$d={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Id={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},Pd={class:"flex items-center justify-between mb-6"},Md={class:"grid grid-cols-3 gap-4 mb-6"},Wd=He({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:n}){const t=n,o=N(15),r=l=>{o.value=l},a=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${o.value}`,"_blank"),t("close")};return(l,u)=>e.isOpen?(U(),j("div",$d,[i("div",Id,[i("div",Pd,[u[4]||(u[4]=i("div",{class:"flex items-center gap-2"},[i("span",{class:"text-red-400 text-xl"},"❤️"),i("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),i("button",{onClick:u[0]||(u[0]=d=>l.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),u[8]||(u[8]=i("div",{class:"mb-6 text-center"},[i("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),i("div",Md,[i("button",{class:se(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",o.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:u[1]||(u[1]=d=>r(5))},u[5]||(u[5]=[i("div",{class:"text-lg font-bold text-white"},"$5",-1),i("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),i("button",{class:se(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",o.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:u[2]||(u[2]=d=>r(15))},u[6]||(u[6]=[i("div",{class:"text-lg font-bold text-white"},"$15",-1),i("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),i("button",{class:se(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",o.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:u[3]||(u[3]=d=>r(50))},u[7]||(u[7]=[i("div",{class:"text-lg font-bold text-white"},"$50",-1),i("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),u[9]||(u[9]=i("div",{class:"flex justify-center items-center gap-1 mb-6"},[i("span",{class:"text-yellow-400"},"⭐"),i("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),i("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:a}," Donate via PayPal "),u[10]||(u[10]=i("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):ne("",!0)}}),Od={class:"fixed inset-0 overflow-hidden pointer-events-none"},Nd=He({__name:"starfield",setup(e){const n=N([]);Ve(()=>{t()});const t=()=>{const r=[];for(let a=0;a<50;a++)r.push({id:a,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});n.value=r};return(o,r)=>(U(),j("div",Od,[(U(!0),j(Be,null,We(n.value,a=>(U(),j("div",{key:a.id,class:"absolute rounded-full bg-white",style:No({width:`${a.size}px`,height:`${a.size}px`,top:`${a.y}%`,left:`${a.x}%`,opacity:a.opacity,boxShadow:`0 0 ${a.size*2}px rgba(255, 255, 255, ${a.opacity})`,animation:`twinkle ${a.duration}s infinite ease-in-out`})},null,4))),128))]))}});const Ld=nt(Nd,[["__scopeId","data-v-f4bff5a3"]]),So=!1,Ud=10,jd=He({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(e){const{remoteStream:n,connectionState:t,partnerId:o,isAudioMuted:r}=Na(),a=N(null),l=N(.8),u=N(!1),d=N(0),s=Ee(()=>(n.value!==null&&n.value?n.value.getAudioTracks().length>0:!1)&&n.value?n.value.getAudioTracks().some(C=>C.enabled):!1);Ee(()=>n.value?n.value.getAudioTracks().filter(p=>p.enabled&&p.readyState==="live").length:0),Ee(()=>u.value&&s.value?"connected":(t.value==="connected"&&!s.value&&!u.value&&setTimeout(g,500),t.value)),Re(()=>n.value,p=>{g(),d.value=0,setTimeout(h,500)}),Re(()=>r.value,p=>{!p&&n.value&&a.value&&setTimeout(()=>{a.value&&a.value.paused&&a.value.play().catch(m=>{})},300)}),Re(()=>t.value,p=>{p==="connected"?setTimeout(()=>{g(),h()},1e3):p==="new"||p==="connecting"?d.value=0:(p==="disconnected"||p==="failed")&&x()}),Re(()=>o.value,p=>{u.value=!1,d.value=0,p||a.value&&(a.value.srcObject=null)}),Ve(()=>{g(),a.value&&(a.value.onplaying=()=>{u.value=!0},a.value.onpause=()=>{u.value=!1},a.value.onended=()=>{u.value=!1},a.value.onerror=p=>{console.error("[AudioOutput] Audio error:",p),u.value=!1},a.value.volume=l.value),document.addEventListener("visibilitychange",y),v()}),Lo(()=>{a.value&&(a.value.srcObject=null),document.removeEventListener("visibilitychange",y),f()});let c=null;function v(){f(),c=window.setInterval(()=>{!u.value&&s.value&&t.value==="connected"&&(g(),h())},5e3)}function f(){c&&(clearInterval(c),c=null)}function y(){document.visibilityState==="visible"&&(g(),setTimeout(()=>{!u.value&&s.value&&h()},500))}function g(){a.value&&(n.value?(a.value.srcObject=n.value,n.value.getAudioTracks().forEach(p=>{p.enabled=!0}),h()):(a.value.srcObject=null,u.value=!1))}async function h(){if(!(!a.value||!a.value.srcObject))try{const p=n.value&&n.value.getAudioTracks().length>0;await a.value.play(),u.value=!0,d.value=0}catch(p){if(console.error("[AudioOutput] Error playing audio:",p),u.value=!1,p instanceof DOMException&&p.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),d.value<Ud){d.value++;const m=d.value*1e3;setTimeout(h,m)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function x(){d.value=0,a.value&&(a.value.srcObject=null),setTimeout(()=>{g(),h()},500)}return(p,m)=>(U(),j("div",null,[i("audio",{ref_key:"audioElement",ref:a,autoplay:"",playsinline:"",class:"hidden"},null,512),ne("",!0)]))}});const Hd=nt(jd,[["__scopeId","data-v-f63dc209"]]),qd={class:"flex items-center"},zd={key:0,class:"spinner mr-3"},Gd={key:1,class:"timeout-icon mr-3"},Vd={class:"content flex-grow"},Kd={class:"message"},Yd={key:0,class:"wait-time"},Xd={key:2,class:"flex-shrink-0"},Qd=He({__name:"queue-status",emits:["retry"],setup(e,{emit:n}){const t=Me(),o=N(t.queueStatus.value),r=N(t.queueMessage.value),a=N(t.queueWaitTime.value),l=Ee(()=>o.value!=="idle"&&o.value!=="matched"),u=Ee(()=>o.value==="waiting"),d=Ee(()=>o.value==="timeout"),s=Ee(()=>({waiting:u.value,timeout:d.value}));function c(g){if(g<60)return`${g} seconds`;if(g<3600){const h=Math.floor(g/60),x=g%60;return`${h} ${h===1?"minute":"minutes"}${x>0?` and ${x} ${x===1?"second":"seconds"}`:""}`}else{const h=Math.floor(g/3600),x=Math.floor(g%3600/60);return`${h} ${h===1?"hour":"hours"}${x>0?` and ${x} ${x===1?"minute":"minutes"}`:""}`}}function v(){t.socket.value&&(o.value="idle",y("retry"))}function f(g){const h=g.detail;o.value=h.status,r.value=h.message,a.value=h.waitTime}const y=n;return Ve(()=>{o.value=t.queueStatus.value,r.value=t.queueMessage.value,a.value=t.queueWaitTime.value,window.addEventListener("queue-status-changed",f)}),xt(()=>{window.removeEventListener("queue-status-changed",f)}),(g,h)=>l.value?(U(),j("div",{key:0,class:se(["queue-status",s.value])},[i("div",qd,[u.value?(U(),j("div",zd)):d.value?(U(),j("div",Gd,"⏱️")):ne("",!0),i("div",Vd,[i("div",Kd,Y(r.value),1),a.value>0?(U(),j("div",Yd," Wait time: "+Y(c(a.value)),1)):ne("",!0)]),d.value?(U(),j("div",Xd,[i("button",{onClick:v,class:"retry-button"}," Try Again ")])):ne("",!0)])],2)):ne("",!0)}});const Zd=nt(Qd,[["__scopeId","data-v-7301a6d5"]]),Jd={class:"filter-feedback"},ef={key:0,class:"mt-2 p-2 bg-emerald-900/30 rounded-lg"},tf={class:"text-xs text-emerald-300"},nf={class:"font-medium"},of={class:"w-full bg-gray-700 rounded-full h-2 mt-1"},rf={key:1,class:"mt-2"},af={class:"text-xs text-gray-400"},sf={key:2,class:"mt-2"},lf={class:"text-xs text-gray-400"},cf=He({__name:"CountryFilterFeedback",props:{preferredCountries:{type:Array,required:!0},blockedCountries:{type:Array,required:!0},onlineUsers:{type:Number,default:0},countries:{type:Array,required:!0}},setup(e){const n=e,t=Ee(()=>{if(n.preferredCountries.length===0)return 100;const r=195,a=n.preferredCountries.length/r*100;return Math.min(Math.round(a),100)}),o=r=>{const a=n.countries.find(l=>l.value===r);return a?a.name:r};return(r,a)=>(U(),j("div",Jd,[e.preferredCountries.length>0?(U(),j("div",ef,[i("p",tf,[i("span",nf,Y(t.value)+"%",1),a[0]||(a[0]=ze(" of users match your preferences "))]),i("div",of,[i("div",{class:"bg-emerald-500 h-2 rounded-full",style:No({width:`${t.value}%`})},null,4)])])):ne("",!0),e.preferredCountries.length>0?(U(),j("div",rf,[i("p",af,[a[1]||(a[1]=ze(" Your current preferences will match you only with users from: ")),(U(!0),j(Be,null,We(e.preferredCountries,(l,u)=>(U(),j("span",{key:l},Y(o(l))+Y(u<e.preferredCountries.length-1?", ":""),1))),128))])])):ne("",!0),e.blockedCountries.length>0?(U(),j("div",sf,[i("p",lf,[a[2]||(a[2]=ze(" You will not be matched with users from: ")),(U(!0),j(Be,null,We(e.blockedCountries,(l,u)=>(U(),j("span",{key:l},Y(o(l))+Y(u<e.blockedCountries.length-1?", ":""),1))),128))])])):ne("",!0)]))}});const uf=nt(cf,[["__scopeId","data-v-bceab852"]]),df={class:"bg-gradient-to-br from-indigo-900 to-purple-900 rounded-2xl p-6 w-full max-w-sm border border-indigo-500/50 shadow-2xl animate-bounce-in"},ff={class:"text-center"},xf={class:"w-24 h-24 mx-auto mb-4 rounded-full bg-gradient-to-br from-indigo-600 to-purple-700 flex items-center justify-center shadow-lg shadow-indigo-500/30 animate-pulse"},vf={class:"text-4xl"},gf={class:"text-white/90 text-sm mb-2"},mf={class:"font-medium text-indigo-300"},pf={class:"mt-4 mb-3 relative"},hf={class:"h-3 bg-gray-700/70 rounded-full overflow-hidden backdrop-blur-sm shadow-inner"},bf={class:"text-sm text-indigo-200 mt-2 font-medium"},la=30,yf=He({__name:"GameInviteNotification",props:{gameType:{},from:{},inviteId:{}},emits:["accept","decline","timeout"],setup(e,{emit:n}){const t=e,o=n,r=N(la);let a=null;const l=Ee(()=>r.value/la*100);Ve(()=>{const f=new Audio("/sounds/notification.mp3");f.volume=.3,f.play().catch(y=>console.log("Error playing sound",y)),a=window.setInterval(()=>{r.value-=.1,r.value<=0&&u()},100)}),Lo(()=>{a!==null&&clearInterval(a)});const u=()=>{a!==null&&clearInterval(a),o("timeout",{inviteId:t.inviteId})},d=()=>{a!==null&&clearInterval(a),o("accept",{inviteId:t.inviteId,gameType:t.gameType,from:t.from})},s=()=>{a!==null&&clearInterval(a),o("decline",{inviteId:t.inviteId,from:t.from})},c=f=>({"rock-paper-scissors":"Rock Paper Scissors","tic-tac-toe":"Tic-Tac-Toe","word-galaxy":"Word Galaxy",trivia:"Trivia Quiz"})[f]||f,v=f=>({"rock-paper-scissors":"✂️","tic-tac-toe":"⭕","word-galaxy":"🌌",trivia:"❓"})[f]||"🎮";return(f,y)=>(U(),j("div",{class:"fixed inset-0 flex items-center justify-center z-50 bg-black/70",onClick:Oo(s,["self"])},[i("div",df,[y[2]||(y[2]=i("div",{class:"absolute inset-0 -z-10 bg-gradient-to-r from-purple-600/20 to-indigo-600/20 rounded-2xl blur-xl animate-pulse"},null,-1)),i("div",ff,[i("div",xf,[i("span",vf,Y(v(f.gameType)),1)]),y[1]||(y[1]=i("p",{class:"text-white text-xl font-semibold mb-2 text-shadow"},"Game Invitation",-1)),i("p",gf,[y[0]||(y[0]=ze(" You've been invited to play ")),i("span",mf,Y(c(f.gameType)),1)]),i("div",pf,[i("div",hf,[i("div",{class:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 animate-pulse-slow",style:No({width:`${l.value}%`})},null,4)]),i("p",bf,Y(Math.ceil(r.value))+"s remaining ",1)])]),i("div",{class:"mt-6 grid grid-cols-2 gap-4"},[i("button",{onClick:s,class:"bg-gray-700/80 hover:bg-gray-600 text-white px-6 py-3 rounded-xl text-sm transition-all duration-300 hover:scale-105 backdrop-blur-sm shadow-lg"}," Decline "),i("button",{onClick:d,class:"bg-gradient-to-r from-indigo-500 to-purple-500 hover:from-indigo-600 hover:to-purple-600 text-white px-6 py-3 rounded-xl text-sm transition-all duration-300 hover:scale-105 shadow-lg shadow-indigo-500/30 font-medium"}," Accept ")])])]))}});const Cf=nt(yf,[["__scopeId","data-v-7a75153e"]]),wf={class:"min-h-screen font-sans"},Ef={class:"relative min-h-screen z-10 text-white"},_f={class:"p-2 sm:p-4 border-b border-white/10"},Af={class:"max-w-4xl mx-auto"},Bf={class:"flex justify-center gap-2 mb-2 sm:mb-3"},Tf={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},kf={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},Df={class:"grid grid-cols-2 gap-2 text-xs relative"},Ff={class:"flex items-center truncate"},Sf={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Rf={class:"py-1"},$f=["onClick"],If={class:"text-sm"},Pf={class:"flex-1 p-2 sm:p-4"},Mf={class:"max-w-md mx-auto space-y-4 sm:space-y-6"},Wf={class:"flex items-center justify-center gap-2 mb-2 sm:mb-4"},Of={class:"relative inline-block w-10 h-5 mr-2"},Nf={class:"text-center"},Lf={class:"text-xs text-gray-400 italic"},Uf={class:"p-2 sm:p-4 border-t border-white/10"},jf={class:"max-w-md mx-auto text-center space-y-1 sm:space-y-2"},Hf={class:"grid grid-cols-2 md:flex md:flex-wrap justify-center gap-2 mt-2 sm:mt-4 text-xs"},qf={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},zf={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},Gf={class:"flex justify-between items-center mb-4"},Vf={class:"space-y-3"},Kf={key:0,class:"text-center py-8"},Yf={class:"flex items-center gap-3"},Xf={class:"text-2xl"},Qf={class:"text-white text-sm font-medium"},Zf={class:"text-gray-400 text-xs"},Jf={class:"text-xs text-gray-500"},ex={key:0,class:"text-xs text-gray-500 text-center mt-4"},tx={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-20 p-4"},nx={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto relative"},ox={class:"flex justify-between items-center mb-6"},rx={class:"space-y-6"},ax={class:"bg-gray-700 border border-gray-600 rounded-lg p-3 min-h-[60px] max-h-32 overflow-y-auto scrollbar-hide"},sx={key:0,class:"text-xs text-gray-400 p-2"},ix={key:1,class:"flex flex-wrap gap-2"},lx={class:"flag-icon"},cx=["onClick"],ux={class:"bg-gray-700 border border-gray-600 rounded-lg p-3 min-h-[60px] max-h-32 overflow-y-auto scrollbar-hide"},dx={key:0,class:"text-xs text-gray-400 p-2"},fx={key:1,class:"flex flex-wrap gap-2"},xx={class:"flag-icon"},vx=["onClick"],gx={key:2,class:"fixed z-50 max-h-64 bg-gray-700 border border-gray-600 rounded-lg shadow-lg overflow-y-auto scrollbar-hide dropdown-outer preferred-outer"},mx={class:"py-1 w-full"},px={class:"px-3 py-2 border-b border-gray-600"},hx={key:0,class:"text-xs text-gray-400 px-3 py-2"},bx=["onClick"],yx={class:"flag-icon w-6 text-center"},Cx={class:"text-sm"},wx={key:3,class:"fixed z-50 max-h-64 bg-gray-700 border border-gray-600 rounded-lg shadow-lg overflow-y-auto scrollbar-hide dropdown-outer blocked-outer"},Ex={class:"py-1 w-full"},_x={class:"px-3 py-2 border-b border-gray-600"},Ax={key:0,class:"text-xs text-gray-400 px-3 py-2"},Bx=["onClick"],Tx={class:"flag-icon w-6 text-center"},kx={class:"text-sm"},Dx={key:4,class:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4"},Fx={class:"bg-gradient-to-br from-gray-900 to-purple-900 rounded-xl p-6 w-full max-w-lg shadow-2xl border border-purple-500/30"},Sx={class:"flex justify-between items-center mb-6"},Rx={class:"space-y-6 text-gray-200"},$x={class:"flex justify-center pt-4"},Ix={key:5,class:"hidden"},Px={key:6,class:"fixed inset-0 flex items-center justify-center z-50 p-4 bg-black/50"},Mx={class:"bg-gradient-to-br from-purple-900 to-indigo-900 rounded-2xl p-6 w-full max-w-sm border border-purple-500/30 shadow-xl"},Wx={class:"text-center"},Ox={class:"text-white/80 text-sm"},Nx={class:"mt-4 text-center"},Lx=He({__name:"HomeView",setup(e){const n=N("disconnected"),t=N(null),o=N(null),r=N(""),a=N(!1);let l=null;const u=N(!1),d=N(!1),s=N(!1),c=N(!1),v=N(!1),f=N(!1),y=N(0),g=N(0),h=N(!1),x=N([]),p=N([]),m=N([]),b=N("any"),C=N(!1),w=N([]),A=N([]),T=N(!1),F=N(!1),z=N(""),B=N([]),_=N(""),W=N([]),E=[{value:"any",text:"Go With the Flow",emoji:"🌟"},{value:"chill",text:"Chill",emoji:"😌"},{value:"fun",text:"Fun",emoji:"🎉"},{value:"curious",text:"Curious",emoji:"🤔"},{value:"creative",text:"Creative",emoji:"🎨"}],P=N([{value:"any",label:"🌍 Any Country",name:"Any Country",flag:"🌍"},{value:"ae",label:"🇦🇪 UAE",name:"United Arab Emirates",flag:"🇦🇪"},{value:"af",label:"🇦🇫 Afghanistan",name:"Afghanistan",flag:"🇦🇫"},{value:"al",label:"🇦🇱 Albania",name:"Albania",flag:"🇦🇱"},{value:"dz",label:"🇩🇿 Algeria",name:"Algeria",flag:"🇩🇿"},{value:"ar",label:"🇦🇷 Argentina",name:"Argentina",flag:"🇦🇷"},{value:"au",label:"🇦🇺 Australia",name:"Australia",flag:"🇦🇺"},{value:"at",label:"🇦🇹 Austria",name:"Austria",flag:"🇦🇹"},{value:"bh",label:"🇧🇭 Bahrain",name:"Bahrain",flag:"🇧🇭"},{value:"bd",label:"🇧🇩 Bangladesh",name:"Bangladesh",flag:"🇧🇩"},{value:"be",label:"🇧🇪 Belgium",name:"Belgium",flag:"🇧🇪"},{value:"br",label:"🇧🇷 Brazil",name:"Brazil",flag:"🇧🇷"},{value:"ca",label:"🇨🇦 Canada",name:"Canada",flag:"🇨🇦"},{value:"cn",label:"🇨🇳 China",name:"China",flag:"🇨🇳"},{value:"dk",label:"🇩🇰 Denmark",name:"Denmark",flag:"🇩🇰"},{value:"eg",label:"🇪🇬 Egypt",name:"Egypt",flag:"🇪🇬"},{value:"fi",label:"🇫🇮 Finland",name:"Finland",flag:"🇫🇮"},{value:"fr",label:"🇫🇷 France",name:"France",flag:"🇫🇷"},{value:"de",label:"🇩🇪 Germany",name:"Germany",flag:"🇩🇪"},{value:"gr",label:"🇬🇷 Greece",name:"Greece",flag:"🇬🇷"},{value:"hk",label:"🇭🇰 Hong Kong",name:"Hong Kong",flag:"🇭🇰"},{value:"hu",label:"🇭🇺 Hungary",name:"Hungary",flag:"🇭🇺"},{value:"in",label:"🇮🇳 India",name:"India",flag:"🇮🇳"},{value:"id",label:"🇮🇩 Indonesia",name:"Indonesia",flag:"🇮🇩"},{value:"ir",label:"🇮🇷 Iran",name:"Iran",flag:"🇮🇷"},{value:"iq",label:"🇮🇶 Iraq",name:"Iraq",flag:"🇮🇶"},{value:"ie",label:"🇮🇪 Ireland",name:"Ireland",flag:"🇮🇪"},{value:"it",label:"🇮🇹 Italy",name:"Italy",flag:"🇮🇹"},{value:"jp",label:"🇯🇵 Japan",name:"Japan",flag:"🇯🇵"},{value:"jo",label:"🇯🇴 Jordan",name:"Jordan",flag:"🇯🇴"},{value:"kz",label:"🇰🇿 Kazakhstan",name:"Kazakhstan",flag:"🇰🇿"},{value:"kr",label:"🇰🇷 Korea",name:"South Korea",flag:"🇰🇷"},{value:"kw",label:"🇰🇼 Kuwait",name:"Kuwait",flag:"🇰🇼"},{value:"lb",label:"🇱🇧 Lebanon",name:"Lebanon",flag:"🇱🇧"},{value:"ly",label:"🇱🇾 Libya",name:"Libya",flag:"🇱🇾"},{value:"my",label:"🇲🇾 Malaysia",name:"Malaysia",flag:"🇲🇾"},{value:"mx",label:"🇲🇽 Mexico",name:"Mexico",flag:"🇲🇽"},{value:"ma",label:"🇲🇦 Morocco",name:"Morocco",flag:"🇲🇦"},{value:"nl",label:"🇳🇱 Netherlands",name:"Netherlands",flag:"🇳🇱"},{value:"nz",label:"🇳🇿 New Zealand",name:"New Zealand",flag:"🇳🇿"},{value:"ng",label:"🇳🇬 Nigeria",name:"Nigeria",flag:"🇳🇬"},{value:"no",label:"🇳🇴 Norway",name:"Norway",flag:"🇳🇴"},{value:"om",label:"🇴🇲 Oman",name:"Oman",flag:"🇴🇲"},{value:"pk",label:"🇵🇰 Pakistan",name:"Pakistan",flag:"🇵🇰"},{value:"ps",label:"🇵🇸 Palestine",name:"Palestine",flag:"🇵🇸"},{value:"ph",label:"🇵🇭 Philippines",name:"Philippines",flag:"🇵🇭"},{value:"pl",label:"🇵🇱 Poland",name:"Poland",flag:"🇵🇱"},{value:"pt",label:"🇵🇹 Portugal",name:"Portugal",flag:"🇵🇹"},{value:"qa",label:"🇶🇦 Qatar",name:"Qatar",flag:"🇶🇦"},{value:"ro",label:"🇷🇴 Romania",name:"Romania",flag:"🇷🇴"},{value:"ru",label:"🇷🇺 Russia",name:"Russia",flag:"🇷🇺"},{value:"sa",label:"🇸🇦 Saudi Arabia",name:"Saudi Arabia",flag:"🇸🇦"},{value:"sg",label:"🇸🇬 Singapore",name:"Singapore",flag:"🇸🇬"},{value:"za",label:"🇿🇦 South Africa",name:"South Africa",flag:"🇿🇦"},{value:"es",label:"🇪🇸 Spain",name:"Spain",flag:"🇪🇸"},{value:"sd",label:"🇸🇩 Sudan",name:"Sudan",flag:"🇸🇩"},{value:"se",label:"🇸🇪 Sweden",name:"Sweden",flag:"🇸🇪"},{value:"ch",label:"🇨🇭 Switzerland",name:"Switzerland",flag:"🇨🇭"},{value:"sy",label:"🇸🇾 Syria",name:"Syria",flag:"🇸🇾"},{value:"tw",label:"🇹🇼 Taiwan",name:"Taiwan",flag:"🇹🇼"},{value:"th",label:"🇹🇭 Thailand",name:"Thailand",flag:"🇹🇭"},{value:"tn",label:"🇹🇳 Tunisia",name:"Tunisia",flag:"🇹🇳"},{value:"tr",label:"🇹🇷 Turkey",name:"Turkey",flag:"🇹🇷"},{value:"ua",label:"🇺🇦 Ukraine",name:"Ukraine",flag:"🇺🇦"},{value:"gb",label:"🇬🇧 UK",name:"United Kingdom",flag:"🇬🇧"},{value:"us",label:"🇺🇸 USA",name:"United States",flag:"🇺🇸"},{value:"ye",label:"🇾🇪 Yemen",name:"Yemen",flag:"🇾🇪"}]),H=async()=>{try{const M=await fetch("/api/countries");if(!M.ok)throw new Error("Failed to load countries");let D=await M.json();if(!D||D.length===0){console.log("Using static countries list");return}D=D.filter(Ke=>Ke.value!=="il"),D.some(Ke=>Ke.value==="ps")||D.push({value:"ps",label:"🇵🇸 Palestine",name:"Palestine",flag:"🇵🇸"}),D.some(Ke=>Ke.value==="eg")||D.push({value:"eg",label:"🇪🇬 Egypt",name:"Egypt",flag:"🇪🇬"}),D.sort((Ke,G)=>Ke.name.localeCompare(G.name)),P.value=[{value:"any",label:"🌍 Any Country",name:"Any Country",flag:"🌍"},...D],console.log("Countries loaded:",P.value.length),console.log("Filtered out Israel and ensured Palestine and Egypt are included"),B.value=[...pe.value],W.value=[...he.value]}catch(M){console.error("Failed to load countries list:",M)}},Z=N(null),$=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],k=N($[Math.floor(Math.random()*$.length)]),S=Me(),R=S.socket,{isConnected:I}=S,L=Na(),{peerConnection:K,remoteStream:V,localStream:me,connectionState:xe,isAudioMuted:ye,partnerId:ie,createOffer:lt,handleOffer:ot,handleAnswer:rt,handleIceCandidate:at,toggleMicrophone:Le,closeConnection:ke,restoreMicrophoneState:vt,diagnoseAndFixConnection:ee}=L,X=Zi(),oe=is(),de=N(oe.params.roomId||null);Re(()=>de.value,M=>{M&&(d.value=!0)},{immediate:!0});const pe=Ee(()=>P.value.filter(M=>M.value!=="any"&&!w.value.includes(M.value)&&!A.value.includes(M.value))),he=Ee(()=>P.value.filter(M=>M.value!=="any"&&!A.value.includes(M.value)&&!w.value.includes(M.value))),be=N(""),ve=N(!1),J=N(!1),De=N(""),Ie=N(null),bt=async()=>{await Le(),a.value=ye.value,n.value==="connected"&&setTimeout(()=>{const M=document.querySelector("audio");M&&M.paused&&M.play().catch(()=>{})},300)},St=async()=>{if(console.log("Finding next partner"),!me.value)try{await L.initializeLocalStream(),console.log("Microphone initialized")}catch(M){console.error("Failed to access microphone",M),alert("Please allow microphone access to use voice chat");return}if(R.value&&(R.value.emit("ping"),console.log("Sending ping to update activity status")),J.value){Un("Please wait before trying again");return}R.value&&(t.value?(console.log("Disconnecting from current partner"),ve.value=!0,R.value.emit("disconnect-partner",{reason:"skip"}),ke(),await(()=>new Promise(D=>{const q=()=>{L.connectionState.value==="closed"?(console.log("Connection successfully closed, proceeding to search"),D()):(console.log(`Waiting for connection to close, current state: ${L.connectionState.value}`),setTimeout(q,300))};setTimeout(q,500)}))(),n.value="searching",r.value="",console.log("Clearing partner data from UI"),t.value=null,o.value=null,x.value=[],console.log("Finding new partner with preferences"),R.value.emit("join-queue",{vibe:b.value,preferences:{preferredCountries:w.value.length?w.value:void 0,blockedCountries:A.value.length?A.value:void 0}}),g.value++,setTimeout(()=>{ve.value=!1},500)):(t.value=null,o.value=null,n.value="searching",r.value="",console.log("Finding new partner with preferences"),R.value.emit("join-queue",{vibe:b.value,preferences:{preferredCountries:w.value.length?w.value:void 0,blockedCountries:A.value.length?A.value:void 0}}),g.value++))},Jt=()=>{u.value=!u.value,u.value&&t.value&&X.markAsRead(t.value)},en=M=>{if(R.value&&t.value){const D=Ua();R.value.emit("chat-message",{id:D,text:M,to:t.value,timestamp:Date.now()}),x.value.push({id:D,message:M,isOwn:!0,timestamp:Date.now()})}},gt=M=>{if(console.log(`Selected game: ${M}`),R.value&&t.value){const D=`invite-${Date.now()}-${Math.floor(Math.random()*1e4)}`;R.value.emit("game-invite",{gameType:M,to:t.value,inviteId:D}),jt("Game invitation sent!","info")}else jt("Cannot send invitation - no partner connected","error")},yt=M=>{M&&!w.value.includes(M)&&w.value.push(M)},$n=M=>{w.value=w.value.filter(D=>D!==M)},tn=M=>{if(M&&!A.value.includes(M)){A.value.push(M);const D=Ct(M);console.log(`Added ${D} (${M}) to blocked countries list`),localStorage.setItem("blockedCountries",JSON.stringify(A.value))}},nn=M=>{A.value=A.value.filter(q=>q!==M);const D=Ct(M);console.log(`Removed ${D} (${M}) from blocked countries list`),localStorage.setItem("blockedCountries",JSON.stringify(A.value))},In=()=>{w.value=[],A.value=[],localStorage.removeItem("preferredCountries"),localStorage.removeItem("blockedCountries")},Pn=()=>{console.log("Applying filters with the following settings:"),console.log("- Blocked countries:",A.value.length?A.value:"None"),console.log("- Preferred countries:",w.value.length?w.value:"None"),v.value=!1,sn(),on(),Ue()},on=()=>{const M=document.createElement("div");M.className="fixed bottom-4 right-4 bg-emerald-600 text-white px-4 py-2 rounded-lg shadow-lg z-50",M.innerHTML=`
    <div class="flex items-center gap-2">
      <span>✓</span>
      <span>Filter settings applied successfully</span>
    </div>
  `,document.body.appendChild(M),setTimeout(()=>{M.classList.add("opacity-0","transition-opacity","duration-300"),setTimeout(()=>{document.body.removeChild(M)},300)},3e3)},rn=M=>{const D=P.value.find(q=>q.value===M);return D?D.flag:"🏳️"},Ct=M=>{const D=P.value.find(q=>q.value===M);return D?D.name:"Earth"},Mn=M=>new Date(M).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),Ot=(M,D,q)=>{M.value=!M.value,M.value&&(D.forEach(Ce=>Ce.value=!1),q!=null&&q.updatePositions&&mt(),q!=null&&q.resetSearch&&(q.resetSearch.query.value="",q.resetSearch.list.value=[...q.resetSearch.source]))},wt=M=>{M==="vibe"?(C.value=!C.value,T.value=!1,F.value=!1):M==="preferred"?Ka():M==="blocked"&&Ya()},Wn=M=>{b.value=M,C.value=!1},On=M=>{const D=E.find(q=>q.value===M);return D?D.emoji:"🌟"},an=M=>{const D=E.find(q=>q.value===M);return D?D.text:"Go With the Flow"},Nt=N(null),Lt=N(null),mt=()=>{da(()=>{var Ke,G;const M=(Ke=Nt.value)==null?void 0:Ke.getBoundingClientRect(),D=(G=Lt.value)==null?void 0:G.getBoundingClientRect(),q=document.querySelector(".preferred-outer"),Ce=document.querySelector(".blocked-outer");M&&q&&(q.style.left=`${M.left}px`,q.style.top=`${M.bottom+5}px`,q.style.width=`${M.width}px`),D&&Ce&&(Ce.style.left=`${D.left}px`,Ce.style.top=`${D.bottom+5}px`,Ce.style.width=`${D.width}px`)})},sn=()=>{localStorage.setItem("preferredCountries",JSON.stringify(w.value)),localStorage.setItem("blockedCountries",JSON.stringify(A.value))},ln=()=>{try{const M=localStorage.getItem("preferredCountries"),D=localStorage.getItem("blockedCountries");M&&(w.value=JSON.parse(M)),D&&(A.value=JSON.parse(D))}catch(M){console.error("Error loading filter settings:",M)}},Ue=()=>{R.value&&I.value?(console.log("Restarting matching with updated filters:",{preferredCountries:w.value,blockedCountries:A.value}),R.value.emit("startMatching",{preferredCountries:w.value.length>0?w.value:null,blockedCountries:A.value}),n.value="searching",r.value=""):console.warn("Cannot restart matching - socket not connected")};Re(n,M=>{console.log(`Connection status changed to: ${M}`),M==="connected"?(l&&clearInterval(l),l=setInterval(()=>{t.value&&xe.value!=="connected"&&(console.log("Connection health check: WebRTC not connected but partnerId exists"),["failed","closed","disconnected"].includes(xe.value)&&(console.log("Connection appears to be broken - resetting UI state"),n.value="disconnected",t.value=null,o.value=null))},2e3)):M==="disconnected"&&l&&(clearInterval(l),l=null)}),Ve(async()=>{var M,D,q,Ce,Ke;console.log("Home view mounted"),H();try{const G=localStorage.getItem("preferredCountries"),we=localStorage.getItem("blockedCountries");G&&(w.value=JSON.parse(G)),we&&(A.value=JSON.parse(we));const un=localStorage.getItem("autoReconnect");un&&(h.value=un==="true")}catch(G){console.error("Error loading saved preferences:",G)}R.value&&(R.value.on("filters-updated",G=>{G.success&&console.log("Filters updated successfully on server")}),R.value.on("user-location",G=>{console.log("Received user location:",G),G&&G.countryCode&&G.country?(Z.value=G,w.value.length===0&&G.countryCode!=="unknown"&&G.countryCode!=="earth"&&(console.log(`Adding user's country ${G.country} (${G.countryCode}) to preferred countries`),w.value.push(G.countryCode),sn()),console.log(`Your location: ${G.flag} ${G.country}`)):console.warn("Received incomplete location data:",G)}),R.value.on("online-count",G=>{let we;if(typeof G=="number")we=G;else if(typeof G=="object"&&G!==null&&"count"in G)we=G.count;else{console.error("Received invalid online count data:",G);return}console.log(`Received online count update: ${we}`),y.value=we}),R.value.on("online-count-update",G=>{console.log(`Received online count update via update event: ${G.count}`),y.value=G.count}),R.value.on("matched",G=>{console.log("Partner matched with event:",G),n.value="matched",r.value="",t.value=G.partnerId,o.value={id:G.partnerId,country:G.country||"Earth",countryCode:G.countryCode||"unknown",flag:G.flag||"🌍",vibe:G.vibe||"any"},p.value.unshift({id:Date.now().toString(),country:o.value.country,flag:o.value.flag,timestamp:Date.now()}),p.value.length>3&&(p.value=p.value.slice(0,3)),G.partnerId&&(console.log("Initiating WebRTC connection with partner immediately"),lt(G.partnerId),setTimeout(()=>{n.value==="matched"&&xe.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),n.value="connected")},2e3))}),R.value.on("direct-connection-established",G=>{console.log("Direct connection established:",G),n.value="connected",t.value=G.partnerId,o.value={id:G.partnerId,country:G.country||"Earth",countryCode:G.countryCode||"unknown",flag:G.flag||"🌍"}}),R.value.on("user-skipped",G=>{console.log("User skipped event received",G),Ut("disconnecting",{reason:"disconnected",message:"The other user disconnected"})}),R.value.on("user-disconnected",G=>{console.log("User disconnected event received",G);let we;G.reason==="connection-lost"?we="The other user's connection was lost":we="The other user disconnected",Ut("disconnecting",{reason:"disconnected",message:we})}),R.value.on("skip-confirmed",G=>{console.log("Skip confirmed by server:",G)}),R.value.on("disconnect-confirmed",G=>{console.log("Disconnect confirmed by server:",G)}),R.value.on("chat-message",G=>{x.value.push({id:G.id||Date.now().toString(),message:G.text||G.message||"",isOwn:!1,timestamp:G.timestamp||Date.now()}),G.id&&G.from&&R.value&&(console.log(`Sending receipt confirmation for message ${G.id}`),R.value.emit("message-received",{id:G.id,to:G.from}))}),R.value.on("error",G=>{if(console.error("Socket error:",G),G.type==="rate-limit"){const we=G.waitTime||60;Un(`Please wait ${we} seconds before trying again`,3e3),n.value==="searching"&&(n.value="disconnected")}}),R.value.on("voice-offer",st),R.value.on("voice-answer",cn),R.value.on("ice-candidate",Nn),R.value.emit("get-online-count"),setTimeout(()=>{h.value&&n.value==="disconnected"&&(console.log("Auto-call is enabled - automatically finding a partner"),St())},1e3),R.value.on("queue-join-error",G=>{if(console.error("Queue join error:",G),G.reason==="rate-limited"){const we=G.waitTime||60;Un(`Please wait ${we} seconds before trying to connect again`,3e3),n.value==="searching"&&(n.value="disconnected")}}),(M=R.value)==null||M.on("game-invite",G=>{console.log(`[Game] Received game invitation for ${G.gameType} from ${G.from}`),m.value.push({id:G.inviteId||`invite-${Date.now()}`,gameType:G.gameType,from:G.from,timestamp:Date.now()});const we=new Audio("/sounds/game-invite.mp3");we.volume=.7,we.play().catch(un=>console.log("Error playing sound",un)),"vibrate"in navigator&&navigator.vibrate([200,100,400])}),(D=R.value)==null||D.on("game-invite-accepted",G=>{var we;console.log(`[Game] ${G.from} accepted your game invitation for ${G.gameType}`),jt("Invitation accepted!","success"),t.value=G.from,d.value=!0,(we=R.value)==null||we.emit("game-join",{gameType:G.gameType,partnerId:G.from})}),(q=R.value)==null||q.on("game-invite-declined",G=>{console.log(`[Game] ${G.from} declined your game invitation`),jt("Invitation declined","error")}),(Ce=R.value)==null||Ce.on("game-invite-timeout",G=>{console.log(`[Game] Game invitation ${G.inviteId} timed out`),jt("Invitation expired","info")}),(Ke=R.value)==null||Ke.on("game-join-confirmed",G=>{console.log(`[Game] Join confirmed for game ${G.gameType} in room ${G.roomId}`)})),document.addEventListener("click",Jo),window.addEventListener("resize",mt),document.addEventListener("scroll",mt,!0),ln(),await vt(),a.value=ye.value,window.addEventListener("connection-closed",()=>{console.log("Connection-closed event detected in HomeView")}),window.addEventListener("connection-state-changed",G=>{if(console.log("Connection state changed event received:",G.detail),(G.detail.state==="disconnected"||G.detail.state==="failed")&&n.value!=="disconnected"&&n.value!=="disconnecting"){const we=G.detail.temporary?"Connection temporarily lost. Trying to reconnect...":"Connection lost. The call has ended.";Ut("disconnecting",{reason:G.detail.reason||"network-disconnect",message:we,temporary:G.detail.temporary})}}),window.addEventListener("queue-status-changed",er)}),Lo(()=>{console.log("Home view unmounting, cleaning up connection"),ke(),l&&(clearInterval(l),l=null),R.value&&(R.value.off("online-count"),R.value.off("matched"),R.value.off("direct-connection-established"),R.value.off("user-skipped"),R.value.off("user-disconnected"),R.value.off("skip-confirmed"),R.value.off("disconnect-confirmed"),R.value.off("queue-join-error"),R.value.off("chat-message"),R.value.off("error"),R.value.off("voice-offer"),R.value.off("voice-answer"),R.value.off("ice-candidate"),R.value.off("online-count-update"),R.value.off("game-invite"),R.value.off("game-invite-accepted"),R.value.off("game-invite-declined"),R.value.off("game-invite-timeout"),R.value.off("game-join-confirmed")),document.removeEventListener("click",Jo),window.removeEventListener("resize",mt),document.removeEventListener("scroll",mt,!0),window.removeEventListener("connection-closed",()=>{}),Ie.value&&(clearTimeout(Ie.value),Ie.value=null),window.removeEventListener("queue-status-changed",er)});const st=async M=>{console.log("Received voice offer - forwarding to WebRTC service"),ot(M.offer,M.from)},cn=async M=>{console.log("Received voice answer - forwarding to WebRTC service"),rt(M.answer)},Nn=async M=>{console.log("Received ICE candidate - forwarding to WebRTC service"),at(M.candidate)};Re(xe,M=>{console.log(`WebRTC connection state changed to: ${M}`),M==="connected"?n.value==="matched"&&Ut("connected"):["failed","closed","disconnected"].includes(M)&&(console.log(`WebRTC connection is now ${M}, updating UI if needed`),t.value&&n.value!=="disconnected"&&n.value!=="disconnecting"&&Ut("disconnecting",{reason:M==="disconnected"?"network-disconnect":"disconnected",message:M==="disconnected"?"Connection lost. Trying to reconnect...":"Connection closed."}))});const Ln=N(null),Jo=M=>{const D=M.target;if(Ln.value&&!Ln.value.contains(D)&&(C.value=!1),T.value){const q=Nt.value,Ce=document.querySelector(".preferred-outer");q&&Ce&&!q.contains(D)&&!Ce.contains(D)&&(T.value=!1)}if(F.value){const q=Lt.value,Ce=document.querySelector(".blocked-outer");q&&Ce&&!q.contains(D)&&!Ce.contains(D)&&(F.value=!1)}};function Ga(){R.value&&(R.value.emit("join-queue",{vibe:b.value,preferences:{preferredCountries:w.value.length?w.value:void 0,blockedCountries:A.value.length?A.value:void 0}}),n.value="searching",console.log("Manual retry initiated, keeping auto-reconnect off"))}Re(h,M=>{localStorage.setItem("autoReconnect",M.toString()),M&&n.value==="disconnected"&&(console.log("Auto-call enabled - automatically finding a partner"),St())}),Re(()=>n.value,M=>{M==="searching"&&(r.value="")});function Un(M,D=3e3){De.value=M,J.value=!0,Ie.value&&clearTimeout(Ie.value),Ie.value=window.setTimeout(()=>{J.value=!1,De.value="",Ie.value=null},D)}const er=M=>{const D=M;D.detail&&D.detail.status==="timeout"&&(console.log("Queue timeout detected, disabling auto-reconnect"),h.value=!1,n.value="disconnected")},Va=()=>{if(he.value)if(_.value.trim()==="")W.value=[...he.value];else{const M=_.value.toLowerCase().trim();W.value=he.value.filter(D=>D.name.toLowerCase().includes(M)||D.value.toLowerCase().includes(M))}},Ka=()=>{Ot(T,[F,C],{updatePositions:!0,resetSearch:{query:z,list:B,source:pe.value}})},Ya=()=>{Ot(F,[T,C],{updatePositions:!0,resetSearch:{query:_,list:W,source:he.value}})},Ut=(M,D={})=>{if(console.log(`Handling connection state change to: ${M} with reason: ${D.reason||"none"}`),M==="disconnecting"){if(be.value=D.reason||"disconnected",D.message&&(r.value=D.message,setTimeout(()=>{r.value=""},5e3)),n.value="disconnecting",!D.temporary){const q=D.skipDelay?0:2e3;setTimeout(()=>{n.value==="disconnecting"&&(t.value=null,o.value=null,n.value="disconnected",be.value="",r.value="",ke(),h.value&&(console.log("Auto-call is enabled - finding new partner after disconnection"),setTimeout(()=>{n.value==="disconnected"&&h.value&&(console.log("Auto-call: Starting new call automatically"),St())},1e3)))},q)}}else n.value=M,M==="searching"&&(r.value="")},Xa=M=>{console.log(`Accepting game invitation: ${M.gameType} from ${M.from}`),m.value=m.value.filter(D=>D.id!==M.inviteId),R.value&&(R.value.emit("game-invite-accept",{inviteId:M.inviteId,gameType:M.gameType,to:M.from}),t.value=M.from,d.value=!0,R.value.emit("game-join",{gameType:M.gameType,partnerId:M.from}))},Qa=M=>{console.log(`Declining game invitation from ${M.from}`),m.value=m.value.filter(D=>D.id!==M.inviteId),R.value&&R.value.emit("game-invite-decline",{inviteId:M.inviteId,to:M.from})},Za=M=>{if(console.log(`Game invitation timed out: ${M.inviteId}`),m.value=m.value.filter(D=>D.id!==M.inviteId),R.value){const D=m.value.find(q=>q.id===M.inviteId);D&&R.value.emit("game-invite-timeout",{inviteId:M.inviteId,to:D.from})}},jt=(M,D="info")=>{const q=document.createElement("div");let Ce="bg-blue-600";D==="success"&&(Ce="bg-emerald-600"),D==="error"&&(Ce="bg-red-600"),q.className=`fixed bottom-4 right-4 ${Ce} text-white px-4 py-2 rounded-lg shadow-lg z-50 animate-fade-in`,q.style.animationDuration="0.3s",q.innerHTML=M,document.body.appendChild(q),setTimeout(()=>{q.style.opacity="0",q.style.transition="opacity 0.3s ease",setTimeout(()=>{document.body.removeChild(q)},300)},3e3)};return(M,D)=>(U(),j("div",wf,[D[41]||(D[41]=ft('<div class="fixed inset-0 pointer-events-none" data-v-7fd665e9><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-7fd665e9></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-7fd665e9></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-7fd665e9></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-7fd665e9></div></div>',1)),Je(Ld),i("div",Ef,[i("header",_f,[i("div",Af,[D[21]||(D[21]=ft('<div class="text-center mb-2 sm:mb-4" data-v-7fd665e9><div class="inline-flex items-center gap-2" data-v-7fd665e9><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-7fd665e9><span class="text-white text-xs" data-v-7fd665e9>✨</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-7fd665e9> SpaceTalk.live </h1></div></div>',1)),i("div",Bf,[i("div",Tf,[D[20]||(D[20]=i("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),i("span",null,Y(y.value)+" online",1)]),g.value>0?(U(),j("div",kf," Today: "+Y(g.value)+" voices ",1)):ne("",!0)]),i("div",Df,[i("div",{class:"relative",ref_key:"vibeDropdownRef",ref:Ln},[i("div",{onClick:D[0]||(D[0]=q=>wt("vibe")),class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[i("span",Ff,Y(On(b.value))+" "+Y(an(b.value)),1),i("span",{class:se(["ml-2 text-xs transition-transform duration-300",{"rotate-180":C.value}])},"▼",2)]),C.value?(U(),j("div",Sf,[i("div",Rf,[(U(),j(Be,null,We(E,q=>i("div",{key:q.value,onClick:Ce=>Wn(q.value),class:se(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":b.value===q.value}])},[i("span",If,Y(q.emoji),1),i("span",null,Y(q.text),1)],10,$f)),64))])])):ne("",!0)],512),i("button",{onClick:D[1]||(D[1]=q=>v.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," 🔍 Filters ")])])]),i("main",Pf,[i("div",Mf,[Je(yl,{status:n.value,"partner-info":o.value,"error-message":r.value,"disconnect-reason":be.value,"show-status":!0},null,8,["status","partner-info","error-message","disconnect-reason"]),Je(Zd,{onRetry:Ga}),i("div",Wf,[i("div",Of,[Pt(i("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":D[2]||(D[2]=q=>h.value=q),class:"opacity-0 w-0 h-0 absolute"},null,512),[[ss,h.value]]),i("label",{for:"auto-reconnect",class:se(["toggle-label block overflow-hidden h-5 rounded-full bg-gray-700 border border-gray-600 cursor-pointer transition-all duration-300",{"bg-gradient-to-r from-indigo-500 to-purple-500 border-indigo-400":h.value}])},[i("span",{class:se(["dot absolute top-0.5 left-0.5 bg-white w-4 h-4 rounded-full transition-all duration-300 shadow-md",{"transform translate-x-5 bg-white":h.value}])},null,2)],2)]),i("label",{for:"auto-reconnect",class:se(["text-xs font-medium cursor-pointer transition-colors duration-300",h.value?"text-indigo-300":"text-gray-400"])}," Auto-call ",2)]),Je(Fl,{"is-muted":a.value,"is-disabled":n.value!=="connected",onToggleMute:bt,onFindNext:St,onToggleChat:Jt,onToggleGames:D[3]||(D[3]=q=>d.value=!0),onToggleHistory:D[4]||(D[4]=q=>c.value=!0),onToggleDonation:D[5]||(D[5]=q=>s.value=!0)},null,8,["is-muted","is-disabled"]),i("div",Nf,[i("p",Lf,'"'+Y(k.value)+'"',1)])])]),i("footer",Uf,[i("div",jf,[D[25]||(D[25]=i("h3",{class:"text-sm font-semibold text-emerald-400"},"Community Guidelines",-1)),D[26]||(D[26]=i("div",{class:"text-xs text-gray-300 space-y-0.5 sm:space-y-1"},[i("p",null,"• Must be 18+ years old to use this service"),i("p",null,"• Be respectful and kind to other users"),i("p",null,"• No harassment, hate speech, or inappropriate content"),i("p",null,"• Report any misconduct using the report feature"),i("p",null,"• Your privacy and safety are our priority")],-1)),D[27]||(D[27]=i("p",{class:"text-xs text-gray-400 mt-2 sm:mt-3"}," By using SpaceTalk.live, you agree to follow these guidelines ",-1)),i("div",Hf,[i("a",{href:"#",onClick:D[6]||(D[6]=Oo(q=>f.value=!0,["prevent"])),class:"bg-cyan-500/20 border border-cyan-500/30 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20 text-center"}," ℹ️ About "),D[22]||(D[22]=i("a",{href:"https://instagram.com",target:"_blank",class:"bg-pink-500/20 border border-pink-500/30 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20 text-center"}," 📷 Instagram ",-1)),D[23]||(D[23]=i("a",{href:"https://facebook.com",target:"_blank",class:"bg-blue-500/20 border border-blue-500/30 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20 text-center"}," 📘 Facebook ",-1)),D[24]||(D[24]=i("a",{href:"mailto:Info@spacetalk.live",class:"bg-emerald-500/20 border border-emerald-500/30 rounded-full px-2 py-1 sm:px-3 sm:py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20 text-center"}," 📧 Contact ",-1))])])])]),c.value?(U(),j("div",qf,[i("div",zf,[i("div",Gf,[D[28]||(D[28]=i("h2",{class:"text-lg font-semibold text-indigo-400"},"📞 Call History",-1)),i("button",{onClick:D[7]||(D[7]=q=>c.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),i("div",Vf,[p.value.length===0?(U(),j("div",Kf,D[29]||(D[29]=[i("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),i("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(U(!0),j(Be,{key:1},We(p.value,(q,Ce)=>(U(),j("div",{key:q.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[i("div",Yf,[i("span",Xf,Y(q.flag),1),i("div",null,[i("p",Qf,Y(q.country),1),i("p",Zf,Y(Mn(q.timestamp)),1)])]),i("div",Jf," #"+Y(Ce+1),1)]))),128))]),p.value.length>0?(U(),j("p",ex," History clears when you leave the page ")):ne("",!0)])])):ne("",!0),v.value?(U(),j("div",tx,[i("div",nx,[i("div",ox,[D[30]||(D[30]=i("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),i("button",{onClick:D[8]||(D[8]=q=>v.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),i("div",rx,[i("div",null,[D[32]||(D[32]=i("label",{class:"block text-sm font-medium mb-3 text-emerald-400"},"Preferred Countries",-1)),i("div",ax,[w.value.length===0?(U(),j("p",sx,"No countries selected")):(U(),j("div",ix,[(U(!0),j(Be,null,We(w.value,q=>(U(),j("span",{key:q,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[i("span",lx,Y(rn(q)),1),ze(" "+Y(Ct(q))+" ",1),i("button",{onClick:Ce=>$n(q),class:"text-emerald-200 hover:text-white ml-1"}," ✕ ",8,cx)]))),128))]))]),i("div",{class:"mt-2 relative preferred-dropdown",ref_key:"preferredDropdownRef",ref:Nt},[i("div",{onClick:D[9]||(D[9]=q=>wt("preferred")),class:"cursor-pointer flex items-center justify-between w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-sm text-white"},D[31]||(D[31]=[i("span",{class:"text-gray-300"},"Add preferred country...",-1),i("span",{class:"ml-1"},"▼",-1)]))],512),Je(uf,{"preferred-countries":w.value,"blocked-countries":A.value,"online-users":y.value,countries:P.value},null,8,["preferred-countries","blocked-countries","online-users","countries"]),D[33]||(D[33]=i("p",{class:"text-xs text-gray-400 mt-2"},"You'll be matched only with users from these countries",-1))]),i("div",null,[D[35]||(D[35]=i("label",{class:"block text-sm font-medium mb-3 text-red-400"},"Blocked Countries",-1)),i("div",ux,[A.value.length===0?(U(),j("p",dx,"No countries blocked")):(U(),j("div",fx,[(U(!0),j(Be,null,We(A.value,q=>(U(),j("span",{key:q,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[i("span",xx,Y(rn(q)),1),ze(" "+Y(Ct(q))+" ",1),i("button",{onClick:Ce=>nn(q),class:"text-red-200 hover:text-white ml-1"}," ✕ ",8,vx)]))),128))]))]),i("div",{class:"mt-2 relative blocked-dropdown",ref_key:"blockedDropdownRef",ref:Lt},[i("div",{onClick:D[10]||(D[10]=q=>wt("blocked")),class:"cursor-pointer flex items-center justify-between w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-sm text-white"},D[34]||(D[34]=[i("span",{class:"text-gray-300"},"Add blocked country...",-1),i("span",{class:"ml-1"},"▼",-1)]))],512),D[36]||(D[36]=i("p",{class:"text-xs text-gray-400 mt-2"},"You won't be matched with users from these countries",-1))])]),i("div",{class:"flex gap-2 mt-8"},[i("button",{onClick:In,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-3 px-4 rounded-lg text-sm transition-colors"}," Clear All "),i("button",{onClick:Pn,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-3 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):ne("",!0),T.value?(U(),j("div",gx,[i("div",mx,[i("div",px,[Pt(i("input",{"onUpdate:modelValue":D[11]||(D[11]=q=>z.value=q),type:"text",placeholder:"Search countries...",class:"w-full px-3 py-2 bg-gray-800 rounded text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500",onInput:D[12]||(D[12]=(...q)=>M.updateCountrySearch&&M.updateCountrySearch(...q))},null,544),[[Xt,z.value]])]),pe.value.length===0?(U(),j("div",hx,"No more countries available")):ne("",!0),(U(!0),j(Be,null,We(B.value,q=>(U(),j("div",{key:q.value,onClick:()=>{yt(q.value),wt("preferred")},class:"cursor-pointer px-3 py-2 hover:bg-gray-600 flex items-center gap-2"},[i("span",yx,Y(q.flag),1),i("span",Cx,Y(q.name),1)],8,bx))),128))])])):ne("",!0),F.value?(U(),j("div",wx,[i("div",Ex,[i("div",_x,[Pt(i("input",{"onUpdate:modelValue":D[13]||(D[13]=q=>_.value=q),type:"text",placeholder:"Search countries...",class:"w-full px-3 py-2 bg-gray-800 rounded text-sm text-white focus:outline-none focus:ring-2 focus:ring-red-500",onInput:Va},null,544),[[Xt,_.value]])]),he.value.length===0?(U(),j("div",Ax,"No more countries available")):ne("",!0),(U(!0),j(Be,null,We(W.value,q=>(U(),j("div",{key:q.value,onClick:()=>{tn(q.value),wt("blocked")},class:"cursor-pointer px-3 py-2 hover:bg-gray-600 flex items-center gap-2"},[i("span",Tx,Y(q.flag),1),i("span",kx,Y(q.name),1)],8,Bx))),128))])])):ne("",!0),Je(jl,{"is-open":u.value,onClose:D[14]||(D[14]=q=>u.value=!1),messages:x.value,onSendMessage:en,"is-connected":n.value==="connected"},null,8,["is-open","messages","is-connected"]),Je(Rd,{"is-open":d.value,onClose:D[15]||(D[15]=q=>d.value=!1),"is-connected":n.value==="connected",onSelectGame:gt,"partner-id":t.value||"","initial-game-room-id":de.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),Je(Wd,{"is-open":s.value,onClose:D[16]||(D[16]=q=>s.value=!1)},null,8,["is-open"]),f.value?(U(),j("div",Dx,[i("div",Fx,[i("div",Sx,[D[37]||(D[37]=i("div",{class:"flex items-center gap-2"},[i("div",{class:"w-8 h-8 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50"},[i("span",{class:"text-white text-lg"},"✨")]),i("h2",{class:"text-xl font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg"}," About SpaceTalk ")],-1)),i("button",{onClick:D[17]||(D[17]=q=>f.value=!1),class:"text-gray-400 hover:text-white text-xl transition-colors"}," ✕ ")]),i("div",Rx,[D[38]||(D[38]=ft('<p class="text-lg font-medium text-center mb-6 text-cyan-300" data-v-7fd665e9> SpaceTalk — where strangers become voices in the void... and maybe new friends. </p><div class="bg-purple-900/30 p-4 rounded-lg border border-purple-500/20" data-v-7fd665e9><p class="mb-4" data-v-7fd665e9>Tired of endless scrolling?</p><p class="mb-4" data-v-7fd665e9>Sick of typing and deleting that message 5 times?</p><p class="mb-4" data-v-7fd665e9>Yeah — us too.</p><p class="mt-6" data-v-7fd665e9>That&#39;s why we built SpaceTalk: a place where you can simply call someone, talk, and see where the conversation goes. No profiles, no DMs, no filters — just your voice and theirs, connected across the stars (well, the internet, but stars sound cooler ✨).</p></div>',2)),i("div",$x,[i("button",{onClick:D[18]||(D[18]=q=>f.value=!1),class:"bg-gradient-to-r from-cyan-500 to-blue-500 hover:from-cyan-600 hover:to-blue-600 text-white px-6 py-3 rounded-full text-sm font-medium transition-all shadow-lg shadow-cyan-500/30"}," Start Talking Now ")])])])])):ne("",!0),n.value==="connected"?(U(),j("div",Ix,[Je(Hd,{showControls:!1})])):ne("",!0),(U(!0),j(Be,null,We(m.value,q=>(U(),gn(Cf,{key:q.id,"invite-id":q.id,"game-type":q.gameType,from:q.from,onAccept:Xa,onDecline:Qa,onTimeout:Za},null,8,["invite-id","game-type","from"]))),128)),J.value?(U(),j("div",Px,[i("div",Mx,[i("div",Wx,[D[39]||(D[39]=i("div",{class:"w-20 h-20 mx-auto mb-4 rounded-full bg-purple-800 flex items-center justify-center"},[i("span",{class:"text-3xl"},"⏱️")],-1)),D[40]||(D[40]=i("p",{class:"text-white text-lg font-semibold mb-1"},"Rate Limit Reached",-1)),i("p",Ox,Y(De.value),1)]),i("div",Nx,[i("button",{onClick:D[19]||(D[19]=q=>J.value=!1),class:"bg-purple-700 hover:bg-purple-600 text-white px-6 py-2 rounded-full text-sm transition-colors duration-300"}," OK ")])])])):ne("",!0)]))}});const ca=nt(Lx,[["__scopeId","data-v-7fd665e9"]]),Ux=ls({history:cs("/"),routes:[{path:"/",name:"home",component:ca},{path:"/game/:roomId",name:"game",component:ca,props:!0}]}),za=us(ps);za.use(Ux);za.mount("#app");
//# sourceMappingURL=index-1fa489aa.js.map
