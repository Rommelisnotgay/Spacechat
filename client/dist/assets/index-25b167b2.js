import{d as ne,c as g,a as ae,u as St,o as v,R as _t,r as f,b as ie,e as ve,s as Ee,w as le,f as re,g as e,t as G,h as J,n as X,F as me,i as pe,j as It,k as De,v as et,l as Wt,m as $e,p as Ae,q as de,x as Ge,y as Ne,z as Et,T as At,A as qe,B as Gt,C as Pt,D as jt,E as Ot,G as Dt,H as Mt}from"./vue-vendor-7cdb6cd3.js";import{l as Nt}from"./socket-vendor-d9998155.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))d(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const u of s.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&d(u)}).observe(document,{childList:!0,subtree:!0});function n(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function d(l){if(l.ep)return;l.ep=!0;const s=n(l);fetch(l.href,s)}})();const Ft={class:"app-container"},Lt=ne({__name:"App",setup(t){return(i,n)=>(v(),g("div",Ft,[ae(St(_t))]))}});const Vt=()=>window.location.origin,H=f(null),ye=f(null),Ce=f(!1);function be(){ie(()=>{H.value||t()}),ve(()=>{H.value&&n()});function t(){const l=Vt();console.log(`Connecting to socket server at: ${l}`),H.value=Nt(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,transports:["websocket","polling"]}),i()}function i(){H.value&&(H.value.on("connect",()=>{var l,s;console.log("Socket connected"),Ce.value=!0,(l=H.value)==null||l.emit("user:identify",{},u=>{console.log("Identified with server, user ID:",u),ye.value=u}),(s=H.value)==null||s.emit("get-online-count")}),H.value.on("disconnect",()=>{console.log("Socket disconnected"),Ce.value=!1}),H.value.on("reconnect",l=>{var s;console.log(`Socket reconnected after ${l} attempts`),Ce.value=!0,ye.value&&((s=H.value)==null||s.emit("user:identify",{prevUserId:ye.value},u=>{var r;console.log("Re-identified with server after reconnection, user ID:",u),ye.value=u,(r=H.value)==null||r.emit("get-online-count")}))}),H.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),H.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),H.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{Ce.value||(console.log("Attempting to reinitialize socket connection..."),n(),t())},5e3)}),H.value.on("error",l=>{console.error("Socket error:",l)}),H.value.on("user-id",l=>{console.log("Received user ID from server:",l),ye.value=l}))}function n(){H.value&&(H.value.off("connect"),H.value.off("disconnect"),H.value.off("reconnect"),H.value.off("reconnect_attempt"),H.value.off("reconnect_error"),H.value.off("reconnect_failed"),H.value.off("error"),H.value.off("user-id"))}function d(){H.value?(console.log("Forcing socket reconnection..."),H.value.disconnect(),H.value.connect()):t()}return{socket:H,isConnected:Ce,userId:ye,reconnect:d}}const Ut={iceServers:[{urls:["turn:relay.metered.ca:443?transport=tcp","turn:relay.metered.ca:443","turn:relay.metered.ca:80"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:80"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};let C=null,O=null,D=null;const Q=f("new"),fe=f(!1),ke=f(null),j=!0;let ee="",Se="",te=!1,se=!1,K=0;const oe=10;let he=[],xe=null,we=null;const Bt=3e3,zt=5e3,Ye=8e3,He=500;async function qt(){if(!C)return{error:"No peer connection available"};try{const t={};return(await C.getStats()).forEach(n=>{n.type==="transport"?t.transport={bytesReceived:n.bytesReceived,bytesSent:n.bytesSent,dtlsState:n.dtlsState,selectedCandidatePairId:n.selectedCandidatePairId}:n.type==="candidate-pair"&&n.selected?t.selectedCandidatePair={localCandidateId:n.localCandidateId,remoteCandidateId:n.remoteCandidateId,state:n.state,availableOutgoingBitrate:n.availableOutgoingBitrate}:n.type==="local-candidate"||n.type==="remote-candidate"?(t.candidates||(t.candidates=[]),t.candidates.push({type:n.type,id:n.id,ip:n.ip,port:n.port,protocol:n.protocol,candidateType:n.candidateType})):(n.type==="media-source"||n.type==="track"||n.type==="media-playout")&&(t.media||(t.media=[]),t.media.push({type:n.type,id:n.id,kind:n.kind,audioLevel:n.audioLevel,trackIdentifier:n.trackIdentifier}))}),t}catch(t){return console.error("[WebRTC] Error getting stats:",t),{error:"Failed to get stats: "+t}}}let _e={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:relay.metered.ca:80","turn:relay.metered.ca:443"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};const Yt={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Ht={iceTransportPolicy:"relay",iceCandidatePoolSize:10,iceServers:[{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:relay.metered.ca:80","turn:relay.metered.ca:443"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:["turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Ke={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]},{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};function Me(){const{socket:t,userId:i}=be(),n=Ee(C),d=Ee(O),l=Ee(D),s=Q,u=fe,r=ke;f({echoCancellation:!0,noiseSuppression:!0});const m=async()=>{try{if(O){j&&console.log("[WebRTC] Using existing local stream");const a=O.getAudioTracks();if(a.length===0||!a[0].enabled)j&&console.log("[WebRTC] Existing stream has no active audio tracks, requesting new stream"),O.getTracks().forEach(b=>b.stop()),O=null;else return O}j&&console.log("[WebRTC] Requesting access to microphone with specific constraints");const o=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:2},video:!1});if(o.getAudioTracks().length===0)throw console.error("[WebRTC] No audio tracks found in stream"),new Error("No audio tracks available");return j&&(console.log("[WebRTC] Local stream acquired successfully"),console.log("[WebRTC] Audio tracks:",o.getAudioTracks().length),o.getAudioTracks().forEach(b=>{console.log(`[WebRTC] Track: ${b.label}, enabled: ${b.enabled}, muted: ${b.muted}, readyState: ${b.readyState}`),console.log("[WebRTC] Track settings:",JSON.stringify(b.getSettings()))})),o.getTracks().forEach(a=>{a.enabled=!0}),O=o,d.value=o,o}catch(o){console.error("[WebRTC] Error accessing microphone:",o);try{j&&console.log("[WebRTC] Trying fallback with simpler constraints");const a=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});if(a.getAudioTracks().length===0)throw new Error("No audio tracks available");return O=a,d.value=a,a}catch(a){throw console.error("[WebRTC] Fallback also failed:",a),new Error("Could not access microphone. Please check permissions.")}}},p=()=>{if(C&&C.connectionState!=="closed"&&C.connectionState!=="failed"&&C.connectionState!=="disconnected")return console.log("[WebRTC] Reusing existing peer connection"),C;console.log("[WebRTC] Creating new peer connection with TURN servers"),C&&c();const o=new RTCPeerConnection(Ut);return D||(D=new MediaStream,l.value=D),k(o),o.ontrack=a=>{console.log("[WebRTC] Track received:",a.track.kind),a.track.kind==="audio"&&(console.log("[WebRTC] Adding remote audio track to stream"),D||(D=new MediaStream),D.addTrack(a.track),l.value=D,a.track.enabled=!0)},o.onconnectionstatechange=()=>{if(console.log("[WebRTC] Connection state changed:",o.connectionState),o.connectionState==="connecting"&&Q.value==="connected"&&D&&D.getAudioTracks().length>0&&D.getAudioTracks().some(b=>b.enabled)){console.log('[WebRTC] Ignoring state change to "connecting" because audio is working');return}if(o.connectionState==="connecting"&&Q.value==="matched"){console.log("[WebRTC] Still in negotiation phase, keeping matched state");return}if(Q.value=o.connectionState||"new",s.value=o.connectionState||"new",o.connectionState==="connected")console.log("[WebRTC] Connection established"),K=0,y(),setTimeout(()=>{$();const a=D&&D.getAudioTracks().length>0&&D.getAudioTracks().some(b=>b.readyState==="live");console.log(`[WebRTC] Audio tracks working: ${a}`),setTimeout(()=>{o.connectionState==="connected"&&($(),Q.value==="matched"&&(console.log("[WebRTC] Updating state from matched to connected"),Q.value="connected",s.value="connected"))},1e3)},300),V();else if(o.connectionState==="failed")Se="Connection failed",K<oe&&!se?(K++,console.log(`[WebRTC] Connection failed, attempting recovery (${K}/${oe})`),_()):console.error("[WebRTC] Connection failed and max retries reached");else if(o.connectionState==="disconnected"){if(D&&D.getAudioTracks().length>0&&D.getAudioTracks().some(b=>b.readyState==="live")){console.log("[WebRTC] Connection reported as disconnected but audio still works, not changing state"),!se&&K<oe&&(K++,console.log(`[WebRTC] Silent connection recovery (${K}/${oe})`),setTimeout(()=>{(o.connectionState==="disconnected"||o.connectionState==="failed")&&(console.log("[WebRTC] Attempting silent recovery"),_())},1e3));return}setTimeout(()=>{o.connectionState==="disconnected"&&!se&&K<oe&&(K++,console.log(`[WebRTC] Connection disconnected, attempting recovery (${K}/${oe})`),_())},1e3)}else o.connectionState==="closed"&&(q(),R())},o.oniceconnectionstatechange=()=>{console.log("[WebRTC] ICE connection state changed:",o.iceConnectionState),o.iceConnectionState==="failed"?(Se="ICE connection failed",!se&&K<oe&&(K++,console.log(`[WebRTC] ICE connection failed, attempting restart (${K}/${oe})`),se=!0,setTimeout(async()=>{if(o.connectionState!=="closed")try{j&&console.log("[WebRTC] Attempting ICE restart");const a=await o.createOffer({iceRestart:!0});await o.setLocalDescription(a),t.value&&r.value&&t.value.emit("voice-offer",{offer:o.localDescription,to:r.value}),setTimeout(()=>{se=!1},5e3)}catch(a){console.error("[WebRTC] ICE restart failed:",a),se=!1}else se=!1},1e3))):o.iceConnectionState==="connected"&&$()},o.onicecandidate=a=>{if(!a.candidate){console.log("[WebRTC] ICE gathering complete");return}console.log("[WebRTC] ICE candidate generated:",a.candidate.candidate),t.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),t.value.emit("ice-candidate",{candidate:a.candidate,to:r.value}))},o.onicegatheringstatechange=()=>{console.log("[WebRTC] ICE gathering state changed:",o.iceGatheringState)},o.onsignalingstatechange=()=>{console.log("[WebRTC] Signaling state changed:",o.signalingState),o.signalingState==="stable"&&(te=!1)},C=o,n.value=o,o},I=async o=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),!o){const a="Cannot create offer: No target partner ID provided";return console.error(`[WebRTC] ${a}`),ee=a,{error:a}}if(!t.value){const a="Cannot create offer: socket not available";return console.error(`[WebRTC] ${a}`),ee=a,{error:a}}if(!O)try{j&&console.log("[WebRTC] Initializing local stream before creating offer"),await m()}catch(a){return console.error("[WebRTC] Failed to initialize local stream:",a),ee=`Failed to access microphone: ${a}`,{error:`Failed to access microphone: ${a}`}}if(console.log(`[WebRTC] Creating offer for partner: ${o}`),te)return console.warn("[WebRTC] Negotiation already in progress, deferring new offer"),new Promise(a=>{setTimeout(async()=>{a(te?{waiting:"Negotiation in progress"}:await I(o))},1e3)});te=!0,ke.value=o,r.value=o;try{j&&console.log(`[WebRTC] Setting partner ID: ${o}`);const a=p();if(O){j&&(console.log("[WebRTC] Adding local tracks to connection"),console.log(`[WebRTC] Local stream has ${O.getTracks().length} tracks`));const W=O;if(a.getSenders().length>0){j&&console.log("[WebRTC] Replacing existing senders");let L=0;W.getTracks().forEach(ce=>{a.getSenders()[L]?(a.getSenders()[L].replaceTrack(ce),L++):a.addTrack(ce,W)})}else W.getTracks().forEach(L=>{a.addTrack(L,W)})}else if(console.error("[WebRTC] No local stream to add tracks from"),await m(),O){const W=O;W.getTracks().forEach(L=>{a.addTrack(L,W)})}Q.value="connecting",s.value="connecting",j&&console.log("[WebRTC] Creating offer");const b=await a.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return j&&console.log("[WebRTC] Setting local description"),await a.setLocalDescription(b),j&&console.log("[WebRTC] Waiting for ICE gathering to complete"),await A(a),t.value&&o&&(j&&console.log("[WebRTC] Sending offer to partner"),t.value.emit("voice-offer",{offer:a.localDescription,to:o}),t.value.emit("webrtc-signal",{type:"offer",offer:a.localDescription,to:o})),k(a),y(),j&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(a){return console.error("[WebRTC] Error creating offer:",a),ee=`Error creating offer: ${a}`,te=!1,{error:`Failed to create offer: ${a}`}}finally{setTimeout(()=>{te=!1},2e3)}},A=o=>o.iceGatheringState==="complete"?(console.log("[WebRTC] ICE gathering already complete"),Promise.resolve()):new Promise(a=>{const b=()=>{o.iceGatheringState==="complete"&&(o.removeEventListener("icegatheringstatechange",b),a())};o.addEventListener("icegatheringstatechange",b),setTimeout(()=>{o.removeEventListener("icegatheringstatechange",b),console.log("[WebRTC] ICE gathering timed out, but continuing anyway"),a()},2e3)}),F=async(o,a)=>{if(!t.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",a),console.log("[WebRTC] Offer SDP:",o.sdp),ke.value=a,r.value=a;try{O||(j&&console.log("[WebRTC] Initializing local stream before handling offer"),await m());const b=p();if(O&&(b.getSenders().length===0?(j&&console.log("[WebRTC] Adding local tracks to connection"),O.getTracks().forEach(ce=>{b.addTrack(ce,O)})):j&&console.log("[WebRTC] Senders already exist, not adding tracks again")),Q.value="connecting",s.value="connecting",j&&console.log("[WebRTC] Setting remote description (offer)"),await b.setRemoteDescription(new RTCSessionDescription(o)),he.length>0){j&&console.log(`[WebRTC] Adding ${he.length} pending ICE candidates`);for(const L of he)try{await b.addIceCandidate(L)}catch(ce){console.error("[WebRTC] Error adding pending ICE candidate:",ce)}he=[]}j&&console.log("[WebRTC] Creating answer");const W=await b.createAnswer({offerToReceiveAudio:!0});j&&console.log("[WebRTC] Answer SDP:",W.sdp),j&&console.log("[WebRTC] Setting local description (answer)"),await b.setLocalDescription(W),await A(b),j&&console.log("[WebRTC] Sending answer to:",a),t.value.emit("voice-answer",{answer:b.localDescription,to:a}),t.value.emit("webrtc-signal",{type:"answer",answer:b.localDescription,to:a}),k(b),y(),j&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(b){console.error("[WebRTC] Error handling offer:",b),ee=`Error handling offer: ${b}`,setTimeout(()=>{t.value&&r.value&&(console.log("[WebRTC] Re-negotiating after offer error"),I(r.value))},2e3)}},P=async o=>{try{if(!C){j&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const a=C.signalingState;if(j&&console.log(`[WebRTC] Current signaling state before handling answer: ${a}`),a==="have-local-offer"){j&&console.log("[WebRTC] Setting remote description from answer");try{await C.setRemoteDescription(new RTCSessionDescription(o)),j&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+C.signalingState)}catch(b){if(console.error("[WebRTC] Error setting remote description:",b),b.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(W=>setTimeout(W,1e3)),C.signalingState==="have-local-offer")try{j&&console.log("[WebRTC] Retrying set remote description after delay"),await C.setRemoteDescription(new RTCSessionDescription(o)),j&&console.log("[WebRTC] Remote description set successfully on retry")}catch(W){console.error("[WebRTC] Final error setting remote description:",W)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${C.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${a}`),a==="stable"?j&&console.log("[WebRTC] Already in stable state, ignoring answer"):a==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),K<oe&&(K++,j&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${K}/${oe})`),c(),setTimeout(()=>{r.value&&I(r.value)},2e3)))}catch(a){console.error("[WebRTC] Error handling answer:",a),ee=`Error handling answer: ${a}`,console.log("[WebRTC] Attempting to recover from answer error"),K<oe&&await _()}},M=async()=>{if(!fe.value)return console.log("[WebRTC] Muting microphone - stopping all tracks"),O&&(O.getAudioTracks().forEach(a=>{a.stop()}),O=null,d.value=null),fe.value=!0,!1;console.log("[WebRTC] Unmuting microphone - requesting new permission");try{O&&(O.getTracks().forEach(b=>b.stop()),O=null,d.value=null);const a=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(a.getAudioTracks().length===0)throw new Error("No audio tracks available");if(O=a,d.value=a,C&&a)try{const W=C.getSenders().find(L=>L.track&&L.track.kind==="audio");if(W){const L=a.getAudioTracks()[0];L&&W.replaceTrack(L)}else a.getAudioTracks().length>0&&a.getAudioTracks().forEach(L=>{C&&C.addTrack(L,a)})}catch(b){console.error("[WebRTC] Error adding audio tracks:",b)}return fe.value=!1,!0}catch(a){console.error("[WebRTC] Error unmuting microphone:",a);try{const b=await navigator.mediaDevices.getUserMedia({audio:!0});return O=b,d.value=b,fe.value=!1,!0}catch(b){return console.error("[WebRTC] Fallback microphone access also failed:",b),!1}}},c=()=>{if(console.log("[WebRTC] Closing connection"),q(),R(),C){try{C.ontrack=null,C.onicecandidate=null,C.oniceconnectionstatechange=null,C.onicegatheringstatechange=null,C.onsignalingstatechange=null,C.onconnectionstatechange=null;try{C.getTransceivers&&C.getTransceivers().forEach(o=>{o.stop&&o.stop()})}catch{}C.close(),j&&console.log("[WebRTC] Peer connection closed")}catch(o){console.error("[WebRTC] Error closing peer connection:",o)}C=null}D&&(D.getTracks().forEach(o=>{o.stop()}),D=new MediaStream,l.value=D),Q.value="closed",s.value="closed"},T=()=>{console.log("[WebRTC] Full cleanup initiated"),c(),O&&(console.log("[WebRTC] Stopping local stream tracks"),O.getTracks().forEach(o=>{o.stop()}),O=null,d.value=null),console.log("[WebRTC] Cleanup complete")};function x(){if(!t.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),t.value.off("webrtc-signal"),t.value.off("ice-candidate"),t.value.off("partner-disconnected"),t.value.off("webrtc-connection-failed"),t.value.off("connection-timeout"),t.value.off("voice-offer"),t.value.off("voice-answer"),t.value.on("voice-offer",async o=>{console.log("[WebRTC] Received legacy voice-offer:",o),await F(o.offer,o.from)}),t.value.on("voice-answer",async o=>{console.log("[WebRTC] Received legacy voice-answer:",o),await P(o.answer)}),t.value.on("webrtc-signal",async o=>{if(console.log(`[WebRTC] Received ${o.type} signal from ${o.from}`),ke.value=o.from,r.value=o.from,o.type==="offer"&&o.offer)try{await F(o.offer,o.from)}catch(a){console.error("[WebRTC] Error handling offer:",a),ee=`Error handling offer: ${a}`,t.value&&t.value.emit("webrtc-connection-failed",{to:o.from,reason:`Failed to handle offer: ${a}`})}else if(o.type==="answer"&&o.answer)try{await P(o.answer)}catch(a){console.error("[WebRTC] Error handling answer:",a),ee=`Error handling answer: ${a}`,t.value&&t.value.emit("webrtc-connection-failed",{to:o.from,reason:`Failed to handle answer: ${a}`})}}),t.value.on("ice-candidate",async o=>{if(console.log(`[WebRTC] Received ICE candidate from ${o.from}`),o.from!==r.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await B(o.candidate)}catch(a){console.error("[WebRTC] Error handling ICE candidate:",a),ee=`Error handling ICE candidate: ${a}`}}),t.value.on("webrtc-connection-failed",o=>{console.log(`[WebRTC] Connection failed notification from ${o.from}: ${o.reason}`),K<oe?(K++,console.log(`[WebRTC] Partner reported connection failure. Retry ${K}/${oe}`),o.from===r.value&&setTimeout(()=>{r.value&&t.value&&I(o.from)},He)):(Q.value="failed",q(),ee=`Partner reported failure: ${o.reason}`)}),t.value.on("partner-disconnected",()=>{console.log("[WebRTC] Partner disconnected"),c(),ke.value=null,r.value=null,Q.value="closed",te=!1,se=!1,K=0})}x(),ve(()=>{n.value=null,d.value=null,l.value=null});function V(){xe&&clearInterval(xe),xe=window.setInterval(()=>{if(C&&(Q.value==="connected"||Q.value==="connecting")){try{const o=C.createDataChannel(`heartbeat_${Date.now()}`);setTimeout(()=>{try{o.close()}catch{}},1e3),j&&console.log("[WebRTC] Heartbeat sent to keep connection alive"),Q.value==="connecting"&&K>3&&(console.log("[WebRTC] Connection stuck in connecting state. Diagnostic report:"),console.log(N()))}catch{}$()}else q()},Bt)}function q(){xe&&(clearInterval(xe),xe=null)}function $(){if(!C||!O){console.log("[WebRTC] No peer connection or local stream to check tracks");return}console.log("[WebRTC] Checking audio tracks"),console.log(`[WebRTC] Connection state: ${C.connectionState}, ICE state: ${C.iceConnectionState}`);const o=O.getAudioTracks();if(o.length===0)console.log("[WebRTC] No local audio tracks found, initializing new stream"),m().then(a=>{C&&C.connectionState!=="closed"&&(a.getAudioTracks().forEach(b=>{console.log("[WebRTC] Adding new local track to connection");try{C.addTrack(b,a)}catch(W){console.warn("[WebRTC] Error adding track, might already exist:",W)}}),C.connectionState==="connected"&&!te&&(console.log("[WebRTC] Starting negotiation for new local tracks"),Y()))}).catch(a=>{console.error("[WebRTC] Failed to initialize new stream:",a)});else{let a=!1;o.forEach(b=>{b.enabled||(console.log(`[WebRTC] Enabling local track: ${b.label}`),b.enabled=!0,a=!0),b.readyState!=="live"&&(console.log(`[WebRTC] Local track ${b.label} not live, state: ${b.readyState}`),a=!0)}),o.some(b=>!b.enabled)?fe.value=!0:fe.value=!1,a&&C.connectionState==="connected"&&!te&&(console.log("[WebRTC] Fixed local tracks, starting negotiation"),Y())}if(D){const a=D.getAudioTracks();if(a.length===0){console.log("[WebRTC] No remote audio tracks found, checking receivers");const W=C.getReceivers().filter(L=>L.track&&L.track.kind==="audio"&&L.track.readyState==="live");W.length>0?(console.log(`[WebRTC] Found ${W.length} audio receivers not in stream, adding tracks`),W.forEach(L=>{if(L.track&&!D.getTracks().includes(L.track)){console.log(`[WebRTC] Adding track ${L.track.id} to remote stream`);try{D.addTrack(L.track)}catch(ce){console.warn("[WebRTC] Error adding remote track:",ce)}}}),l.value=D,console.log("[WebRTC] Updated remote stream with receiver tracks")):Q.value==="connected"&&!te&&(console.log("[WebRTC] No audio receivers found but connected, trying to renegotiate"),Y())}else{let b=!1;a.forEach(W=>{W.enabled||(console.log(`[WebRTC] Enabling remote track: ${W.label}`),W.enabled=!0,b=!0),W.readyState!=="live"&&(console.log(`[WebRTC] Remote track ${W.label} not live, state: ${W.readyState}`),b=!0)}),b&&(l.value=D,console.log("[WebRTC] Updated remote stream after fixing tracks"))}}else if(C.getReceivers().length>0){console.log("[WebRTC] No remote stream but receivers exist, creating new stream"),D=new MediaStream,l.value=D;let a=!1;C.getReceivers().forEach(b=>{if(b.track&&b.track.kind==="audio"){console.log(`[WebRTC] Adding track ${b.track.id} from receiver to new remote stream`);try{D.addTrack(b.track),a=!0}catch(W){console.warn("[WebRTC] Error adding track from receiver:",W)}}}),a&&(l.value=D,console.log("[WebRTC] Updated components with new remote stream"))}U()}async function _(){if(!(!C||!r.value)){console.log("[WebRTC] Attempting connection recovery");try{if(C.restartIce){C.restartIce();const o=await C.createOffer({iceRestart:!0});await C.setLocalDescription(o),t.value&&t.value.emit("offer",{offer:C.localDescription,to:r.value})}}catch(o){console.error("[WebRTC] Recovery attempt failed:",o)}}}function U(){typeof window<"u"&&(window.__webrtc_debug={connectionState:Q.value,connectionRetryCount:K,lastConnectionError:ee,failureReason:Se,isNegotiating:te,isRestartingIce:se,pendingCandidates:he.length,hasLocalTracks:O?O.getAudioTracks().length>0:!1,hasRemoteTracks:D?D.getAudioTracks().length>0:!1})}le(()=>Q.value,()=>{U()});function y(){we&&clearInterval(we),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),C&&(C.onicecandidate=o=>{o.candidate&&(console.log("[WebRTC] ICE candidate generated:",o.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:o.candidate.candidate,timestamp:Date.now()})),t.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),t.value.emit("ice-candidate",{candidate:o.candidate,to:r.value})))}),we=window.setInterval(async()=>{if(!C||Q.value!=="connecting"&&Q.value!=="connected"){R();return}try{const o=await qt();o&&o.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=o.iceCandidatePairs),S(o)}catch(o){console.error("[WebRTC] Error monitoring connection:",o)}},zt)}function R(){we&&(clearInterval(we),we=null)}function S(o){if(!o||o.error)return;const a=!o.media||o.media.length===0||!o.media.some(W=>W.kind==="audio"&&W.audioLevel>0),b=!o.selectedCandidatePair||o.selectedCandidatePair.state!=="succeeded";(a||b)&&(console.log("[WebRTC] Connection health issues detected, trying to fix..."),$(),Q.value==="connected"&&K<oe&&(K++,console.log(`[WebRTC] Attempting connection improvement (${K}/${oe})`),C&&C.getTransceivers&&C.getTransceivers().forEach(W=>{W.sender&&W.sender.track&&W.sender.track.kind==="audio"&&W.sender.setParameters({...W.sender.getParameters(),degradationPreference:"maintain-framerate"})})))}function k(o){r.value&&(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),window.__webrtcConnectionTimeout=setTimeout(()=>{var a,b,W;if(o.connectionState==="connecting"||o.connectionState==="new"){console.log(`[WebRTC] Connection attempt timed out after ${Ye/1e3} seconds`);const L={localCandidates:((a=window.__localIceCandidates)==null?void 0:a.length)||0,remoteCandidates:((b=window.__remoteIceCandidates)==null?void 0:b.length)||0,iceCandidatePairsCount:((W=window.__iceCandidatePairs)==null?void 0:W.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(L)),ee=`Connection timed out. Local candidates: ${L.localCandidates}, Remote: ${L.remoteCandidates}`,L.localCandidates===0&&(console.error("[WebRTC] No local ICE candidates generated, could be a network/firewall issue"),ee+=". No local candidates - check firewall settings"),r.value&&(console.log("[WebRTC] Restarting connection with different servers"),c(),setTimeout(()=>{r.value&&(_e===Ke||_e===Yt?(console.log("[WebRTC] Switching to TURN-only configuration"),_e=Ht):(console.log("[WebRTC] Switching to standard configuration"),_e=Ke),I(r.value))},He))}},Ye))}function N(){var b,W;const o=C,a=[];return a.push(`Connection State: ${(o==null?void 0:o.connectionState)||"none"}`),a.push(`Signaling State: ${(o==null?void 0:o.signalingState)||"none"}`),a.push(`ICE Connection State: ${(o==null?void 0:o.iceConnectionState)||"none"}`),a.push(`ICE Gathering State: ${(o==null?void 0:o.iceGatheringState)||"none"}`),a.push(`Reconnection Attempts: ${K}/${oe}`),a.push(`Last Error: ${ee||"none"}`),a.push(`Local Audio Tracks: ${(O==null?void 0:O.getAudioTracks().length)||0}`),a.push(`Remote Audio Tracks: ${(D==null?void 0:D.getAudioTracks().length)||0}`),a.push(`Local Candidates: ${((b=window.__localIceCandidates)==null?void 0:b.length)||0}`),a.push(`Remote Candidates: ${((W=window.__remoteIceCandidates)==null?void 0:W.length)||0}`),a.push(`Is Negotiating: ${te}`),a.push(`Is Restarting ICE: ${se}`),a.join(`
`)}const B=async o=>{if(!C){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(j&&console.log("[WebRTC] Adding received ICE candidate:",o.candidate),!C.remoteDescription||!C.localDescription){j&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(C&&C.remoteDescription){j&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await C.addIceCandidate(o)}catch(a){console.error("[WebRTC] Error adding delayed ICE candidate:",a)}}},1e3);return}await C.addIceCandidate(o),j&&console.log("[WebRTC] Successfully added ICE candidate")}catch(a){console.error("[WebRTC] Error adding ICE candidate:",a),ee=`Error adding ICE candidate: ${a}`,setTimeout(async()=>{if(C&&C.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await C.addIceCandidate(o),j&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(b){console.error("[WebRTC] Error adding ICE candidate on retry:",b)}}},2e3)}};function Y(){if(!C||!r.value||te){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),te=!0;try{C.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then(o=>{if(C)return C.setLocalDescription(o)}).then(()=>{!C||!t.value||!r.value||(t.value.emit("voice-offer",{offer:C.localDescription,to:r.value}),j&&console.log("[WebRTC] Sent renegotiation offer"))}).catch(o=>{console.error("[WebRTC] Error during negotiation:",o)}).finally(()=>{setTimeout(()=>{te=!1},2e3)})}catch(o){console.error("[WebRTC] Failed to start negotiation:",o),te=!1}}const z={connectionState:Q.value,iceCandidatesGenerated:he.length,localStreamActive:!!O&&O.active,remoteStreamActive:!!D&&D.active,localTracks:O?O.getAudioTracks().length:0,remoteTracks:D?D.getAudioTracks().length:0,connectionRetries:K,lastError:ee||Se||"",isAudioMuted:fe.value,forceReconnect:()=>C&&Q.value!=="new"?(_(),!0):!1};return{socket:t,peerConnection:n,remoteStream:l,localStream:d,connectionState:s,isAudioMuted:u,partnerId:r,createOffer:I,handleOffer:F,handleAnswer:P,handleIceCandidate:B,toggleMicrophone:M,closeConnection:c,initializeLocalStream:m,cleanup:T,diagnosticReport:z}}function Kt(){const t="test";try{return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(i){return console.error("localStorage is not available:",i),!1}}function Jt(){const t=f(Kt());function i(s,u){if(!t.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(s,u)}catch(r){console.error("Failed to set localStorage item:",r)}}function n(s){if(!t.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(s)}catch(u){return console.error("Failed to get localStorage item:",u),null}}function d(s){if(!t.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(s)}catch(u){console.error("Failed to remove localStorage item:",u)}}function l(){if(!t.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(s){console.error("Failed to clear localStorage:",s)}}return{isAvailable:t,setItem:i,getItem:n,removeItem:d,clear:l}}const Z=f({}),Te=f(null),ge=f({}),Ie=f(!1),Pe=!0;let Je=!1;function Qt(){const{socket:t,userId:i}=be(),n=Jt();Je?console.log("[ChatService] Using existing chat service instance"):(console.log("[ChatService] Initializing chat service"),d(),Je=!0);function d(){l(),F(),le(Z,()=>{A()},{deep:!0}),le(()=>t.value,c=>{c&&!Ie.value&&(console.log("[ChatService] Socket reconnected, setting up listeners again"),l())})}function l(){if(!t.value){console.log("[ChatService] No socket available, cannot set up listeners");return}Ie.value&&(console.log("[ChatService] Removing existing chat-message listener"),t.value.off("chat-message"),Ie.value=!1),console.log("[ChatService] Setting up chat-message listener"),t.value.on("chat-message",c=>{console.log("[ChatService] Received chat message:",c);const T=c.from,x=I(T);console.log(`[ChatService] Conversation key: ${x}, current partner: ${Te.value}`),Z.value[x]||(Z.value[x]=[]),Z.value[x].push({sender:"partner",text:c.text,timestamp:c.timestamp||Date.now()}),T!==Te.value&&(ge.value[T]=!0,console.log(`[ChatService] Marked message from ${T} as unread`)),A(),console.log("[ChatService] Updated messages:",Z.value[x])}),Ie.value=!0,console.log("[ChatService] Chat message listener setup complete")}function s(c){console.log(`[ChatService] Setting current partner: ${c}`),Te.value=c,c&&(ge.value[c]=!1)}function u(c,T=null){const x=T||Te.value;if(!x||!c.trim()||!t.value)return console.log(`[ChatService] Cannot send message: partnerId=${x}, text=${c.trim()?"present":"empty"}, socket=${t.value?"present":"not present"}`),!1;console.log(`[ChatService] Sending message to ${x}: ${c}`);const V=I(x);Z.value[V]||(Z.value[V]=[]);const q=Date.now();return Z.value[V].push({sender:"me",text:c.trim(),timestamp:q}),t.value.emit("chat-message",{text:c.trim(),to:x}),console.log("[ChatService] Message sent, current messages:",Z.value[V]),!0}function r(c){if(!c)return[];const T=I(c),x=Z.value[T]||[];return console.log(`[ChatService] Getting messages for ${c}, found ${x.length} messages`),x}function m(c){if(!c)return!1;const T=!!ge.value[c];return console.log(`[ChatService] Checking unread for ${c}: ${T}`),T}function p(c){c&&(console.log(`[ChatService] Marking messages as read for ${c}`),ge.value[c]=!1)}function I(c){if(!i.value)return c;const T=[i.value,c].sort();return`${T[0]}_${T[1]}`}function A(){if(!n.isAvailable.value){console.log("[ChatService] localStorage not available, cannot save chats");return}try{n.setItem("chat_messages",JSON.stringify(Z.value)),n.setItem("chat_unread",JSON.stringify(ge.value)),Pe&&console.log("[ChatService] Saved chats to localStorage")}catch(c){console.error("[ChatService] Failed to save chats:",c)}}function F(){if(!n.isAvailable.value){console.log("[ChatService] localStorage not available, cannot load chats");return}try{const c=n.getItem("chat_messages");c&&(Z.value=JSON.parse(c),Pe&&console.log("[ChatService] Loaded messages from localStorage:",Object.keys(Z.value).length,"conversations"));const T=n.getItem("chat_unread");T&&(ge.value=JSON.parse(T),Pe&&console.log("[ChatService] Loaded unread status from localStorage"))}catch(c){console.error("[ChatService] Failed to load chats:",c)}}function P(c){if(!c)return;const T=I(c);Z.value[T]&&(Z.value[T]=[],A(),console.log(`[ChatService] Cleared chat for ${c}`))}function M(){Z.value={},ge.value={},A(),console.log("[ChatService] Cleared all chats")}return{messages:Z,unreadMessages:ge,currentPartnerId:Te,setCurrentPartner:s,sendMessage:u,getMessages:r,hasUnreadMessages:m,markAsRead:p,clearChat:P,clearAllChats:M}}const Xt={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/10"},Zt={key:0},eo={key:1},to={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},oo={class:"text-xl"},no={class:"text-sm"},ao={key:2},lo={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},so={class:"text-xl"},ro={class:"text-sm"},io={key:3},co={key:4,class:"mt-4 text-xs"},uo={class:"flex items-center justify-center gap-2"},vo={key:0,class:"text-red-400 mt-1 text-xs"},fo=ne({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0}},setup(t){const i=t,n=re(()=>{switch(i.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";default:return"Disconnected"}});return(d,l)=>(v(),g("div",Xt,[t.status==="searching"?(v(),g("div",Zt,l[0]||(l[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center animate-pulse"},[e("div",{class:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Searching...",-1),e("p",{class:"text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):t.status==="matched"?(v(),g("div",eo,[l[1]||(l[1]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-yellow-500 to-green-500 rounded-full flex items-center justify-center animate-pulse"},[e("span",{class:"text-2xl"},"🔄")],-1)),l[2]||(l[2]=e("h2",{class:"text-lg font-semibold mb-2 text-yellow-400"},"Match Found!",-1)),t.partnerInfo?(v(),g("div",to,[e("span",oo,G(t.partnerInfo.flag),1),e("span",no,G(t.partnerInfo.country),1)])):J("",!0),l[3]||(l[3]=e("p",{class:"text-sm text-yellow-400 mt-2"},"Setting up voice connection...",-1)),l[4]||(l[4]=e("div",{class:"mt-3 relative h-1.5 w-3/4 mx-auto bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-500 to-green-500 rounded-full animate-progress"})],-1))])):t.status==="connected"?(v(),g("div",ao,[l[5]||(l[5]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"👥")],-1)),l[6]||(l[6]=e("h2",{class:"text-lg font-semibold mb-2"},"Connected!",-1)),t.partnerInfo?(v(),g("div",lo,[e("span",so,G(t.partnerInfo.flag),1),e("span",ro,G(t.partnerInfo.country),1)])):J("",!0),l[7]||(l[7]=e("p",{class:"text-sm text-green-400 mt-2"},"You can talk now",-1))])):(v(),g("div",io,l[8]||(l[8]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-600 to-gray-700 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"🌟")],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Ready to Connect",-1),e("p",{class:"text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))),t.showStatus&&t.status!=="disconnected"?(v(),g("div",co,[e("div",uo,[e("span",{class:X({"text-green-400":t.status==="connected","text-yellow-400":t.status==="matched","text-blue-400":t.status==="searching"})},"●",2),e("span",null,G(n.value),1)]),t.errorMessage?(v(),g("p",vo,G(t.errorMessage),1)):J("",!0)])):J("",!0)]))}});const ue=(t,i)=>{const n=t.__vccOpts||t;for(const[d,l]of i)n[d]=l;return n},go=ue(fo,[["__scopeId","data-v-911ccaff"]]),mo={class:"space-y-3 md:space-y-4 px-2"},po={class:"flex justify-center items-center gap-3 md:gap-4"},bo=["disabled"],yo={class:"relative"},ho={key:0,class:"text-white text-lg md:text-xl"},xo={key:1,class:"text-white text-lg md:text-xl"},wo={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-300 rounded-full animate-pulse"},Co=["disabled"],ko={class:"flex flex-wrap justify-center gap-2 md:gap-3"},To=ne({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(t,{emit:i}){const n=i,d=f(!1);function l(){d.value||(d.value=!0,n("toggle-mute"),setTimeout(()=>{d.value=!1},200),setTimeout(()=>{try{const s=document.querySelector("audio");s&&s.paused&&s.play().catch(u=>{console.warn("Could not auto-play audio after mute toggle:",u)})}catch(s){console.error("Error trying to auto-play:",s)}},300))}return(s,u)=>(v(),g("div",mo,[e("div",po,[e("button",{onClick:l,class:X(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",t.isMuted?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:d.value},[e("div",yo,[t.isMuted?(v(),g("span",xo,"🔇")):(v(),g("span",ho,"🎤")),d.value?(v(),g("span",wo)):J("",!0)])],10,bo),e("button",{onClick:u[0]||(u[0]=r=>s.$emit("find-next")),class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},u[5]||(u[5]=[e("span",{class:"text-white text-2xl md:text-3xl"},"📞",-1)])),e("button",{onClick:u[1]||(u[1]=r=>s.$emit("toggle-chat")),disabled:t.isDisabled,class:X(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",t.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},u[6]||(u[6]=[e("span",{class:"text-white text-lg md:text-xl"},"💬",-1)]),10,Co)]),e("div",ko,[e("button",{onClick:u[2]||(u[2]=r=>s.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110"}," 🎮 Games "),e("button",{onClick:u[3]||(u[3]=r=>s.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110"}," 📞 History "),e("button",{onClick:u[4]||(u[4]=r=>s.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110"}," ❤️ Support ")])]))}}),$o={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Ro={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},So={class:"flex items-center justify-between p-4 border-b border-gray-700"},_o={key:0,class:"h-full flex items-center justify-center text-gray-500"},Io={key:1,class:"space-y-2"},Wo={class:"flex justify-between gap-2"},Eo={class:"text-xs text-gray-400"},Ao={class:"mt-1 text-white break-words"},Go={class:"p-3 border-t border-gray-700"},Po=["disabled"],jo=["disabled"],Oo=ne({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(t,{emit:i}){const n=t,d=i,l=f(""),s=f(null),u=()=>{l.value.trim()&&n.isConnected&&(d("send-message",l.value),l.value="")},r=async()=>{await Wt(),s.value&&(s.value.scrollTop=s.value.scrollHeight)},m=p=>new Date(p).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return le(()=>n.messages,()=>{r()},{deep:!0}),le(()=>n.isOpen,p=>{p&&r()}),ie(()=>{n.isOpen&&r()}),(p,I)=>t.isOpen?(v(),g("div",$o,[e("div",Ro,[e("div",So,[I[2]||(I[2]=e("div",{class:"flex items-center"},[e("span",{class:"text-white text-lg font-medium"},"💬 Chat")],-1)),e("button",{onClick:I[0]||(I[0]=A=>p.$emit("close")),class:"text-gray-400 hover:text-white"}," ✕ ")]),e("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:s},[t.messages.length===0?(v(),g("div",_o,I[3]||(I[3]=[e("div",{class:"text-center"},[e("p",null,"No messages yet"),e("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(v(),g("div",Io,[(v(!0),g(me,null,pe(t.messages,A=>(v(),g("div",{key:A.id,class:X(["rounded-lg p-3 max-w-[80%]",A.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[e("div",Wo,[e("span",{class:X(["text-sm",A.isOwn?"text-blue-200":"text-gray-200"])},G(A.isOwn?"You":"Partner"),3),e("span",Eo,G(m(A.timestamp)),1)]),e("p",Ao,G(A.message),1)],2))),128))]))],512),e("div",Go,[e("form",{onSubmit:It(u,["prevent"]),class:"flex gap-2"},[De(e("input",{"onUpdate:modelValue":I[1]||(I[1]=A=>l.value=A),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!t.isConnected},null,8,Po),[[et,l.value]]),e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!t.isConnected||!l.value.trim()}," Send ",8,jo)],32)])])])):J("",!0)}}),Do={class:"w-full"},Mo={class:"flex justify-between items-center mb-4"},No={class:"text-white text-sm"},Fo={key:0,class:"text-yellow-300 animate-pulse"},Lo={key:1},Vo={key:2},Uo={key:0,class:"hidden"},Bo={class:"text-sm text-gray-300"},zo={class:"text-purple-400"},qo={class:"bg-gray-800 rounded-lg p-4 mb-4"},Yo={class:"mb-4 text-center"},Ho={class:"text-gray-300 text-sm mb-2"},Ko={class:"font-bold text-lg"},Jo={class:"grid grid-cols-3 gap-2 mb-4"},Qo=["onClick","disabled"],Xo={key:0,class:"text-blue-400"},Zo={key:1,class:"text-green-400"},en={key:0,class:"text-center mt-4"},tn={class:"flex justify-between"},Qe=3e4,on=ne({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},initialRoomId:{type:String,default:void 0}},emits:["back","error"],setup(t,{emit:i}){const n=t,d=i,{socket:l,userId:s}=be(),u=f(n.initialRoomId&&n.initialRoomId.startsWith("ttt-")?n.initialRoomId:`ttt-${Math.random().toString(36).substring(2,8)}`),r=f(!1),m=f("waiting"),p=f(["","","","","","","","",""]),I=f("X"),A=f("O"),F=f("X"),P=f(null),M=f(!1),c=f(null),T=f(Date.now()),x=re(()=>F.value===I.value),V=S=>{var k;if(!(m.value!=="playing"||p.value[S]!==""||!x.value||P.value!==null))try{p.value[S]=I.value,F.value=A.value,T.value=Date.now(),(k=l.value)==null||k.emit("game-move",{gameType:"tic-tac-toe",move:S,to:n.partnerId,roomId:u.value}),q(),R()}catch{y("Failed to make a move. Please try again.")}},q=()=>{const S=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const k of S){const[N,B,Y]=k;if(p.value[N]&&p.value[N]===p.value[B]&&p.value[N]===p.value[Y]){P.value=p.value[N],m.value="finished",c.value&&(clearTimeout(c.value),c.value=null);return}}p.value.includes("")||(P.value="tie",m.value="finished",c.value&&(clearTimeout(c.value),c.value=null))},$=()=>{var S;try{p.value=["","","","","","","","",""],F.value=Math.random()>.5?I.value:A.value,P.value=null,m.value=M.value?"playing":"waiting",T.value=Date.now(),(S=l.value)==null||S.emit("game-reset",{gameType:"tic-tac-toe",to:n.partnerId,roomId:u.value}),R()}catch{y("Failed to reset the game. Please try again.")}},_=()=>{const S=`${window.location.origin}/game/${u.value}`;navigator.clipboard.writeText(S).then(()=>{r.value=!0,setTimeout(()=>{r.value=!1},2e3)}).catch(()=>{y("Failed to copy invite link to clipboard.")})},U=()=>{var S;try{(S=l.value)==null||S.emit("game-invite",{gameType:"tic-tac-toe",to:n.partnerId,roomId:u.value})}catch{y("Failed to send game invite. Please try again.")}},y=S=>{console.error(`Tic-Tac-Toe Error: ${S}`),d("error",S)},R=()=>{c.value&&clearTimeout(c.value),m.value==="playing"&&!P.value&&(c.value=window.setTimeout(()=>{Date.now()-T.value>Qe&&(y("Connection with your partner appears to be lost. The game will be closed."),d("back"))},Qe))};return ie(()=>{var S,k,N;try{(S=l.value)==null||S.on("game-invite-accept",B=>{B.from===n.partnerId&&(M.value=!0,m.value="playing",T.value=Date.now(),R())}),(k=l.value)==null||k.on("game-move",B=>{if(B.from===n.partnerId&&B.gameType==="tic-tac-toe"){const Y=B.move;typeof Y=="number"&&Y>=0&&Y<9&&p.value[Y]===""?(p.value[Y]=A.value,F.value=I.value,T.value=Date.now(),q(),R()):y("Received invalid move from partner.")}}),(N=l.value)==null||N.on("game-reset",B=>{B.from===n.partnerId&&B.gameType==="tic-tac-toe"&&(p.value=["","","","","","","","",""],F.value=B.firstTurn===I.value?I.value:A.value,P.value=null,m.value="playing",T.value=Date.now(),R())})}catch{y("Failed to initialize game connection.")}}),ve(()=>{var S,k,N;(S=l.value)==null||S.off("game-invite-accept"),(k=l.value)==null||k.off("game-move"),(N=l.value)==null||N.off("game-reset"),c.value&&(clearTimeout(c.value),c.value=null)}),M.value||(m.value="waiting"),(S,k)=>(v(),g("div",Do,[e("div",Mo,[k[1]||(k[1]=e("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),e("div",No,[m.value==="waiting"?(v(),g("span",Fo," Waiting for partner... ")):P.value?(v(),g("span",Lo,G(P.value===I.value?"You Won! 🎉":P.value==="tie"?"It's a Tie! 🤝":"You Lost! 😢"),1)):(v(),g("span",Vo,G(x.value?"Your Turn":"Partner's Turn"),1))])]),u.value?(v(),g("div",Uo,[e("div",Bo,[k[2]||(k[2]=$e("Room: ")),e("span",zo,G(u.value),1)]),e("button",{onClick:_,class:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"},G(r.value?"Copied!":"Invite"),1)])):J("",!0),e("div",qo,[e("div",{class:X(["flex flex-col items-center",{"opacity-60":m.value==="waiting"}])},[e("div",Yo,[e("p",Ho,[k[3]||(k[3]=$e("You are: ")),e("span",Ko,G(I.value),1)])]),e("div",Jo,[(v(!0),g(me,null,pe(p.value,(N,B)=>(v(),g("button",{key:B,onClick:Y=>V(B),disabled:N!==""||!x.value||P.value!==null||m.value==="waiting",class:X(["w-20 h-20 bg-gray-700 hover:bg-gray-600 rounded-lg flex items-center justify-center text-3xl font-bold transition-colors",{"cursor-not-allowed":N!==""||!x.value||P.value!==null,"hover:bg-purple-700":x.value&&N===""&&!P.value&&m.value==="playing"}])},[N==="X"?(v(),g("span",Xo,"X")):N==="O"?(v(),g("span",Zo,"O")):J("",!0)],10,Qo))),128))]),P.value?(v(),g("div",en,[e("button",{onClick:$,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):J("",!0)],2)]),e("div",tn,[e("button",{onClick:k[0]||(k[0]=N=>S.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games "),m.value==="waiting"?(v(),g("button",{key:0,onClick:U,class:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Invite Partner ")):J("",!0)])]))}});const nn=ue(on,[["__scopeId","data-v-5bd9fa05"]]),an={class:"w-full"},ln={class:"flex justify-between items-center mb-4"},sn={class:"text-white text-sm"},rn={key:0,class:"text-yellow-300 animate-pulse"},cn={key:1},un={key:2},dn={key:0,class:"hidden"},vn={class:"text-sm text-gray-300"},fn={class:"text-purple-400"},gn={class:"bg-gray-800 rounded-lg p-4 mb-4"},mn={class:"mb-6 text-center"},pn={class:"text-5xl mb-4 h-16 flex items-center justify-center"},bn={key:0,class:"flex justify-center gap-4 mb-6"},yn={class:"text-5xl mb-2 h-16 flex items-center justify-center"},hn={key:0},xn={key:1,class:"animate-pulse"},wn={key:2},Cn={key:0,class:"text-center mt-4"},kn={class:"flex justify-between"},Xe=3e4,Tn=ne({__name:"RockPaperScissors",props:{partnerId:{type:String,required:!0},initialRoomId:{type:String,default:void 0}},emits:["back","error"],setup(t,{emit:i}){const n=t,d=i,{socket:l}=be(),s=f("waiting"),u=f(""),r=f(""),m=f(""),p=f(!1),I=f(!1),A=f(null),F=f(Date.now());re(()=>u.value!==""&&r.value!=="");const P={rock:"👊",paper:"✋",scissors:"✌️"},M=f(n.initialRoomId&&n.initialRoomId.startsWith("rps-")?n.initialRoomId:`rps-${Math.random().toString(36).substring(2,8)}`),c=f(!1),T=()=>{const y=`${window.location.origin}/game/${M.value}`;navigator.clipboard.writeText(y).then(()=>{c.value=!0,setTimeout(()=>{c.value=!1},2e3)}).catch(()=>{_("Failed to copy invite link to clipboard.")})},x=y=>{var R;if(!(s.value!=="playing"||u.value))try{u.value=P[y],F.value=Date.now(),(R=l.value)==null||R.emit("game-move",{gameType:"rock-paper-scissors",move:y,to:n.partnerId,roomId:M.value}),V(),U()}catch{_("Failed to make a choice. Please try again.")}},V=()=>{var y,R;if(!(!u.value||!r.value))try{const S=(y=Object.entries(P).find(([N,B])=>B===u.value))==null?void 0:y[0],k=(R=Object.entries(P).find(([N,B])=>B===r.value))==null?void 0:R[0];if(!S||!k)return;S===k?m.value="tie":S==="rock"&&k==="scissors"||S==="paper"&&k==="rock"||S==="scissors"&&k==="paper"?m.value="win":m.value="lose",m.value&&(s.value="finished",A.value&&(clearTimeout(A.value),A.value=null))}catch{_("Failed to determine game result.")}},q=()=>{var y;try{u.value="",r.value="",m.value="",F.value=Date.now(),(y=l.value)==null||y.emit("game-reset",{gameType:"rock-paper-scissors",to:n.partnerId,roomId:M.value}),s.value=p.value?"playing":"waiting",U()}catch{_("Failed to reset the game. Please try again.")}},$=()=>{var y;try{(y=l.value)==null||y.emit("game-invite",{gameType:"rock-paper-scissors",to:n.partnerId,roomId:M.value})}catch{_("Failed to send game invite. Please try again.")}},_=y=>{console.error(`Rock-Paper-Scissors Error: ${y}`),d("error",y)},U=()=>{A.value&&clearTimeout(A.value),s.value==="playing"&&!m.value&&(A.value=window.setTimeout(()=>{Date.now()-F.value>Xe&&(_("Connection with your partner appears to be lost. The game will be closed."),d("back"))},Xe))};return ie(()=>{var y,R,S;try{(y=l.value)==null||y.on("game-invite-accept",k=>{k.from===n.partnerId&&k.gameType==="rock-paper-scissors"&&(p.value=!0,s.value="playing",F.value=Date.now(),U())}),(R=l.value)==null||R.on("game-move",k=>{if(k.from===n.partnerId&&k.gameType==="rock-paper-scissors"){const N=k.move;N&&P[N]?(r.value=P[N],F.value=Date.now(),V(),U()):_("Received invalid move from partner.")}}),(S=l.value)==null||S.on("game-reset",k=>{k.from===n.partnerId&&k.gameType==="rock-paper-scissors"&&(u.value="",r.value="",m.value="",s.value="playing",F.value=Date.now(),U())}),n.initialRoomId&&(s.value="waiting",$())}catch{_("Failed to initialize game connection.")}}),ve(()=>{var y,R,S;(y=l.value)==null||y.off("game-invite-accept"),(R=l.value)==null||R.off("game-move"),(S=l.value)==null||S.off("game-reset"),A.value&&(clearTimeout(A.value),A.value=null)}),le([u,r],()=>{u.value&&r.value?(I.value=!0,V()):I.value=!1}),(y,R)=>(v(),g("div",an,[e("div",ln,[R[4]||(R[4]=e("h2",{class:"text-xl font-bold text-purple-400"},"Rock Paper Scissors",-1)),e("div",sn,[s.value==="waiting"?(v(),g("span",rn," Waiting for partner... ")):s.value==="playing"&&!u.value?(v(),g("span",cn," Your Turn ")):s.value==="playing"&&u.value&&!I.value?(v(),g("span",un," Waiting for partner... ")):J("",!0)])]),M.value?(v(),g("div",dn,[e("div",vn,[R[5]||(R[5]=$e("Room: ")),e("span",fn,G(M.value),1)]),e("button",{onClick:T,class:"bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm transition-colors"},G(c.value?"Copied!":"Invite"),1)])):J("",!0),e("div",gn,[e("div",{class:X(["flex flex-col items-center",{"opacity-60":s.value!=="playing"}])},[e("div",mn,[R[6]||(R[6]=e("p",{class:"text-gray-300 text-sm mb-1"},"Your Choice",-1)),e("div",pn,G(u.value||"❓"),1),!u.value&&s.value==="playing"?(v(),g("div",bn,[e("button",{onClick:R[0]||(R[0]=S=>x("rock")),class:"text-3xl bg-gray-700 hover:bg-purple-700 w-16 h-16 rounded-full flex items-center justify-center transition-all transform hover:scale-110 active:scale-95"}," 👊 "),e("button",{onClick:R[1]||(R[1]=S=>x("paper")),class:"text-3xl bg-gray-700 hover:bg-purple-700 w-16 h-16 rounded-full flex items-center justify-center transition-all transform hover:scale-110 active:scale-95"}," ✋ "),e("button",{onClick:R[2]||(R[2]=S=>x("scissors")),class:"text-3xl bg-gray-700 hover:bg-purple-700 w-16 h-16 rounded-full flex items-center justify-center transition-all transform hover:scale-110 active:scale-95"}," ✌️ ")])):J("",!0),R[7]||(R[7]=e("div",{class:"w-full h-px bg-gray-700 my-4"},null,-1)),R[8]||(R[8]=e("p",{class:"text-gray-300 text-sm mb-1"},"Partner's Choice",-1)),e("div",yn,[m.value&&r.value?(v(),g("span",hn,G(r.value),1)):u.value?(v(),g("span",xn,"⏳")):(v(),g("span",wn,"❓"))])]),m.value?(v(),g("div",Cn,[e("div",{class:X(["text-xl font-bold mb-4",{"text-green-400":m.value==="win","text-red-400":m.value==="lose","text-yellow-400":m.value==="tie"}])},G(m.value==="win"?"You Win! 🎉":m.value==="lose"?"You Lose! 😢":"It's a Tie! 🤝"),3),e("button",{onClick:q,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):J("",!0)],2)]),e("div",kn,[e("button",{onClick:R[3]||(R[3]=S=>y.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games "),s.value==="waiting"?(v(),g("button",{key:0,onClick:$,class:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Invite Partner ")):J("",!0)])]))}});const $n=ue(Tn,[["__scopeId","data-v-33461718"]]),Rn={class:"w-full max-w-md mx-auto bg-purple-900 bg-opacity-80 rounded-xl p-4 shadow-lg"},Sn={class:"flex justify-between items-center mb-4"},_n={class:"text-white"},In={key:0,class:"flex flex-col items-center justify-center py-8"},Wn={key:1,class:"space-y-4"},En={class:"bg-purple-800 bg-opacity-70 p-4 rounded-lg"},An={class:"text-white text-lg mb-2"},Gn={class:"text-gray-300 text-sm"},Pn={class:"space-y-2"},jn=["onClick","disabled"],On={key:0,class:"mt-4 text-center"},Dn={class:"mt-6 flex justify-end"},Mn=ne({__name:"TriviaGame",emits:["close"],setup(t,{emit:i}){const n=f(!0),d=f(null),l=f([]),s=f(null),u=f(0),r=re(()=>{var c;return s.value===((c=d.value)==null?void 0:c.correct_answer)}),{socket:m,userId:p}=be();function I(){var c,T;(c=m.value)==null||c.on("trivia:question",x=>{d.value=x,A(),s.value=null,n.value=!1}),(T=m.value)==null||T.on("trivia:score",x=>{x.userId===p.value&&(u.value=x.score)}),P()}function A(){if(!d.value)return;const c=[d.value.correct_answer,...d.value.incorrect_answers];for(let T=c.length-1;T>0;T--){const x=Math.floor(Math.random()*(T+1));[c[T],c[x]]=[c[x],c[T]]}l.value=c}function F(c){var T;s.value===null&&(s.value=c,(T=m.value)==null||T.emit("trivia:answer",{userId:p.value,answer:c}),r.value&&u.value++)}function P(){var c;n.value=!0,(c=m.value)==null||c.emit("trivia:request",{userId:p.value})}function M(){P()}return ie(()=>{I()}),ve(()=>{var c,T;(c=m.value)==null||c.off("trivia:question"),(T=m.value)==null||T.off("trivia:score")}),(c,T)=>(v(),g("div",Rn,[e("div",Sn,[T[1]||(T[1]=e("h2",{class:"text-xl font-bold text-white"},"Trivia Challenge",-1)),e("div",_n," Score: "+G(u.value),1)]),n.value?(v(),g("div",In,T[2]||(T[2]=[e("div",{class:"animate-spin h-10 w-10 border-4 border-blue-500 rounded-full border-t-transparent mb-4"},null,-1),e("p",{class:"text-white"},"Loading question...",-1)]))):d.value?(v(),g("div",Wn,[e("div",En,[e("p",An,G(d.value.question),1),e("p",Gn,"Category: "+G(d.value.category),1)]),e("div",Pn,[(v(!0),g(me,null,pe(l.value,(x,V)=>(v(),g("button",{key:V,onClick:q=>F(x),disabled:s.value!==null,class:X(["w-full text-left p-3 rounded-lg transition-colors text-white",s.value===null?"bg-purple-800 hover:bg-purple-700":x===d.value.correct_answer?"bg-green-600":s.value===x?"bg-red-600":"bg-purple-800 opacity-75"])},G(x),11,jn))),128))]),s.value?(v(),g("div",On,[e("p",{class:X(["text-lg mb-4",r.value?"text-green-400":"text-red-400"])},G(r.value?"Correct! +1 point":"Wrong answer!"),3),e("button",{onClick:M,class:"bg-blue-600 hover:bg-blue-500 text-white px-6 py-2 rounded-lg transition-colors"}," Next Question ")])):J("",!0)])):J("",!0),e("div",Dn,[e("button",{onClick:T[0]||(T[0]=x=>c.$emit("close")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors"}," Exit Game ")])]))}});const Nn=ue(Mn,[["__scopeId","data-v-0598912d"]]),Fn=ne({name:"GameSelector",components:{TicTacToe:nn,RockPaperScissors:$n,TriviaGame:Nn},props:{partnerId:{type:String,required:!0}},emits:["close","error"],setup(t,{emit:i}){const{socket:n}=be(),d=f(null),l=f(!1),s=f(!1),u=f(null),r=f(!1),m=f(null),p=f(null),I=3e4,A=["tic-tac-toe","rock-paper-scissors","trivia"],F={"tic-tac-toe":"Tic-Tac-Toe","rock-paper-scissors":"Rock Paper Scissors",trivia:"Trivia Challenge","sound-game":"Sound Game","word-galaxy":"Word Galaxy"},P=re(()=>u.value?F[u.value]||u.value:""),M=y=>A.includes(y),c=y=>{var S;if(!M(y)){p.value=`${F[y]||y} is not yet implemented. Please try another game.`,i("error",p.value);return}p.value=null,l.value=!0,r.value=!0,d.value=y,(S=n.value)==null||S.emit("game-invite",{gameType:y,to:t.partnerId});const R=setTimeout(()=>{l.value&&(l.value=!1,d.value=null,p.value="Your partner didn't respond to the game invitation. Please try again.",i("error",p.value))},I);ve(()=>{clearTimeout(R)})},T=()=>{var y;l.value&&((y=n.value)==null||y.emit("game-invite-cancel",{to:t.partnerId})),$()},x=()=>{var y,R;if(u.value){if(!M(u.value)){p.value=`${F[u.value]||u.value} is not yet implemented. Please ask your partner to choose another game.`,i("error",p.value),(y=n.value)==null||y.emit("game-invite-decline",{to:t.partnerId}),s.value=!1,u.value=null;return}p.value=null,d.value=u.value,s.value=!1,r.value=!1,(R=n.value)==null||R.emit("game-invite-accept",{gameType:u.value,to:t.partnerId}),l.value=!1}},V=()=>{var y;(y=n.value)==null||y.emit("game-invite-decline",{to:t.partnerId}),s.value=!1,u.value=null},q=()=>{var y;$(),(y=n.value)==null||y.emit("game-close",{to:t.partnerId}),i("close")},$=()=>{d.value=null,l.value=!1,s.value=!1,u.value=null,m.value=null,p.value=null},_=y=>{p.value=y,i("error",y)},U=y=>{console.log("Game ended with result:",y)};return ie(()=>{var y,R,S,k,N,B;(y=n.value)==null||y.on("game-invite",Y=>{Y.from===t.partnerId&&(u.value=Y.gameType,m.value=Y.roomId||null,s.value=!0)}),(R=n.value)==null||R.on("game-invite-accept",Y=>{Y.from===t.partnerId&&(l.value?(l.value=!1,d.value=Y.gameType):s.value&&(s.value=!1,d.value=u.value))}),(S=n.value)==null||S.on("game-invite-decline",Y=>{Y.from===t.partnerId&&(l.value=!1,d.value=null,p.value="Your partner declined the game invitation.",i("error",p.value))}),(k=n.value)==null||k.on("game-invite-cancel",Y=>{Y.from===t.partnerId&&(s.value=!1,u.value=null)}),(N=n.value)==null||N.on("game-close",Y=>{Y.from===t.partnerId&&($(),p.value="Your partner ended the game session.",i("error",p.value),i("close"))}),(B=n.value)==null||B.on("game-error",Y=>{Y.from===t.partnerId&&(p.value=Y.message||"An error occurred in the game.",i("error",p.value))})}),ve(()=>{var y,R,S,k,N,B;(y=n.value)==null||y.off("game-invite"),(R=n.value)==null||R.off("game-invite-accept"),(S=n.value)==null||S.off("game-invite-decline"),(k=n.value)==null||k.off("game-invite-cancel"),(N=n.value)==null||N.off("game-close"),(B=n.value)==null||B.off("game-error")}),{selectedGame:d,waitingForAccept:l,showGameInvite:s,inviteGameType:u,isInitiator:r,roomId:m,inviteGameName:P,error:p,selectGame:c,cancelGame:T,acceptInvite:x,declineInvite:V,closeGame:q,handleGameEnd:U,handleGameError:_}}}),Ln={class:"game-selector"},Vn={key:0,class:"game-list"},Un={class:"grid grid-cols-1 gap-4 mb-4"},Bn={class:"text-center"},zn={key:1,class:"error-screen text-center p-4"},qn={class:"mb-4"},Yn={class:"text-gray-300 mb-4"},Hn={key:2,class:"waiting-screen text-center p-4"},Kn={key:3,class:"game-invite text-center p-4"},Jn={class:"mb-4"},Qn={class:"flex justify-center gap-4"},Xn={key:7,class:"game-not-found text-center p-4"};function Zn(t,i,n,d,l,s){const u=Ae("TicTacToe"),r=Ae("RockPaperScissors"),m=Ae("TriviaGame");return v(),g("div",Ln,[t.selectedGame?t.error?(v(),g("div",zn,[e("div",qn,[i[13]||(i[13]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⚠️")],-1)),i[14]||(i[14]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",Yn,G(t.error),1)]),e("button",{onClick:i[4]||(i[4]=(...p)=>t.closeGame&&t.closeGame(...p)),class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors"}," Back to Games ")])):t.waitingForAccept?(v(),g("div",Hn,[i[15]||(i[15]=e("div",{class:"animate-pulse mb-4"},[e("div",{class:"w-16 h-16 bg-purple-600/30 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⏳")]),e("h3",{class:"text-xl font-bold text-purple-400"},"Waiting for partner to accept...")],-1)),e("button",{onClick:i[5]||(i[5]=(...p)=>t.cancelGame&&t.cancelGame(...p)),class:"px-4 py-2 bg-red-600 rounded-full hover:bg-red-700 transition-colors"}," Cancel ")])):t.showGameInvite?(v(),g("div",Kn,[e("div",Jn,[i[16]||(i[16]=e("div",{class:"w-16 h-16 bg-green-600/30 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"🎮")],-1)),i[17]||(i[17]=e("h3",{class:"text-xl font-bold mb-2 text-purple-400"},"Game Invitation",-1)),e("p",null,"Your partner wants to play "+G(t.inviteGameName),1)]),e("div",Qn,[e("button",{onClick:i[6]||(i[6]=(...p)=>t.acceptInvite&&t.acceptInvite(...p)),class:"px-4 py-2 bg-green-600 rounded-full hover:bg-green-700 transition-colors"}," Accept "),e("button",{onClick:i[7]||(i[7]=(...p)=>t.declineInvite&&t.declineInvite(...p)),class:"px-4 py-2 bg-red-600 rounded-full hover:bg-red-700 transition-colors"}," Decline ")])])):t.selectedGame==="tic-tac-toe"?(v(),Ge(u,{key:4,partnerId:t.partnerId,initialRoomId:t.roomId?t.roomId:void 0,onBack:t.closeGame,onError:t.handleGameError},null,8,["partnerId","initialRoomId","onBack","onError"])):t.selectedGame==="rock-paper-scissors"?(v(),Ge(r,{key:5,partnerId:t.partnerId,initialRoomId:t.roomId?t.roomId:void 0,onBack:t.closeGame,onError:t.handleGameError},null,8,["partnerId","initialRoomId","onBack","onError"])):t.selectedGame==="trivia"?(v(),Ge(m,{key:6,partnerId:t.partnerId,initiator:t.isInitiator,onClose:t.closeGame,onGameEnd:t.handleGameEnd,onError:t.handleGameError},null,8,["partnerId","initiator","onClose","onGameEnd","onError"])):(v(),g("div",Xn,[i[18]||(i[18]=de('<div class="mb-4"><div class="w-16 h-16 bg-yellow-500/20 rounded-full flex items-center justify-center mx-auto mb-2"><span class="text-2xl">🔍</span></div><h3 class="text-xl font-bold mb-2 text-yellow-400">Game Not Found</h3><p class="text-gray-300">The selected game is not available.</p></div>',1)),e("button",{onClick:i[8]||(i[8]=(...p)=>t.closeGame&&t.closeGame(...p)),class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors"}," Back to Games ")])):(v(),g("div",Vn,[i[12]||(i[12]=e("h3",{class:"text-xl font-bold mb-4 text-center text-purple-400"},"Choose a Game",-1)),e("div",Un,[e("button",{onClick:i[0]||(i[0]=p=>t.selectGame("rock-paper-scissors")),class:"p-4 bg-gray-800 rounded-lg flex items-center transition-all hover:bg-gray-700"},i[9]||(i[9]=[de('<div class="w-12 h-12 bg-orange-600/30 rounded-full flex items-center justify-center mr-4"><span class="text-2xl">👊</span></div><div class="flex-1"><h4 class="font-bold">Rock Paper Scissors</h4><p class="text-sm text-gray-300">Classic hand game</p></div>',2)])),e("button",{onClick:i[1]||(i[1]=p=>t.selectGame("tic-tac-toe")),class:"p-4 bg-gray-800 rounded-lg flex items-center transition-all hover:bg-gray-700"},i[10]||(i[10]=[de('<div class="w-12 h-12 bg-blue-600/30 rounded-full flex items-center justify-center mr-4"><span class="text-2xl">⭕</span></div><div class="flex-1"><h4 class="font-bold">Tic-Tac-Toe</h4><p class="text-sm text-gray-300">Classic game of X&#39;s and O&#39;s</p></div>',2)])),e("button",{onClick:i[2]||(i[2]=p=>t.selectGame("trivia")),class:"p-4 bg-gray-800 rounded-lg flex items-center transition-all hover:bg-gray-700"},i[11]||(i[11]=[de('<div class="w-12 h-12 bg-green-600/30 rounded-full flex items-center justify-center mr-4"><span class="text-2xl">❓</span></div><div class="flex-1"><h4 class="font-bold">Trivia Challenge</h4><p class="text-sm text-gray-300">Test your knowledge against your partner</p></div>',2)]))]),e("div",Bn,[e("button",{onClick:i[3]||(i[3]=p=>t.$emit("close")),class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors"}," Cancel ")])]))])}const ea=ue(Fn,[["render",Zn]]),ta={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4"},oa={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},na={class:"flex items-center justify-between p-3 border-b border-gray-800"},aa={key:0,class:"p-4"},la={class:"grid grid-cols-2 gap-4 mb-4"},sa=["disabled"],ra=["disabled"],ia={key:0,class:"text-center text-sm text-gray-400 mt-2"},ca={key:1,class:"text-center p-6"},ua={class:"mb-4"},da={class:"text-gray-300"},va={key:2,class:"text-center p-6"},fa={key:3,class:"text-center p-6"},ga={class:"mb-4"},ma={key:4,class:"mt-2"},pa=3e4,ba=ne({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(t,{emit:i}){const{socket:n}=be(),d=t,l=f(null),s=f(!1),u=f(!1),r=f(null),m=f(null),p=["rock-paper-scissors","tic-tac-toe","trivia"],I={"tic-tac-toe":"Tic-Tac-Toe","rock-paper-scissors":"Rock Paper Scissors",trivia:"Trivia Challenge","sound-game":"Sound Game","word-galaxy":"Word Galaxy"},A=$=>$?I[$]||$:"",F=$=>p.includes($),P=$=>{var U;if(!d.isConnected)return;if(!F($)){m.value=`${A($)} is not yet implemented. Please try another game.`;return}m.value=null,l.value=$,s.value=!0,(U=n.value)==null||U.emit("game-invite",{gameType:$,to:d.partnerId});const _=setTimeout(()=>{s.value&&(s.value=!1,m.value="Your partner didn't respond to the game invitation. Please try again.",l.value=null)},pa);ve(()=>{clearTimeout(_)})},M=()=>{var $;($=n.value)==null||$.emit("game-invite-cancel",{to:d.partnerId}),V()},c=()=>{var $,_;if(r.value){if(!F(r.value)){m.value=`${A(r.value)} is not yet implemented. Please ask your partner to choose another game.`,($=n.value)==null||$.emit("game-invite-decline",{to:d.partnerId}),u.value=!1,r.value=null;return}m.value=null,l.value=r.value,u.value=!1,(_=n.value)==null||_.emit("game-invite-accept",{gameType:r.value,to:d.partnerId}),s.value=!1}},T=()=>{var $;($=n.value)==null||$.emit("game-invite-decline",{to:d.partnerId}),u.value=!1,r.value=null},x=()=>{var $;V(),($=n.value)==null||$.emit("game-close",{to:d.partnerId})},V=()=>{l.value=null,s.value=!1,u.value=!1,r.value=null,m.value=null},q=$=>{m.value=$,l.value=null};return ie(()=>{var $,_,U,y,R,S;($=n.value)==null||$.on("game-invite",k=>{k.from===d.partnerId&&(r.value=k.gameType,u.value=!0)}),(_=n.value)==null||_.on("game-invite-accept",k=>{k.from===d.partnerId&&(s.value?s.value=!1:u.value&&(u.value=!1,l.value=r.value))}),(U=n.value)==null||U.on("game-invite-decline",k=>{k.from===d.partnerId&&(s.value=!1,l.value=null,m.value="Your partner declined the game invitation.")}),(y=n.value)==null||y.on("game-invite-cancel",k=>{k.from===d.partnerId&&(u.value=!1,r.value=null)}),(R=n.value)==null||R.on("game-close",k=>{k.from===d.partnerId&&(V(),m.value="Your partner ended the game session.")}),(S=n.value)==null||S.on("game-error",k=>{k.from===d.partnerId&&(m.value=k.message||"An error occurred in the game.",l.value=null)})}),ve(()=>{var $,_,U,y,R,S;($=n.value)==null||$.off("game-invite"),(_=n.value)==null||_.off("game-invite-accept"),(U=n.value)==null||U.off("game-invite-decline"),(y=n.value)==null||y.off("game-invite-cancel"),(R=n.value)==null||R.off("game-close"),(S=n.value)==null||S.off("game-error")}),le(()=>d.isOpen,$=>{$||V()}),($,_)=>t.isOpen?(v(),g("div",ta,[e("div",oa,[e("div",na,[_[3]||(_[3]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-purple-400 text-xl"},"🎮"),e("h2",{class:"text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),e("button",{onClick:_[0]||(_[0]=U=>$.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),l.value?m.value?(v(),g("div",ca,[e("div",ua,[_[8]||(_[8]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⚠️")],-1)),_[9]||(_[9]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",da,G(m.value),1)]),e("button",{onClick:x,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):s.value?(v(),g("div",va,[_[10]||(_[10]=e("div",{class:"animate-pulse mb-4"},[e("div",{class:"w-16 h-16 bg-purple-600/30 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⏳")]),e("h3",{class:"text-xl font-bold text-purple-400"},"Waiting for partner to accept...")],-1)),e("button",{onClick:M,class:"px-4 py-2 bg-red-600 rounded-full hover:bg-red-700 transition-colors"}," Cancel ")])):u.value?(v(),g("div",fa,[e("div",ga,[_[11]||(_[11]=e("div",{class:"w-16 h-16 bg-green-600/30 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"🎮")],-1)),_[12]||(_[12]=e("h3",{class:"text-xl font-bold mb-2 text-purple-400"},"Game Invitation",-1)),e("p",null,"Your partner wants to play "+G(A(r.value)),1)]),e("div",{class:"flex justify-center gap-4"},[e("button",{onClick:c,class:"px-4 py-2 bg-green-600 rounded-full hover:bg-green-700 transition-colors"}," Accept "),e("button",{onClick:T,class:"px-4 py-2 bg-red-600 rounded-full hover:bg-red-700 transition-colors"}," Decline ")])])):(v(),g("div",ma,[ae(ea,{partnerId:t.partnerId,onClose:x,onError:q},null,8,["partnerId"])])):(v(),g("div",aa,[e("div",la,[e("button",{class:X(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors",{"opacity-50 cursor-not-allowed":!t.isConnected}]),onClick:_[1]||(_[1]=U=>P("rock-paper-scissors")),disabled:!t.isConnected},_[4]||(_[4]=[e("div",{class:"bg-yellow-500 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"👊",-1),e("div",{class:"text-white font-medium"},"Rock Paper Scissors",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,sa),e("button",{class:X(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},_[5]||(_[5]=[de('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-a2c0c965><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-a2c0c965>Coming Soon</span></div><div class="bg-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-a2c0c965>🎵</div><div class="text-white font-medium" data-v-a2c0c965>Sound Game</div><div class="text-xs text-gray-400" data-v-a2c0c965>Voice Challenge</div>',4)])),e("button",{class:X(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors",{"opacity-50 cursor-not-allowed":!t.isConnected}]),onClick:_[2]||(_[2]=U=>P("tic-tac-toe")),disabled:!t.isConnected},_[6]||(_[6]=[e("div",{class:"bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"⭕",-1),e("div",{class:"text-white font-medium"},"Tic-Tac-Toe",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,ra),e("button",{class:X(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},_[7]||(_[7]=[de('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-a2c0c965><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-a2c0c965>Coming Soon</span></div><div class="bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-a2c0c965>💬</div><div class="text-white font-medium" data-v-a2c0c965>Word Galaxy</div><div class="text-xs text-gray-400" data-v-a2c0c965>Brain Game</div>',4)]))]),t.isConnected?J("",!0):(v(),g("p",ia," Connect to play with others "))]))])])):J("",!0)}});const ya=ue(ba,[["__scopeId","data-v-a2c0c965"]]),ha={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},xa={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},wa={class:"flex items-center justify-between mb-6"},Ca={class:"grid grid-cols-3 gap-4 mb-6"},ka=ne({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(t,{emit:i}){const n=i,d=f(15),l=u=>{d.value=u},s=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${d.value}`,"_blank"),n("close")};return(u,r)=>t.isOpen?(v(),g("div",ha,[e("div",xa,[e("div",wa,[r[4]||(r[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-red-400 text-xl"},"❤️"),e("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),e("button",{onClick:r[0]||(r[0]=m=>u.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),r[8]||(r[8]=e("div",{class:"mb-6 text-center"},[e("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),e("div",Ca,[e("button",{class:X(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",d.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[1]||(r[1]=m=>l(5))},r[5]||(r[5]=[e("div",{class:"text-lg font-bold text-white"},"$5",-1),e("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),e("button",{class:X(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",d.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[2]||(r[2]=m=>l(15))},r[6]||(r[6]=[e("div",{class:"text-lg font-bold text-white"},"$15",-1),e("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),e("button",{class:X(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",d.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[3]||(r[3]=m=>l(50))},r[7]||(r[7]=[e("div",{class:"text-lg font-bold text-white"},"$50",-1),e("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),r[9]||(r[9]=e("div",{class:"flex justify-center items-center gap-1 mb-6"},[e("span",{class:"text-yellow-400"},"⭐"),e("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),e("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:s}," Donate via PayPal "),r[10]||(r[10]=e("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):J("",!0)}}),Ta={class:"relative w-full"},$a={class:"py-1"},Ra=ne({__name:"select",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Select an option"},options:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(t,{emit:i}){const n=t,d=f(!1),l=f(null),s=f(null),u=re(()=>{if(n.options&&n.options.length){const p=n.options.find(I=>I.value===n.modelValue);return p?p.label:""}return n.modelValue}),r=()=>{d.value=!d.value},m=p=>{d.value&&l.value&&s.value&&!l.value.contains(p.target)&&!s.value.contains(p.target)&&(d.value=!1)};return ie(()=>{document.addEventListener("click",m)}),Ne(()=>{document.removeEventListener("click",m)}),(p,I)=>(v(),g("div",Ta,[e("button",{type:"button",ref_key:"triggerRef",ref:l,onClick:r,class:"w-full flex items-center justify-between bg-purple-500/20 border-purple-500/30 rounded-full h-8 px-3 text-xs shadow-lg shadow-purple-500/20 text-white"},[e("span",null,G(u.value||t.placeholder),1),I[0]||(I[0]=e("span",{class:"ml-1"},"▼",-1))],512),ae(At,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Et(()=>[d.value?(v(),g("div",{key:0,ref_key:"contentRef",ref:s,class:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto"},[e("div",$a,[qe(p.$slots,"default",{},()=>[qe(p.$slots,"placeholder",{},()=>[I[1]||(I[1]=e("div",{class:"px-3 py-2 text-xs text-gray-400"},"No items",-1))],!0)],!0)])],512)):J("",!0)]),_:3})]))}});const je=ue(Ra,[["__scopeId","data-v-9f96ce6c"]]),Sa={class:"fixed inset-0 overflow-hidden pointer-events-none"},_a=ne({__name:"starfield",setup(t){const i=f([]);ie(()=>{n()});const n=()=>{const l=[];for(let s=0;s<50;s++)l.push({id:s,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});i.value=l};return(d,l)=>(v(),g("div",Sa,[(v(!0),g(me,null,pe(i.value,s=>(v(),g("div",{key:s.id,class:"absolute rounded-full bg-white",style:Gt({width:`${s.size}px`,height:`${s.size}px`,top:`${s.y}%`,left:`${s.x}%`,opacity:s.opacity,boxShadow:`0 0 ${s.size*2}px rgba(255, 255, 255, ${s.opacity})`,animation:`twinkle ${s.duration}s infinite ease-in-out`})},null,4))),128))]))}});const Ia=ue(_a,[["__scopeId","data-v-f4bff5a3"]]),Oe=!1,Wa=10,Ea=ne({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(t){const{remoteStream:i,connectionState:n,partnerId:d,isAudioMuted:l}=Me(),s=f(null),u=f(.8),r=f(!1),m=f(0),p=re(()=>(i.value!==null&&i.value?i.value.getAudioTracks().length>0:!1)&&i.value?i.value.getAudioTracks().some($=>$.enabled):!1);re(()=>i.value?i.value.getAudioTracks().filter(x=>x.enabled&&x.readyState==="live").length:0),re(()=>r.value&&p.value?"connected":(n.value==="connected"&&!p.value&&!r.value&&setTimeout(M,500),n.value)),le(()=>i.value,x=>{M(),m.value=0,setTimeout(c,500)}),le(()=>l.value,x=>{!x&&i.value&&s.value&&setTimeout(()=>{s.value&&s.value.paused&&s.value.play().catch(V=>{})},300)}),le(()=>n.value,x=>{x==="connected"?setTimeout(()=>{M(),c()},1e3):x==="new"||x==="connecting"?m.value=0:(x==="disconnected"||x==="failed")&&T()}),le(()=>d.value,x=>{r.value=!1,m.value=0,x||s.value&&(s.value.srcObject=null)}),ie(()=>{M(),s.value&&(s.value.onplaying=()=>{r.value=!0},s.value.onpause=()=>{r.value=!1},s.value.onended=()=>{r.value=!1},s.value.onerror=x=>{console.error("[AudioOutput] Audio error:",x),r.value=!1},s.value.volume=u.value),document.addEventListener("visibilitychange",P),A()}),Ne(()=>{s.value&&(s.value.srcObject=null),document.removeEventListener("visibilitychange",P),F()});let I=null;function A(){F(),I=window.setInterval(()=>{!r.value&&p.value&&n.value==="connected"&&(M(),c())},5e3)}function F(){I&&(clearInterval(I),I=null)}function P(){document.visibilityState==="visible"&&(M(),setTimeout(()=>{!r.value&&p.value&&c()},500))}function M(){s.value&&(i.value?(s.value.srcObject=i.value,i.value.getAudioTracks().forEach(x=>{x.enabled=!0}),c()):(s.value.srcObject=null,r.value=!1))}async function c(){if(!(!s.value||!s.value.srcObject))try{const x=i.value&&i.value.getAudioTracks().length>0;await s.value.play(),r.value=!0,m.value=0}catch(x){if(console.error("[AudioOutput] Error playing audio:",x),r.value=!1,x instanceof DOMException&&x.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),m.value<Wa){m.value++;const V=m.value*1e3;setTimeout(c,V)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function T(){m.value=0,s.value&&(s.value.srcObject=null),setTimeout(()=>{M(),c()},500)}return(x,V)=>(v(),g("div",null,[e("audio",{ref_key:"audioElement",ref:s,autoplay:"",playsinline:"",class:"hidden"},null,512),J("",!0)]))}});const Aa=ue(Ea,[["__scopeId","data-v-f63dc209"]]),Ga={class:"min-h-screen font-sans"},Pa={class:"relative min-h-screen z-10 text-white"},ja={class:"p-4 border-b border-white/10"},Oa={class:"max-w-4xl mx-auto"},Da={class:"flex justify-center gap-2 mb-3"},Ma={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},Na={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},Fa={class:"grid grid-cols-2 gap-2 text-xs relative"},La={class:"flex items-center"},Va={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Ua={class:"py-1"},Ba=["onClick"],za={class:"text-sm"},qa={class:"flex-1 p-4"},Ya={class:"max-w-md mx-auto space-y-6"},Ha={class:"flex items-center justify-center gap-2 mb-4"},Ka={class:"text-center"},Ja={class:"text-xs text-gray-400 italic"},Qa={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Xa={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},Za={class:"flex justify-between items-center mb-4"},el={class:"space-y-3"},tl={key:0,class:"text-center py-8"},ol={class:"flex items-center gap-3"},nl={class:"text-2xl"},al={class:"text-white text-sm font-medium"},ll={class:"text-gray-400 text-xs"},sl={class:"text-xs text-gray-500"},rl={key:0,class:"text-xs text-gray-500 text-center mt-4"},il={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},cl={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},ul={class:"flex justify-between items-center mb-4"},dl={class:"space-y-4"},vl={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},fl={key:0,class:"text-xs text-gray-400 p-2"},gl={key:1,class:"flex flex-wrap gap-1"},ml=["onClick"],pl={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},bl={key:0,class:"text-xs text-gray-400 p-2"},yl={key:1,class:"flex flex-wrap gap-1"},hl=["onClick"],xl={key:2,class:"hidden"},wl=ne({__name:"HomeView",setup(t){const i=f("disconnected"),n=f(null),d=f(null),l=f(""),s=f(!1),u=f(!1),r=f(!1),m=f(!1),p=f(!1),I=f(!1),A=f(0),F=f(0),P=f(!1),M=f([]),c=f([]),T=f("any"),x=f(!1),V=f(""),q=f([]),$=f([]),_=f("off"),U=f(""),y=f(""),R=[{value:"any",text:"Any Vibe",emoji:"🌟"},{value:"chill",text:"Chill",emoji:"😌"},{value:"fun",text:"Fun",emoji:"🎉"},{value:"curious",text:"Curious",emoji:"🤔"},{value:"creative",text:"Creative",emoji:"🎨"}],S=[{value:"off",label:"⏰ Disabled"},{value:"30",label:"30 seconds"},{value:"60",label:"60 seconds"},{value:"90",label:"90 seconds"}],k=[{value:"any",label:"🌍 Any Country"},{value:"us",label:"🇺🇸 United States"},{value:"gb",label:"🇬🇧 United Kingdom"},{value:"ca",label:"🇨🇦 Canada"},{value:"au",label:"🇦🇺 Australia"},{value:"de",label:"🇩🇪 Germany"},{value:"fr",label:"🇫🇷 France"},{value:"it",label:"🇮🇹 Italy"},{value:"es",label:"🇪🇸 Spain"},{value:"jp",label:"🇯🇵 Japan"}],N=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],B=f(N[Math.floor(Math.random()*N.length)]),z=be().socket,{remoteStream:o,localStream:a,connectionState:b,createOffer:W,handleOffer:L,handleAnswer:ce,handleIceCandidate:ot,closeConnection:Fe,toggleMicrophone:nt,initializeLocalStream:at}=Me(),lt=Qt(),st=jt(),Le=f(st.params.roomId||null);le(()=>Le.value,w=>{w&&(r.value=!0)},{immediate:!0});const rt=re(()=>k.filter(w=>w.value!=="any"&&!q.value.includes(w.value)&&!$.value.includes(w.value))),it=re(()=>k.filter(w=>w.value!=="any"&&!$.value.includes(w.value)&&!q.value.includes(w.value))),ct=async()=>{const w=await nt();s.value!==!w&&(s.value=!w),i.value==="connected"&&setTimeout(()=>{const h=document.querySelector("audio");h&&h.paused&&h.play().catch(()=>{})},300)},Ve=async()=>{if(!a.value)try{await at(),console.log("Microphone initialized")}catch(w){console.error("Failed to access microphone",w),alert("Please allow microphone access to use voice chat");return}z.value&&(i.value="searching",n.value&&(console.log("Disconnecting from current partner"),z.value.emit("disconnect-partner"),n.value=null,d.value=null,M.value=[],Fe()),console.log("Finding new partner with preferences"),z.value.emit("join-queue",{vibe:T.value,preferences:{preferredCountries:q.value.length?q.value:void 0,blockedCountries:$.value.length?$.value:void 0,interests:V.value?V.value.split(",").map(w=>w.trim()):void 0}}),F.value++)},ut=()=>{u.value=!u.value,u.value&&n.value&&lt.markAsRead(n.value)},dt=w=>{z.value&&n.value&&(z.value.emit("chat-message",{message:w,to:n.value}),M.value.push({id:Date.now().toString(),message:w,isOwn:!0,timestamp:Date.now()}))},vt=w=>{console.log(`Selected game: ${w}`),z.value&&n.value&&z.value.emit("game-invite",{game:w,to:n.value})},ft=()=>{U.value&&!q.value.includes(U.value)&&(q.value.push(U.value),U.value="")},gt=w=>{q.value=q.value.filter(h=>h!==w)},mt=()=>{y.value&&!$.value.includes(y.value)&&($.value.push(y.value),y.value="")},pt=w=>{$.value=$.value.filter(h=>h!==w)},bt=()=>{V.value="",q.value=[],$.value=[],_.value="off"},yt=()=>{I.value=!1},Ue=w=>{const h=k.find(E=>E.value===w);return h?h.label.split(" ")[0]:"🏳️"},Be=w=>{const h=k.find(E=>E.value===w);return h?h.label.split(" ").slice(1).join(" "):"Unknown"},ht=w=>new Date(w).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),xt=()=>{x.value=!x.value},wt=w=>{T.value=w,x.value=!1},Ct=w=>{const h=R.find(E=>E.value===w);return h?h.emoji:"🌟"},kt=w=>{const h=R.find(E=>E.value===w);return h?h.text:"Any Vibe"};ie(async()=>{console.log("Home view mounted"),z.value&&(z.value.on("online-count",w=>{A.value=w}),z.value.on("matched",w=>{if(console.log("Partner matched with event:",w),i.value="matched",l.value="",n.value=w.partnerId,d.value={id:w.partnerId,country:w.country||"Unknown",flag:w.flag||"🌍",vibe:w.vibe||"any"},c.value.unshift({id:Date.now().toString(),country:d.value.country,flag:d.value.flag,timestamp:Date.now()}),c.value.length>3&&(c.value=c.value.slice(0,3)),console.log("Partner matched:",w),w.partnerId){console.log("Initiating WebRTC connection with partner immediately");const{createOffer:h}=Me();h(w.partnerId),setTimeout(()=>{i.value==="matched"&&b.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),i.value="connected")},2e3)}}),z.value.on("direct-connection-established",w=>{console.log("Direct connection established:",w),i.value="connected",n.value=w.partnerId,d.value={id:w.partnerId,country:w.country||"Unknown",flag:w.flag||"🌍"}}),z.value.on("partner-disconnected",()=>{i.value="disconnected",n.value=null,d.value=null,M.value=[],P.value&&setTimeout(()=>{i.value==="disconnected"&&P.value&&Ve()},2e3)}),z.value.on("chat-message",w=>{M.value.push({id:Date.now().toString(),message:w.message,isOwn:!1,timestamp:Date.now()})}),z.value.on("error",w=>{console.error("Socket error:",w.message),w.type==="matching"&&(i.value="disconnected")}),z.value.on("voice-offer",Tt),z.value.on("voice-answer",$t),z.value.on("ice-candidate",Rt),z.value.emit("get-online-count")),document.addEventListener("click",ze)}),Ne(()=>{console.log("Home view unmounting, cleaning up connection"),Fe(),z.value&&(z.value.off("online-count"),z.value.off("matched"),z.value.off("direct-connection-established"),z.value.off("partner-disconnected"),z.value.off("chat-message"),z.value.off("error"),z.value.off("voice-offer"),z.value.off("voice-answer"),z.value.off("ice-candidate")),document.removeEventListener("click",ze)});const Tt=async w=>{console.log("Received voice offer - forwarding to WebRTC service"),L(w.offer,w.from)},$t=async w=>{console.log("Received voice answer - forwarding to WebRTC service"),ce(w.answer)},Rt=async w=>{console.log("Received ICE candidate - forwarding to WebRTC service"),ot(w.candidate)};le(b,(w,h)=>{console.log(`[HomeView] WebRTC connection state changed: ${h} -> ${w}`),w==="connected"&&i.value==="matched"?setTimeout(()=>{b.value==="connected"&&i.value==="matched"&&(i.value="connected",l.value="",console.log("[HomeView] Successfully transitioned from matched to connected"))},1e3):w==="failed"?(l.value="",setTimeout(()=>{b.value==="failed"&&(i.value==="matched"||i.value==="connected")&&(l.value='Connection failed. Press "Next" to find a new partner.')},6e4)):w==="disconnected"&&(i.value==="connected"||i.value==="matched")&&(l.value="",setTimeout(()=>{b.value==="disconnected"&&(i.value==="connected"||i.value==="matched")&&(l.value="Connection lost. Trying to reconnect...")},6e4))});const We=f(null),ze=w=>{const h=w.target;We.value&&!We.value.contains(h)&&(x.value=!1)};return(w,h)=>(v(),g("div",Ga,[h[26]||(h[26]=de('<div class="fixed inset-0 pointer-events-none" data-v-d136ba69><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-d136ba69></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-d136ba69></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-d136ba69></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-d136ba69></div></div>',1)),ae(Ia),e("div",Pa,[e("header",ja,[e("div",Oa,[h[15]||(h[15]=de('<div class="text-center mb-4" data-v-d136ba69><div class="inline-flex items-center gap-2" data-v-d136ba69><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-d136ba69><span class="text-white text-xs" data-v-d136ba69>✨</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-d136ba69> SpaceTalk.live </h1></div></div>',1)),e("div",Da,[e("div",Ma,[h[14]||(h[14]=e("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),e("span",null,G(A.value)+" online",1)]),F.value>0?(v(),g("div",Na," Today: "+G(F.value)+" voices ",1)):J("",!0)]),e("div",Fa,[e("div",{class:"relative",ref_key:"vibeDropdownRef",ref:We},[e("div",{onClick:xt,class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[e("span",La,G(Ct(T.value))+" "+G(kt(T.value)),1),e("span",{class:X(["ml-2 text-xs transition-transform duration-300",{"rotate-180":x.value}])},"▼",2)]),x.value?(v(),g("div",Va,[e("div",Ua,[(v(),g(me,null,pe(R,E=>e("div",{key:E.value,onClick:Re=>wt(E.value),class:X(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":T.value===E.value}])},[e("span",za,G(E.emoji),1),e("span",null,G(E.text),1)],10,Ba)),64))])])):J("",!0)],512),e("button",{onClick:h[0]||(h[0]=E=>I.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," 🔍 Filters ")])])]),e("main",qa,[e("div",Ya,[ae(go,{status:i.value,"partner-info":d.value,"error-message":l.value,"show-status":!0},null,8,["status","partner-info","error-message"]),e("div",Ha,[De(e("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":h[1]||(h[1]=E=>P.value=E),class:"w-3 h-3 rounded border-gray-600 bg-gray-700 text-emerald-500 focus:ring-emerald-500 focus:ring-1"},null,512),[[Pt,P.value]]),h[16]||(h[16]=e("label",{for:"auto-reconnect",class:"text-xs text-gray-400 cursor-pointer"}," Auto-reconnect to others ",-1))]),ae(To,{"is-muted":s.value,"is-disabled":i.value!=="connected",onToggleMute:ct,onFindNext:Ve,onToggleChat:ut,onToggleGames:h[2]||(h[2]=E=>r.value=!0),onToggleHistory:h[3]||(h[3]=E=>p.value=!0),onToggleDonation:h[4]||(h[4]=E=>m.value=!0)},null,8,["is-muted","is-disabled"]),e("div",Ka,[e("p",Ja,'"'+G(B.value)+'"',1)])])]),h[17]||(h[17]=de('<footer class="p-4 border-t border-white/10" data-v-d136ba69><div class="max-w-md mx-auto text-center space-y-2" data-v-d136ba69><h3 class="text-sm font-semibold text-emerald-400" data-v-d136ba69>Community Guidelines</h3><div class="text-xs text-gray-300 space-y-1" data-v-d136ba69><p data-v-d136ba69>• Must be 18+ years old to use this service</p><p data-v-d136ba69>• Be respectful and kind to other users</p><p data-v-d136ba69>• No harassment, hate speech, or inappropriate content</p><p data-v-d136ba69>• Report any misconduct using the report feature</p><p data-v-d136ba69>• Your privacy and safety are our priority</p></div><p class="text-xs text-gray-400 mt-3" data-v-d136ba69> By using SpaceTalk.live, you agree to follow these guidelines </p><div class="flex justify-center gap-3 mt-4 text-xs" data-v-d136ba69><a href="#" class="bg-cyan-500/20 border border-cyan-500/30 rounded-full px-3 py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20" data-v-d136ba69> ℹ️ About </a><a href="https://instagram.com" target="_blank" class="bg-pink-500/20 border border-pink-500/30 rounded-full px-3 py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20" data-v-d136ba69> 📷 Instagram </a><a href="https://facebook.com" target="_blank" class="bg-blue-500/20 border border-blue-500/30 rounded-full px-3 py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20" data-v-d136ba69> 📘 Facebook </a><a href="mailto:contact@spacetalk.live" class="bg-emerald-500/20 border border-emerald-500/30 rounded-full px-3 py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20" data-v-d136ba69> 📧 Contact </a></div></div></footer>',1))]),p.value?(v(),g("div",Qa,[e("div",Xa,[e("div",Za,[h[18]||(h[18]=e("h2",{class:"text-lg font-semibold text-indigo-400"},"📞 Call History",-1)),e("button",{onClick:h[5]||(h[5]=E=>p.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",el,[c.value.length===0?(v(),g("div",tl,h[19]||(h[19]=[e("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),e("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(v(!0),g(me,{key:1},pe(c.value,(E,Re)=>(v(),g("div",{key:E.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[e("div",ol,[e("span",nl,G(E.flag),1),e("div",null,[e("p",al,G(E.country),1),e("p",ll,G(ht(E.timestamp)),1)])]),e("div",sl," #"+G(Re+1),1)]))),128))]),c.value.length>0?(v(),g("p",rl," History clears when you leave the page ")):J("",!0)])])):J("",!0),I.value?(v(),g("div",il,[e("div",cl,[e("div",ul,[h[20]||(h[20]=e("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),e("button",{onClick:h[6]||(h[6]=E=>I.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",dl,[e("div",null,[h[21]||(h[21]=e("label",{class:"block text-sm font-medium mb-2 text-teal-400"},"Interest Keywords",-1)),De(e("input",{"onUpdate:modelValue":h[7]||(h[7]=E=>V.value=E),type:"text",placeholder:"e.g., music, travel, technology...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-emerald-500 focus:outline-none"},null,512),[[et,V.value]]),h[22]||(h[22]=e("p",{class:"text-xs text-gray-400 mt-1"},"Separate with commas",-1))]),e("div",null,[h[23]||(h[23]=e("label",{class:"block text-sm font-medium mb-2 text-emerald-400"},"Preferred Countries",-1)),e("div",vl,[q.value.length===0?(v(),g("p",fl,"No countries selected")):(v(),g("div",gl,[(v(!0),g(me,null,pe(q.value,E=>(v(),g("span",{key:E,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[$e(G(Ue(E))+" "+G(Be(E))+" ",1),e("button",{onClick:Re=>gt(E),class:"text-emerald-200 hover:text-white ml-1"}," ✕ ",8,ml)]))),128))]))]),ae(je,{modelValue:U.value,"onUpdate:modelValue":h[8]||(h[8]=E=>U.value=E),options:rt.value,placeholder:"Add preferred country...",class:"mt-2",onChange:ft},null,8,["modelValue","options"])]),e("div",null,[h[24]||(h[24]=e("label",{class:"block text-sm font-medium mb-2 text-red-400"},"Blocked Countries",-1)),e("div",pl,[$.value.length===0?(v(),g("p",bl,"No countries blocked")):(v(),g("div",yl,[(v(!0),g(me,null,pe($.value,E=>(v(),g("span",{key:E,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[$e(G(Ue(E))+" "+G(Be(E))+" ",1),e("button",{onClick:Re=>pt(E),class:"text-red-200 hover:text-white ml-1"}," ✕ ",8,hl)]))),128))]))]),ae(je,{modelValue:y.value,"onUpdate:modelValue":h[9]||(h[9]=E=>y.value=E),options:it.value,placeholder:"Add blocked country...",class:"mt-2",onChange:mt},null,8,["modelValue","options"])]),e("div",null,[h[25]||(h[25]=e("label",{class:"block text-sm font-medium mb-2 text-orange-400"},"Auto-Next Timer",-1)),ae(je,{modelValue:_.value,"onUpdate:modelValue":h[10]||(h[10]=E=>_.value=E),options:S,placeholder:"Select timer"},null,8,["modelValue"])])]),e("div",{class:"flex gap-2 mt-6"},[e("button",{onClick:bt,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Clear All "),e("button",{onClick:yt,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):J("",!0),ae(Oo,{"is-open":u.value,onClose:h[11]||(h[11]=E=>u.value=!1),messages:M.value,onSendMessage:dt,"is-connected":i.value==="connected"},null,8,["is-open","messages","is-connected"]),ae(ya,{"is-open":r.value,onClose:h[12]||(h[12]=E=>r.value=!1),"is-connected":i.value==="connected",onSelectGame:vt,"partner-id":n.value||"","initial-game-room-id":Le.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),ae(ka,{"is-open":m.value,onClose:h[13]||(h[13]=E=>m.value=!1)},null,8,["is-open"]),i.value==="connected"?(v(),g("div",xl,[ae(Aa,{showControls:!1})])):J("",!0)]))}});const Ze=ue(wl,[["__scopeId","data-v-d136ba69"]]),Cl=Ot({history:Dt("/"),routes:[{path:"/",name:"home",component:Ze},{path:"/game/:roomId",name:"game",component:Ze,props:!0}]}),tt=Mt(Lt);tt.use(Cl);tt.mount("#app");
//# sourceMappingURL=index-25b167b2.js.map
