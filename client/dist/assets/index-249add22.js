import{d as ee,c as x,a as Q,u as kt,o as h,R as Rt,r as p,b as se,e as $e,s as Ie,w as J,f as le,g as e,t as M,h as G,n as B,F as ie,i as ce,j as St,k as je,v as Je,l as $t,m as De,p as me,q as _t,x as Me,y as Wt,T as It,z as Ge,A as Et,B as At,C as Ot,D as jt,E as Dt,G as Pt}from"./vue-vendor-21d667bf.js";import{l as Mt}from"./socket-vendor-d9998155.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))w(l);new MutationObserver(l=>{for(const n of l)if(n.type==="childList")for(const f of n.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&w(f)}).observe(document,{childList:!0,subtree:!0});function s(l){const n={};return l.integrity&&(n.integrity=l.integrity),l.referrerPolicy&&(n.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?n.credentials="include":l.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function w(l){if(l.ep)return;l.ep=!0;const n=s(l);fetch(l.href,n)}})();const Nt={class:"app-container"},Ft=ee({__name:"App",setup(a){return(v,s)=>(h(),x("div",Nt,[Q(kt(Rt))]))}});const Lt=()=>window.location.origin,P=p(null),de=p(null),pe=p(!1);function he(){se(()=>{P.value||a()}),$e(()=>{P.value&&s()});function a(){const l=Lt();console.log(`Connecting to socket server at: ${l}`),P.value=Mt(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:2e4,transports:["websocket","polling"]}),v()}function v(){P.value&&(P.value.on("connect",()=>{var l,n;console.log("Socket connected"),pe.value=!0,(l=P.value)==null||l.emit("user:identify",{},f=>{console.log("Identified with server, user ID:",f),de.value=f}),(n=P.value)==null||n.emit("get-online-count")}),P.value.on("disconnect",()=>{console.log("Socket disconnected"),pe.value=!1}),P.value.on("reconnect",l=>{var n;console.log(`Socket reconnected after ${l} attempts`),pe.value=!0,de.value&&((n=P.value)==null||n.emit("user:identify",{prevUserId:de.value},f=>{var r;console.log("Re-identified with server after reconnection, user ID:",f),de.value=f,(r=P.value)==null||r.emit("get-online-count")}))}),P.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),P.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),P.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{pe.value||(console.log("Attempting to reinitialize socket connection..."),s(),a())},5e3)}),P.value.on("error",l=>{console.error("Socket error:",l)}),P.value.on("user-id",l=>{console.log("Received user ID from server:",l),de.value=l}))}function s(){P.value&&(P.value.off("connect"),P.value.off("disconnect"),P.value.off("reconnect"),P.value.off("reconnect_attempt"),P.value.off("reconnect_error"),P.value.off("reconnect_failed"),P.value.off("error"),P.value.off("user-id"))}function w(){P.value?(console.log("Forcing socket reconnection..."),P.value.disconnect(),P.value.connect()):a()}return{socket:P,isConnected:pe,userId:de,reconnect:w}}const Vt={iceServers:[{urls:["turn:relay.metered.ca:443?transport=tcp","turn:relay.metered.ca:443","turn:relay.metered.ca:80"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:80"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};let g=null,W=null,I=null;const V=p("new"),ne=p(!1),be=p(null),_=!0;let X="",ke="",Y=!1,Z=!1,F=0;const K=10;let fe=[],ge=null,ve=null;const Ut=3e3,zt=5e3,Be=8e3,He=500;async function Gt(){if(!g)return{error:"No peer connection available"};try{const a={};return(await g.getStats()).forEach(s=>{s.type==="transport"?a.transport={bytesReceived:s.bytesReceived,bytesSent:s.bytesSent,dtlsState:s.dtlsState,selectedCandidatePairId:s.selectedCandidatePairId}:s.type==="candidate-pair"&&s.selected?a.selectedCandidatePair={localCandidateId:s.localCandidateId,remoteCandidateId:s.remoteCandidateId,state:s.state,availableOutgoingBitrate:s.availableOutgoingBitrate}:s.type==="local-candidate"||s.type==="remote-candidate"?(a.candidates||(a.candidates=[]),a.candidates.push({type:s.type,id:s.id,ip:s.ip,port:s.port,protocol:s.protocol,candidateType:s.candidateType})):(s.type==="media-source"||s.type==="track"||s.type==="media-playout")&&(a.media||(a.media=[]),a.media.push({type:s.type,id:s.id,kind:s.kind,audioLevel:s.audioLevel,trackIdentifier:s.trackIdentifier}))}),a}catch(a){return console.error("[WebRTC] Error getting stats:",a),{error:"Failed to get stats: "+a}}}let Re={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:relay.metered.ca:80","turn:relay.metered.ca:443"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};const Bt={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Ht={iceTransportPolicy:"relay",iceCandidatePoolSize:10,iceServers:[{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:relay.metered.ca:80","turn:relay.metered.ca:443"],username:"e7d68233d99b711f726f5f4d",credential:"tYJEzRe2K5L7A0kO"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:["turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},qe={iceTransportPolicy:"all",iceCandidatePoolSize:10,iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]},{urls:["turn:openrelay.metered.ca:80","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};function Pe(){const{socket:a,userId:v}=he(),s=Ie(g),w=Ie(W),l=Ie(I),n=V,f=ne,r=be;p({echoCancellation:!0,noiseSuppression:!0});const S=async()=>{try{if(W){_&&console.log("[WebRTC] Using existing local stream");const o=W.getAudioTracks();if(o.length===0||!o[0].enabled)_&&console.log("[WebRTC] Existing stream has no active audio tracks, requesting new stream"),W.getTracks().forEach(c=>c.stop()),W=null;else return W}_&&console.log("[WebRTC] Requesting access to microphone with specific constraints");const t=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:2},video:!1});if(t.getAudioTracks().length===0)throw console.error("[WebRTC] No audio tracks found in stream"),new Error("No audio tracks available");return _&&(console.log("[WebRTC] Local stream acquired successfully"),console.log("[WebRTC] Audio tracks:",t.getAudioTracks().length),t.getAudioTracks().forEach(c=>{console.log(`[WebRTC] Track: ${c.label}, enabled: ${c.enabled}, muted: ${c.muted}, readyState: ${c.readyState}`),console.log("[WebRTC] Track settings:",JSON.stringify(c.getSettings()))})),t.getTracks().forEach(o=>{o.enabled=!0}),W=t,w.value=t,t}catch(t){console.error("[WebRTC] Error accessing microphone:",t);try{_&&console.log("[WebRTC] Trying fallback with simpler constraints");const o=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");return W=o,w.value=o,o}catch(o){throw console.error("[WebRTC] Fallback also failed:",o),new Error("Could not access microphone. Please check permissions.")}}},E=()=>{if(g&&g.connectionState!=="closed"&&g.connectionState!=="failed"&&g.connectionState!=="disconnected")return console.log("[WebRTC] Reusing existing peer connection"),g;console.log("[WebRTC] Creating new peer connection with TURN servers"),g&&i();const t=new RTCPeerConnection(Vt);return I||(I=new MediaStream,l.value=I),oe(t),t.ontrack=o=>{console.log("[WebRTC] Track received:",o.track.kind),o.track.kind==="audio"&&(console.log("[WebRTC] Adding remote audio track to stream"),I||(I=new MediaStream),I.addTrack(o.track),l.value=I,o.track.enabled=!0)},t.onconnectionstatechange=()=>{if(console.log("[WebRTC] Connection state changed:",t.connectionState),t.connectionState==="connecting"&&V.value==="connected"&&I&&I.getAudioTracks().length>0&&I.getAudioTracks().some(c=>c.enabled)){console.log('[WebRTC] Ignoring state change to "connecting" because audio is working');return}if(t.connectionState==="connecting"&&V.value==="matched"){console.log("[WebRTC] Still in negotiation phase, keeping matched state");return}if(V.value=t.connectionState||"new",n.value=t.connectionState||"new",t.connectionState==="connected")console.log("[WebRTC] Connection established"),F=0,H(),setTimeout(()=>{$();const o=I&&I.getAudioTracks().length>0&&I.getAudioTracks().some(c=>c.readyState==="live");console.log(`[WebRTC] Audio tracks working: ${o}`),setTimeout(()=>{t.connectionState==="connected"&&($(),V.value==="matched"&&(console.log("[WebRTC] Updating state from matched to connected"),V.value="connected",n.value="connected"))},1e3)},300),D();else if(t.connectionState==="failed")ke="Connection failed",F<K&&!Z?(F++,console.log(`[WebRTC] Connection failed, attempting recovery (${F}/${K})`),O()):console.error("[WebRTC] Connection failed and max retries reached");else if(t.connectionState==="disconnected"){if(I&&I.getAudioTracks().length>0&&I.getAudioTracks().some(c=>c.readyState==="live")){console.log("[WebRTC] Connection reported as disconnected but audio still works, not changing state"),!Z&&F<K&&(F++,console.log(`[WebRTC] Silent connection recovery (${F}/${K})`),setTimeout(()=>{(t.connectionState==="disconnected"||t.connectionState==="failed")&&(console.log("[WebRTC] Attempting silent recovery"),O())},1e3));return}setTimeout(()=>{t.connectionState==="disconnected"&&!Z&&F<K&&(F++,console.log(`[WebRTC] Connection disconnected, attempting recovery (${F}/${K})`),O())},1e3)}else t.connectionState==="closed"&&(y(),re())},t.oniceconnectionstatechange=()=>{console.log("[WebRTC] ICE connection state changed:",t.iceConnectionState),t.iceConnectionState==="failed"?(ke="ICE connection failed",!Z&&F<K&&(F++,console.log(`[WebRTC] ICE connection failed, attempting restart (${F}/${K})`),Z=!0,setTimeout(async()=>{if(t.connectionState!=="closed")try{_&&console.log("[WebRTC] Attempting ICE restart");const o=await t.createOffer({iceRestart:!0});await t.setLocalDescription(o),a.value&&r.value&&a.value.emit("voice-offer",{offer:t.localDescription,to:r.value}),setTimeout(()=>{Z=!1},5e3)}catch(o){console.error("[WebRTC] ICE restart failed:",o),Z=!1}else Z=!1},1e3))):t.iceConnectionState==="connected"&&$()},t.onicecandidate=o=>{if(!o.candidate){console.log("[WebRTC] ICE gathering complete");return}console.log("[WebRTC] ICE candidate generated:",o.candidate.candidate),a.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),a.value.emit("ice-candidate",{candidate:o.candidate,to:r.value}))},t.onicegatheringstatechange=()=>{console.log("[WebRTC] ICE gathering state changed:",t.iceGatheringState)},t.onsignalingstatechange=()=>{console.log("[WebRTC] Signaling state changed:",t.signalingState),t.signalingState==="stable"&&(Y=!1)},g=t,s.value=t,t},C=async t=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),!t){const o="Cannot create offer: No target partner ID provided";return console.error(`[WebRTC] ${o}`),X=o,{error:o}}if(!a.value){const o="Cannot create offer: socket not available";return console.error(`[WebRTC] ${o}`),X=o,{error:o}}if(!W)try{_&&console.log("[WebRTC] Initializing local stream before creating offer"),await S()}catch(o){return console.error("[WebRTC] Failed to initialize local stream:",o),X=`Failed to access microphone: ${o}`,{error:`Failed to access microphone: ${o}`}}if(console.log(`[WebRTC] Creating offer for partner: ${t}`),Y)return console.warn("[WebRTC] Negotiation already in progress, deferring new offer"),new Promise(o=>{setTimeout(async()=>{o(Y?{waiting:"Negotiation in progress"}:await C(t))},1e3)});Y=!0,be.value=t,r.value=t;try{_&&console.log(`[WebRTC] Setting partner ID: ${t}`);const o=E();if(W){_&&(console.log("[WebRTC] Adding local tracks to connection"),console.log(`[WebRTC] Local stream has ${W.getTracks().length} tracks`));const T=W;if(o.getSenders().length>0){_&&console.log("[WebRTC] Replacing existing senders");let A=0;T.getTracks().forEach(te=>{o.getSenders()[A]?(o.getSenders()[A].replaceTrack(te),A++):o.addTrack(te,T)})}else T.getTracks().forEach(A=>{o.addTrack(A,T)})}else if(console.error("[WebRTC] No local stream to add tracks from"),await S(),W){const T=W;T.getTracks().forEach(A=>{o.addTrack(A,T)})}V.value="connecting",n.value="connecting",_&&console.log("[WebRTC] Creating offer");const c=await o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return _&&console.log("[WebRTC] Setting local description"),await o.setLocalDescription(c),_&&console.log("[WebRTC] Waiting for ICE gathering to complete"),await R(o),a.value&&t&&(_&&console.log("[WebRTC] Sending offer to partner"),a.value.emit("voice-offer",{offer:o.localDescription,to:t}),a.value.emit("webrtc-signal",{type:"offer",offer:o.localDescription,to:t})),oe(o),H(),_&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(o){return console.error("[WebRTC] Error creating offer:",o),X=`Error creating offer: ${o}`,Y=!1,{error:`Failed to create offer: ${o}`}}finally{setTimeout(()=>{Y=!1},2e3)}},R=t=>t.iceGatheringState==="complete"?(console.log("[WebRTC] ICE gathering already complete"),Promise.resolve()):new Promise(o=>{const c=()=>{t.iceGatheringState==="complete"&&(t.removeEventListener("icegatheringstatechange",c),o())};t.addEventListener("icegatheringstatechange",c),setTimeout(()=>{t.removeEventListener("icegatheringstatechange",c),console.log("[WebRTC] ICE gathering timed out, but continuing anyway"),o()},2e3)}),U=async(t,o)=>{if(!a.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",o),console.log("[WebRTC] Offer SDP:",t.sdp),be.value=o,r.value=o;try{W||(_&&console.log("[WebRTC] Initializing local stream before handling offer"),await S());const c=E();if(W&&(c.getSenders().length===0?(_&&console.log("[WebRTC] Adding local tracks to connection"),W.getTracks().forEach(te=>{c.addTrack(te,W)})):_&&console.log("[WebRTC] Senders already exist, not adding tracks again")),V.value="connecting",n.value="connecting",_&&console.log("[WebRTC] Setting remote description (offer)"),await c.setRemoteDescription(new RTCSessionDescription(t)),fe.length>0){_&&console.log(`[WebRTC] Adding ${fe.length} pending ICE candidates`);for(const A of fe)try{await c.addIceCandidate(A)}catch(te){console.error("[WebRTC] Error adding pending ICE candidate:",te)}fe=[]}_&&console.log("[WebRTC] Creating answer");const T=await c.createAnswer({offerToReceiveAudio:!0});_&&console.log("[WebRTC] Answer SDP:",T.sdp),_&&console.log("[WebRTC] Setting local description (answer)"),await c.setLocalDescription(T),await R(c),_&&console.log("[WebRTC] Sending answer to:",o),a.value.emit("voice-answer",{answer:c.localDescription,to:o}),a.value.emit("webrtc-signal",{type:"answer",answer:c.localDescription,to:o}),oe(c),H(),_&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(c){console.error("[WebRTC] Error handling offer:",c),X=`Error handling offer: ${c}`,setTimeout(()=>{a.value&&r.value&&(console.log("[WebRTC] Re-negotiating after offer error"),C(r.value))},2e3)}},N=async t=>{try{if(!g){_&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const o=g.signalingState;if(_&&console.log(`[WebRTC] Current signaling state before handling answer: ${o}`),o==="have-local-offer"){_&&console.log("[WebRTC] Setting remote description from answer");try{await g.setRemoteDescription(new RTCSessionDescription(t)),_&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+g.signalingState)}catch(c){if(console.error("[WebRTC] Error setting remote description:",c),c.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(T=>setTimeout(T,1e3)),g.signalingState==="have-local-offer")try{_&&console.log("[WebRTC] Retrying set remote description after delay"),await g.setRemoteDescription(new RTCSessionDescription(t)),_&&console.log("[WebRTC] Remote description set successfully on retry")}catch(T){console.error("[WebRTC] Final error setting remote description:",T)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${g.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${o}`),o==="stable"?_&&console.log("[WebRTC] Already in stable state, ignoring answer"):o==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),F<K&&(F++,_&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${F}/${K})`),i(),setTimeout(()=>{r.value&&C(r.value)},2e3)))}catch(o){console.error("[WebRTC] Error handling answer:",o),X=`Error handling answer: ${o}`,console.log("[WebRTC] Attempting to recover from answer error"),F<K&&await O()}},z=async()=>{if(!ne.value)return console.log("[WebRTC] Muting microphone - stopping all tracks"),W&&(W.getAudioTracks().forEach(o=>{o.stop()}),W=null,w.value=null),ne.value=!0,!1;console.log("[WebRTC] Unmuting microphone - requesting new permission");try{W&&(W.getTracks().forEach(c=>c.stop()),W=null,w.value=null);const o=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");if(W=o,w.value=o,g&&o)try{const T=g.getSenders().find(A=>A.track&&A.track.kind==="audio");if(T){const A=o.getAudioTracks()[0];A&&T.replaceTrack(A)}else o.getAudioTracks().length>0&&o.getAudioTracks().forEach(A=>{g&&g.addTrack(A,o)})}catch(c){console.error("[WebRTC] Error adding audio tracks:",c)}return ne.value=!1,!0}catch(o){console.error("[WebRTC] Error unmuting microphone:",o);try{const c=await navigator.mediaDevices.getUserMedia({audio:!0});return W=c,w.value=c,ne.value=!1,!0}catch(c){return console.error("[WebRTC] Fallback microphone access also failed:",c),!1}}},i=()=>{if(console.log("[WebRTC] Closing connection"),y(),re(),g){try{g.ontrack=null,g.onicecandidate=null,g.oniceconnectionstatechange=null,g.onicegatheringstatechange=null,g.onsignalingstatechange=null,g.onconnectionstatechange=null;try{g.getTransceivers&&g.getTransceivers().forEach(t=>{t.stop&&t.stop()})}catch{}g.close(),_&&console.log("[WebRTC] Peer connection closed")}catch(t){console.error("[WebRTC] Error closing peer connection:",t)}g=null}I&&(I.getTracks().forEach(t=>{t.stop()}),I=new MediaStream,l.value=I),V.value="closed",n.value="closed"},b=()=>{console.log("[WebRTC] Full cleanup initiated"),i(),W&&(console.log("[WebRTC] Stopping local stream tracks"),W.getTracks().forEach(t=>{t.stop()}),W=null,w.value=null),console.log("[WebRTC] Cleanup complete")};function m(){if(!a.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),a.value.off("webrtc-signal"),a.value.off("ice-candidate"),a.value.off("partner-disconnected"),a.value.off("webrtc-connection-failed"),a.value.off("connection-timeout"),a.value.off("voice-offer"),a.value.off("voice-answer"),a.value.on("voice-offer",async t=>{console.log("[WebRTC] Received legacy voice-offer:",t),await U(t.offer,t.from)}),a.value.on("voice-answer",async t=>{console.log("[WebRTC] Received legacy voice-answer:",t),await N(t.answer)}),a.value.on("webrtc-signal",async t=>{if(console.log(`[WebRTC] Received ${t.type} signal from ${t.from}`),be.value=t.from,r.value=t.from,t.type==="offer"&&t.offer)try{await U(t.offer,t.from)}catch(o){console.error("[WebRTC] Error handling offer:",o),X=`Error handling offer: ${o}`,a.value&&a.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle offer: ${o}`})}else if(t.type==="answer"&&t.answer)try{await N(t.answer)}catch(o){console.error("[WebRTC] Error handling answer:",o),X=`Error handling answer: ${o}`,a.value&&a.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle answer: ${o}`})}}),a.value.on("ice-candidate",async t=>{if(console.log(`[WebRTC] Received ICE candidate from ${t.from}`),t.from!==r.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await we(t.candidate)}catch(o){console.error("[WebRTC] Error handling ICE candidate:",o),X=`Error handling ICE candidate: ${o}`}}),a.value.on("webrtc-connection-failed",t=>{console.log(`[WebRTC] Connection failed notification from ${t.from}: ${t.reason}`),F<K?(F++,console.log(`[WebRTC] Partner reported connection failure. Retry ${F}/${K}`),t.from===r.value&&setTimeout(()=>{r.value&&a.value&&C(t.from)},He)):(V.value="failed",y(),X=`Partner reported failure: ${t.reason}`)}),a.value.on("partner-disconnected",()=>{console.log("[WebRTC] Partner disconnected"),i(),be.value=null,r.value=null,V.value="closed",Y=!1,Z=!1,F=0})}m(),$e(()=>{s.value=null,w.value=null,l.value=null});function D(){ge&&clearInterval(ge),ge=window.setInterval(()=>{if(g&&(V.value==="connected"||V.value==="connecting")){try{const t=g.createDataChannel(`heartbeat_${Date.now()}`);setTimeout(()=>{try{t.close()}catch{}},1e3),_&&console.log("[WebRTC] Heartbeat sent to keep connection alive"),V.value==="connecting"&&F>3&&(console.log("[WebRTC] Connection stuck in connecting state. Diagnostic report:"),console.log(xe()))}catch{}$()}else y()},Ut)}function y(){ge&&(clearInterval(ge),ge=null)}function $(){if(!g||!W){console.log("[WebRTC] No peer connection or local stream to check tracks");return}console.log("[WebRTC] Checking audio tracks"),console.log(`[WebRTC] Connection state: ${g.connectionState}, ICE state: ${g.iceConnectionState}`);const t=W.getAudioTracks();if(t.length===0)console.log("[WebRTC] No local audio tracks found, initializing new stream"),S().then(o=>{g&&g.connectionState!=="closed"&&(o.getAudioTracks().forEach(c=>{console.log("[WebRTC] Adding new local track to connection");try{g.addTrack(c,o)}catch(T){console.warn("[WebRTC] Error adding track, might already exist:",T)}}),g.connectionState==="connected"&&!Y&&(console.log("[WebRTC] Starting negotiation for new local tracks"),Ce()))}).catch(o=>{console.error("[WebRTC] Failed to initialize new stream:",o)});else{let o=!1;t.forEach(c=>{c.enabled||(console.log(`[WebRTC] Enabling local track: ${c.label}`),c.enabled=!0,o=!0),c.readyState!=="live"&&(console.log(`[WebRTC] Local track ${c.label} not live, state: ${c.readyState}`),o=!0)}),t.some(c=>!c.enabled)?ne.value=!0:ne.value=!1,o&&g.connectionState==="connected"&&!Y&&(console.log("[WebRTC] Fixed local tracks, starting negotiation"),Ce())}if(I){const o=I.getAudioTracks();if(o.length===0){console.log("[WebRTC] No remote audio tracks found, checking receivers");const T=g.getReceivers().filter(A=>A.track&&A.track.kind==="audio"&&A.track.readyState==="live");T.length>0?(console.log(`[WebRTC] Found ${T.length} audio receivers not in stream, adding tracks`),T.forEach(A=>{if(A.track&&!I.getTracks().includes(A.track)){console.log(`[WebRTC] Adding track ${A.track.id} to remote stream`);try{I.addTrack(A.track)}catch(te){console.warn("[WebRTC] Error adding remote track:",te)}}}),l.value=I,console.log("[WebRTC] Updated remote stream with receiver tracks")):V.value==="connected"&&!Y&&(console.log("[WebRTC] No audio receivers found but connected, trying to renegotiate"),Ce())}else{let c=!1;o.forEach(T=>{T.enabled||(console.log(`[WebRTC] Enabling remote track: ${T.label}`),T.enabled=!0,c=!0),T.readyState!=="live"&&(console.log(`[WebRTC] Remote track ${T.label} not live, state: ${T.readyState}`),c=!0)}),c&&(l.value=I,console.log("[WebRTC] Updated remote stream after fixing tracks"))}}else if(g.getReceivers().length>0){console.log("[WebRTC] No remote stream but receivers exist, creating new stream"),I=new MediaStream,l.value=I;let o=!1;g.getReceivers().forEach(c=>{if(c.track&&c.track.kind==="audio"){console.log(`[WebRTC] Adding track ${c.track.id} from receiver to new remote stream`);try{I.addTrack(c.track),o=!0}catch(T){console.warn("[WebRTC] Error adding track from receiver:",T)}}}),o&&(l.value=I,console.log("[WebRTC] Updated components with new remote stream"))}L()}async function O(){if(!(!g||!r.value)){console.log("[WebRTC] Attempting connection recovery");try{if(g.restartIce){g.restartIce();const t=await g.createOffer({iceRestart:!0});await g.setLocalDescription(t),a.value&&a.value.emit("offer",{offer:g.localDescription,to:r.value})}}catch(t){console.error("[WebRTC] Recovery attempt failed:",t)}}}function L(){typeof window<"u"&&(window.__webrtc_debug={connectionState:V.value,connectionRetryCount:F,lastConnectionError:X,failureReason:ke,isNegotiating:Y,isRestartingIce:Z,pendingCandidates:fe.length,hasLocalTracks:W?W.getAudioTracks().length>0:!1,hasRemoteTracks:I?I.getAudioTracks().length>0:!1})}J(()=>V.value,()=>{L()});function H(){ve&&clearInterval(ve),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),g&&(g.onicecandidate=t=>{t.candidate&&(console.log("[WebRTC] ICE candidate generated:",t.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:t.candidate.candidate,timestamp:Date.now()})),a.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),a.value.emit("ice-candidate",{candidate:t.candidate,to:r.value})))}),ve=window.setInterval(async()=>{if(!g||V.value!=="connecting"&&V.value!=="connected"){re();return}try{const t=await Gt();t&&t.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=t.iceCandidatePairs),_e(t)}catch(t){console.error("[WebRTC] Error monitoring connection:",t)}},zt)}function re(){ve&&(clearInterval(ve),ve=null)}function _e(t){if(!t||t.error)return;const o=!t.media||t.media.length===0||!t.media.some(T=>T.kind==="audio"&&T.audioLevel>0),c=!t.selectedCandidatePair||t.selectedCandidatePair.state!=="succeeded";(o||c)&&(console.log("[WebRTC] Connection health issues detected, trying to fix..."),$(),V.value==="connected"&&F<K&&(F++,console.log(`[WebRTC] Attempting connection improvement (${F}/${K})`),g&&g.getTransceivers&&g.getTransceivers().forEach(T=>{T.sender&&T.sender.track&&T.sender.track.kind==="audio"&&T.sender.setParameters({...T.sender.getParameters(),degradationPreference:"maintain-framerate"})})))}function oe(t){r.value&&(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),window.__webrtcConnectionTimeout=setTimeout(()=>{var o,c,T;if(t.connectionState==="connecting"||t.connectionState==="new"){console.log(`[WebRTC] Connection attempt timed out after ${Be/1e3} seconds`);const A={localCandidates:((o=window.__localIceCandidates)==null?void 0:o.length)||0,remoteCandidates:((c=window.__remoteIceCandidates)==null?void 0:c.length)||0,iceCandidatePairsCount:((T=window.__iceCandidatePairs)==null?void 0:T.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(A)),X=`Connection timed out. Local candidates: ${A.localCandidates}, Remote: ${A.remoteCandidates}`,A.localCandidates===0&&(console.error("[WebRTC] No local ICE candidates generated, could be a network/firewall issue"),X+=". No local candidates - check firewall settings"),r.value&&(console.log("[WebRTC] Restarting connection with different servers"),i(),setTimeout(()=>{r.value&&(Re===qe||Re===Bt?(console.log("[WebRTC] Switching to TURN-only configuration"),Re=Ht):(console.log("[WebRTC] Switching to standard configuration"),Re=qe),C(r.value))},He))}},Be))}function xe(){var c,T;const t=g,o=[];return o.push(`Connection State: ${(t==null?void 0:t.connectionState)||"none"}`),o.push(`Signaling State: ${(t==null?void 0:t.signalingState)||"none"}`),o.push(`ICE Connection State: ${(t==null?void 0:t.iceConnectionState)||"none"}`),o.push(`ICE Gathering State: ${(t==null?void 0:t.iceGatheringState)||"none"}`),o.push(`Reconnection Attempts: ${F}/${K}`),o.push(`Last Error: ${X||"none"}`),o.push(`Local Audio Tracks: ${(W==null?void 0:W.getAudioTracks().length)||0}`),o.push(`Remote Audio Tracks: ${(I==null?void 0:I.getAudioTracks().length)||0}`),o.push(`Local Candidates: ${((c=window.__localIceCandidates)==null?void 0:c.length)||0}`),o.push(`Remote Candidates: ${((T=window.__remoteIceCandidates)==null?void 0:T.length)||0}`),o.push(`Is Negotiating: ${Y}`),o.push(`Is Restarting ICE: ${Z}`),o.join(`
`)}const we=async t=>{if(!g){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(_&&console.log("[WebRTC] Adding received ICE candidate:",t.candidate),!g.remoteDescription||!g.localDescription){_&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(g&&g.remoteDescription){_&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await g.addIceCandidate(t)}catch(o){console.error("[WebRTC] Error adding delayed ICE candidate:",o)}}},1e3);return}await g.addIceCandidate(t),_&&console.log("[WebRTC] Successfully added ICE candidate")}catch(o){console.error("[WebRTC] Error adding ICE candidate:",o),X=`Error adding ICE candidate: ${o}`,setTimeout(async()=>{if(g&&g.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await g.addIceCandidate(t),_&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(c){console.error("[WebRTC] Error adding ICE candidate on retry:",c)}}},2e3)}};function Ce(){if(!g||!r.value||Y){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),Y=!0;try{g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then(t=>{if(g)return g.setLocalDescription(t)}).then(()=>{!g||!a.value||!r.value||(a.value.emit("voice-offer",{offer:g.localDescription,to:r.value}),_&&console.log("[WebRTC] Sent renegotiation offer"))}).catch(t=>{console.error("[WebRTC] Error during negotiation:",t)}).finally(()=>{setTimeout(()=>{Y=!1},2e3)})}catch(t){console.error("[WebRTC] Failed to start negotiation:",t),Y=!1}}const j={connectionState:V.value,iceCandidatesGenerated:fe.length,localStreamActive:!!W&&W.active,remoteStreamActive:!!I&&I.active,localTracks:W?W.getAudioTracks().length:0,remoteTracks:I?I.getAudioTracks().length:0,connectionRetries:F,lastError:X||ke||"",isAudioMuted:ne.value,forceReconnect:()=>g&&V.value!=="new"?(O(),!0):!1};return{socket:a,peerConnection:s,remoteStream:l,localStream:w,connectionState:n,isAudioMuted:f,partnerId:r,createOffer:C,handleOffer:U,handleAnswer:N,handleIceCandidate:we,toggleMicrophone:z,closeConnection:i,initializeLocalStream:S,cleanup:b,diagnosticReport:j}}function qt(){const a="test";try{return localStorage.setItem(a,a),localStorage.removeItem(a),!0}catch(v){return console.error("localStorage is not available:",v),!1}}function Xt(){const a=p(qt());function v(n,f){if(!a.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(n,f)}catch(r){console.error("Failed to set localStorage item:",r)}}function s(n){if(!a.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(n)}catch(f){return console.error("Failed to get localStorage item:",f),null}}function w(n){if(!a.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(n)}catch(f){console.error("Failed to remove localStorage item:",f)}}function l(){if(!a.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(n){console.error("Failed to clear localStorage:",n)}}return{isAvailable:a,setItem:v,getItem:s,removeItem:w,clear:l}}const q=p({}),ye=p(null),ae=p({}),Se=p(!1),Ee=!0;let Xe=!1;function Yt(){const{socket:a,userId:v}=he(),s=Xt();Xe?console.log("[ChatService] Using existing chat service instance"):(console.log("[ChatService] Initializing chat service"),w(),Xe=!0);function w(){l(),U(),J(q,()=>{R()},{deep:!0}),J(()=>a.value,i=>{i&&!Se.value&&(console.log("[ChatService] Socket reconnected, setting up listeners again"),l())})}function l(){if(!a.value){console.log("[ChatService] No socket available, cannot set up listeners");return}Se.value&&(console.log("[ChatService] Removing existing chat-message listener"),a.value.off("chat-message"),Se.value=!1),console.log("[ChatService] Setting up chat-message listener"),a.value.on("chat-message",i=>{console.log("[ChatService] Received chat message:",i);const b=i.from,m=C(b);console.log(`[ChatService] Conversation key: ${m}, current partner: ${ye.value}`),q.value[m]||(q.value[m]=[]),q.value[m].push({sender:"partner",text:i.text,timestamp:i.timestamp||Date.now()}),b!==ye.value&&(ae.value[b]=!0,console.log(`[ChatService] Marked message from ${b} as unread`)),R(),console.log("[ChatService] Updated messages:",q.value[m])}),Se.value=!0,console.log("[ChatService] Chat message listener setup complete")}function n(i){console.log(`[ChatService] Setting current partner: ${i}`),ye.value=i,i&&(ae.value[i]=!1)}function f(i,b=null){const m=b||ye.value;if(!m||!i.trim()||!a.value)return console.log(`[ChatService] Cannot send message: partnerId=${m}, text=${i.trim()?"present":"empty"}, socket=${a.value?"present":"not present"}`),!1;console.log(`[ChatService] Sending message to ${m}: ${i}`);const D=C(m);q.value[D]||(q.value[D]=[]);const y=Date.now();return q.value[D].push({sender:"me",text:i.trim(),timestamp:y}),a.value.emit("chat-message",{text:i.trim(),to:m}),console.log("[ChatService] Message sent, current messages:",q.value[D]),!0}function r(i){if(!i)return[];const b=C(i),m=q.value[b]||[];return console.log(`[ChatService] Getting messages for ${i}, found ${m.length} messages`),m}function S(i){if(!i)return!1;const b=!!ae.value[i];return console.log(`[ChatService] Checking unread for ${i}: ${b}`),b}function E(i){i&&(console.log(`[ChatService] Marking messages as read for ${i}`),ae.value[i]=!1)}function C(i){if(!v.value)return i;const b=[v.value,i].sort();return`${b[0]}_${b[1]}`}function R(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot save chats");return}try{s.setItem("chat_messages",JSON.stringify(q.value)),s.setItem("chat_unread",JSON.stringify(ae.value)),Ee&&console.log("[ChatService] Saved chats to localStorage")}catch(i){console.error("[ChatService] Failed to save chats:",i)}}function U(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot load chats");return}try{const i=s.getItem("chat_messages");i&&(q.value=JSON.parse(i),Ee&&console.log("[ChatService] Loaded messages from localStorage:",Object.keys(q.value).length,"conversations"));const b=s.getItem("chat_unread");b&&(ae.value=JSON.parse(b),Ee&&console.log("[ChatService] Loaded unread status from localStorage"))}catch(i){console.error("[ChatService] Failed to load chats:",i)}}function N(i){if(!i)return;const b=C(i);q.value[b]&&(q.value[b]=[],R(),console.log(`[ChatService] Cleared chat for ${i}`))}function z(){q.value={},ae.value={},R(),console.log("[ChatService] Cleared all chats")}return{messages:q,unreadMessages:ae,currentPartnerId:ye,setCurrentPartner:n,sendMessage:f,getMessages:r,hasUnreadMessages:S,markAsRead:E,clearChat:N,clearAllChats:z}}const Kt={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/10"},Jt={key:0},Qt={key:1},Zt={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},eo={class:"text-xl"},to={class:"text-sm"},oo={key:2},no={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},ao={class:"text-xl"},lo={class:"text-sm"},so={key:3},ro={key:4,class:"mt-4 text-xs"},io={class:"flex items-center justify-center gap-2"},co={key:0,class:"text-red-400 mt-1 text-xs"},uo=ee({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0}},setup(a){const v=a,s=le(()=>{switch(v.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";default:return"Disconnected"}});return(w,l)=>(h(),x("div",Kt,[a.status==="searching"?(h(),x("div",Jt,l[0]||(l[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center animate-pulse"},[e("div",{class:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Searching...",-1),e("p",{class:"text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):a.status==="matched"?(h(),x("div",Qt,[l[1]||(l[1]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-yellow-500 to-green-500 rounded-full flex items-center justify-center animate-pulse"},[e("span",{class:"text-2xl"},"üîÑ")],-1)),l[2]||(l[2]=e("h2",{class:"text-lg font-semibold mb-2 text-yellow-400"},"Match Found!",-1)),a.partnerInfo?(h(),x("div",Zt,[e("span",eo,M(a.partnerInfo.flag),1),e("span",to,M(a.partnerInfo.country),1)])):G("",!0),l[3]||(l[3]=e("p",{class:"text-sm text-yellow-400 mt-2"},"Setting up voice connection...",-1)),l[4]||(l[4]=e("div",{class:"mt-3 relative h-1.5 w-3/4 mx-auto bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-500 to-green-500 rounded-full animate-progress"})],-1))])):a.status==="connected"?(h(),x("div",oo,[l[5]||(l[5]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"üë•")],-1)),l[6]||(l[6]=e("h2",{class:"text-lg font-semibold mb-2"},"Connected!",-1)),a.partnerInfo?(h(),x("div",no,[e("span",ao,M(a.partnerInfo.flag),1),e("span",lo,M(a.partnerInfo.country),1)])):G("",!0),l[7]||(l[7]=e("p",{class:"text-sm text-green-400 mt-2"},"You can talk now",-1))])):(h(),x("div",so,l[8]||(l[8]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-600 to-gray-700 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"üåü")],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Ready to Connect",-1),e("p",{class:"text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))),a.showStatus&&a.status!=="disconnected"?(h(),x("div",ro,[e("div",io,[e("span",{class:B({"text-green-400":a.status==="connected","text-yellow-400":a.status==="matched","text-blue-400":a.status==="searching"})},"‚óè",2),e("span",null,M(s.value),1)]),a.errorMessage?(h(),x("p",co,M(a.errorMessage),1)):G("",!0)])):G("",!0)]))}});const ue=(a,v)=>{const s=a.__vccOpts||a;for(const[w,l]of v)s[w]=l;return s},fo=ue(uo,[["__scopeId","data-v-911ccaff"]]),go={class:"space-y-3 md:space-y-4 px-2"},vo={class:"flex justify-center items-center gap-3 md:gap-4"},mo=["disabled"],po={class:"relative"},bo={key:0,class:"text-white text-lg md:text-xl"},yo={key:1,class:"text-white text-lg md:text-xl"},ho={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-300 rounded-full animate-pulse"},xo=["disabled"],wo={class:"flex flex-wrap justify-center gap-2 md:gap-3"},Co=ee({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(a,{emit:v}){const s=v,w=p(!1);function l(){w.value||(w.value=!0,s("toggle-mute"),setTimeout(()=>{w.value=!1},200),setTimeout(()=>{try{const n=document.querySelector("audio");n&&n.paused&&n.play().catch(f=>{console.warn("Could not auto-play audio after mute toggle:",f)})}catch(n){console.error("Error trying to auto-play:",n)}},300))}return(n,f)=>(h(),x("div",go,[e("div",vo,[e("button",{onClick:l,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",a.isMuted?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:w.value},[e("div",po,[a.isMuted?(h(),x("span",yo,"üîá")):(h(),x("span",bo,"üé§")),w.value?(h(),x("span",ho)):G("",!0)])],10,mo),e("button",{onClick:f[0]||(f[0]=r=>n.$emit("find-next")),class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},f[5]||(f[5]=[e("span",{class:"text-white text-2xl md:text-3xl"},"üìû",-1)])),e("button",{onClick:f[1]||(f[1]=r=>n.$emit("toggle-chat")),disabled:a.isDisabled,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",a.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},f[6]||(f[6]=[e("span",{class:"text-white text-lg md:text-xl"},"üí¨",-1)]),10,xo)]),e("div",wo,[e("button",{onClick:f[2]||(f[2]=r=>n.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110"}," üéÆ Games "),e("button",{onClick:f[3]||(f[3]=r=>n.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110"}," üìû History "),e("button",{onClick:f[4]||(f[4]=r=>n.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110"}," ‚ù§Ô∏è Support ")])]))}}),To={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},ko={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},Ro={class:"flex items-center justify-between p-4 border-b border-gray-700"},So={key:0,class:"h-full flex items-center justify-center text-gray-500"},$o={key:1,class:"space-y-2"},_o={class:"flex justify-between gap-2"},Wo={class:"text-xs text-gray-400"},Io={class:"mt-1 text-white break-words"},Eo={class:"p-3 border-t border-gray-700"},Ao=["disabled"],Oo=["disabled"],jo=ee({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(a,{emit:v}){const s=a,w=v,l=p(""),n=p(null),f=()=>{l.value.trim()&&s.isConnected&&(w("send-message",l.value),l.value="")},r=async()=>{await $t(),n.value&&(n.value.scrollTop=n.value.scrollHeight)},S=E=>new Date(E).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return J(()=>s.messages,()=>{r()},{deep:!0}),J(()=>s.isOpen,E=>{E&&r()}),se(()=>{s.isOpen&&r()}),(E,C)=>a.isOpen?(h(),x("div",To,[e("div",ko,[e("div",Ro,[C[2]||(C[2]=e("div",{class:"flex items-center"},[e("span",{class:"text-white text-lg font-medium"},"üí¨ Chat")],-1)),e("button",{onClick:C[0]||(C[0]=R=>E.$emit("close")),class:"text-gray-400 hover:text-white"}," ‚úï ")]),e("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:n},[a.messages.length===0?(h(),x("div",So,C[3]||(C[3]=[e("div",{class:"text-center"},[e("p",null,"No messages yet"),e("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(h(),x("div",$o,[(h(!0),x(ie,null,ce(a.messages,R=>(h(),x("div",{key:R.id,class:B(["rounded-lg p-3 max-w-[80%]",R.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[e("div",_o,[e("span",{class:B(["text-sm",R.isOwn?"text-blue-200":"text-gray-200"])},M(R.isOwn?"You":"Partner"),3),e("span",Wo,M(S(R.timestamp)),1)]),e("p",Io,M(R.message),1)],2))),128))]))],512),e("div",Eo,[e("form",{onSubmit:St(f,["prevent"]),class:"flex gap-2"},[je(e("input",{"onUpdate:modelValue":C[1]||(C[1]=R=>l.value=R),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!a.isConnected},null,8,Ao),[[Je,l.value]]),e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!a.isConnected||!l.value.trim()}," Send ",8,Oo)],32)])])])):G("",!0)}}),Do={class:"w-full p-2"},Po={class:"flex justify-between items-center mb-4"},Mo={key:0,class:"text-yellow-300 animate-pulse"},No={key:1},Fo={key:2},Lo={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 mb-4"},Vo={class:"mb-4 text-center"},Uo={class:"flex items-center justify-center gap-4"},zo={class:"text-center"},Go={class:"grid grid-cols-3 gap-3 mb-4"},Bo=["onClick","disabled"],Ho={key:0,class:"text-blue-400"},qo={key:1,class:"text-green-400"},Xo={key:0,class:"text-center mt-4 animate__animated animate__fadeIn"},Yo={key:1,class:"text-center mt-4"},Ko={class:"flex justify-between"},Ye=3e4,Jo=ee({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},isFirstPlayer:{type:Boolean,default:!0}},emits:["back","error"],setup(a,{emit:v}){const s=a,w=v,{socket:l}=he(),n=p("waiting"),f=p(["","","","","","","","",""]),r=p(s.isFirstPlayer?"X":"O"),S=p(s.isFirstPlayer?"O":"X"),E=p("X"),C=p(null),R=p(null),U=p(Date.now()),N=le(()=>E.value===r.value),z=y=>{var $;if(!(n.value!=="playing"||f.value[y]!==""||!N.value||C.value!==null))try{f.value[y]=r.value,E.value=S.value,U.value=Date.now(),($=l.value)==null||$.emit("game-move",{gameType:"tic-tac-toe",move:y,to:s.partnerId}),i(),D()}catch{m("Failed to make a move. Please try again.")}},i=()=>{const y=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const $ of y){const[O,L,H]=$;if(f.value[O]&&f.value[O]===f.value[L]&&f.value[O]===f.value[H]){C.value=f.value[O],n.value="finished",R.value&&(clearTimeout(R.value),R.value=null);return}}f.value.includes("")||(C.value="tie",n.value="finished",R.value&&(clearTimeout(R.value),R.value=null))},b=()=>{var y;try{f.value=["","","","","","","","",""],E.value="X",C.value=null,n.value="playing",U.value=Date.now(),(y=l.value)==null||y.emit("game-reset",{gameType:"tic-tac-toe",to:s.partnerId}),D()}catch{m("Failed to reset the game. Please try again.")}},m=y=>{console.error(`Tic-Tac-Toe Error: ${y}`),w("error",y)},D=()=>{R.value&&clearTimeout(R.value),n.value==="playing"&&!C.value&&(R.value=window.setTimeout(()=>{Date.now()-U.value>Ye&&(m("Connection with your partner appears to be lost. The game will be closed."),w("back"))},Ye))};return J(()=>s.isFirstPlayer,y=>{r.value=y?"X":"O",S.value=y?"O":"X",y||(n.value="playing")}),se(()=>{var y,$,O;try{(y=l.value)==null||y.on("game-partner-joined",L=>{L.from===s.partnerId&&L.gameType==="tic-tac-toe"&&(console.log("Partner joined the game!",L),n.value="playing",U.value=Date.now(),D())}),($=l.value)==null||$.on("game-move",L=>{if(L.from===s.partnerId&&L.gameType==="tic-tac-toe"){const H=L.move;typeof H=="number"&&H>=0&&H<9&&f.value[H]===""?(f.value[H]=S.value,E.value=r.value,U.value=Date.now(),i(),D()):m("Received invalid move from partner.")}}),(O=l.value)==null||O.on("game-reset",L=>{L.from===s.partnerId&&L.gameType==="tic-tac-toe"&&(f.value=["","","","","","","","",""],E.value="X",C.value=null,n.value="playing",U.value=Date.now(),D())}),s.isFirstPlayer||(n.value="playing")}catch{m("Failed to initialize game connection.")}}),$e(()=>{var y,$,O;(y=l.value)==null||y.off("game-partner-joined"),($=l.value)==null||$.off("game-move"),(O=l.value)==null||O.off("game-reset"),R.value&&(clearTimeout(R.value),R.value=null)}),(y,$)=>(h(),x("div",Do,[e("div",Po,[$[1]||($[1]=e("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),e("div",{class:B(["text-white text-sm px-3 py-1 rounded-full",{"bg-yellow-600/30":n.value==="waiting","bg-green-600/30":N.value&&n.value==="playing","bg-red-600/30":!N.value&&n.value==="playing","bg-purple-600/30":C.value}])},[n.value==="waiting"?(h(),x("span",Mo," Waiting for partner... ")):C.value?(h(),x("span",No,M(C.value===r.value?"You Won! üéâ":C.value==="tie"?"It's a Tie! ü§ù":"You Lost! üò¢"),1)):(h(),x("span",Fo,M(N.value?"Your Turn":"Partner's Turn"),1))],2)]),e("div",Lo,[e("div",{class:B(["flex flex-col items-center",{"opacity-70":n.value==="waiting"||!N.value&&!C.value}])},[e("div",Vo,[e("div",Uo,[e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="X"},"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-lg font-bold"])}," X ",2),e("div",zo,[$[2]||($[2]=e("p",{class:"text-gray-300 text-sm"},"You are",-1)),e("p",{class:B(["font-bold text-lg",{"text-blue-400":r.value==="X","text-green-400":r.value==="O"}])},M(r.value),3)]),e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="O"},"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-lg font-bold"])}," O ",2)])]),e("div",Go,[(h(!0),x(ie,null,ce(f.value,(O,L)=>(h(),x("button",{key:L,onClick:H=>z(L),disabled:O!==""||!N.value||C.value!==null||n.value==="waiting",class:B(["w-20 h-20 rounded-lg flex items-center justify-center text-3xl font-bold transition-all duration-300",{"bg-gray-700 hover:bg-gray-600":O===""&&N.value&&!C.value&&n.value!=="waiting","bg-gray-700/50":O===""&&(!N.value||C.value!==null||n.value==="waiting"),"bg-blue-600/20":O==="X","bg-green-600/20":O==="O","cursor-not-allowed":O!==""||!N.value||C.value!==null||n.value==="waiting","hover:bg-purple-700/50":N.value&&O===""&&!C.value&&n.value==="playing"}])},[O==="X"?(h(),x("span",Ho,"X")):O==="O"?(h(),x("span",qo,"O")):G("",!0)],10,Bo))),128))]),C.value?(h(),x("div",Xo,[e("button",{onClick:b,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):G("",!0),n.value==="waiting"?(h(),x("div",Yo,$[3]||($[3]=[e("div",{class:"bg-yellow-600/20 rounded-lg p-4 animate-pulse"},[e("p",{class:"text-yellow-300 mb-1"},"Waiting for your partner to join..."),e("p",{class:"text-sm text-gray-300"},[De("You'll play as "),e("span",{class:"font-bold text-blue-400"},"X")])],-1)]))):G("",!0)],2)]),e("div",Ko,[e("button",{onClick:$[0]||($[0]=O=>y.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games ")])]))}});const Qo=ue(Jo,[["__scopeId","data-v-98a0628f"]]),Zo={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4"},en={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},tn={class:"flex items-center justify-between p-3 border-b border-gray-800"},on={key:1,class:"p-4"},nn={class:"grid grid-cols-2 gap-4 mb-4"},an=["disabled"],ln=["disabled"],sn={key:2,class:"text-center p-6"},rn={class:"mb-4"},cn={class:"text-gray-300"},un={key:3},dn=ee({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(a,{emit:v}){const{socket:s,userId:w}=he(),l=a,n=p(null),f=p(null),r=p(!0),S=p(null),E=p(!1),C=p(""),R=i=>{console.log(`[Game Debug] ${i}`),C.value=i},U=i=>{var m;if(!l.isConnected)return;R(`Starting game: ${i} with partner: ${l.partnerId}`),f.value=null,n.value=i,r.value=!0,E.value=!1;const b=[w.value,l.partnerId].sort();S.value=`${i}-${b[0]}-${b[1]}`,R(`Created game room: ${S.value}`),(m=s.value)==null||m.emit("game-join-room",{gameType:i,roomId:S.value,to:l.partnerId,isFirstPlayer:!0})},N=()=>{var i;S.value&&((i=s.value)==null||i.emit("game-leave-room",{roomId:S.value,to:l.partnerId})),n.value=null,f.value=null,r.value=!0,S.value=null,E.value=!1},z=i=>{f.value=i,R(`Error: ${i}`)};return se(()=>{var i,b,m,D;R("Setting up game events"),(i=s.value)==null||i.on("game-room-invite",y=>{var $;y.from===l.partnerId&&(R(`Received invitation to join game room: ${y.roomId}`),S.value=y.roomId,n.value=y.gameType,r.value=!1,($=s.value)==null||$.emit("game-join-room",{gameType:y.gameType,roomId:y.roomId,to:l.partnerId,isFirstPlayer:!1}))}),(b=s.value)==null||b.on("game-partner-joined",y=>{y.from===l.partnerId&&(R(`Partner joined the game: ${y.gameType}`),E.value=!0)}),(m=s.value)==null||m.on("game-error",y=>{(y.from==="system"||y.from===l.partnerId)&&(f.value=y.message||"An error occurred in the game.",R(`Game error: ${y.message}`))}),(D=s.value)==null||D.on("game-partner-left",y=>{n.value&&(f.value="Your partner left the game.",R("Partner left the game"),n.value=null)})}),$e(()=>{var i,b,m,D,y;(i=s.value)==null||i.off("game-room-invite"),(b=s.value)==null||b.off("game-partner-joined"),(m=s.value)==null||m.off("game-error"),(D=s.value)==null||D.off("game-partner-left"),S.value&&((y=s.value)==null||y.emit("game-leave-room",{roomId:S.value,to:l.partnerId}))}),J(()=>l.isOpen,i=>{i||N()}),(i,b)=>a.isOpen?(h(),x("div",Zo,[e("div",en,[e("div",tn,[b[2]||(b[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-purple-400 text-xl"},"üéÆ"),e("h2",{class:"text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),e("button",{onClick:b[0]||(b[0]=m=>i.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ‚úï ")]),G("",!0),n.value?f.value?(h(),x("div",sn,[e("div",rn,[b[8]||(b[8]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"‚ö†Ô∏è")],-1)),b[9]||(b[9]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",cn,M(f.value),1)]),e("button",{onClick:N,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):(h(),x("div",un,[n.value==="tic-tac-toe"?(h(),_t(Qo,{key:0,partnerId:a.partnerId,isFirstPlayer:r.value,partnerReady:E.value,onBack:N,onError:z},null,8,["partnerId","isFirstPlayer","partnerReady"])):G("",!0)])):(h(),x("div",on,[e("div",nn,[e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!a.isConnected}]),disabled:!a.isConnected},b[3]||(b[3]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-yellow-500 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>üëä</div><div class="text-white font-medium" data-v-823f908a>Rock Paper Scissors</div><div class="text-xs text-gray-400" data-v-823f908a>vs Partner</div>',4)]),10,an),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},b[4]||(b[4]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>üéµ</div><div class="text-white font-medium" data-v-823f908a>Sound Game</div><div class="text-xs text-gray-400" data-v-823f908a>Voice Challenge</div>',4)])),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!a.isConnected}]),disabled:!a.isConnected,onClick:b[1]||(b[1]=m=>U("tic-tac-toe"))},b[5]||(b[5]=[e("div",{class:"bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"‚≠ï",-1),e("div",{class:"text-white font-medium"},"Tic-Tac-Toe",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,ln),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},b[6]||(b[6]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>üí¨</div><div class="text-white font-medium" data-v-823f908a>Word Galaxy</div><div class="text-xs text-gray-400" data-v-823f908a>Brain Game</div>',4)]))]),b[7]||(b[7]=e("p",{class:"text-center text-sm text-gray-400 mt-2"}," Connect to play with others ",-1))]))])])):G("",!0)}});const fn=ue(dn,[["__scopeId","data-v-823f908a"]]),gn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},vn={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},mn={class:"flex items-center justify-between mb-6"},pn={class:"grid grid-cols-3 gap-4 mb-6"},bn=ee({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(a,{emit:v}){const s=v,w=p(15),l=f=>{w.value=f},n=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${w.value}`,"_blank"),s("close")};return(f,r)=>a.isOpen?(h(),x("div",gn,[e("div",vn,[e("div",mn,[r[4]||(r[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-red-400 text-xl"},"‚ù§Ô∏è"),e("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),e("button",{onClick:r[0]||(r[0]=S=>f.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ‚úï ")]),r[8]||(r[8]=e("div",{class:"mb-6 text-center"},[e("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),e("div",pn,[e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",w.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[1]||(r[1]=S=>l(5))},r[5]||(r[5]=[e("div",{class:"text-lg font-bold text-white"},"$5",-1),e("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",w.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[2]||(r[2]=S=>l(15))},r[6]||(r[6]=[e("div",{class:"text-lg font-bold text-white"},"$15",-1),e("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",w.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[3]||(r[3]=S=>l(50))},r[7]||(r[7]=[e("div",{class:"text-lg font-bold text-white"},"$50",-1),e("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),r[9]||(r[9]=e("div",{class:"flex justify-center items-center gap-1 mb-6"},[e("span",{class:"text-yellow-400"},"‚≠ê"),e("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),e("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:n}," Donate via PayPal "),r[10]||(r[10]=e("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):G("",!0)}}),yn={class:"relative w-full"},hn={class:"py-1"},xn=ee({__name:"select",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Select an option"},options:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(a,{emit:v}){const s=a,w=p(!1),l=p(null),n=p(null),f=le(()=>{if(s.options&&s.options.length){const E=s.options.find(C=>C.value===s.modelValue);return E?E.label:""}return s.modelValue}),r=()=>{w.value=!w.value},S=E=>{w.value&&l.value&&n.value&&!l.value.contains(E.target)&&!n.value.contains(E.target)&&(w.value=!1)};return se(()=>{document.addEventListener("click",S)}),Me(()=>{document.removeEventListener("click",S)}),(E,C)=>(h(),x("div",yn,[e("button",{type:"button",ref_key:"triggerRef",ref:l,onClick:r,class:"w-full flex items-center justify-between bg-purple-500/20 border-purple-500/30 rounded-full h-8 px-3 text-xs shadow-lg shadow-purple-500/20 text-white"},[e("span",null,M(f.value||a.placeholder),1),C[0]||(C[0]=e("span",{class:"ml-1"},"‚ñº",-1))],512),Q(It,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Wt(()=>[w.value?(h(),x("div",{key:0,ref_key:"contentRef",ref:n,class:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto"},[e("div",hn,[Ge(E.$slots,"default",{},()=>[Ge(E.$slots,"placeholder",{},()=>[C[1]||(C[1]=e("div",{class:"px-3 py-2 text-xs text-gray-400"},"No items",-1))],!0)],!0)])],512)):G("",!0)]),_:3})]))}});const Ae=ue(xn,[["__scopeId","data-v-9f96ce6c"]]),wn={class:"fixed inset-0 overflow-hidden pointer-events-none"},Cn=ee({__name:"starfield",setup(a){const v=p([]);se(()=>{s()});const s=()=>{const l=[];for(let n=0;n<50;n++)l.push({id:n,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});v.value=l};return(w,l)=>(h(),x("div",wn,[(h(!0),x(ie,null,ce(v.value,n=>(h(),x("div",{key:n.id,class:"absolute rounded-full bg-white",style:Et({width:`${n.size}px`,height:`${n.size}px`,top:`${n.y}%`,left:`${n.x}%`,opacity:n.opacity,boxShadow:`0 0 ${n.size*2}px rgba(255, 255, 255, ${n.opacity})`,animation:`twinkle ${n.duration}s infinite ease-in-out`})},null,4))),128))]))}});const Tn=ue(Cn,[["__scopeId","data-v-f4bff5a3"]]),Oe=!1,kn=10,Rn=ee({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(a){const{remoteStream:v,connectionState:s,partnerId:w,isAudioMuted:l}=Pe(),n=p(null),f=p(.8),r=p(!1),S=p(0),E=le(()=>(v.value!==null&&v.value?v.value.getAudioTracks().length>0:!1)&&v.value?v.value.getAudioTracks().some($=>$.enabled):!1);le(()=>v.value?v.value.getAudioTracks().filter(m=>m.enabled&&m.readyState==="live").length:0),le(()=>r.value&&E.value?"connected":(s.value==="connected"&&!E.value&&!r.value&&setTimeout(z,500),s.value)),J(()=>v.value,m=>{z(),S.value=0,setTimeout(i,500)}),J(()=>l.value,m=>{!m&&v.value&&n.value&&setTimeout(()=>{n.value&&n.value.paused&&n.value.play().catch(D=>{})},300)}),J(()=>s.value,m=>{m==="connected"?setTimeout(()=>{z(),i()},1e3):m==="new"||m==="connecting"?S.value=0:(m==="disconnected"||m==="failed")&&b()}),J(()=>w.value,m=>{r.value=!1,S.value=0,m||n.value&&(n.value.srcObject=null)}),se(()=>{z(),n.value&&(n.value.onplaying=()=>{r.value=!0},n.value.onpause=()=>{r.value=!1},n.value.onended=()=>{r.value=!1},n.value.onerror=m=>{console.error("[AudioOutput] Audio error:",m),r.value=!1},n.value.volume=f.value),document.addEventListener("visibilitychange",N),R()}),Me(()=>{n.value&&(n.value.srcObject=null),document.removeEventListener("visibilitychange",N),U()});let C=null;function R(){U(),C=window.setInterval(()=>{!r.value&&E.value&&s.value==="connected"&&(z(),i())},5e3)}function U(){C&&(clearInterval(C),C=null)}function N(){document.visibilityState==="visible"&&(z(),setTimeout(()=>{!r.value&&E.value&&i()},500))}function z(){n.value&&(v.value?(n.value.srcObject=v.value,v.value.getAudioTracks().forEach(m=>{m.enabled=!0}),i()):(n.value.srcObject=null,r.value=!1))}async function i(){if(!(!n.value||!n.value.srcObject))try{const m=v.value&&v.value.getAudioTracks().length>0;await n.value.play(),r.value=!0,S.value=0}catch(m){if(console.error("[AudioOutput] Error playing audio:",m),r.value=!1,m instanceof DOMException&&m.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),S.value<kn){S.value++;const D=S.value*1e3;setTimeout(i,D)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function b(){S.value=0,n.value&&(n.value.srcObject=null),setTimeout(()=>{z(),i()},500)}return(m,D)=>(h(),x("div",null,[e("audio",{ref_key:"audioElement",ref:n,autoplay:"",playsinline:"",class:"hidden"},null,512),G("",!0)]))}});const Sn=ue(Rn,[["__scopeId","data-v-f63dc209"]]),$n={class:"min-h-screen font-sans"},_n={class:"relative min-h-screen z-10 text-white"},Wn={class:"p-4 border-b border-white/10"},In={class:"max-w-4xl mx-auto"},En={class:"flex justify-center gap-2 mb-3"},An={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},On={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},jn={class:"grid grid-cols-2 gap-2 text-xs relative"},Dn={class:"flex items-center"},Pn={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Mn={class:"py-1"},Nn=["onClick"],Fn={class:"text-sm"},Ln={class:"flex-1 p-4"},Vn={class:"max-w-md mx-auto space-y-6"},Un={class:"flex items-center justify-center gap-2 mb-4"},zn={class:"text-center"},Gn={class:"text-xs text-gray-400 italic"},Bn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Hn={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},qn={class:"flex justify-between items-center mb-4"},Xn={class:"space-y-3"},Yn={key:0,class:"text-center py-8"},Kn={class:"flex items-center gap-3"},Jn={class:"text-2xl"},Qn={class:"text-white text-sm font-medium"},Zn={class:"text-gray-400 text-xs"},ea={class:"text-xs text-gray-500"},ta={key:0,class:"text-xs text-gray-500 text-center mt-4"},oa={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},na={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},aa={class:"flex justify-between items-center mb-4"},la={class:"space-y-4"},sa={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},ra={key:0,class:"text-xs text-gray-400 p-2"},ia={key:1,class:"flex flex-wrap gap-1"},ca=["onClick"],ua={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},da={key:0,class:"text-xs text-gray-400 p-2"},fa={key:1,class:"flex flex-wrap gap-1"},ga=["onClick"],va={key:2,class:"hidden"},ma=ee({__name:"HomeView",setup(a){const v=p("disconnected"),s=p(null),w=p(null),l=p(""),n=p(!1),f=p(!1),r=p(!1),S=p(!1),E=p(!1),C=p(!1),R=p(0),U=p(0),N=p(!1),z=p([]),i=p([]),b=p("any"),m=p(!1),D=p(""),y=p([]),$=p([]),O=p("off"),L=p(""),H=p(""),re=[{value:"any",text:"Any Vibe",emoji:"üåü"},{value:"chill",text:"Chill",emoji:"üòå"},{value:"fun",text:"Fun",emoji:"üéâ"},{value:"curious",text:"Curious",emoji:"ü§î"},{value:"creative",text:"Creative",emoji:"üé®"}],_e=[{value:"off",label:"‚è∞ Disabled"},{value:"30",label:"30 seconds"},{value:"60",label:"60 seconds"},{value:"90",label:"90 seconds"}],oe=[{value:"any",label:"üåç Any Country"},{value:"us",label:"üá∫üá∏ United States"},{value:"gb",label:"üá¨üáß United Kingdom"},{value:"ca",label:"üá®üá¶ Canada"},{value:"au",label:"üá¶üá∫ Australia"},{value:"de",label:"üá©üá™ Germany"},{value:"fr",label:"üá´üá∑ France"},{value:"it",label:"üáÆüáπ Italy"},{value:"es",label:"üá™üá∏ Spain"},{value:"jp",label:"üáØüáµ Japan"}],xe=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],we=p(xe[Math.floor(Math.random()*xe.length)]),j=he().socket,{remoteStream:t,localStream:o,connectionState:c,createOffer:T,handleOffer:A,handleAnswer:te,handleIceCandidate:Ze,closeConnection:Ne,toggleMicrophone:et,initializeLocalStream:tt}=Pe(),ot=Yt(),nt=Ot(),Fe=p(nt.params.roomId||null);J(()=>Fe.value,d=>{d&&(r.value=!0)},{immediate:!0});const at=le(()=>oe.filter(d=>d.value!=="any"&&!y.value.includes(d.value)&&!$.value.includes(d.value))),lt=le(()=>oe.filter(d=>d.value!=="any"&&!$.value.includes(d.value)&&!y.value.includes(d.value))),st=async()=>{const d=await et();n.value!==!d&&(n.value=!d),v.value==="connected"&&setTimeout(()=>{const u=document.querySelector("audio");u&&u.paused&&u.play().catch(()=>{})},300)},Le=async()=>{if(!o.value)try{await tt(),console.log("Microphone initialized")}catch(d){console.error("Failed to access microphone",d),alert("Please allow microphone access to use voice chat");return}j.value&&(v.value="searching",s.value&&(console.log("Disconnecting from current partner"),j.value.emit("disconnect-partner"),s.value=null,w.value=null,z.value=[],Ne()),console.log("Finding new partner with preferences"),j.value.emit("join-queue",{vibe:b.value,preferences:{preferredCountries:y.value.length?y.value:void 0,blockedCountries:$.value.length?$.value:void 0,interests:D.value?D.value.split(",").map(d=>d.trim()):void 0}}),U.value++)},rt=()=>{f.value=!f.value,f.value&&s.value&&ot.markAsRead(s.value)},it=d=>{j.value&&s.value&&(j.value.emit("chat-message",{message:d,to:s.value}),z.value.push({id:Date.now().toString(),message:d,isOwn:!0,timestamp:Date.now()}))},ct=d=>{console.log(`Selected game: ${d}`),j.value&&s.value&&j.value.emit("game-invite",{game:d,to:s.value})},ut=()=>{L.value&&!y.value.includes(L.value)&&(y.value.push(L.value),L.value="")},dt=d=>{y.value=y.value.filter(u=>u!==d)},ft=()=>{H.value&&!$.value.includes(H.value)&&($.value.push(H.value),H.value="")},gt=d=>{$.value=$.value.filter(u=>u!==d)},vt=()=>{D.value="",y.value=[],$.value=[],O.value="off"},mt=()=>{C.value=!1},Ve=d=>{const u=oe.find(k=>k.value===d);return u?u.label.split(" ")[0]:"üè≥Ô∏è"},Ue=d=>{const u=oe.find(k=>k.value===d);return u?u.label.split(" ").slice(1).join(" "):"Unknown"},pt=d=>new Date(d).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),bt=()=>{m.value=!m.value},yt=d=>{b.value=d,m.value=!1},ht=d=>{const u=re.find(k=>k.value===d);return u?u.emoji:"üåü"},xt=d=>{const u=re.find(k=>k.value===d);return u?u.text:"Any Vibe"};se(async()=>{console.log("Home view mounted"),j.value&&(j.value.on("online-count",d=>{R.value=d}),j.value.on("matched",d=>{if(console.log("Partner matched with event:",d),v.value="matched",l.value="",s.value=d.partnerId,w.value={id:d.partnerId,country:d.country||"Unknown",flag:d.flag||"üåç",vibe:d.vibe||"any"},i.value.unshift({id:Date.now().toString(),country:w.value.country,flag:w.value.flag,timestamp:Date.now()}),i.value.length>3&&(i.value=i.value.slice(0,3)),console.log("Partner matched:",d),d.partnerId){console.log("Initiating WebRTC connection with partner immediately");const{createOffer:u}=Pe();u(d.partnerId),setTimeout(()=>{v.value==="matched"&&c.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),v.value="connected")},2e3)}}),j.value.on("direct-connection-established",d=>{console.log("Direct connection established:",d),v.value="connected",s.value=d.partnerId,w.value={id:d.partnerId,country:d.country||"Unknown",flag:d.flag||"üåç"}}),j.value.on("partner-disconnected",()=>{v.value="disconnected",s.value=null,w.value=null,z.value=[],N.value&&setTimeout(()=>{v.value==="disconnected"&&N.value&&Le()},2e3)}),j.value.on("chat-message",d=>{z.value.push({id:Date.now().toString(),message:d.message,isOwn:!1,timestamp:Date.now()})}),j.value.on("error",d=>{console.error("Socket error:",d.message),d.type==="matching"&&(v.value="disconnected")}),j.value.on("voice-offer",wt),j.value.on("voice-answer",Ct),j.value.on("ice-candidate",Tt),j.value.emit("get-online-count")),document.addEventListener("click",ze)}),Me(()=>{console.log("Home view unmounting, cleaning up connection"),Ne(),j.value&&(j.value.off("online-count"),j.value.off("matched"),j.value.off("direct-connection-established"),j.value.off("partner-disconnected"),j.value.off("chat-message"),j.value.off("error"),j.value.off("voice-offer"),j.value.off("voice-answer"),j.value.off("ice-candidate")),document.removeEventListener("click",ze)});const wt=async d=>{console.log("Received voice offer - forwarding to WebRTC service"),A(d.offer,d.from)},Ct=async d=>{console.log("Received voice answer - forwarding to WebRTC service"),te(d.answer)},Tt=async d=>{console.log("Received ICE candidate - forwarding to WebRTC service"),Ze(d.candidate)};J(c,(d,u)=>{console.log(`[HomeView] WebRTC connection state changed: ${u} -> ${d}`),d==="connected"&&v.value==="matched"?setTimeout(()=>{c.value==="connected"&&v.value==="matched"&&(v.value="connected",l.value="",console.log("[HomeView] Successfully transitioned from matched to connected"))},1e3):d==="failed"?(l.value="",setTimeout(()=>{c.value==="failed"&&(v.value==="matched"||v.value==="connected")&&(l.value='Connection failed. Press "Next" to find a new partner.')},6e4)):d==="disconnected"&&(v.value==="connected"||v.value==="matched")&&(l.value="",setTimeout(()=>{c.value==="disconnected"&&(v.value==="connected"||v.value==="matched")&&(l.value="Connection lost. Trying to reconnect...")},6e4))});const We=p(null),ze=d=>{const u=d.target;We.value&&!We.value.contains(u)&&(m.value=!1)};return(d,u)=>(h(),x("div",$n,[u[26]||(u[26]=me('<div class="fixed inset-0 pointer-events-none" data-v-d136ba69><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-d136ba69></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-d136ba69></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-d136ba69></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-d136ba69></div></div>',1)),Q(Tn),e("div",_n,[e("header",Wn,[e("div",In,[u[15]||(u[15]=me('<div class="text-center mb-4" data-v-d136ba69><div class="inline-flex items-center gap-2" data-v-d136ba69><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-d136ba69><span class="text-white text-xs" data-v-d136ba69>‚ú®</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-d136ba69> SpaceTalk.live </h1></div></div>',1)),e("div",En,[e("div",An,[u[14]||(u[14]=e("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),e("span",null,M(R.value)+" online",1)]),U.value>0?(h(),x("div",On," Today: "+M(U.value)+" voices ",1)):G("",!0)]),e("div",jn,[e("div",{class:"relative",ref_key:"vibeDropdownRef",ref:We},[e("div",{onClick:bt,class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[e("span",Dn,M(ht(b.value))+" "+M(xt(b.value)),1),e("span",{class:B(["ml-2 text-xs transition-transform duration-300",{"rotate-180":m.value}])},"‚ñº",2)]),m.value?(h(),x("div",Pn,[e("div",Mn,[(h(),x(ie,null,ce(re,k=>e("div",{key:k.value,onClick:Te=>yt(k.value),class:B(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":b.value===k.value}])},[e("span",Fn,M(k.emoji),1),e("span",null,M(k.text),1)],10,Nn)),64))])])):G("",!0)],512),e("button",{onClick:u[0]||(u[0]=k=>C.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," üîç Filters ")])])]),e("main",Ln,[e("div",Vn,[Q(fo,{status:v.value,"partner-info":w.value,"error-message":l.value,"show-status":!0},null,8,["status","partner-info","error-message"]),e("div",Un,[je(e("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":u[1]||(u[1]=k=>N.value=k),class:"w-3 h-3 rounded border-gray-600 bg-gray-700 text-emerald-500 focus:ring-emerald-500 focus:ring-1"},null,512),[[At,N.value]]),u[16]||(u[16]=e("label",{for:"auto-reconnect",class:"text-xs text-gray-400 cursor-pointer"}," Auto-reconnect to others ",-1))]),Q(Co,{"is-muted":n.value,"is-disabled":v.value!=="connected",onToggleMute:st,onFindNext:Le,onToggleChat:rt,onToggleGames:u[2]||(u[2]=k=>r.value=!0),onToggleHistory:u[3]||(u[3]=k=>E.value=!0),onToggleDonation:u[4]||(u[4]=k=>S.value=!0)},null,8,["is-muted","is-disabled"]),e("div",zn,[e("p",Gn,'"'+M(we.value)+'"',1)])])]),u[17]||(u[17]=me('<footer class="p-4 border-t border-white/10" data-v-d136ba69><div class="max-w-md mx-auto text-center space-y-2" data-v-d136ba69><h3 class="text-sm font-semibold text-emerald-400" data-v-d136ba69>Community Guidelines</h3><div class="text-xs text-gray-300 space-y-1" data-v-d136ba69><p data-v-d136ba69>‚Ä¢ Must be 18+ years old to use this service</p><p data-v-d136ba69>‚Ä¢ Be respectful and kind to other users</p><p data-v-d136ba69>‚Ä¢ No harassment, hate speech, or inappropriate content</p><p data-v-d136ba69>‚Ä¢ Report any misconduct using the report feature</p><p data-v-d136ba69>‚Ä¢ Your privacy and safety are our priority</p></div><p class="text-xs text-gray-400 mt-3" data-v-d136ba69> By using SpaceTalk.live, you agree to follow these guidelines </p><div class="flex justify-center gap-3 mt-4 text-xs" data-v-d136ba69><a href="#" class="bg-cyan-500/20 border border-cyan-500/30 rounded-full px-3 py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20" data-v-d136ba69> ‚ÑπÔ∏è About </a><a href="https://instagram.com" target="_blank" class="bg-pink-500/20 border border-pink-500/30 rounded-full px-3 py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20" data-v-d136ba69> üì∑ Instagram </a><a href="https://facebook.com" target="_blank" class="bg-blue-500/20 border border-blue-500/30 rounded-full px-3 py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20" data-v-d136ba69> üìò Facebook </a><a href="mailto:contact@spacetalk.live" class="bg-emerald-500/20 border border-emerald-500/30 rounded-full px-3 py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20" data-v-d136ba69> üìß Contact </a></div></div></footer>',1))]),E.value?(h(),x("div",Bn,[e("div",Hn,[e("div",qn,[u[18]||(u[18]=e("h2",{class:"text-lg font-semibold text-indigo-400"},"üìû Call History",-1)),e("button",{onClick:u[5]||(u[5]=k=>E.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ‚úï ")]),e("div",Xn,[i.value.length===0?(h(),x("div",Yn,u[19]||(u[19]=[e("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),e("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(h(!0),x(ie,{key:1},ce(i.value,(k,Te)=>(h(),x("div",{key:k.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[e("div",Kn,[e("span",Jn,M(k.flag),1),e("div",null,[e("p",Qn,M(k.country),1),e("p",Zn,M(pt(k.timestamp)),1)])]),e("div",ea," #"+M(Te+1),1)]))),128))]),i.value.length>0?(h(),x("p",ta," History clears when you leave the page ")):G("",!0)])])):G("",!0),C.value?(h(),x("div",oa,[e("div",na,[e("div",aa,[u[20]||(u[20]=e("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),e("button",{onClick:u[6]||(u[6]=k=>C.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ‚úï ")]),e("div",la,[e("div",null,[u[21]||(u[21]=e("label",{class:"block text-sm font-medium mb-2 text-teal-400"},"Interest Keywords",-1)),je(e("input",{"onUpdate:modelValue":u[7]||(u[7]=k=>D.value=k),type:"text",placeholder:"e.g., music, travel, technology...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-emerald-500 focus:outline-none"},null,512),[[Je,D.value]]),u[22]||(u[22]=e("p",{class:"text-xs text-gray-400 mt-1"},"Separate with commas",-1))]),e("div",null,[u[23]||(u[23]=e("label",{class:"block text-sm font-medium mb-2 text-emerald-400"},"Preferred Countries",-1)),e("div",sa,[y.value.length===0?(h(),x("p",ra,"No countries selected")):(h(),x("div",ia,[(h(!0),x(ie,null,ce(y.value,k=>(h(),x("span",{key:k,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[De(M(Ve(k))+" "+M(Ue(k))+" ",1),e("button",{onClick:Te=>dt(k),class:"text-emerald-200 hover:text-white ml-1"}," ‚úï ",8,ca)]))),128))]))]),Q(Ae,{modelValue:L.value,"onUpdate:modelValue":u[8]||(u[8]=k=>L.value=k),options:at.value,placeholder:"Add preferred country...",class:"mt-2",onChange:ut},null,8,["modelValue","options"])]),e("div",null,[u[24]||(u[24]=e("label",{class:"block text-sm font-medium mb-2 text-red-400"},"Blocked Countries",-1)),e("div",ua,[$.value.length===0?(h(),x("p",da,"No countries blocked")):(h(),x("div",fa,[(h(!0),x(ie,null,ce($.value,k=>(h(),x("span",{key:k,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[De(M(Ve(k))+" "+M(Ue(k))+" ",1),e("button",{onClick:Te=>gt(k),class:"text-red-200 hover:text-white ml-1"}," ‚úï ",8,ga)]))),128))]))]),Q(Ae,{modelValue:H.value,"onUpdate:modelValue":u[9]||(u[9]=k=>H.value=k),options:lt.value,placeholder:"Add blocked country...",class:"mt-2",onChange:ft},null,8,["modelValue","options"])]),e("div",null,[u[25]||(u[25]=e("label",{class:"block text-sm font-medium mb-2 text-orange-400"},"Auto-Next Timer",-1)),Q(Ae,{modelValue:O.value,"onUpdate:modelValue":u[10]||(u[10]=k=>O.value=k),options:_e,placeholder:"Select timer"},null,8,["modelValue"])])]),e("div",{class:"flex gap-2 mt-6"},[e("button",{onClick:vt,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Clear All "),e("button",{onClick:mt,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):G("",!0),Q(jo,{"is-open":f.value,onClose:u[11]||(u[11]=k=>f.value=!1),messages:z.value,onSendMessage:it,"is-connected":v.value==="connected"},null,8,["is-open","messages","is-connected"]),Q(fn,{"is-open":r.value,onClose:u[12]||(u[12]=k=>r.value=!1),"is-connected":v.value==="connected",onSelectGame:ct,"partner-id":s.value||"","initial-game-room-id":Fe.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),Q(bn,{"is-open":S.value,onClose:u[13]||(u[13]=k=>S.value=!1)},null,8,["is-open"]),v.value==="connected"?(h(),x("div",va,[Q(Sn,{showControls:!1})])):G("",!0)]))}});const Ke=ue(ma,[["__scopeId","data-v-d136ba69"]]),pa=jt({history:Dt("/"),routes:[{path:"/",name:"home",component:Ke},{path:"/game/:roomId",name:"game",component:Ke,props:!0}]}),Qe=Pt(Ft);Qe.use(pa);Qe.mount("#app");
//# sourceMappingURL=index-249add22.js.map
