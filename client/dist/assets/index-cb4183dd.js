import{d as te,c as w,a as Z,u as St,o as h,R as _t,r as p,b as se,e as Re,s as _e,w as K,f as le,g as e,t as M,h as U,n as B,F as ie,i as ce,j as $t,k as Ee,v as Ye,l as Wt,m as Ae,p as me,q as It,x as je,y as Et,T as At,z as Ve,A as Ot,B as jt,C as Dt,D as Mt,E as Pt,G as Nt}from"./vue-vendor-21d667bf.js";import{l as Ft}from"./socket-vendor-d9998155.js";(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))C(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&C(f)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function C(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();const Lt={class:"app-container"},Vt=te({__name:"App",setup(o){return(g,s)=>(h(),w("div",Lt,[Z(St(_t))]))}});const Ut=()=>window.location.origin,D=p(null),de=p(null),pe=p(!1);function xe(){se(()=>{D.value||o()}),Re(()=>{D.value&&s()});function o(){const l=Ut();console.log(`Connecting to socket server at: ${l}`),D.value=Ft(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:3e4,transports:["websocket","polling"],extraHeaders:{"X-Client-Version":"1.0.0"},forceNew:!1,rememberUpgrade:!0,withCredentials:!0}),g()}function g(){D.value&&(D.value.on("connect",()=>{var l,a;console.log("Socket connected"),pe.value=!0,(l=D.value)==null||l.emit("user:identify",{},f=>{console.log("Identified with server, user ID:",f),de.value=f}),(a=D.value)==null||a.emit("get-online-count")}),D.value.on("disconnect",()=>{console.log("Socket disconnected"),pe.value=!1}),D.value.on("reconnect",l=>{var a;console.log(`Socket reconnected after ${l} attempts`),pe.value=!0,de.value&&((a=D.value)==null||a.emit("user:identify",{prevUserId:de.value},f=>{var i;console.log("Re-identified with server after reconnection, user ID:",f),de.value=f,(i=D.value)==null||i.emit("get-online-count")}))}),D.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),D.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),D.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{pe.value||(console.log("Attempting to reinitialize socket connection..."),s(),o())},5e3)}),D.value.on("error",l=>{console.error("Socket error:",l)}),D.value.on("user-id",l=>{console.log("Received user ID from server:",l),de.value=l}))}function s(){D.value&&(D.value.off("connect"),D.value.off("disconnect"),D.value.off("reconnect"),D.value.off("reconnect_attempt"),D.value.off("reconnect_error"),D.value.off("reconnect_failed"),D.value.off("error"),D.value.off("user-id"))}function C(){D.value?(console.log("Forcing socket reconnection..."),D.value.disconnect(),D.value.connect()):o()}return{socket:D,isConnected:pe,userId:de,reconnect:C}}const Ke={iceServers:[{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:80","turn:global.turn.twilio.com:3478?transport=tcp","turn:global.turn.twilio.com:3478?transport=udp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com:3478"},{urls:"stun:stun.callwithus.com:3478"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Ue={iceServers:[{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:global.turn.twilio.com:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"}],iceCandidatePoolSize:10,iceTransportPolicy:"relay",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Ge={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],iceCandidatePoolSize:5,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};let ve=Ke;const Gt=ve;let v=null,E=null,A=null;const G=p("new"),ne=p(!1),be=p(null),k=!0;let Y="",ee="",Be=null,z=!1,fe=!1,F=0;const Q=15;let J=[],ge=null;const Bt=8e3,zt=1e3;async function Je(){if(!v)return{error:"No peer connection available"};try{const o={};return(await v.getStats()).forEach(s=>{s.type==="transport"?o.transport={bytesReceived:s.bytesReceived,bytesSent:s.bytesSent,dtlsState:s.dtlsState,selectedCandidatePairId:s.selectedCandidatePairId}:s.type==="candidate-pair"&&s.selected?o.selectedCandidatePair={localCandidateId:s.localCandidateId,remoteCandidateId:s.remoteCandidateId,state:s.state,availableOutgoingBitrate:s.availableOutgoingBitrate}:s.type==="local-candidate"||s.type==="remote-candidate"?(o.candidates||(o.candidates=[]),o.candidates.push({type:s.type,id:s.id,ip:s.ip,port:s.port,protocol:s.protocol,candidateType:s.candidateType})):(s.type==="media-source"||s.type==="track"||s.type==="media-playout")&&(o.media||(o.media=[]),o.media.push({type:s.type,id:s.id,kind:s.kind,audioLevel:s.audioLevel,trackIdentifier:s.trackIdentifier}))}),o}catch(o){return console.error("[WebRTC] Error getting stats:",o),{error:"Failed to get stats: "+o}}}function qt(){ze();const o=setInterval(async()=>{v&&(G.value==="connected"||G.value==="connecting")?(Be=await Je(),console.log("[WebRTC] Connection stats:",Be)):ze()},5e3);window.__webrtcStatsTimer=o}function ze(){const o=window.__webrtcStatsTimer;o&&(clearInterval(o),window.__webrtcStatsTimer=null)}function Oe(){const{socket:o,userId:g}=xe(),s=_e(v),C=_e(E),l=_e(A),a=G,f=ne,i=be;p({echoCancellation:!0,noiseSuppression:!0});const S=async()=>{try{if(E){k&&console.log("[WebRTC] Using existing local stream");const n=E.getAudioTracks();if(n.length===0||!n[0].enabled)k&&console.log("[WebRTC] Existing stream has no active audio tracks, requesting new stream"),E.getTracks().forEach(r=>r.stop()),E=null;else return E}k&&console.log("[WebRTC] Requesting access to microphone with specific constraints");const t=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:2},video:!1});if(t.getAudioTracks().length===0)throw console.error("[WebRTC] No audio tracks found in stream"),new Error("No audio tracks available");return k&&(console.log("[WebRTC] Local stream acquired successfully"),console.log("[WebRTC] Audio tracks:",t.getAudioTracks().length),t.getAudioTracks().forEach(r=>{console.log(`[WebRTC] Track: ${r.label}, enabled: ${r.enabled}, muted: ${r.muted}, readyState: ${r.readyState}`),console.log("[WebRTC] Track settings:",JSON.stringify(r.getSettings()))})),t.getTracks().forEach(n=>{n.enabled=!0}),E=t,C.value=t,t}catch(t){console.error("[WebRTC] Error accessing microphone:",t);try{k&&console.log("[WebRTC] Trying fallback with simpler constraints");const n=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});if(n.getAudioTracks().length===0)throw new Error("No audio tracks available");return E=n,C.value=n,n}catch(n){throw console.error("[WebRTC] Fallback also failed:",n),new Error("Could not access microphone. Please check permissions.")}}},I=()=>{if(v)try{v.close(),v=null,A&&(A.getTracks().forEach(t=>{t.stop()}),A=null)}catch(t){console.error("[WebRTC] Error cleaning up old peer connection:",t)}try{const t=new RTCPeerConnection(Gt);return t.onnegotiationneeded=async n=>{if(k&&console.log("[WebRTC] Negotiation needed event",n),!Ht(t)||z){k&&console.log("[WebRTC] Skipping negotiation - already in progress or not in stable state");return}z=!0;try{k&&console.log("[WebRTC] Starting negotiation"),oe()}catch(r){console.error("[WebRTC] Negotiation error:",r),ee=`Negotiation error: ${r}`,z=!1}},t.oniceconnectionstatechange=()=>{k&&console.log("[WebRTC] ICE Connection state changed to:",t.iceConnectionState),t.iceConnectionState==="connected"||t.iceConnectionState==="completed"?(ee="",F=0,O(),qt(),ye("connected")):(t.iceConnectionState==="failed"||t.iceConnectionState==="disconnected"||t.iceConnectionState==="closed")&&(t.iceConnectionState==="failed"&&(ee="ICE connection failed",console.error("[WebRTC] ICE Connection failed")),t.iceConnectionState!=="closed"?!fe&&F<Q?(console.log(`[WebRTC] Attempting ICE restart, attempt ${F+1} of ${Q}`),y()):F>=Q&&(console.error("[WebRTC] Max connection retry attempts reached, giving up"),ye("failed"),F=0,ee="Max retries reached, connection failed",c()):ye("closed")),G.value=t.iceConnectionState},t.onicecandidate=n=>{var r;n.candidate?(k&&console.log("[WebRTC] New ICE candidate:",n.candidate),window.__localIceCandidates||(window.__localIceCandidates=[]),window.__localIceCandidates.push(n.candidate),i.value?(r=o.value)==null||r.emit("webrtc-signal",{type:"ice-candidate",candidate:n.candidate,to:i.value}):(J.push(n.candidate),k&&console.log("[WebRTC] Storing ICE candidate for later. Total pending:",J.length))):(k&&console.log("[WebRTC] ICE gathering complete"),J.length>0&&i.value&&(J.forEach(T=>{var W;(W=o.value)==null||W.emit("webrtc-signal",{type:"ice-candidate",candidate:T,to:i.value})}),k&&console.log(`[WebRTC] Sent ${J.length} pending ICE candidates`),J=[]))},t.onicegatheringstatechange=()=>{k&&console.log("[WebRTC] ICE gathering state changed to:",t.iceGatheringState)},t.onconnectionstatechange=()=>{k&&console.log("[WebRTC] Connection state changed to:",t.connectionState),ye(t.connectionState),t.connectionState==="connected"?(ee="",F=0):(t.connectionState==="failed"||t.connectionState==="disconnected"||t.connectionState==="closed")&&t.connectionState==="failed"&&!ee&&(ee="PeerConnection failed")},t.onsignalingstatechange=()=>{k&&console.log("[WebRTC] Signaling state changed to:",t.signalingState),t.signalingState==="stable"&&(z=!1)},t.ontrack=n=>{k&&console.log("[WebRTC] Track received:",n.track),A||(A=new MediaStream,l.value=A,console.log("[WebRTC] Created new remote stream")),A.addTrack(n.track),console.log(`[WebRTC] Added ${n.track.kind} track to remote stream, now has ${A.getTracks().length} tracks`),setTimeout(()=>{if(A){const r=A.getTracks();console.log(`[WebRTC] Remote stream has ${r.length} tracks after adding`),r.forEach(T=>{console.log(`[WebRTC] Track: ${T.kind}, enabled: ${T.enabled}, muted: ${T.muted}, readyState: ${T.readyState}`),T.kind==="audio"&&(!T.enabled||T.muted)&&(console.log("[WebRTC] ðŸ”´ Found disabled or muted audio track, enabling it"),T.enabled=!0)})}},500),k&&(n.track.onunmute=()=>{console.log("[WebRTC] Track unmuted:",n.track.kind)},n.track.onmute=()=>{console.log("[WebRTC] Track muted:",n.track.kind),n.track.enabled=!0},n.track.onended=()=>{console.log("[WebRTC] Track ended:",n.track.kind)})},re(t),v=t,t}catch(t){throw console.error("[WebRTC] Error creating peer connection:",t),Y=`Creation error: ${t}`,ee="Failed to create connection",ye("failed"),t}},x=async t=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),!t){const n="Cannot create offer: No target partner ID provided";return console.error(`[WebRTC] ${n}`),Y=n,{error:n}}if(!o.value){const n="Cannot create offer: socket not available";return console.error(`[WebRTC] ${n}`),Y=n,{error:n}}if(!E)try{k&&console.log("[WebRTC] Initializing local stream before creating offer"),await S()}catch(n){return console.error("[WebRTC] Failed to initialize local stream:",n),Y=`Failed to access microphone: ${n}`,{error:`Failed to access microphone: ${n}`}}if(console.log(`[WebRTC] Creating offer for partner: ${t}`),z)return console.warn("[WebRTC] Negotiation already in progress, deferring new offer"),new Promise(n=>{setTimeout(async()=>{n(z?{waiting:"Negotiation in progress"}:await x(t))},1e3)});z=!0,be.value=t,i.value=t;try{k&&console.log(`[WebRTC] Setting partner ID: ${t}`);const n=I();if(E){k&&(console.log("[WebRTC] Adding local tracks to connection"),console.log(`[WebRTC] Local stream has ${E.getTracks().length} tracks`));const T=E;if(n.getSenders().length>0){k&&console.log("[WebRTC] Replacing existing senders");let W=0;T.getTracks().forEach(q=>{n.getSenders()[W]?(n.getSenders()[W].replaceTrack(q),W++):n.addTrack(q,T)})}else T.getTracks().forEach(W=>{n.addTrack(W,T)})}else if(console.error("[WebRTC] No local stream to add tracks from"),await S(),E){const T=E;T.getTracks().forEach(W=>{n.addTrack(W,T)})}G.value="connecting",a.value="connecting",k&&console.log("[WebRTC] Creating offer");const r=await n.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return k&&console.log("[WebRTC] Setting local description"),await n.setLocalDescription(r),o.value&&t&&(k&&console.log("[WebRTC] Sending immediate offer using Trickle ICE"),o.value.emit("voice-offer",{offer:n.localDescription,to:t}),o.value.emit("webrtc-signal",{type:"offer",offer:n.localDescription,to:t})),re(n),O(),k&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(n){return console.error("[WebRTC] Error creating offer:",n),Y=`Error creating offer: ${n}`,z=!1,{error:`Failed to create offer: ${n}`}}finally{setTimeout(()=>{z=!1},2e3)}},_=t=>t.iceGatheringState==="complete"?(console.log("[WebRTC] ICE gathering already complete"),Promise.resolve()):new Promise(n=>{const r=()=>{t.iceGatheringState==="complete"&&(t.removeEventListener("icegatheringstatechange",r),n())};t.addEventListener("icegatheringstatechange",r),setTimeout(()=>{t.removeEventListener("icegatheringstatechange",r),console.log("[WebRTC] ICE gathering timed out, but continuing anyway"),n()},1e3)}),L=async(t,n)=>{if(!o.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",n),console.log("[WebRTC] Offer SDP:",t.sdp),be.value=n,i.value=n;try{E||(k&&console.log("[WebRTC] Initializing local stream before handling offer"),await S());const r=I();if(E&&(r.getSenders().length===0?(k&&console.log("[WebRTC] Adding local tracks to connection"),E.getTracks().forEach(q=>{r.addTrack(q,E)})):k&&console.log("[WebRTC] Senders already exist, not adding tracks again")),G.value="connecting",a.value="connecting",k&&console.log("[WebRTC] Setting remote description (offer)"),await r.setRemoteDescription(new RTCSessionDescription(t)),J.length>0){k&&console.log(`[WebRTC] Adding ${J.length} pending ICE candidates`);for(const W of J)try{await r.addIceCandidate(W)}catch(q){console.error("[WebRTC] Error adding pending ICE candidate:",q)}J=[]}k&&console.log("[WebRTC] Creating answer");const T=await r.createAnswer({offerToReceiveAudio:!0});k&&console.log("[WebRTC] Answer SDP:",T.sdp),k&&console.log("[WebRTC] Setting local description (answer)"),await r.setLocalDescription(T),r.getTransceivers().forEach(W=>{if(W.receiver.track.kind==="audio"&&(console.log("[WebRTC] Ensuring audio transceiver is set to receive"),W.direction!=="sendrecv"&&W.direction!=="recvonly"))try{W.direction="sendrecv"}catch(q){console.error("[WebRTC] Could not update transceiver direction:",q)}}),await _(r),k&&console.log("[WebRTC] Sending answer to:",n),o.value.emit("voice-answer",{answer:r.localDescription,to:n}),o.value.emit("webrtc-signal",{type:"answer",answer:r.localDescription,to:n}),re(r),O(),k&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(r){console.error("[WebRTC] Error handling offer:",r),Y=`Error handling offer: ${r}`,setTimeout(()=>{o.value&&i.value&&(console.log("[WebRTC] Re-negotiating after offer error"),x(i.value))},2e3)}},P=async t=>{try{if(!v){k&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const n=v.signalingState;if(k&&console.log(`[WebRTC] Current signaling state before handling answer: ${n}`),n==="have-local-offer"){k&&console.log("[WebRTC] Setting remote description from answer");try{await v.setRemoteDescription(new RTCSessionDescription(t)),k&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+v.signalingState)}catch(r){if(console.error("[WebRTC] Error setting remote description:",r),r.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(T=>setTimeout(T,1e3)),v.signalingState==="have-local-offer")try{k&&console.log("[WebRTC] Retrying set remote description after delay"),await v.setRemoteDescription(new RTCSessionDescription(t)),k&&console.log("[WebRTC] Remote description set successfully on retry")}catch(T){console.error("[WebRTC] Final error setting remote description:",T)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${v.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${n}`),n==="stable"?k&&console.log("[WebRTC] Already in stable state, ignoring answer"):n==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),F<Q&&(F++,k&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${F}/${Q})`),c(),setTimeout(()=>{i.value&&x(i.value)},2e3)))}catch(n){console.error("[WebRTC] Error handling answer:",n),Y=`Error handling answer: ${n}`,console.log("[WebRTC] Attempting to recover from answer error"),F<Q&&await y()}},V=async()=>{if(!ne.value)return console.log("[WebRTC] Muting microphone - stopping all tracks"),E&&(E.getAudioTracks().forEach(n=>{n.stop()}),E=null,C.value=null),ne.value=!0,!1;console.log("[WebRTC] Unmuting microphone - requesting new permission");try{E&&(E.getTracks().forEach(r=>r.stop()),E=null,C.value=null);const n=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(n.getAudioTracks().length===0)throw new Error("No audio tracks available");if(E=n,C.value=n,v&&n)try{const T=v.getSenders().find(W=>W.track&&W.track.kind==="audio");if(T){const W=n.getAudioTracks()[0];W&&T.replaceTrack(W)}else n.getAudioTracks().length>0&&n.getAudioTracks().forEach(W=>{v&&v.addTrack(W,n)})}catch(r){console.error("[WebRTC] Error adding audio tracks:",r)}return ne.value=!1,!0}catch(n){console.error("[WebRTC] Error unmuting microphone:",n);try{const r=await navigator.mediaDevices.getUserMedia({audio:!0});return E=r,C.value=r,ne.value=!1,!0}catch(r){return console.error("[WebRTC] Fallback microphone access also failed:",r),!1}}},c=()=>{if(console.log("[WebRTC] Closing connection"),N(),v){try{v.ontrack=null,v.onicecandidate=null,v.oniceconnectionstatechange=null,v.onicegatheringstatechange=null,v.onsignalingstatechange=null,v.onconnectionstatechange=null;try{v.getTransceivers&&v.getTransceivers().forEach(t=>{t.stop&&t.stop()})}catch{}v.close(),k&&console.log("[WebRTC] Peer connection closed")}catch(t){console.error("[WebRTC] Error closing peer connection:",t)}v=null}A&&(A.getTracks().forEach(t=>{t.stop()}),A=new MediaStream,l.value=A),G.value="closed",a.value="closed"},b=()=>{console.log("[WebRTC] Full cleanup initiated"),c(),E&&(console.log("[WebRTC] Stopping local stream tracks"),E.getTracks().forEach(t=>{t.stop()}),E=null,C.value=null),console.log("[WebRTC] Cleanup complete")};function m(){if(!o.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),o.value.off("webrtc-signal"),o.value.off("ice-candidate"),o.value.off("partner-disconnected"),o.value.off("webrtc-connection-failed"),o.value.off("connection-timeout"),o.value.off("voice-offer"),o.value.off("voice-answer"),o.value.on("voice-offer",async t=>{console.log("[WebRTC] Received legacy voice-offer:",t),await L(t.offer,t.from)}),o.value.on("voice-answer",async t=>{console.log("[WebRTC] Received legacy voice-answer:",t),await P(t.answer)}),o.value.on("webrtc-signal",async t=>{if(console.log(`[WebRTC] Received ${t.type} signal from ${t.from}`),be.value=t.from,i.value=t.from,t.type==="offer"&&t.offer)try{await L(t.offer,t.from)}catch(n){console.error("[WebRTC] Error handling offer:",n),Y=`Error handling offer: ${n}`,o.value&&o.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle offer: ${n}`})}else if(t.type==="answer"&&t.answer)try{await P(t.answer)}catch(n){console.error("[WebRTC] Error handling answer:",n),Y=`Error handling answer: ${n}`,o.value&&o.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle answer: ${n}`})}}),o.value.on("ice-candidate",async t=>{if(console.log(`[WebRTC] Received ICE candidate from ${t.from}`),t.from!==i.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await we(t.candidate)}catch(n){console.error("[WebRTC] Error handling ICE candidate:",n),Y=`Error handling ICE candidate: ${n}`}}),o.value.on("webrtc-connection-failed",t=>{console.log(`[WebRTC] Connection failed notification from ${t.from}: ${t.reason}`),F<Q?(F++,console.log(`[WebRTC] Partner reported connection failure. Retry ${F}/${Q}`),t.from===i.value&&setTimeout(()=>{i.value&&o.value&&x(t.from)},zt)):(G.value="failed",Y=`Partner reported failure: ${t.reason}`)}),o.value.on("partner-disconnected",()=>{console.log("[WebRTC] Partner disconnected"),c(),be.value=null,i.value=null,G.value="closed",z=!1,fe=!1,F=0})}m(),Re(()=>{s.value=null,C.value=null,l.value=null});function j(){if(!v||!E){console.log("[WebRTC] No peer connection or local stream to check tracks");return}console.log("[WebRTC] Checking audio tracks"),console.log(`[WebRTC] Connection state: ${v.connectionState}, ICE state: ${v.iceConnectionState}`);const t=E.getAudioTracks();if(t.length===0)console.log("[WebRTC] No local audio tracks found, initializing new stream"),S().then(n=>{v&&v.connectionState!=="closed"&&(n.getAudioTracks().forEach(r=>{console.log("[WebRTC] Adding new local track to connection");try{v.addTrack(r,n)}catch(T){console.warn("[WebRTC] Error adding track, might already exist:",T)}}),v.connectionState==="connected"&&!z&&(console.log("[WebRTC] Starting negotiation for new local tracks"),oe()))}).catch(n=>{console.error("[WebRTC] Failed to initialize new stream:",n)});else{let n=!1;t.forEach(r=>{r.enabled||(console.log(`[WebRTC] Enabling local track: ${r.label}`),r.enabled=!0,n=!0),r.readyState!=="live"&&(console.log(`[WebRTC] Local track ${r.label} not live, state: ${r.readyState}`),n=!0)}),t.some(r=>!r.enabled)?ne.value=!0:ne.value=!1,n&&v.connectionState==="connected"&&!z&&(console.log("[WebRTC] Fixed local tracks, starting negotiation"),oe())}if(A){const n=A.getAudioTracks();if(n.length===0){console.log("[WebRTC] No remote audio tracks found, checking receivers");const T=v.getReceivers().filter(W=>W.track&&W.track.kind==="audio"&&W.track.readyState==="live");T.length>0?(console.log(`[WebRTC] Found ${T.length} audio receivers not in stream, adding tracks`),T.forEach(W=>{if(W.track&&!A.getTracks().includes(W.track)){console.log(`[WebRTC] Adding track ${W.track.id} to remote stream`);try{A.addTrack(W.track)}catch(q){console.warn("[WebRTC] Error adding remote track:",q)}}}),l.value=A,console.log("[WebRTC] Updated remote stream with receiver tracks")):G.value==="connected"&&!z&&(console.log("[WebRTC] No audio receivers found but connected, trying to renegotiate"),oe())}else{let r=!1;n.forEach(T=>{T.enabled||(console.log(`[WebRTC] Enabling remote track: ${T.label}`),T.enabled=!0,r=!0),T.readyState!=="live"&&(console.log(`[WebRTC] Remote track ${T.label} not live, state: ${T.readyState}`),r=!0)}),r&&(l.value=A,console.log("[WebRTC] Updated remote stream after fixing tracks"))}}else if(v.getReceivers().length>0){console.log("[WebRTC] No remote stream but receivers exist, creating new stream"),A=new MediaStream,l.value=A;let n=!1;v.getReceivers().forEach(r=>{if(r.track&&r.track.kind==="audio"){console.log(`[WebRTC] Adding track ${r.track.id} from receiver to new remote stream`);try{A.addTrack(r.track),n=!0}catch(T){console.warn("[WebRTC] Error adding track from receiver:",T)}}}),n&&(l.value=A,console.log("[WebRTC] Updated components with new remote stream"))}$(),diagnoseAndFixAudioIssues()}async function y(){if(!(!v||!i.value)){console.log("[WebRTC] Attempting connection recovery");try{if(fe=!0,ve===Ke?(ve=Ge,console.log("[WebRTC] Switching to fast configuration for quicker connection")):F>5&&(ve=Ue,console.log("[WebRTC] Switching to TURN-only configuration")),v.restartIce){v.restartIce();const t=await v.createOffer({iceRestart:!0,offerToReceiveAudio:!0});await v.setLocalDescription(t),o.value&&(o.value.emit("offer",{offer:v.localDescription,to:i.value}),o.value.emit("webrtc-signal",{type:"offer",offer:v.localDescription,to:i.value}))}setTimeout(()=>{fe=!1},500)}catch(t){console.error("[WebRTC] Recovery attempt failed:",t),fe=!1,F<Q&&setTimeout(()=>{c(),i.value&&x(i.value)},200)}}}function $(){typeof window<"u"&&(window.__webrtc_debug={connectionState:G.value,connectionRetryCount:F,lastConnectionError:Y,failureReason:ee,isNegotiating:z,isRestartingIce:fe,pendingCandidates:J.length,hasLocalTracks:E?E.getAudioTracks().length>0:!1,hasRemoteTracks:A?A.getAudioTracks().length>0:!1})}K(()=>G.value,()=>{$()});function O(){ge&&clearInterval(ge),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),v&&(v.onicecandidate=t=>{t.candidate&&(console.log("[WebRTC] ICE candidate generated:",t.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:t.candidate.candidate,timestamp:Date.now()})),o.value&&i.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),o.value.emit("ice-candidate",{candidate:t.candidate,to:i.value})))}),ge=window.setInterval(async()=>{if(!v||G.value!=="connecting"&&G.value!=="connected"){N();return}try{const t=await Je();t&&t.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=t.iceCandidatePairs),H(t)}catch(t){console.error("[WebRTC] Error monitoring connection:",t)}},Bt)}function N(){ge&&(clearInterval(ge),ge=null)}function H(t){if(!t||t.error)return;const n=!t.media||t.media.length===0||!t.media.some(T=>T.kind==="audio"&&T.audioLevel>0),r=!t.selectedCandidatePair||t.selectedCandidatePair.state!=="succeeded";(n||r)&&(console.log("[WebRTC] Connection health issues detected, trying to fix..."),j(),G.value==="connected"&&F<Q&&(F++,console.log(`[WebRTC] Attempting connection improvement (${F}/${Q})`),v&&v.getTransceivers&&v.getTransceivers().forEach(T=>{T.sender&&T.sender.track&&T.sender.track.kind==="audio"&&T.sender.setParameters({...T.sender.getParameters(),degradationPreference:"maintain-framerate"})})))}function re(t){if(!i.value)return;window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout);const n=5e3;window.__webrtcConnectionTimeout=setTimeout(()=>{(t.connectionState==="connecting"||t.connectionState==="new")&&(console.log(`[WebRTC] Connection not established after ${n/1e3} seconds, trying fast config`),ve=Ge,i.value&&!z&&x(i.value),window.__webrtcConnectionTimeout=setTimeout(()=>{var r,T,W;if(t.connectionState==="connecting"||t.connectionState==="new"){console.log("[WebRTC] Connection still not established, trying TURN-only config");const q={localCandidates:((r=window.__localIceCandidates)==null?void 0:r.length)||0,remoteCandidates:((T=window.__remoteIceCandidates)==null?void 0:T.length)||0,iceCandidatePairsCount:((W=window.__iceCandidatePairs)==null?void 0:W.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(q)),ve=Ue,c(),i.value&&setTimeout(()=>{x(i.value)},200)}},5e3))},n)}const we=async t=>{if(!v){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(k&&console.log("[WebRTC] Adding received ICE candidate:",t.candidate),window.__remoteIceCandidates||(window.__remoteIceCandidates=[]),window.__remoteIceCandidates.push(t),!v.remoteDescription||!v.localDescription){k&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(v&&v.remoteDescription){k&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await v.addIceCandidate(t)}catch(n){console.error("[WebRTC] Error adding delayed ICE candidate:",n)}}},1e3);return}await v.addIceCandidate(t),k&&console.log("[WebRTC] Successfully added ICE candidate")}catch(n){console.error("[WebRTC] Error adding ICE candidate:",n),Y=`Error adding ICE candidate: ${n}`,setTimeout(async()=>{if(v&&v.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await v.addIceCandidate(t),k&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(r){console.error("[WebRTC] Error adding ICE candidate on retry:",r)}}},2e3)}};function oe(){if(!v||!i.value||z){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),z=!0;try{v.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then(t=>{if(v)return v.setLocalDescription(t)}).then(()=>{!v||!o.value||!i.value||(o.value.emit("voice-offer",{offer:v.localDescription,to:i.value}),k&&console.log("[WebRTC] Sent renegotiation offer"))}).catch(t=>{console.error("[WebRTC] Error during negotiation:",t)}).finally(()=>{setTimeout(()=>{z=!1},2e3)})}catch(t){console.error("[WebRTC] Failed to start negotiation:",t),z=!1}}const Ce={connectionState:G.value,iceCandidatesGenerated:J.length,localStreamActive:!!E&&E.active,remoteStreamActive:!!A&&A.active,localTracks:E?E.getAudioTracks().length:0,remoteTracks:A?A.getAudioTracks().length:0,connectionRetries:F,lastError:Y||ee||"",isAudioMuted:ne.value,forceReconnect:()=>v&&G.value!=="new"?(y(),!0):!1};return{socket:o,peerConnection:s,remoteStream:l,localStream:C,connectionState:a,isAudioMuted:f,partnerId:i,createOffer:x,handleOffer:L,handleAnswer:P,handleIceCandidate:we,toggleMicrophone:V,closeConnection:c,initializeLocalStream:S,cleanup:b,diagnosticReport:Ce}}function Ht(o){return o.signalingState==="stable"||o.signalingState==="have-remote-offer"}function ye(o){G.value!==o&&(console.log(`[WebRTC] Connection state changing from ${G.value} to ${o}`),G.value=o,o==="connected"||o==="completed"?(ee="",Y="",F=0,console.log("[WebRTC] Connection established successfully")):(o==="failed"||o==="disconnected")&&(console.warn(`[WebRTC] Connection ${o}: ${ee||"Unknown reason"}`),o==="failed"&&(F++,console.log(`[WebRTC] Connection failure count: ${F}/${Q}`))))}function Xt(){const o="test";try{return localStorage.setItem(o,o),localStorage.removeItem(o),!0}catch(g){return console.error("localStorage is not available:",g),!1}}function Yt(){const o=p(Xt());function g(a,f){if(!o.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(a,f)}catch(i){console.error("Failed to set localStorage item:",i)}}function s(a){if(!o.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(a)}catch(f){return console.error("Failed to get localStorage item:",f),null}}function C(a){if(!o.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(a)}catch(f){console.error("Failed to remove localStorage item:",f)}}function l(){if(!o.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(a){console.error("Failed to clear localStorage:",a)}}return{isAvailable:o,setItem:g,getItem:s,removeItem:C,clear:l}}const X=p({}),he=p(null),ae=p({}),ke=p(!1),$e=!0;let qe=!1;function Kt(){const{socket:o,userId:g}=xe(),s=Yt();qe?console.log("[ChatService] Using existing chat service instance"):(console.log("[ChatService] Initializing chat service"),C(),qe=!0);function C(){l(),L(),K(X,()=>{_()},{deep:!0}),K(()=>o.value,c=>{c&&!ke.value&&(console.log("[ChatService] Socket reconnected, setting up listeners again"),l())})}function l(){if(!o.value){console.log("[ChatService] No socket available, cannot set up listeners");return}ke.value&&(console.log("[ChatService] Removing existing chat-message listener"),o.value.off("chat-message"),ke.value=!1),console.log("[ChatService] Setting up chat-message listener"),o.value.on("chat-message",c=>{console.log("[ChatService] Received chat message:",c);const b=c.from,m=x(b);console.log(`[ChatService] Conversation key: ${m}, current partner: ${he.value}`),X.value[m]||(X.value[m]=[]),X.value[m].push({sender:"partner",text:c.text,timestamp:c.timestamp||Date.now()}),b!==he.value&&(ae.value[b]=!0,console.log(`[ChatService] Marked message from ${b} as unread`)),_(),console.log("[ChatService] Updated messages:",X.value[m])}),ke.value=!0,console.log("[ChatService] Chat message listener setup complete")}function a(c){console.log(`[ChatService] Setting current partner: ${c}`),he.value=c,c&&(ae.value[c]=!1)}function f(c,b=null){const m=b||he.value;if(!m||!c.trim()||!o.value)return console.log(`[ChatService] Cannot send message: partnerId=${m}, text=${c.trim()?"present":"empty"}, socket=${o.value?"present":"not present"}`),!1;console.log(`[ChatService] Sending message to ${m}: ${c}`);const j=x(m);X.value[j]||(X.value[j]=[]);const y=Date.now();return X.value[j].push({sender:"me",text:c.trim(),timestamp:y}),o.value.emit("chat-message",{text:c.trim(),to:m}),console.log("[ChatService] Message sent, current messages:",X.value[j]),!0}function i(c){if(!c)return[];const b=x(c),m=X.value[b]||[];return console.log(`[ChatService] Getting messages for ${c}, found ${m.length} messages`),m}function S(c){if(!c)return!1;const b=!!ae.value[c];return console.log(`[ChatService] Checking unread for ${c}: ${b}`),b}function I(c){c&&(console.log(`[ChatService] Marking messages as read for ${c}`),ae.value[c]=!1)}function x(c){if(!g.value)return c;const b=[g.value,c].sort();return`${b[0]}_${b[1]}`}function _(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot save chats");return}try{s.setItem("chat_messages",JSON.stringify(X.value)),s.setItem("chat_unread",JSON.stringify(ae.value)),$e&&console.log("[ChatService] Saved chats to localStorage")}catch(c){console.error("[ChatService] Failed to save chats:",c)}}function L(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot load chats");return}try{const c=s.getItem("chat_messages");c&&(X.value=JSON.parse(c),$e&&console.log("[ChatService] Loaded messages from localStorage:",Object.keys(X.value).length,"conversations"));const b=s.getItem("chat_unread");b&&(ae.value=JSON.parse(b),$e&&console.log("[ChatService] Loaded unread status from localStorage"))}catch(c){console.error("[ChatService] Failed to load chats:",c)}}function P(c){if(!c)return;const b=x(c);X.value[b]&&(X.value[b]=[],_(),console.log(`[ChatService] Cleared chat for ${c}`))}function V(){X.value={},ae.value={},_(),console.log("[ChatService] Cleared all chats")}return{messages:X,unreadMessages:ae,currentPartnerId:he,setCurrentPartner:a,sendMessage:f,getMessages:i,hasUnreadMessages:S,markAsRead:I,clearChat:P,clearAllChats:V}}const Jt={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/10"},Qt={key:0},Zt={key:1},eo={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},to={class:"text-xl"},oo={class:"text-sm"},no={key:2},ao={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},lo={class:"text-xl"},so={class:"text-sm"},ro={key:3},io={key:4,class:"mt-4 text-xs"},co={class:"flex items-center justify-center gap-2"},uo={key:0,class:"text-red-400 mt-1 text-xs"},fo=te({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0}},setup(o){const g=o,s=le(()=>{switch(g.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";default:return"Disconnected"}});return(C,l)=>(h(),w("div",Jt,[o.status==="searching"?(h(),w("div",Qt,l[0]||(l[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center animate-pulse"},[e("div",{class:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Searching...",-1),e("p",{class:"text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):o.status==="matched"?(h(),w("div",Zt,[l[1]||(l[1]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-yellow-500 to-green-500 rounded-full flex items-center justify-center animate-pulse"},[e("span",{class:"text-2xl"},"ðŸ”„")],-1)),l[2]||(l[2]=e("h2",{class:"text-lg font-semibold mb-2 text-yellow-400"},"Match Found!",-1)),o.partnerInfo?(h(),w("div",eo,[e("span",to,M(o.partnerInfo.flag),1),e("span",oo,M(o.partnerInfo.country),1)])):U("",!0),l[3]||(l[3]=e("p",{class:"text-sm text-yellow-400 mt-2"},"Setting up voice connection...",-1)),l[4]||(l[4]=e("div",{class:"mt-3 relative h-1.5 w-3/4 mx-auto bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-500 to-green-500 rounded-full animate-progress"})],-1))])):o.status==="connected"?(h(),w("div",no,[l[5]||(l[5]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"ðŸ‘¥")],-1)),l[6]||(l[6]=e("h2",{class:"text-lg font-semibold mb-2"},"Connected!",-1)),o.partnerInfo?(h(),w("div",ao,[e("span",lo,M(o.partnerInfo.flag),1),e("span",so,M(o.partnerInfo.country),1)])):U("",!0),l[7]||(l[7]=e("p",{class:"text-sm text-green-400 mt-2"},"You can talk now",-1))])):(h(),w("div",ro,l[8]||(l[8]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-600 to-gray-700 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"ðŸŒŸ")],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Ready to Connect",-1),e("p",{class:"text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))),o.showStatus&&o.status!=="disconnected"?(h(),w("div",io,[e("div",co,[e("span",{class:B({"text-green-400":o.status==="connected","text-yellow-400":o.status==="matched","text-blue-400":o.status==="searching"})},"â—",2),e("span",null,M(s.value),1)]),o.errorMessage?(h(),w("p",uo,M(o.errorMessage),1)):U("",!0)])):U("",!0)]))}});const ue=(o,g)=>{const s=o.__vccOpts||o;for(const[C,l]of g)s[C]=l;return s},go=ue(fo,[["__scopeId","data-v-911ccaff"]]),vo={class:"space-y-3 md:space-y-4 px-2"},mo={class:"flex justify-center items-center gap-3 md:gap-4"},po=["disabled"],bo={class:"relative"},yo={key:0,class:"text-white text-lg md:text-xl"},ho={key:1,class:"text-white text-lg md:text-xl"},xo={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-300 rounded-full animate-pulse"},wo=["disabled"],Co={class:"flex flex-wrap justify-center gap-2 md:gap-3"},To=te({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(o,{emit:g}){const s=g,C=p(!1);function l(){C.value||(C.value=!0,s("toggle-mute"),setTimeout(()=>{C.value=!1},200),setTimeout(()=>{try{const a=document.querySelector("audio");a&&a.paused&&a.play().catch(f=>{console.warn("Could not auto-play audio after mute toggle:",f)})}catch(a){console.error("Error trying to auto-play:",a)}},300))}return(a,f)=>(h(),w("div",vo,[e("div",mo,[e("button",{onClick:l,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",o.isMuted?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:C.value},[e("div",bo,[o.isMuted?(h(),w("span",ho,"ðŸ”‡")):(h(),w("span",yo,"ðŸŽ¤")),C.value?(h(),w("span",xo)):U("",!0)])],10,po),e("button",{onClick:f[0]||(f[0]=i=>a.$emit("find-next")),class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},f[5]||(f[5]=[e("span",{class:"text-white text-2xl md:text-3xl"},"ðŸ“ž",-1)])),e("button",{onClick:f[1]||(f[1]=i=>a.$emit("toggle-chat")),disabled:o.isDisabled,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",o.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},f[6]||(f[6]=[e("span",{class:"text-white text-lg md:text-xl"},"ðŸ’¬",-1)]),10,wo)]),e("div",Co,[e("button",{onClick:f[2]||(f[2]=i=>a.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110"}," ðŸŽ® Games "),e("button",{onClick:f[3]||(f[3]=i=>a.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110"}," ðŸ“ž History "),e("button",{onClick:f[4]||(f[4]=i=>a.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110"}," â¤ï¸ Support ")])]))}}),ko={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Ro={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},So={class:"flex items-center justify-between p-4 border-b border-gray-700"},_o={key:0,class:"h-full flex items-center justify-center text-gray-500"},$o={key:1,class:"space-y-2"},Wo={class:"flex justify-between gap-2"},Io={class:"text-xs text-gray-400"},Eo={class:"mt-1 text-white break-words"},Ao={class:"p-3 border-t border-gray-700"},Oo=["disabled"],jo=["disabled"],Do=te({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(o,{emit:g}){const s=o,C=g,l=p(""),a=p(null),f=()=>{l.value.trim()&&s.isConnected&&(C("send-message",l.value),l.value="")},i=async()=>{await Wt(),a.value&&(a.value.scrollTop=a.value.scrollHeight)},S=I=>new Date(I).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K(()=>s.messages,()=>{i()},{deep:!0}),K(()=>s.isOpen,I=>{I&&i()}),se(()=>{s.isOpen&&i()}),(I,x)=>o.isOpen?(h(),w("div",ko,[e("div",Ro,[e("div",So,[x[2]||(x[2]=e("div",{class:"flex items-center"},[e("span",{class:"text-white text-lg font-medium"},"ðŸ’¬ Chat")],-1)),e("button",{onClick:x[0]||(x[0]=_=>I.$emit("close")),class:"text-gray-400 hover:text-white"}," âœ• ")]),e("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:a},[o.messages.length===0?(h(),w("div",_o,x[3]||(x[3]=[e("div",{class:"text-center"},[e("p",null,"No messages yet"),e("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(h(),w("div",$o,[(h(!0),w(ie,null,ce(o.messages,_=>(h(),w("div",{key:_.id,class:B(["rounded-lg p-3 max-w-[80%]",_.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[e("div",Wo,[e("span",{class:B(["text-sm",_.isOwn?"text-blue-200":"text-gray-200"])},M(_.isOwn?"You":"Partner"),3),e("span",Io,M(S(_.timestamp)),1)]),e("p",Eo,M(_.message),1)],2))),128))]))],512),e("div",Ao,[e("form",{onSubmit:$t(f,["prevent"]),class:"flex gap-2"},[Ee(e("input",{"onUpdate:modelValue":x[1]||(x[1]=_=>l.value=_),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!o.isConnected},null,8,Oo),[[Ye,l.value]]),e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!o.isConnected||!l.value.trim()}," Send ",8,jo)],32)])])])):U("",!0)}}),Mo={class:"w-full p-2"},Po={class:"flex justify-between items-center mb-4"},No={key:0,class:"text-yellow-300 animate-pulse"},Fo={key:1},Lo={key:2},Vo={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 mb-4"},Uo={class:"mb-4 text-center"},Go={class:"flex items-center justify-center gap-4"},Bo={class:"text-center"},zo={class:"grid grid-cols-3 gap-3 mb-4"},qo=["onClick","disabled"],Ho={key:0,class:"text-blue-400"},Xo={key:1,class:"text-green-400"},Yo={key:0,class:"text-center mt-4 animate__animated animate__fadeIn"},Ko={key:1,class:"text-center mt-4"},Jo={class:"flex justify-between"},He=3e4,Qo=te({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},isFirstPlayer:{type:Boolean,default:!0}},emits:["back","error"],setup(o,{emit:g}){const s=o,C=g,{socket:l}=xe(),a=p("waiting"),f=p(["","","","","","","","",""]),i=p(s.isFirstPlayer?"X":"O"),S=p(s.isFirstPlayer?"O":"X"),I=p("X"),x=p(null),_=p(null),L=p(Date.now()),P=le(()=>I.value===i.value),V=y=>{var $;if(!(a.value!=="playing"||f.value[y]!==""||!P.value||x.value!==null))try{f.value[y]=i.value,I.value=S.value,L.value=Date.now(),($=l.value)==null||$.emit("game-move",{gameType:"tic-tac-toe",move:y,to:s.partnerId}),c(),j()}catch{m("Failed to make a move. Please try again.")}},c=()=>{const y=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const $ of y){const[O,N,H]=$;if(f.value[O]&&f.value[O]===f.value[N]&&f.value[O]===f.value[H]){x.value=f.value[O],a.value="finished",_.value&&(clearTimeout(_.value),_.value=null);return}}f.value.includes("")||(x.value="tie",a.value="finished",_.value&&(clearTimeout(_.value),_.value=null))},b=()=>{var y;try{f.value=["","","","","","","","",""],I.value="X",x.value=null,a.value="playing",L.value=Date.now(),(y=l.value)==null||y.emit("game-reset",{gameType:"tic-tac-toe",to:s.partnerId}),j()}catch{m("Failed to reset the game. Please try again.")}},m=y=>{console.error(`Tic-Tac-Toe Error: ${y}`),C("error",y)},j=()=>{_.value&&clearTimeout(_.value),a.value==="playing"&&!x.value&&(_.value=window.setTimeout(()=>{Date.now()-L.value>He&&(m("Connection with your partner appears to be lost. The game will be closed."),C("back"))},He))};return K(()=>s.isFirstPlayer,y=>{i.value=y?"X":"O",S.value=y?"O":"X",y||(a.value="playing")}),se(()=>{var y,$,O;try{(y=l.value)==null||y.on("game-partner-joined",N=>{N.from===s.partnerId&&N.gameType==="tic-tac-toe"&&(console.log("Partner joined the game!",N),a.value="playing",L.value=Date.now(),j())}),($=l.value)==null||$.on("game-move",N=>{if(N.from===s.partnerId&&N.gameType==="tic-tac-toe"){const H=N.move;typeof H=="number"&&H>=0&&H<9&&f.value[H]===""?(f.value[H]=S.value,I.value=i.value,L.value=Date.now(),c(),j()):m("Received invalid move from partner.")}}),(O=l.value)==null||O.on("game-reset",N=>{N.from===s.partnerId&&N.gameType==="tic-tac-toe"&&(f.value=["","","","","","","","",""],I.value="X",x.value=null,a.value="playing",L.value=Date.now(),j())}),s.isFirstPlayer||(a.value="playing")}catch{m("Failed to initialize game connection.")}}),Re(()=>{var y,$,O;(y=l.value)==null||y.off("game-partner-joined"),($=l.value)==null||$.off("game-move"),(O=l.value)==null||O.off("game-reset"),_.value&&(clearTimeout(_.value),_.value=null)}),(y,$)=>(h(),w("div",Mo,[e("div",Po,[$[1]||($[1]=e("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),e("div",{class:B(["text-white text-sm px-3 py-1 rounded-full",{"bg-yellow-600/30":a.value==="waiting","bg-green-600/30":P.value&&a.value==="playing","bg-red-600/30":!P.value&&a.value==="playing","bg-purple-600/30":x.value}])},[a.value==="waiting"?(h(),w("span",No," Waiting for partner... ")):x.value?(h(),w("span",Fo,M(x.value===i.value?"You Won! ðŸŽ‰":x.value==="tie"?"It's a Tie! ðŸ¤":"You Lost! ðŸ˜¢"),1)):(h(),w("span",Lo,M(P.value?"Your Turn":"Partner's Turn"),1))],2)]),e("div",Vo,[e("div",{class:B(["flex flex-col items-center",{"opacity-70":a.value==="waiting"||!P.value&&!x.value}])},[e("div",Uo,[e("div",Go,[e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":i.value==="X"},"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-lg font-bold"])}," X ",2),e("div",Bo,[$[2]||($[2]=e("p",{class:"text-gray-300 text-sm"},"You are",-1)),e("p",{class:B(["font-bold text-lg",{"text-blue-400":i.value==="X","text-green-400":i.value==="O"}])},M(i.value),3)]),e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":i.value==="O"},"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-lg font-bold"])}," O ",2)])]),e("div",zo,[(h(!0),w(ie,null,ce(f.value,(O,N)=>(h(),w("button",{key:N,onClick:H=>V(N),disabled:O!==""||!P.value||x.value!==null||a.value==="waiting",class:B(["w-20 h-20 rounded-lg flex items-center justify-center text-3xl font-bold transition-all duration-300",{"bg-gray-700 hover:bg-gray-600":O===""&&P.value&&!x.value&&a.value!=="waiting","bg-gray-700/50":O===""&&(!P.value||x.value!==null||a.value==="waiting"),"bg-blue-600/20":O==="X","bg-green-600/20":O==="O","cursor-not-allowed":O!==""||!P.value||x.value!==null||a.value==="waiting","hover:bg-purple-700/50":P.value&&O===""&&!x.value&&a.value==="playing"}])},[O==="X"?(h(),w("span",Ho,"X")):O==="O"?(h(),w("span",Xo,"O")):U("",!0)],10,qo))),128))]),x.value?(h(),w("div",Yo,[e("button",{onClick:b,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):U("",!0),a.value==="waiting"?(h(),w("div",Ko,$[3]||($[3]=[e("div",{class:"bg-yellow-600/20 rounded-lg p-4 animate-pulse"},[e("p",{class:"text-yellow-300 mb-1"},"Waiting for your partner to join..."),e("p",{class:"text-sm text-gray-300"},[Ae("You'll play as "),e("span",{class:"font-bold text-blue-400"},"X")])],-1)]))):U("",!0)],2)]),e("div",Jo,[e("button",{onClick:$[0]||($[0]=O=>y.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games ")])]))}});const Zo=ue(Qo,[["__scopeId","data-v-98a0628f"]]),en={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4"},tn={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},on={class:"flex items-center justify-between p-3 border-b border-gray-800"},nn={key:1,class:"p-4"},an={class:"grid grid-cols-2 gap-4 mb-4"},ln=["disabled"],sn=["disabled"],rn={key:2,class:"text-center p-6"},cn={class:"mb-4"},un={class:"text-gray-300"},dn={key:3},fn=te({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(o,{emit:g}){const{socket:s,userId:C}=xe(),l=o,a=p(null),f=p(null),i=p(!0),S=p(null),I=p(!1),x=p(""),_=c=>{console.log(`[Game Debug] ${c}`),x.value=c},L=c=>{var m;if(!l.isConnected)return;_(`Starting game: ${c} with partner: ${l.partnerId}`),f.value=null,a.value=c,i.value=!0,I.value=!1;const b=[C.value,l.partnerId].sort();S.value=`${c}-${b[0]}-${b[1]}`,_(`Created game room: ${S.value}`),(m=s.value)==null||m.emit("game-join-room",{gameType:c,roomId:S.value,to:l.partnerId,isFirstPlayer:!0})},P=()=>{var c;S.value&&((c=s.value)==null||c.emit("game-leave-room",{roomId:S.value,to:l.partnerId})),a.value=null,f.value=null,i.value=!0,S.value=null,I.value=!1},V=c=>{f.value=c,_(`Error: ${c}`)};return se(()=>{var c,b,m,j;_("Setting up game events"),(c=s.value)==null||c.on("game-room-invite",y=>{var $;y.from===l.partnerId&&(_(`Received invitation to join game room: ${y.roomId}`),S.value=y.roomId,a.value=y.gameType,i.value=!1,($=s.value)==null||$.emit("game-join-room",{gameType:y.gameType,roomId:y.roomId,to:l.partnerId,isFirstPlayer:!1}))}),(b=s.value)==null||b.on("game-partner-joined",y=>{y.from===l.partnerId&&(_(`Partner joined the game: ${y.gameType}`),I.value=!0)}),(m=s.value)==null||m.on("game-error",y=>{(y.from==="system"||y.from===l.partnerId)&&(f.value=y.message||"An error occurred in the game.",_(`Game error: ${y.message}`))}),(j=s.value)==null||j.on("game-partner-left",y=>{a.value&&(f.value="Your partner left the game.",_("Partner left the game"),a.value=null)})}),Re(()=>{var c,b,m,j,y;(c=s.value)==null||c.off("game-room-invite"),(b=s.value)==null||b.off("game-partner-joined"),(m=s.value)==null||m.off("game-error"),(j=s.value)==null||j.off("game-partner-left"),S.value&&((y=s.value)==null||y.emit("game-leave-room",{roomId:S.value,to:l.partnerId}))}),K(()=>l.isOpen,c=>{c||P()}),(c,b)=>o.isOpen?(h(),w("div",en,[e("div",tn,[e("div",on,[b[2]||(b[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-purple-400 text-xl"},"ðŸŽ®"),e("h2",{class:"text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),e("button",{onClick:b[0]||(b[0]=m=>c.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," âœ• ")]),U("",!0),a.value?f.value?(h(),w("div",rn,[e("div",cn,[b[8]||(b[8]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"âš ï¸")],-1)),b[9]||(b[9]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",un,M(f.value),1)]),e("button",{onClick:P,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):(h(),w("div",dn,[a.value==="tic-tac-toe"?(h(),It(Zo,{key:0,partnerId:o.partnerId,isFirstPlayer:i.value,partnerReady:I.value,onBack:P,onError:V},null,8,["partnerId","isFirstPlayer","partnerReady"])):U("",!0)])):(h(),w("div",nn,[e("div",an,[e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!o.isConnected}]),disabled:!o.isConnected},b[3]||(b[3]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-yellow-500 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>ðŸ‘Š</div><div class="text-white font-medium" data-v-823f908a>Rock Paper Scissors</div><div class="text-xs text-gray-400" data-v-823f908a>vs Partner</div>',4)]),10,ln),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},b[4]||(b[4]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>ðŸŽµ</div><div class="text-white font-medium" data-v-823f908a>Sound Game</div><div class="text-xs text-gray-400" data-v-823f908a>Voice Challenge</div>',4)])),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!o.isConnected}]),disabled:!o.isConnected,onClick:b[1]||(b[1]=m=>L("tic-tac-toe"))},b[5]||(b[5]=[e("div",{class:"bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"â­•",-1),e("div",{class:"text-white font-medium"},"Tic-Tac-Toe",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,sn),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},b[6]||(b[6]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>ðŸ’¬</div><div class="text-white font-medium" data-v-823f908a>Word Galaxy</div><div class="text-xs text-gray-400" data-v-823f908a>Brain Game</div>',4)]))]),b[7]||(b[7]=e("p",{class:"text-center text-sm text-gray-400 mt-2"}," Connect to play with others ",-1))]))])])):U("",!0)}});const gn=ue(fn,[["__scopeId","data-v-823f908a"]]),vn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},mn={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},pn={class:"flex items-center justify-between mb-6"},bn={class:"grid grid-cols-3 gap-4 mb-6"},yn=te({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(o,{emit:g}){const s=g,C=p(15),l=f=>{C.value=f},a=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${C.value}`,"_blank"),s("close")};return(f,i)=>o.isOpen?(h(),w("div",vn,[e("div",mn,[e("div",pn,[i[4]||(i[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-red-400 text-xl"},"â¤ï¸"),e("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),e("button",{onClick:i[0]||(i[0]=S=>f.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," âœ• ")]),i[8]||(i[8]=e("div",{class:"mb-6 text-center"},[e("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),e("div",bn,[e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",C.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:i[1]||(i[1]=S=>l(5))},i[5]||(i[5]=[e("div",{class:"text-lg font-bold text-white"},"$5",-1),e("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",C.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:i[2]||(i[2]=S=>l(15))},i[6]||(i[6]=[e("div",{class:"text-lg font-bold text-white"},"$15",-1),e("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",C.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:i[3]||(i[3]=S=>l(50))},i[7]||(i[7]=[e("div",{class:"text-lg font-bold text-white"},"$50",-1),e("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),i[9]||(i[9]=e("div",{class:"flex justify-center items-center gap-1 mb-6"},[e("span",{class:"text-yellow-400"},"â­"),e("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),e("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:a}," Donate via PayPal "),i[10]||(i[10]=e("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):U("",!0)}}),hn={class:"relative w-full"},xn={class:"py-1"},wn=te({__name:"select",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Select an option"},options:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(o,{emit:g}){const s=o,C=p(!1),l=p(null),a=p(null),f=le(()=>{if(s.options&&s.options.length){const I=s.options.find(x=>x.value===s.modelValue);return I?I.label:""}return s.modelValue}),i=()=>{C.value=!C.value},S=I=>{C.value&&l.value&&a.value&&!l.value.contains(I.target)&&!a.value.contains(I.target)&&(C.value=!1)};return se(()=>{document.addEventListener("click",S)}),je(()=>{document.removeEventListener("click",S)}),(I,x)=>(h(),w("div",hn,[e("button",{type:"button",ref_key:"triggerRef",ref:l,onClick:i,class:"w-full flex items-center justify-between bg-purple-500/20 border-purple-500/30 rounded-full h-8 px-3 text-xs shadow-lg shadow-purple-500/20 text-white"},[e("span",null,M(f.value||o.placeholder),1),x[0]||(x[0]=e("span",{class:"ml-1"},"â–¼",-1))],512),Z(At,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Et(()=>[C.value?(h(),w("div",{key:0,ref_key:"contentRef",ref:a,class:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto"},[e("div",xn,[Ve(I.$slots,"default",{},()=>[Ve(I.$slots,"placeholder",{},()=>[x[1]||(x[1]=e("div",{class:"px-3 py-2 text-xs text-gray-400"},"No items",-1))],!0)],!0)])],512)):U("",!0)]),_:3})]))}});const We=ue(wn,[["__scopeId","data-v-9f96ce6c"]]),Cn={class:"fixed inset-0 overflow-hidden pointer-events-none"},Tn=te({__name:"starfield",setup(o){const g=p([]);se(()=>{s()});const s=()=>{const l=[];for(let a=0;a<50;a++)l.push({id:a,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});g.value=l};return(C,l)=>(h(),w("div",Cn,[(h(!0),w(ie,null,ce(g.value,a=>(h(),w("div",{key:a.id,class:"absolute rounded-full bg-white",style:Ot({width:`${a.size}px`,height:`${a.size}px`,top:`${a.y}%`,left:`${a.x}%`,opacity:a.opacity,boxShadow:`0 0 ${a.size*2}px rgba(255, 255, 255, ${a.opacity})`,animation:`twinkle ${a.duration}s infinite ease-in-out`})},null,4))),128))]))}});const kn=ue(Tn,[["__scopeId","data-v-f4bff5a3"]]),Ie=!1,Rn=10,Sn=te({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(o){const{remoteStream:g,connectionState:s,partnerId:C,isAudioMuted:l}=Oe(),a=p(null),f=p(.8),i=p(!1),S=p(0),I=le(()=>(g.value!==null&&g.value?g.value.getAudioTracks().length>0:!1)&&g.value?g.value.getAudioTracks().some($=>$.enabled):!1);le(()=>g.value?g.value.getAudioTracks().filter(m=>m.enabled&&m.readyState==="live").length:0),le(()=>i.value&&I.value?"connected":(s.value==="connected"&&!I.value&&!i.value&&setTimeout(V,500),s.value)),K(()=>g.value,m=>{V(),S.value=0,setTimeout(c,500)}),K(()=>l.value,m=>{!m&&g.value&&a.value&&setTimeout(()=>{a.value&&a.value.paused&&a.value.play().catch(j=>{})},300)}),K(()=>s.value,m=>{m==="connected"?setTimeout(()=>{V(),c()},1e3):m==="new"||m==="connecting"?S.value=0:(m==="disconnected"||m==="failed")&&b()}),K(()=>C.value,m=>{i.value=!1,S.value=0,m||a.value&&(a.value.srcObject=null)}),se(()=>{V(),a.value&&(a.value.onplaying=()=>{i.value=!0},a.value.onpause=()=>{i.value=!1},a.value.onended=()=>{i.value=!1},a.value.onerror=m=>{console.error("[AudioOutput] Audio error:",m),i.value=!1},a.value.volume=f.value),document.addEventListener("visibilitychange",P),_()}),je(()=>{a.value&&(a.value.srcObject=null),document.removeEventListener("visibilitychange",P),L()});let x=null;function _(){L(),x=window.setInterval(()=>{!i.value&&I.value&&s.value==="connected"&&(V(),c())},5e3)}function L(){x&&(clearInterval(x),x=null)}function P(){document.visibilityState==="visible"&&(V(),setTimeout(()=>{!i.value&&I.value&&c()},500))}function V(){a.value&&(g.value?(a.value.srcObject=g.value,g.value.getAudioTracks().forEach(m=>{m.enabled=!0}),c()):(a.value.srcObject=null,i.value=!1))}async function c(){if(!(!a.value||!a.value.srcObject))try{const m=g.value&&g.value.getAudioTracks().length>0;await a.value.play(),i.value=!0,S.value=0}catch(m){if(console.error("[AudioOutput] Error playing audio:",m),i.value=!1,m instanceof DOMException&&m.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),S.value<Rn){S.value++;const j=S.value*1e3;setTimeout(c,j)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function b(){S.value=0,a.value&&(a.value.srcObject=null),setTimeout(()=>{V(),c()},500)}return(m,j)=>(h(),w("div",null,[e("audio",{ref_key:"audioElement",ref:a,autoplay:"",playsinline:"",class:"hidden"},null,512),U("",!0)]))}});const _n=ue(Sn,[["__scopeId","data-v-f63dc209"]]),$n={class:"min-h-screen font-sans"},Wn={class:"relative min-h-screen z-10 text-white"},In={class:"p-4 border-b border-white/10"},En={class:"max-w-4xl mx-auto"},An={class:"flex justify-center gap-2 mb-3"},On={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},jn={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},Dn={class:"grid grid-cols-2 gap-2 text-xs relative"},Mn={class:"flex items-center"},Pn={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Nn={class:"py-1"},Fn=["onClick"],Ln={class:"text-sm"},Vn={class:"flex-1 p-4"},Un={class:"max-w-md mx-auto space-y-6"},Gn={class:"flex items-center justify-center gap-2 mb-4"},Bn={class:"text-center"},zn={class:"text-xs text-gray-400 italic"},qn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Hn={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},Xn={class:"flex justify-between items-center mb-4"},Yn={class:"space-y-3"},Kn={key:0,class:"text-center py-8"},Jn={class:"flex items-center gap-3"},Qn={class:"text-2xl"},Zn={class:"text-white text-sm font-medium"},ea={class:"text-gray-400 text-xs"},ta={class:"text-xs text-gray-500"},oa={key:0,class:"text-xs text-gray-500 text-center mt-4"},na={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},aa={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},la={class:"flex justify-between items-center mb-4"},sa={class:"space-y-4"},ra={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},ia={key:0,class:"text-xs text-gray-400 p-2"},ca={key:1,class:"flex flex-wrap gap-1"},ua=["onClick"],da={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},fa={key:0,class:"text-xs text-gray-400 p-2"},ga={key:1,class:"flex flex-wrap gap-1"},va=["onClick"],ma={key:2,class:"hidden"},pa=te({__name:"HomeView",setup(o){const g=p("disconnected"),s=p(null),C=p(null),l=p(""),a=p(!1),f=p(!1),i=p(!1),S=p(!1),I=p(!1),x=p(!1),_=p(0),L=p(0),P=p(!1),V=p([]),c=p([]),b=p("any"),m=p(!1),j=p(""),y=p([]),$=p([]),O=p("off"),N=p(""),H=p(""),re=[{value:"any",text:"Any Vibe",emoji:"ðŸŒŸ"},{value:"chill",text:"Chill",emoji:"ðŸ˜Œ"},{value:"fun",text:"Fun",emoji:"ðŸŽ‰"},{value:"curious",text:"Curious",emoji:"ðŸ¤”"},{value:"creative",text:"Creative",emoji:"ðŸŽ¨"}],we=[{value:"off",label:"â° Disabled"},{value:"30",label:"30 seconds"},{value:"60",label:"60 seconds"},{value:"90",label:"90 seconds"}],oe=[{value:"any",label:"ðŸŒ Any Country"},{value:"us",label:"ðŸ‡ºðŸ‡¸ United States"},{value:"gb",label:"ðŸ‡¬ðŸ‡§ United Kingdom"},{value:"ca",label:"ðŸ‡¨ðŸ‡¦ Canada"},{value:"au",label:"ðŸ‡¦ðŸ‡º Australia"},{value:"de",label:"ðŸ‡©ðŸ‡ª Germany"},{value:"fr",label:"ðŸ‡«ðŸ‡· France"},{value:"it",label:"ðŸ‡®ðŸ‡¹ Italy"},{value:"es",label:"ðŸ‡ªðŸ‡¸ Spain"},{value:"jp",label:"ðŸ‡¯ðŸ‡µ Japan"}],Ce=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],t=p(Ce[Math.floor(Math.random()*Ce.length)]),r=xe().socket,{remoteStream:T,localStream:W,connectionState:q,createOffer:ya,handleOffer:Ze,handleAnswer:et,handleIceCandidate:tt,closeConnection:De,toggleMicrophone:ot,initializeLocalStream:nt}=Oe(),at=Kt(),lt=Dt(),Me=p(lt.params.roomId||null);K(()=>Me.value,d=>{d&&(i.value=!0)},{immediate:!0});const st=le(()=>oe.filter(d=>d.value!=="any"&&!y.value.includes(d.value)&&!$.value.includes(d.value))),rt=le(()=>oe.filter(d=>d.value!=="any"&&!$.value.includes(d.value)&&!y.value.includes(d.value))),it=async()=>{const d=await ot();a.value!==!d&&(a.value=!d),g.value==="connected"&&setTimeout(()=>{const u=document.querySelector("audio");u&&u.paused&&u.play().catch(()=>{})},300)},Pe=async()=>{if(!W.value)try{await nt(),console.log("Microphone initialized")}catch(d){console.error("Failed to access microphone",d),alert("Please allow microphone access to use voice chat");return}r.value&&(g.value="searching",s.value&&(console.log("Disconnecting from current partner"),r.value.emit("disconnect-partner"),s.value=null,C.value=null,V.value=[],De()),console.log("Finding new partner with preferences"),r.value.emit("join-queue",{vibe:b.value,preferences:{preferredCountries:y.value.length?y.value:void 0,blockedCountries:$.value.length?$.value:void 0,interests:j.value?j.value.split(",").map(d=>d.trim()):void 0}}),L.value++)},ct=()=>{f.value=!f.value,f.value&&s.value&&at.markAsRead(s.value)},ut=d=>{r.value&&s.value&&(r.value.emit("chat-message",{message:d,to:s.value}),V.value.push({id:Date.now().toString(),message:d,isOwn:!0,timestamp:Date.now()}))},dt=d=>{console.log(`Selected game: ${d}`),r.value&&s.value&&r.value.emit("game-invite",{game:d,to:s.value})},ft=()=>{N.value&&!y.value.includes(N.value)&&(y.value.push(N.value),N.value="")},gt=d=>{y.value=y.value.filter(u=>u!==d)},vt=()=>{H.value&&!$.value.includes(H.value)&&($.value.push(H.value),H.value="")},mt=d=>{$.value=$.value.filter(u=>u!==d)},pt=()=>{j.value="",y.value=[],$.value=[],O.value="off"},bt=()=>{x.value=!1},Ne=d=>{const u=oe.find(R=>R.value===d);return u?u.label.split(" ")[0]:"ðŸ³ï¸"},Fe=d=>{const u=oe.find(R=>R.value===d);return u?u.label.split(" ").slice(1).join(" "):"Unknown"},yt=d=>new Date(d).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),ht=()=>{m.value=!m.value},xt=d=>{b.value=d,m.value=!1},wt=d=>{const u=re.find(R=>R.value===d);return u?u.emoji:"ðŸŒŸ"},Ct=d=>{const u=re.find(R=>R.value===d);return u?u.text:"Any Vibe"};se(async()=>{console.log("Home view mounted"),r.value&&(r.value.on("online-count",d=>{_.value=d}),r.value.on("matched",d=>{if(console.log("Partner matched with event:",d),g.value="matched",l.value="",s.value=d.partnerId,C.value={id:d.partnerId,country:d.country||"Unknown",flag:d.flag||"ðŸŒ",vibe:d.vibe||"any"},c.value.unshift({id:Date.now().toString(),country:C.value.country,flag:C.value.flag,timestamp:Date.now()}),c.value.length>3&&(c.value=c.value.slice(0,3)),console.log("Partner matched:",d),d.partnerId){console.log("Initiating WebRTC connection with partner immediately");const{createOffer:u}=Oe();u(d.partnerId),setTimeout(()=>{g.value==="matched"&&q.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),g.value="connected")},2e3)}}),r.value.on("direct-connection-established",d=>{console.log("Direct connection established:",d),g.value="connected",s.value=d.partnerId,C.value={id:d.partnerId,country:d.country||"Unknown",flag:d.flag||"ðŸŒ"}}),r.value.on("partner-disconnected",()=>{g.value="disconnected",s.value=null,C.value=null,V.value=[],P.value&&setTimeout(()=>{g.value==="disconnected"&&P.value&&Pe()},2e3)}),r.value.on("chat-message",d=>{V.value.push({id:Date.now().toString(),message:d.message,isOwn:!1,timestamp:Date.now()})}),r.value.on("error",d=>{console.error("Socket error:",d.message),d.type==="matching"&&(g.value="disconnected")}),r.value.on("voice-offer",Tt),r.value.on("voice-answer",kt),r.value.on("ice-candidate",Rt),r.value.emit("get-online-count")),document.addEventListener("click",Le)}),je(()=>{console.log("Home view unmounting, cleaning up connection"),De(),r.value&&(r.value.off("online-count"),r.value.off("matched"),r.value.off("direct-connection-established"),r.value.off("partner-disconnected"),r.value.off("chat-message"),r.value.off("error"),r.value.off("voice-offer"),r.value.off("voice-answer"),r.value.off("ice-candidate")),document.removeEventListener("click",Le)});const Tt=async d=>{console.log("Received voice offer - forwarding to WebRTC service"),Ze(d.offer,d.from)},kt=async d=>{console.log("Received voice answer - forwarding to WebRTC service"),et(d.answer)},Rt=async d=>{console.log("Received ICE candidate - forwarding to WebRTC service"),tt(d.candidate)};K(q,(d,u)=>{console.log(`[HomeView] WebRTC connection state changed: ${u} -> ${d}`),d==="connected"&&g.value==="matched"?setTimeout(()=>{q.value==="connected"&&g.value==="matched"&&(g.value="connected",l.value="",console.log("[HomeView] Successfully transitioned from matched to connected"))},1e3):d==="failed"?(l.value="",setTimeout(()=>{q.value==="failed"&&(g.value==="matched"||g.value==="connected")&&(l.value='Connection failed. Press "Next" to find a new partner.')},6e4)):d==="disconnected"&&(g.value==="connected"||g.value==="matched")&&(l.value="",setTimeout(()=>{q.value==="disconnected"&&(g.value==="connected"||g.value==="matched")&&(l.value="Connection lost. Trying to reconnect...")},6e4))});const Se=p(null),Le=d=>{const u=d.target;Se.value&&!Se.value.contains(u)&&(m.value=!1)};return(d,u)=>(h(),w("div",$n,[u[26]||(u[26]=me('<div class="fixed inset-0 pointer-events-none" data-v-d136ba69><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-d136ba69></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-d136ba69></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-d136ba69></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-d136ba69></div></div>',1)),Z(kn),e("div",Wn,[e("header",In,[e("div",En,[u[15]||(u[15]=me('<div class="text-center mb-4" data-v-d136ba69><div class="inline-flex items-center gap-2" data-v-d136ba69><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-d136ba69><span class="text-white text-xs" data-v-d136ba69>âœ¨</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-d136ba69> SpaceTalk.live </h1></div></div>',1)),e("div",An,[e("div",On,[u[14]||(u[14]=e("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),e("span",null,M(_.value)+" online",1)]),L.value>0?(h(),w("div",jn," Today: "+M(L.value)+" voices ",1)):U("",!0)]),e("div",Dn,[e("div",{class:"relative",ref_key:"vibeDropdownRef",ref:Se},[e("div",{onClick:ht,class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[e("span",Mn,M(wt(b.value))+" "+M(Ct(b.value)),1),e("span",{class:B(["ml-2 text-xs transition-transform duration-300",{"rotate-180":m.value}])},"â–¼",2)]),m.value?(h(),w("div",Pn,[e("div",Nn,[(h(),w(ie,null,ce(re,R=>e("div",{key:R.value,onClick:Te=>xt(R.value),class:B(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":b.value===R.value}])},[e("span",Ln,M(R.emoji),1),e("span",null,M(R.text),1)],10,Fn)),64))])])):U("",!0)],512),e("button",{onClick:u[0]||(u[0]=R=>x.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," ðŸ” Filters ")])])]),e("main",Vn,[e("div",Un,[Z(go,{status:g.value,"partner-info":C.value,"error-message":l.value,"show-status":!0},null,8,["status","partner-info","error-message"]),e("div",Gn,[Ee(e("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":u[1]||(u[1]=R=>P.value=R),class:"w-3 h-3 rounded border-gray-600 bg-gray-700 text-emerald-500 focus:ring-emerald-500 focus:ring-1"},null,512),[[jt,P.value]]),u[16]||(u[16]=e("label",{for:"auto-reconnect",class:"text-xs text-gray-400 cursor-pointer"}," Auto-reconnect to others ",-1))]),Z(To,{"is-muted":a.value,"is-disabled":g.value!=="connected",onToggleMute:it,onFindNext:Pe,onToggleChat:ct,onToggleGames:u[2]||(u[2]=R=>i.value=!0),onToggleHistory:u[3]||(u[3]=R=>I.value=!0),onToggleDonation:u[4]||(u[4]=R=>S.value=!0)},null,8,["is-muted","is-disabled"]),e("div",Bn,[e("p",zn,'"'+M(t.value)+'"',1)])])]),u[17]||(u[17]=me('<footer class="p-4 border-t border-white/10" data-v-d136ba69><div class="max-w-md mx-auto text-center space-y-2" data-v-d136ba69><h3 class="text-sm font-semibold text-emerald-400" data-v-d136ba69>Community Guidelines</h3><div class="text-xs text-gray-300 space-y-1" data-v-d136ba69><p data-v-d136ba69>â€¢ Must be 18+ years old to use this service</p><p data-v-d136ba69>â€¢ Be respectful and kind to other users</p><p data-v-d136ba69>â€¢ No harassment, hate speech, or inappropriate content</p><p data-v-d136ba69>â€¢ Report any misconduct using the report feature</p><p data-v-d136ba69>â€¢ Your privacy and safety are our priority</p></div><p class="text-xs text-gray-400 mt-3" data-v-d136ba69> By using SpaceTalk.live, you agree to follow these guidelines </p><div class="flex justify-center gap-3 mt-4 text-xs" data-v-d136ba69><a href="#" class="bg-cyan-500/20 border border-cyan-500/30 rounded-full px-3 py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20" data-v-d136ba69> â„¹ï¸ About </a><a href="https://instagram.com" target="_blank" class="bg-pink-500/20 border border-pink-500/30 rounded-full px-3 py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20" data-v-d136ba69> ðŸ“· Instagram </a><a href="https://facebook.com" target="_blank" class="bg-blue-500/20 border border-blue-500/30 rounded-full px-3 py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20" data-v-d136ba69> ðŸ“˜ Facebook </a><a href="mailto:contact@spacetalk.live" class="bg-emerald-500/20 border border-emerald-500/30 rounded-full px-3 py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20" data-v-d136ba69> ðŸ“§ Contact </a></div></div></footer>',1))]),I.value?(h(),w("div",qn,[e("div",Hn,[e("div",Xn,[u[18]||(u[18]=e("h2",{class:"text-lg font-semibold text-indigo-400"},"ðŸ“ž Call History",-1)),e("button",{onClick:u[5]||(u[5]=R=>I.value=!1),class:"text-gray-400 hover:text-white text-xl"}," âœ• ")]),e("div",Yn,[c.value.length===0?(h(),w("div",Kn,u[19]||(u[19]=[e("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),e("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(h(!0),w(ie,{key:1},ce(c.value,(R,Te)=>(h(),w("div",{key:R.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[e("div",Jn,[e("span",Qn,M(R.flag),1),e("div",null,[e("p",Zn,M(R.country),1),e("p",ea,M(yt(R.timestamp)),1)])]),e("div",ta," #"+M(Te+1),1)]))),128))]),c.value.length>0?(h(),w("p",oa," History clears when you leave the page ")):U("",!0)])])):U("",!0),x.value?(h(),w("div",na,[e("div",aa,[e("div",la,[u[20]||(u[20]=e("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),e("button",{onClick:u[6]||(u[6]=R=>x.value=!1),class:"text-gray-400 hover:text-white text-xl"}," âœ• ")]),e("div",sa,[e("div",null,[u[21]||(u[21]=e("label",{class:"block text-sm font-medium mb-2 text-teal-400"},"Interest Keywords",-1)),Ee(e("input",{"onUpdate:modelValue":u[7]||(u[7]=R=>j.value=R),type:"text",placeholder:"e.g., music, travel, technology...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-emerald-500 focus:outline-none"},null,512),[[Ye,j.value]]),u[22]||(u[22]=e("p",{class:"text-xs text-gray-400 mt-1"},"Separate with commas",-1))]),e("div",null,[u[23]||(u[23]=e("label",{class:"block text-sm font-medium mb-2 text-emerald-400"},"Preferred Countries",-1)),e("div",ra,[y.value.length===0?(h(),w("p",ia,"No countries selected")):(h(),w("div",ca,[(h(!0),w(ie,null,ce(y.value,R=>(h(),w("span",{key:R,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[Ae(M(Ne(R))+" "+M(Fe(R))+" ",1),e("button",{onClick:Te=>gt(R),class:"text-emerald-200 hover:text-white ml-1"}," âœ• ",8,ua)]))),128))]))]),Z(We,{modelValue:N.value,"onUpdate:modelValue":u[8]||(u[8]=R=>N.value=R),options:st.value,placeholder:"Add preferred country...",class:"mt-2",onChange:ft},null,8,["modelValue","options"])]),e("div",null,[u[24]||(u[24]=e("label",{class:"block text-sm font-medium mb-2 text-red-400"},"Blocked Countries",-1)),e("div",da,[$.value.length===0?(h(),w("p",fa,"No countries blocked")):(h(),w("div",ga,[(h(!0),w(ie,null,ce($.value,R=>(h(),w("span",{key:R,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[Ae(M(Ne(R))+" "+M(Fe(R))+" ",1),e("button",{onClick:Te=>mt(R),class:"text-red-200 hover:text-white ml-1"}," âœ• ",8,va)]))),128))]))]),Z(We,{modelValue:H.value,"onUpdate:modelValue":u[9]||(u[9]=R=>H.value=R),options:rt.value,placeholder:"Add blocked country...",class:"mt-2",onChange:vt},null,8,["modelValue","options"])]),e("div",null,[u[25]||(u[25]=e("label",{class:"block text-sm font-medium mb-2 text-orange-400"},"Auto-Next Timer",-1)),Z(We,{modelValue:O.value,"onUpdate:modelValue":u[10]||(u[10]=R=>O.value=R),options:we,placeholder:"Select timer"},null,8,["modelValue"])])]),e("div",{class:"flex gap-2 mt-6"},[e("button",{onClick:pt,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Clear All "),e("button",{onClick:bt,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):U("",!0),Z(Do,{"is-open":f.value,onClose:u[11]||(u[11]=R=>f.value=!1),messages:V.value,onSendMessage:ut,"is-connected":g.value==="connected"},null,8,["is-open","messages","is-connected"]),Z(gn,{"is-open":i.value,onClose:u[12]||(u[12]=R=>i.value=!1),"is-connected":g.value==="connected",onSelectGame:dt,"partner-id":s.value||"","initial-game-room-id":Me.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),Z(yn,{"is-open":S.value,onClose:u[13]||(u[13]=R=>S.value=!1)},null,8,["is-open"]),g.value==="connected"?(h(),w("div",ma,[Z(_n,{showControls:!1})])):U("",!0)]))}});const Xe=ue(pa,[["__scopeId","data-v-d136ba69"]]),ba=Mt({history:Pt("/"),routes:[{path:"/",name:"home",component:Xe},{path:"/game/:roomId",name:"game",component:Xe,props:!0}]}),Qe=Nt(Vt);Qe.use(ba);Qe.mount("#app");
//# sourceMappingURL=index-cb4183dd.js.map
