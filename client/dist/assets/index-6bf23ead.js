import{d as te,c as w,a as Z,u as _t,o as h,R as $t,r as b,b as le,e as Se,s as We,w as K,f as ae,g as e,t as M,h as U,n as G,F as re,i as ie,j as Wt,k as Oe,v as Je,l as It,m as je,p as me,q as Et,x as Me,y as At,T as Ot,z as Ge,A as jt,B as Dt,C as Mt,D as Pt,E as Nt,G as Ft}from"./vue-vendor-21d667bf.js";import{l as Lt}from"./socket-vendor-d9998155.js";(function(){const v=document.createElement("link").relList;if(v&&v.supports&&v.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))T(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const d of a.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&T(d)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function T(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();const Vt={class:"app-container"},Ut=te({__name:"App",setup(n){return(v,s)=>(h(),w("div",Vt,[Z(_t($t))]))}});const Gt=()=>window.location.origin,j=b(null),ue=b(null),ye=b(!1);function we(){le(()=>{j.value||n()}),Se(()=>{j.value&&s()});function n(){const l=Gt();console.log(`Connecting to socket server at: ${l}`),j.value=Lt(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:3e4,transports:["websocket","polling"],extraHeaders:{"X-Client-Version":"1.0.0"},forceNew:!1,rememberUpgrade:!0,withCredentials:!0}),v()}function v(){j.value&&(j.value.on("connect",()=>{var l,a;console.log("Socket connected"),ye.value=!0,(l=j.value)==null||l.emit("user:identify",{},d=>{console.log("Identified with server, user ID:",d),ue.value=d}),(a=j.value)==null||a.emit("get-online-count")}),j.value.on("disconnect",()=>{console.log("Socket disconnected"),ye.value=!1}),j.value.on("reconnect",l=>{var a;console.log(`Socket reconnected after ${l} attempts`),ye.value=!0,ue.value&&((a=j.value)==null||a.emit("user:identify",{prevUserId:ue.value},d=>{var r;console.log("Re-identified with server after reconnection, user ID:",d),ue.value=d,(r=j.value)==null||r.emit("get-online-count")}))}),j.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),j.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),j.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{ye.value||(console.log("Attempting to reinitialize socket connection..."),s(),n())},5e3)}),j.value.on("error",l=>{console.error("Socket error:",l)}),j.value.on("user-id",l=>{console.log("Received user ID from server:",l),ue.value=l}))}function s(){j.value&&(j.value.off("connect"),j.value.off("disconnect"),j.value.off("reconnect"),j.value.off("reconnect_attempt"),j.value.off("reconnect_error"),j.value.off("reconnect_failed"),j.value.off("error"),j.value.off("user-id"))}function T(){j.value?(console.log("Forcing socket reconnection..."),j.value.disconnect(),j.value.connect()):n()}return{socket:j,isConnected:ye,userId:ue,reconnect:T}}const Qe={iceServers:[{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443","turn:openrelay.metered.ca:80","turn:global.turn.twilio.com:3478?transport=tcp","turn:global.turn.twilio.com:3478?transport=udp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.voiparound.com:3478"},{urls:"stun:stun.callwithus.com:3478"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},Be={iceServers:[{urls:["turn:openrelay.metered.ca:443?transport=tcp","turn:openrelay.metered.ca:443"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:global.turn.twilio.com:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:["turn:turn.anyfirewall.com:443?transport=tcp"],username:"webrtc",credential:"webrtc"}],iceCandidatePoolSize:10,iceTransportPolicy:"relay",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},ze={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:["turn:openrelay.metered.ca:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],iceCandidatePoolSize:5,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};let ve=Qe;const Bt=ve;let g=null,W=null,D=null;const B=b("new"),de=b(!1),he=b(null),R=!0;let Y="",ee="",qe=null,X=!1,fe=!1,F=0;const Q=15;let J=[],ge=null;const zt=8e3,qt=1e3;async function Ze(){if(!g)return{error:"No peer connection available"};try{const n={};return(await g.getStats()).forEach(s=>{s.type==="transport"?n.transport={bytesReceived:s.bytesReceived,bytesSent:s.bytesSent,dtlsState:s.dtlsState,selectedCandidatePairId:s.selectedCandidatePairId}:s.type==="candidate-pair"&&s.selected?n.selectedCandidatePair={localCandidateId:s.localCandidateId,remoteCandidateId:s.remoteCandidateId,state:s.state,availableOutgoingBitrate:s.availableOutgoingBitrate}:s.type==="local-candidate"||s.type==="remote-candidate"?(n.candidates||(n.candidates=[]),n.candidates.push({type:s.type,id:s.id,ip:s.ip,port:s.port,protocol:s.protocol,candidateType:s.candidateType})):(s.type==="media-source"||s.type==="track"||s.type==="media-playout")&&(n.media||(n.media=[]),n.media.push({type:s.type,id:s.id,kind:s.kind,audioLevel:s.audioLevel,trackIdentifier:s.trackIdentifier}))}),n}catch(n){return console.error("[WebRTC] Error getting stats:",n),{error:"Failed to get stats: "+n}}}function Ht(){He();const n=setInterval(async()=>{g&&(B.value==="connected"||B.value==="connecting")?(qe=await Ze(),console.log("[WebRTC] Connection stats:",qe)):He()},5e3);window.__webrtcStatsTimer=n}function He(){const n=window.__webrtcStatsTimer;n&&(clearInterval(n),window.__webrtcStatsTimer=null)}function De(){const{socket:n,userId:v}=we(),s=We(g),T=We(W),l=We(D),a=B,d=de,r=he;b({echoCancellation:!0,noiseSuppression:!0});const $=async()=>{try{if(W){R&&console.log("[WebRTC] Using existing local stream");const o=W.getAudioTracks();if(o.length===0||!o[0].enabled)R&&console.log("[WebRTC] Existing stream has no active audio tracks, requesting new stream"),W.getTracks().forEach(f=>f.stop()),W=null;else return W}R&&console.log("[WebRTC] Requesting access to microphone with specific constraints");const t=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:2},video:!1});if(t.getAudioTracks().length===0)throw console.error("[WebRTC] No audio tracks found in stream"),new Error("No audio tracks available");return R&&(console.log("[WebRTC] Local stream acquired successfully"),console.log("[WebRTC] Audio tracks:",t.getAudioTracks().length),t.getAudioTracks().forEach(f=>{console.log(`[WebRTC] Track: ${f.label}, enabled: ${f.enabled}, muted: ${f.muted}, readyState: ${f.readyState}`),console.log("[WebRTC] Track settings:",JSON.stringify(f.getSettings()))})),t.getTracks().forEach(o=>{o.enabled=!0}),W=t,T.value=t,t}catch(t){console.error("[WebRTC] Error accessing microphone:",t);try{R&&console.log("[WebRTC] Trying fallback with simpler constraints");const o=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");return W=o,T.value=o,o}catch(o){throw console.error("[WebRTC] Fallback also failed:",o),new Error("Could not access microphone. Please check permissions.")}}},E=()=>{if(g)try{g.close(),g=null,D&&(D.getTracks().forEach(t=>{t.stop()}),D=null)}catch(t){console.error("[WebRTC] Error cleaning up old peer connection:",t)}try{const t=new RTCPeerConnection(Bt);return t.onnegotiationneeded=async o=>{if(R&&console.log("[WebRTC] Negotiation needed event",o),!Xt(t)||X){R&&console.log("[WebRTC] Skipping negotiation - already in progress or not in stable state");return}X=!0;try{R&&console.log("[WebRTC] Starting negotiation"),Te()}catch(f){console.error("[WebRTC] Negotiation error:",f),ee=`Negotiation error: ${f}`,X=!1}},t.oniceconnectionstatechange=()=>{R&&console.log("[WebRTC] ICE Connection state changed to:",t.iceConnectionState),t.iceConnectionState==="connected"||t.iceConnectionState==="completed"?(ee="",F=0,N(),Ht(),xe("connected")):(t.iceConnectionState==="failed"||t.iceConnectionState==="disconnected"||t.iceConnectionState==="closed")&&(t.iceConnectionState==="failed"&&(ee="ICE connection failed",console.error("[WebRTC] ICE Connection failed")),t.iceConnectionState!=="closed"?!fe&&F<Q?(console.log(`[WebRTC] Attempting ICE restart, attempt ${F+1} of ${Q}`),I()):F>=Q&&(console.error("[WebRTC] Max connection retry attempts reached, giving up"),xe("failed"),F=0,ee="Max retries reached, connection failed",i()):xe("closed")),B.value=t.iceConnectionState},t.onicecandidate=o=>{var f;o.candidate?(R&&console.log("[WebRTC] New ICE candidate:",o.candidate),window.__localIceCandidates||(window.__localIceCandidates=[]),window.__localIceCandidates.push(o.candidate),r.value?(f=n.value)==null||f.emit("webrtc-signal",{type:"ice-candidate",candidate:o.candidate,to:r.value}):(J.push(o.candidate),R&&console.log("[WebRTC] Storing ICE candidate for later. Total pending:",J.length))):(R&&console.log("[WebRTC] ICE gathering complete"),J.length>0&&r.value&&(J.forEach(p=>{var k;(k=n.value)==null||k.emit("webrtc-signal",{type:"ice-candidate",candidate:p,to:r.value})}),R&&console.log(`[WebRTC] Sent ${J.length} pending ICE candidates`),J=[]))},t.onicegatheringstatechange=()=>{R&&console.log("[WebRTC] ICE gathering state changed to:",t.iceGatheringState)},t.onconnectionstatechange=()=>{R&&console.log("[WebRTC] Connection state changed to:",t.connectionState),xe(t.connectionState),t.connectionState==="connected"?(ee="",F=0):(t.connectionState==="failed"||t.connectionState==="disconnected"||t.connectionState==="closed")&&t.connectionState==="failed"&&!ee&&(ee="PeerConnection failed")},t.onsignalingstatechange=()=>{R&&console.log("[WebRTC] Signaling state changed to:",t.signalingState),t.signalingState==="stable"&&(X=!1)},t.ontrack=o=>{R&&console.log("[WebRTC] Track received:",o.track),D||(D=new MediaStream,l.value=D,console.log("[WebRTC] Created new remote stream")),D.addTrack(o.track),console.log(`[WebRTC] Added ${o.track.kind} track to remote stream, now has ${D.getTracks().length} tracks`),setTimeout(()=>{if(D){const f=D.getTracks();console.log(`[WebRTC] Remote stream has ${f.length} tracks after adding`),f.forEach(p=>{console.log(`[WebRTC] Track: ${p.kind}, enabled: ${p.enabled}, muted: ${p.muted}, readyState: ${p.readyState}`),p.kind==="audio"&&(!p.enabled||p.muted)&&(console.log("[WebRTC] 🔴 Found disabled or muted audio track, enabling it"),p.enabled=!0)})}},500),R&&(o.track.onunmute=()=>{console.log("[WebRTC] Track unmuted:",o.track.kind)},o.track.onmute=()=>{console.log("[WebRTC] Track muted:",o.track.kind),o.track.enabled=!0},o.track.onended=()=>{console.log("[WebRTC] Track ended:",o.track.kind)})},be(t),g=t,t}catch(t){throw console.error("[WebRTC] Error creating peer connection:",t),Y=`Creation error: ${t}`,ee="Failed to create connection",xe("failed"),t}},x=async t=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),!t){const o="Cannot create offer: No target partner ID provided";return console.error(`[WebRTC] ${o}`),Y=o,{error:o}}if(!n.value){const o="Cannot create offer: socket not available";return console.error(`[WebRTC] ${o}`),Y=o,{error:o}}if(!W)try{R&&console.log("[WebRTC] Initializing local stream before creating offer"),await $()}catch(o){return console.error("[WebRTC] Failed to initialize local stream:",o),Y=`Failed to access microphone: ${o}`,{error:`Failed to access microphone: ${o}`}}if(console.log(`[WebRTC] Creating offer for partner: ${t}`),X)return console.warn("[WebRTC] Negotiation already in progress, deferring new offer"),new Promise(o=>{setTimeout(async()=>{o(X?{waiting:"Negotiation in progress"}:await x(t))},1e3)});X=!0,he.value=t,r.value=t;try{R&&console.log(`[WebRTC] Setting partner ID: ${t}`);const o=E();if(W){R&&(console.log("[WebRTC] Adding local tracks to connection"),console.log(`[WebRTC] Local stream has ${W.getTracks().length} tracks`));const p=W;if(o.getSenders().length>0){R&&console.log("[WebRTC] Replacing existing senders");let k=0;p.getTracks().forEach(q=>{o.getSenders()[k]?(o.getSenders()[k].replaceTrack(q),k++):o.addTrack(q,p)})}else p.getTracks().forEach(k=>{o.addTrack(k,p)})}else if(console.error("[WebRTC] No local stream to add tracks from"),await $(),W){const p=W;p.getTracks().forEach(k=>{o.addTrack(k,p)})}B.value="connecting",a.value="connecting",R&&console.log("[WebRTC] Creating offer");const f=await o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return R&&console.log("[WebRTC] Setting local description"),await o.setLocalDescription(f),n.value&&t&&(R&&console.log("[WebRTC] Sending immediate offer using Trickle ICE"),n.value.emit("voice-offer",{offer:o.localDescription,to:t}),n.value.emit("webrtc-signal",{type:"offer",offer:o.localDescription,to:t})),be(o),N(),R&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(o){return console.error("[WebRTC] Error creating offer:",o),Y=`Error creating offer: ${o}`,X=!1,{error:`Failed to create offer: ${o}`}}finally{setTimeout(()=>{X=!1},2e3)}},_=t=>t.iceGatheringState==="complete"?(console.log("[WebRTC] ICE gathering already complete"),Promise.resolve()):new Promise(o=>{const f=()=>{t.iceGatheringState==="complete"&&(t.removeEventListener("icegatheringstatechange",f),o())};t.addEventListener("icegatheringstatechange",f),setTimeout(()=>{t.removeEventListener("icegatheringstatechange",f),console.log("[WebRTC] ICE gathering timed out, but continuing anyway"),o()},1e3)}),L=async(t,o)=>{if(!n.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",o),console.log("[WebRTC] Offer SDP:",t.sdp),he.value=o,r.value=o;try{W||(R&&console.log("[WebRTC] Initializing local stream before handling offer"),await $());const f=E();if(W&&(f.getSenders().length===0?(R&&console.log("[WebRTC] Adding local tracks to connection"),W.getTracks().forEach(q=>{f.addTrack(q,W)})):R&&console.log("[WebRTC] Senders already exist, not adding tracks again")),B.value="connecting",a.value="connecting",R&&console.log("[WebRTC] Setting remote description (offer)"),await f.setRemoteDescription(new RTCSessionDescription(t)),J.length>0){R&&console.log(`[WebRTC] Adding ${J.length} pending ICE candidates`);for(const k of J)try{await f.addIceCandidate(k)}catch(q){console.error("[WebRTC] Error adding pending ICE candidate:",q)}J=[]}R&&console.log("[WebRTC] Creating answer");const p=await f.createAnswer({offerToReceiveAudio:!0});R&&console.log("[WebRTC] Answer SDP:",p.sdp),R&&console.log("[WebRTC] Setting local description (answer)"),await f.setLocalDescription(p),f.getTransceivers().forEach(k=>{if(k.receiver.track.kind==="audio"&&(console.log("[WebRTC] Ensuring audio transceiver is set to receive"),k.direction!=="sendrecv"&&k.direction!=="recvonly"))try{k.direction="sendrecv"}catch(q){console.error("[WebRTC] Could not update transceiver direction:",q)}}),await _(f),R&&console.log("[WebRTC] Sending answer to:",o),n.value.emit("voice-answer",{answer:f.localDescription,to:o}),n.value.emit("webrtc-signal",{type:"answer",answer:f.localDescription,to:o}),be(f),N(),R&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(f){console.error("[WebRTC] Error handling offer:",f),Y=`Error handling offer: ${f}`,setTimeout(()=>{n.value&&r.value&&(console.log("[WebRTC] Re-negotiating after offer error"),x(r.value))},2e3)}},P=async t=>{try{if(!g){R&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const o=g.signalingState;if(R&&console.log(`[WebRTC] Current signaling state before handling answer: ${o}`),o==="have-local-offer"){R&&console.log("[WebRTC] Setting remote description from answer");try{await g.setRemoteDescription(new RTCSessionDescription(t)),R&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+g.signalingState)}catch(f){if(console.error("[WebRTC] Error setting remote description:",f),f.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(p=>setTimeout(p,1e3)),g.signalingState==="have-local-offer")try{R&&console.log("[WebRTC] Retrying set remote description after delay"),await g.setRemoteDescription(new RTCSessionDescription(t)),R&&console.log("[WebRTC] Remote description set successfully on retry")}catch(p){console.error("[WebRTC] Final error setting remote description:",p)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${g.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${o}`),o==="stable"?R&&console.log("[WebRTC] Already in stable state, ignoring answer"):o==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),F<Q&&(F++,R&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${F}/${Q})`),i(),setTimeout(()=>{r.value&&x(r.value)},2e3)))}catch(o){console.error("[WebRTC] Error handling answer:",o),Y=`Error handling answer: ${o}`,console.log("[WebRTC] Attempting to recover from answer error"),F<Q&&await I()}},V=async()=>{if(!de.value)return console.log("[WebRTC] Muting microphone - stopping all tracks"),W&&(W.getAudioTracks().forEach(o=>{o.stop()}),W=null,T.value=null),de.value=!0,!1;console.log("[WebRTC] Unmuting microphone - requesting new permission");try{W&&(W.getTracks().forEach(f=>f.stop()),W=null,T.value=null);const o=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");if(W=o,T.value=o,g&&o)try{const p=g.getSenders().find(k=>k.track&&k.track.kind==="audio");if(p){const k=o.getAudioTracks()[0];k&&p.replaceTrack(k)}else o.getAudioTracks().length>0&&o.getAudioTracks().forEach(k=>{g&&g.addTrack(k,o)})}catch(f){console.error("[WebRTC] Error adding audio tracks:",f)}return de.value=!1,!0}catch(o){console.error("[WebRTC] Error unmuting microphone:",o);try{const f=await navigator.mediaDevices.getUserMedia({audio:!0});return W=f,T.value=f,de.value=!1,!0}catch(f){return console.error("[WebRTC] Fallback microphone access also failed:",f),!1}}},i=()=>{if(console.log("[WebRTC] Closing connection"),z(),g){try{g.ontrack=null,g.onicecandidate=null,g.oniceconnectionstatechange=null,g.onicegatheringstatechange=null,g.onsignalingstatechange=null,g.onconnectionstatechange=null;try{g.getTransceivers&&g.getTransceivers().forEach(t=>{t.stop&&t.stop()})}catch{}g.close(),R&&console.log("[WebRTC] Peer connection closed")}catch(t){console.error("[WebRTC] Error closing peer connection:",t)}g=null}D&&(D.getTracks().forEach(t=>{t.stop()}),D=new MediaStream,l.value=D),B.value="closed",a.value="closed"},y=()=>{console.log("[WebRTC] Full cleanup initiated"),i(),W&&(console.log("[WebRTC] Stopping local stream tracks"),W.getTracks().forEach(t=>{t.stop()}),W=null,T.value=null),console.log("[WebRTC] Cleanup complete")};function m(){if(!n.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),n.value.off("webrtc-signal"),n.value.off("ice-candidate"),n.value.off("partner-disconnected"),n.value.off("webrtc-connection-failed"),n.value.off("connection-timeout"),n.value.off("voice-offer"),n.value.off("voice-answer"),n.value.on("voice-offer",async t=>{console.log("[WebRTC] Received legacy voice-offer:",t),await L(t.offer,t.from)}),n.value.on("voice-answer",async t=>{console.log("[WebRTC] Received legacy voice-answer:",t),await P(t.answer)}),n.value.on("webrtc-signal",async t=>{if(console.log(`[WebRTC] Received ${t.type} signal from ${t.from}`),he.value=t.from,r.value=t.from,t.type==="offer"&&t.offer)try{await L(t.offer,t.from)}catch(o){console.error("[WebRTC] Error handling offer:",o),Y=`Error handling offer: ${o}`,n.value&&n.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle offer: ${o}`})}else if(t.type==="answer"&&t.answer)try{await P(t.answer)}catch(o){console.error("[WebRTC] Error handling answer:",o),Y=`Error handling answer: ${o}`,n.value&&n.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle answer: ${o}`})}}),n.value.on("ice-candidate",async t=>{if(console.log(`[WebRTC] Received ICE candidate from ${t.from}`),t.from!==r.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await se(t.candidate)}catch(o){console.error("[WebRTC] Error handling ICE candidate:",o),Y=`Error handling ICE candidate: ${o}`}}),n.value.on("webrtc-connection-failed",t=>{console.log(`[WebRTC] Connection failed notification from ${t.from}: ${t.reason}`),F<Q?(F++,console.log(`[WebRTC] Partner reported connection failure. Retry ${F}/${Q}`),t.from===r.value&&setTimeout(()=>{r.value&&n.value&&x(t.from)},qt)):(B.value="failed",Y=`Partner reported failure: ${t.reason}`)}),n.value.on("partner-disconnected",()=>{console.log("[WebRTC] Partner disconnected"),i(),he.value=null,r.value=null,B.value="closed",X=!1,fe=!1,F=0})}m(),Se(()=>{s.value=null,T.value=null,l.value=null});function A(){if(!g||!D)return console.log("[WebRTC] Cannot fix tracks: missing connection or stream"),!1;console.log("[WebRTC] Checking and fixing tracks");const t=g.getSenders();if(t.length===0&&W)console.log("[WebRTC] No senders found, re-adding local tracks"),W.getTracks().forEach(f=>{g==null||g.addTrack(f,W)});else if(t.length>0&&W){console.log(`[WebRTC] Found ${t.length} senders, checking state`);const f=W.getTracks();t.forEach(p=>{if(p.track&&p.track.readyState!=="live"){const k=f.find(q=>{var oe;return q.kind===((oe=p.track)==null?void 0:oe.kind)});k&&(console.log("[WebRTC] Replacing inactive track with active one"),p.replaceTrack(k))}})}const o=g.getReceivers();if(o.length>0){console.log(`[WebRTC] Found ${o.length} receivers`);let f=!1;o.forEach(p=>{p.track&&p.track.kind==="audio"&&(f=!0,!(D!=null&&D.getTracks().some(q=>{var oe;return q.id===((oe=p.track)==null?void 0:oe.id)}))&&D&&(console.log("[WebRTC] Adding missing track to remote stream"),D.addTrack(p.track)))}),f||console.log("[WebRTC] No audio receivers found!")}O(),C()}function C(){if(console.log("[WebRTC] 🔍 Diagnosing audio connection issues"),!g)return console.log("[WebRTC] 🔴 No peer connection exists"),!1;console.log(`[WebRTC] Connection state: ${g.connectionState}`),console.log(`[WebRTC] ICE connection state: ${g.iceConnectionState}`),console.log(`[WebRTC] Signaling state: ${g.signalingState}`);const t=g.getReceivers();console.log(`[WebRTC] Connection has ${t.length} receivers`);let o=!1;if(t.forEach((f,p)=>{const k=f.track;k&&k.kind==="audio"&&(o=!0,console.log(`[WebRTC] Audio receiver ${p} - Track: ${k.label}, enabled: ${k.enabled}, readyState: ${k.readyState}`),k.enabled||(console.log("[WebRTC] 🟠 Found disabled audio track, enabling it"),k.enabled=!0))}),!o&&R&&console.log("[WebRTC] 🔴 No audio receivers found. Remote party may not be sending audio."),W){const f=W.getAudioTracks();console.log(`[WebRTC] Local stream has ${f.length} audio tracks`),f.forEach((p,k)=>{console.log(`[WebRTC] Local audio track ${k}: ${p.label}, enabled: ${p.enabled}, readyState: ${p.readyState}`)})}else console.log("[WebRTC] 🔴 No local stream available");if(D){const f=D.getAudioTracks();console.log(`[WebRTC] Remote stream has ${f.length} audio tracks`),f.forEach((p,k)=>{console.log(`[WebRTC] Remote audio track ${k}: ${p.label}, enabled: ${p.enabled}, readyState: ${p.readyState}`),p.enabled||(console.log("[WebRTC] 🟠 Found disabled remote audio track, enabling it"),p.enabled=!0)}),f.length===0&&R&&(console.log("[WebRTC] 🔴 No audio tracks in remote stream. Trying to check transceivers..."),g.getTransceivers().forEach((k,q)=>{if(console.log(`[WebRTC] Transceiver ${q} direction: ${k.direction}`),k.direction==="sendonly"||k.direction==="inactive"){console.log("[WebRTC] 🟠 Transceiver not set to receive, updating direction");try{k.direction="sendrecv",R&&console.log("[WebRTC] Updated transceiver direction to sendrecv")}catch(oe){console.error("[WebRTC] Failed to update transceiver direction:",oe)}}}))}else console.log("[WebRTC] 🔴 No remote stream available");return!0}async function I(){if(!(!g||!r.value)){console.log("[WebRTC] Attempting connection recovery");try{if(fe=!0,ve===Qe?(ve=ze,console.log("[WebRTC] Switching to fast configuration for quicker connection")):F>5&&(ve=Be,console.log("[WebRTC] Switching to TURN-only configuration")),g.restartIce){g.restartIce();const t=await g.createOffer({iceRestart:!0,offerToReceiveAudio:!0});await g.setLocalDescription(t),n.value&&(n.value.emit("offer",{offer:g.localDescription,to:r.value}),n.value.emit("webrtc-signal",{type:"offer",offer:g.localDescription,to:r.value}))}setTimeout(()=>{fe=!1},500)}catch(t){console.error("[WebRTC] Recovery attempt failed:",t),fe=!1,F<Q&&setTimeout(()=>{i(),r.value&&x(r.value)},200)}}}function O(){typeof window<"u"&&(window.__webrtc_debug={connectionState:B.value,connectionRetryCount:F,lastConnectionError:Y,failureReason:ee,isNegotiating:X,isRestartingIce:fe,pendingCandidates:J.length,hasLocalTracks:W?W.getAudioTracks().length>0:!1,hasRemoteTracks:D?D.getAudioTracks().length>0:!1})}K(()=>B.value,()=>{O()});function N(){ge&&clearInterval(ge),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),g&&(g.onicecandidate=t=>{t.candidate&&(console.log("[WebRTC] ICE candidate generated:",t.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:t.candidate.candidate,timestamp:Date.now()})),n.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),n.value.emit("ice-candidate",{candidate:t.candidate,to:r.value})))}),ge=window.setInterval(async()=>{if(!g||B.value!=="connecting"&&B.value!=="connected"){z();return}try{const t=await Ze();t&&t.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=t.iceCandidatePairs),pe(t)}catch(t){console.error("[WebRTC] Error monitoring connection:",t)}},zt)}function z(){ge&&(clearInterval(ge),ge=null)}function pe(t){if(!t||t.error)return;const o=!t.media||t.media.length===0||!t.media.some(p=>p.kind==="audio"&&p.audioLevel>0),f=!t.selectedCandidatePair||t.selectedCandidatePair.state!=="succeeded";(o||f)&&(console.log("[WebRTC] Connection health issues detected, trying to fix..."),A(),B.value==="connected"&&F<Q&&(F++,console.log(`[WebRTC] Attempting connection improvement (${F}/${Q})`),g&&g.getTransceivers&&g.getTransceivers().forEach(p=>{p.sender&&p.sender.track&&p.sender.track.kind==="audio"&&p.sender.setParameters({...p.sender.getParameters(),degradationPreference:"maintain-framerate"})})))}function be(t){if(!r.value)return;window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout);const o=5e3;window.__webrtcConnectionTimeout=setTimeout(()=>{(t.connectionState==="connecting"||t.connectionState==="new")&&(console.log(`[WebRTC] Connection not established after ${o/1e3} seconds, trying fast config`),ve=ze,r.value&&!X&&x(r.value),window.__webrtcConnectionTimeout=setTimeout(()=>{var f,p,k;if(t.connectionState==="connecting"||t.connectionState==="new"){console.log("[WebRTC] Connection still not established, trying TURN-only config");const q={localCandidates:((f=window.__localIceCandidates)==null?void 0:f.length)||0,remoteCandidates:((p=window.__remoteIceCandidates)==null?void 0:p.length)||0,iceCandidatePairsCount:((k=window.__iceCandidatePairs)==null?void 0:k.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(q)),ve=Be,i(),r.value&&setTimeout(()=>{x(r.value)},200)}},5e3))},o)}const se=async t=>{if(!g){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(R&&console.log("[WebRTC] Adding received ICE candidate:",t.candidate),window.__remoteIceCandidates||(window.__remoteIceCandidates=[]),window.__remoteIceCandidates.push(t),!g.remoteDescription||!g.localDescription){R&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(g&&g.remoteDescription){R&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await g.addIceCandidate(t)}catch(o){console.error("[WebRTC] Error adding delayed ICE candidate:",o)}}},1e3);return}await g.addIceCandidate(t),R&&console.log("[WebRTC] Successfully added ICE candidate")}catch(o){console.error("[WebRTC] Error adding ICE candidate:",o),Y=`Error adding ICE candidate: ${o}`,setTimeout(async()=>{if(g&&g.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await g.addIceCandidate(t),R&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(f){console.error("[WebRTC] Error adding ICE candidate on retry:",f)}}},2e3)}};function Te(){if(!g||!r.value||X){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),X=!0;try{g.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then(t=>{if(g)return g.setLocalDescription(t)}).then(()=>{!g||!n.value||!r.value||(n.value.emit("voice-offer",{offer:g.localDescription,to:r.value}),R&&console.log("[WebRTC] Sent renegotiation offer"))}).catch(t=>{console.error("[WebRTC] Error during negotiation:",t)}).finally(()=>{setTimeout(()=>{X=!1},2e3)})}catch(t){console.error("[WebRTC] Failed to start negotiation:",t),X=!1}}const _e={connectionState:B.value,iceCandidatesGenerated:J.length,localStreamActive:!!W&&W.active,remoteStreamActive:!!D&&D.active,localTracks:W?W.getAudioTracks().length:0,remoteTracks:D?D.getAudioTracks().length:0,connectionRetries:F,lastError:Y||ee||"",isAudioMuted:de.value,forceReconnect:()=>g&&B.value!=="new"?(I(),!0):!1};return{socket:n,peerConnection:s,remoteStream:l,localStream:T,connectionState:a,isAudioMuted:d,partnerId:r,createOffer:x,handleOffer:L,handleAnswer:P,handleIceCandidate:se,toggleMicrophone:V,closeConnection:i,initializeLocalStream:$,cleanup:y,diagnosticReport:_e}}function Xt(n){return n.signalingState==="stable"||n.signalingState==="have-remote-offer"}function xe(n){B.value!==n&&(console.log(`[WebRTC] Connection state changing from ${B.value} to ${n}`),B.value=n,n==="connected"||n==="completed"?(ee="",Y="",F=0,console.log("[WebRTC] Connection established successfully")):(n==="failed"||n==="disconnected")&&(console.warn(`[WebRTC] Connection ${n}: ${ee||"Unknown reason"}`),n==="failed"&&(F++,console.log(`[WebRTC] Connection failure count: ${F}/${Q}`))))}function Yt(){const n="test";try{return localStorage.setItem(n,n),localStorage.removeItem(n),!0}catch(v){return console.error("localStorage is not available:",v),!1}}function Kt(){const n=b(Yt());function v(a,d){if(!n.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(a,d)}catch(r){console.error("Failed to set localStorage item:",r)}}function s(a){if(!n.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(a)}catch(d){return console.error("Failed to get localStorage item:",d),null}}function T(a){if(!n.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(a)}catch(d){console.error("Failed to remove localStorage item:",d)}}function l(){if(!n.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(a){console.error("Failed to clear localStorage:",a)}}return{isAvailable:n,setItem:v,getItem:s,removeItem:T,clear:l}}const H=b({}),Ce=b(null),ne=b({}),Re=b(!1),Ie=!0;let Xe=!1;function Jt(){const{socket:n,userId:v}=we(),s=Kt();Xe?console.log("[ChatService] Using existing chat service instance"):(console.log("[ChatService] Initializing chat service"),T(),Xe=!0);function T(){l(),L(),K(H,()=>{_()},{deep:!0}),K(()=>n.value,i=>{i&&!Re.value&&(console.log("[ChatService] Socket reconnected, setting up listeners again"),l())})}function l(){if(!n.value){console.log("[ChatService] No socket available, cannot set up listeners");return}Re.value&&(console.log("[ChatService] Removing existing chat-message listener"),n.value.off("chat-message"),Re.value=!1),console.log("[ChatService] Setting up chat-message listener"),n.value.on("chat-message",i=>{console.log("[ChatService] Received chat message:",i);const y=i.from,m=x(y);console.log(`[ChatService] Conversation key: ${m}, current partner: ${Ce.value}`),H.value[m]||(H.value[m]=[]),H.value[m].push({sender:"partner",text:i.text,timestamp:i.timestamp||Date.now()}),y!==Ce.value&&(ne.value[y]=!0,console.log(`[ChatService] Marked message from ${y} as unread`)),_(),console.log("[ChatService] Updated messages:",H.value[m])}),Re.value=!0,console.log("[ChatService] Chat message listener setup complete")}function a(i){console.log(`[ChatService] Setting current partner: ${i}`),Ce.value=i,i&&(ne.value[i]=!1)}function d(i,y=null){const m=y||Ce.value;if(!m||!i.trim()||!n.value)return console.log(`[ChatService] Cannot send message: partnerId=${m}, text=${i.trim()?"present":"empty"}, socket=${n.value?"present":"not present"}`),!1;console.log(`[ChatService] Sending message to ${m}: ${i}`);const A=x(m);H.value[A]||(H.value[A]=[]);const C=Date.now();return H.value[A].push({sender:"me",text:i.trim(),timestamp:C}),n.value.emit("chat-message",{text:i.trim(),to:m}),console.log("[ChatService] Message sent, current messages:",H.value[A]),!0}function r(i){if(!i)return[];const y=x(i),m=H.value[y]||[];return console.log(`[ChatService] Getting messages for ${i}, found ${m.length} messages`),m}function $(i){if(!i)return!1;const y=!!ne.value[i];return console.log(`[ChatService] Checking unread for ${i}: ${y}`),y}function E(i){i&&(console.log(`[ChatService] Marking messages as read for ${i}`),ne.value[i]=!1)}function x(i){if(!v.value)return i;const y=[v.value,i].sort();return`${y[0]}_${y[1]}`}function _(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot save chats");return}try{s.setItem("chat_messages",JSON.stringify(H.value)),s.setItem("chat_unread",JSON.stringify(ne.value)),Ie&&console.log("[ChatService] Saved chats to localStorage")}catch(i){console.error("[ChatService] Failed to save chats:",i)}}function L(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot load chats");return}try{const i=s.getItem("chat_messages");i&&(H.value=JSON.parse(i),Ie&&console.log("[ChatService] Loaded messages from localStorage:",Object.keys(H.value).length,"conversations"));const y=s.getItem("chat_unread");y&&(ne.value=JSON.parse(y),Ie&&console.log("[ChatService] Loaded unread status from localStorage"))}catch(i){console.error("[ChatService] Failed to load chats:",i)}}function P(i){if(!i)return;const y=x(i);H.value[y]&&(H.value[y]=[],_(),console.log(`[ChatService] Cleared chat for ${i}`))}function V(){H.value={},ne.value={},_(),console.log("[ChatService] Cleared all chats")}return{messages:H,unreadMessages:ne,currentPartnerId:Ce,setCurrentPartner:a,sendMessage:d,getMessages:r,hasUnreadMessages:$,markAsRead:E,clearChat:P,clearAllChats:V}}const Qt={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/10"},Zt={key:0},eo={key:1},to={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},oo={class:"text-xl"},no={class:"text-sm"},ao={key:2},lo={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},so={class:"text-xl"},ro={class:"text-sm"},io={key:3},co={key:4,class:"mt-4 text-xs"},uo={class:"flex items-center justify-center gap-2"},fo={key:0,class:"text-red-400 mt-1 text-xs"},go=te({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0}},setup(n){const v=n,s=ae(()=>{switch(v.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";default:return"Disconnected"}});return(T,l)=>(h(),w("div",Qt,[n.status==="searching"?(h(),w("div",Zt,l[0]||(l[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center animate-pulse"},[e("div",{class:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Searching...",-1),e("p",{class:"text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):n.status==="matched"?(h(),w("div",eo,[l[1]||(l[1]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-yellow-500 to-green-500 rounded-full flex items-center justify-center animate-pulse"},[e("span",{class:"text-2xl"},"🔄")],-1)),l[2]||(l[2]=e("h2",{class:"text-lg font-semibold mb-2 text-yellow-400"},"Match Found!",-1)),n.partnerInfo?(h(),w("div",to,[e("span",oo,M(n.partnerInfo.flag),1),e("span",no,M(n.partnerInfo.country),1)])):U("",!0),l[3]||(l[3]=e("p",{class:"text-sm text-yellow-400 mt-2"},"Setting up voice connection...",-1)),l[4]||(l[4]=e("div",{class:"mt-3 relative h-1.5 w-3/4 mx-auto bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-500 to-green-500 rounded-full animate-progress"})],-1))])):n.status==="connected"?(h(),w("div",ao,[l[5]||(l[5]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"👥")],-1)),l[6]||(l[6]=e("h2",{class:"text-lg font-semibold mb-2"},"Connected!",-1)),n.partnerInfo?(h(),w("div",lo,[e("span",so,M(n.partnerInfo.flag),1),e("span",ro,M(n.partnerInfo.country),1)])):U("",!0),l[7]||(l[7]=e("p",{class:"text-sm text-green-400 mt-2"},"You can talk now",-1))])):(h(),w("div",io,l[8]||(l[8]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-600 to-gray-700 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"🌟")],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Ready to Connect",-1),e("p",{class:"text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))),n.showStatus&&n.status!=="disconnected"?(h(),w("div",co,[e("div",uo,[e("span",{class:G({"text-green-400":n.status==="connected","text-yellow-400":n.status==="matched","text-blue-400":n.status==="searching"})},"●",2),e("span",null,M(s.value),1)]),n.errorMessage?(h(),w("p",fo,M(n.errorMessage),1)):U("",!0)])):U("",!0)]))}});const ce=(n,v)=>{const s=n.__vccOpts||n;for(const[T,l]of v)s[T]=l;return s},vo=ce(go,[["__scopeId","data-v-911ccaff"]]),mo={class:"space-y-3 md:space-y-4 px-2"},po={class:"flex justify-center items-center gap-3 md:gap-4"},bo=["disabled"],yo={class:"relative"},ho={key:0,class:"text-white text-lg md:text-xl"},xo={key:1,class:"text-white text-lg md:text-xl"},Co={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-300 rounded-full animate-pulse"},wo=["disabled"],To={class:"flex flex-wrap justify-center gap-2 md:gap-3"},ko=te({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(n,{emit:v}){const s=v,T=b(!1);function l(){T.value||(T.value=!0,s("toggle-mute"),setTimeout(()=>{T.value=!1},200),setTimeout(()=>{try{const a=document.querySelector("audio");a&&a.paused&&a.play().catch(d=>{console.warn("Could not auto-play audio after mute toggle:",d)})}catch(a){console.error("Error trying to auto-play:",a)}},300))}return(a,d)=>(h(),w("div",mo,[e("div",po,[e("button",{onClick:l,class:G(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",n.isMuted?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:T.value},[e("div",yo,[n.isMuted?(h(),w("span",xo,"🔇")):(h(),w("span",ho,"🎤")),T.value?(h(),w("span",Co)):U("",!0)])],10,bo),e("button",{onClick:d[0]||(d[0]=r=>a.$emit("find-next")),class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},d[5]||(d[5]=[e("span",{class:"text-white text-2xl md:text-3xl"},"📞",-1)])),e("button",{onClick:d[1]||(d[1]=r=>a.$emit("toggle-chat")),disabled:n.isDisabled,class:G(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",n.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},d[6]||(d[6]=[e("span",{class:"text-white text-lg md:text-xl"},"💬",-1)]),10,wo)]),e("div",To,[e("button",{onClick:d[2]||(d[2]=r=>a.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110"}," 🎮 Games "),e("button",{onClick:d[3]||(d[3]=r=>a.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110"}," 📞 History "),e("button",{onClick:d[4]||(d[4]=r=>a.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110"}," ❤️ Support ")])]))}}),Ro={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},So={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},_o={class:"flex items-center justify-between p-4 border-b border-gray-700"},$o={key:0,class:"h-full flex items-center justify-center text-gray-500"},Wo={key:1,class:"space-y-2"},Io={class:"flex justify-between gap-2"},Eo={class:"text-xs text-gray-400"},Ao={class:"mt-1 text-white break-words"},Oo={class:"p-3 border-t border-gray-700"},jo=["disabled"],Do=["disabled"],Mo=te({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(n,{emit:v}){const s=n,T=v,l=b(""),a=b(null),d=()=>{l.value.trim()&&s.isConnected&&(T("send-message",l.value),l.value="")},r=async()=>{await It(),a.value&&(a.value.scrollTop=a.value.scrollHeight)},$=E=>new Date(E).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K(()=>s.messages,()=>{r()},{deep:!0}),K(()=>s.isOpen,E=>{E&&r()}),le(()=>{s.isOpen&&r()}),(E,x)=>n.isOpen?(h(),w("div",Ro,[e("div",So,[e("div",_o,[x[2]||(x[2]=e("div",{class:"flex items-center"},[e("span",{class:"text-white text-lg font-medium"},"💬 Chat")],-1)),e("button",{onClick:x[0]||(x[0]=_=>E.$emit("close")),class:"text-gray-400 hover:text-white"}," ✕ ")]),e("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:a},[n.messages.length===0?(h(),w("div",$o,x[3]||(x[3]=[e("div",{class:"text-center"},[e("p",null,"No messages yet"),e("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(h(),w("div",Wo,[(h(!0),w(re,null,ie(n.messages,_=>(h(),w("div",{key:_.id,class:G(["rounded-lg p-3 max-w-[80%]",_.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[e("div",Io,[e("span",{class:G(["text-sm",_.isOwn?"text-blue-200":"text-gray-200"])},M(_.isOwn?"You":"Partner"),3),e("span",Eo,M($(_.timestamp)),1)]),e("p",Ao,M(_.message),1)],2))),128))]))],512),e("div",Oo,[e("form",{onSubmit:Wt(d,["prevent"]),class:"flex gap-2"},[Oe(e("input",{"onUpdate:modelValue":x[1]||(x[1]=_=>l.value=_),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!n.isConnected},null,8,jo),[[Je,l.value]]),e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n.isConnected||!l.value.trim()}," Send ",8,Do)],32)])])])):U("",!0)}}),Po={class:"w-full p-2"},No={class:"flex justify-between items-center mb-4"},Fo={key:0,class:"text-yellow-300 animate-pulse"},Lo={key:1},Vo={key:2},Uo={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 mb-4"},Go={class:"mb-4 text-center"},Bo={class:"flex items-center justify-center gap-4"},zo={class:"text-center"},qo={class:"grid grid-cols-3 gap-3 mb-4"},Ho=["onClick","disabled"],Xo={key:0,class:"text-blue-400"},Yo={key:1,class:"text-green-400"},Ko={key:0,class:"text-center mt-4 animate__animated animate__fadeIn"},Jo={key:1,class:"text-center mt-4"},Qo={class:"flex justify-between"},Ye=3e4,Zo=te({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},isFirstPlayer:{type:Boolean,default:!0}},emits:["back","error"],setup(n,{emit:v}){const s=n,T=v,{socket:l}=we(),a=b("waiting"),d=b(["","","","","","","","",""]),r=b(s.isFirstPlayer?"X":"O"),$=b(s.isFirstPlayer?"O":"X"),E=b("X"),x=b(null),_=b(null),L=b(Date.now()),P=ae(()=>E.value===r.value),V=C=>{var I;if(!(a.value!=="playing"||d.value[C]!==""||!P.value||x.value!==null))try{d.value[C]=r.value,E.value=$.value,L.value=Date.now(),(I=l.value)==null||I.emit("game-move",{gameType:"tic-tac-toe",move:C,to:s.partnerId}),i(),A()}catch{m("Failed to make a move. Please try again.")}},i=()=>{const C=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const I of C){const[O,N,z]=I;if(d.value[O]&&d.value[O]===d.value[N]&&d.value[O]===d.value[z]){x.value=d.value[O],a.value="finished",_.value&&(clearTimeout(_.value),_.value=null);return}}d.value.includes("")||(x.value="tie",a.value="finished",_.value&&(clearTimeout(_.value),_.value=null))},y=()=>{var C;try{d.value=["","","","","","","","",""],E.value="X",x.value=null,a.value="playing",L.value=Date.now(),(C=l.value)==null||C.emit("game-reset",{gameType:"tic-tac-toe",to:s.partnerId}),A()}catch{m("Failed to reset the game. Please try again.")}},m=C=>{console.error(`Tic-Tac-Toe Error: ${C}`),T("error",C)},A=()=>{_.value&&clearTimeout(_.value),a.value==="playing"&&!x.value&&(_.value=window.setTimeout(()=>{Date.now()-L.value>Ye&&(m("Connection with your partner appears to be lost. The game will be closed."),T("back"))},Ye))};return K(()=>s.isFirstPlayer,C=>{r.value=C?"X":"O",$.value=C?"O":"X",C||(a.value="playing")}),le(()=>{var C,I,O;try{(C=l.value)==null||C.on("game-partner-joined",N=>{N.from===s.partnerId&&N.gameType==="tic-tac-toe"&&(console.log("Partner joined the game!",N),a.value="playing",L.value=Date.now(),A())}),(I=l.value)==null||I.on("game-move",N=>{if(N.from===s.partnerId&&N.gameType==="tic-tac-toe"){const z=N.move;typeof z=="number"&&z>=0&&z<9&&d.value[z]===""?(d.value[z]=$.value,E.value=r.value,L.value=Date.now(),i(),A()):m("Received invalid move from partner.")}}),(O=l.value)==null||O.on("game-reset",N=>{N.from===s.partnerId&&N.gameType==="tic-tac-toe"&&(d.value=["","","","","","","","",""],E.value="X",x.value=null,a.value="playing",L.value=Date.now(),A())}),s.isFirstPlayer||(a.value="playing")}catch{m("Failed to initialize game connection.")}}),Se(()=>{var C,I,O;(C=l.value)==null||C.off("game-partner-joined"),(I=l.value)==null||I.off("game-move"),(O=l.value)==null||O.off("game-reset"),_.value&&(clearTimeout(_.value),_.value=null)}),(C,I)=>(h(),w("div",Po,[e("div",No,[I[1]||(I[1]=e("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),e("div",{class:G(["text-white text-sm px-3 py-1 rounded-full",{"bg-yellow-600/30":a.value==="waiting","bg-green-600/30":P.value&&a.value==="playing","bg-red-600/30":!P.value&&a.value==="playing","bg-purple-600/30":x.value}])},[a.value==="waiting"?(h(),w("span",Fo," Waiting for partner... ")):x.value?(h(),w("span",Lo,M(x.value===r.value?"You Won! 🎉":x.value==="tie"?"It's a Tie! 🤝":"You Lost! 😢"),1)):(h(),w("span",Vo,M(P.value?"Your Turn":"Partner's Turn"),1))],2)]),e("div",Uo,[e("div",{class:G(["flex flex-col items-center",{"opacity-70":a.value==="waiting"||!P.value&&!x.value}])},[e("div",Go,[e("div",Bo,[e("div",{class:G([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="X"},"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-lg font-bold"])}," X ",2),e("div",zo,[I[2]||(I[2]=e("p",{class:"text-gray-300 text-sm"},"You are",-1)),e("p",{class:G(["font-bold text-lg",{"text-blue-400":r.value==="X","text-green-400":r.value==="O"}])},M(r.value),3)]),e("div",{class:G([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="O"},"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-lg font-bold"])}," O ",2)])]),e("div",qo,[(h(!0),w(re,null,ie(d.value,(O,N)=>(h(),w("button",{key:N,onClick:z=>V(N),disabled:O!==""||!P.value||x.value!==null||a.value==="waiting",class:G(["w-20 h-20 rounded-lg flex items-center justify-center text-3xl font-bold transition-all duration-300",{"bg-gray-700 hover:bg-gray-600":O===""&&P.value&&!x.value&&a.value!=="waiting","bg-gray-700/50":O===""&&(!P.value||x.value!==null||a.value==="waiting"),"bg-blue-600/20":O==="X","bg-green-600/20":O==="O","cursor-not-allowed":O!==""||!P.value||x.value!==null||a.value==="waiting","hover:bg-purple-700/50":P.value&&O===""&&!x.value&&a.value==="playing"}])},[O==="X"?(h(),w("span",Xo,"X")):O==="O"?(h(),w("span",Yo,"O")):U("",!0)],10,Ho))),128))]),x.value?(h(),w("div",Ko,[e("button",{onClick:y,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):U("",!0),a.value==="waiting"?(h(),w("div",Jo,I[3]||(I[3]=[e("div",{class:"bg-yellow-600/20 rounded-lg p-4 animate-pulse"},[e("p",{class:"text-yellow-300 mb-1"},"Waiting for your partner to join..."),e("p",{class:"text-sm text-gray-300"},[je("You'll play as "),e("span",{class:"font-bold text-blue-400"},"X")])],-1)]))):U("",!0)],2)]),e("div",Qo,[e("button",{onClick:I[0]||(I[0]=O=>C.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games ")])]))}});const en=ce(Zo,[["__scopeId","data-v-98a0628f"]]),tn={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4"},on={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},nn={class:"flex items-center justify-between p-3 border-b border-gray-800"},an={key:1,class:"p-4"},ln={class:"grid grid-cols-2 gap-4 mb-4"},sn=["disabled"],rn=["disabled"],cn={key:2,class:"text-center p-6"},un={class:"mb-4"},dn={class:"text-gray-300"},fn={key:3},gn=te({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:v}){const{socket:s,userId:T}=we(),l=n,a=b(null),d=b(null),r=b(!0),$=b(null),E=b(!1),x=b(""),_=i=>{console.log(`[Game Debug] ${i}`),x.value=i},L=i=>{var m;if(!l.isConnected)return;_(`Starting game: ${i} with partner: ${l.partnerId}`),d.value=null,a.value=i,r.value=!0,E.value=!1;const y=[T.value,l.partnerId].sort();$.value=`${i}-${y[0]}-${y[1]}`,_(`Created game room: ${$.value}`),(m=s.value)==null||m.emit("game-join-room",{gameType:i,roomId:$.value,to:l.partnerId,isFirstPlayer:!0})},P=()=>{var i;$.value&&((i=s.value)==null||i.emit("game-leave-room",{roomId:$.value,to:l.partnerId})),a.value=null,d.value=null,r.value=!0,$.value=null,E.value=!1},V=i=>{d.value=i,_(`Error: ${i}`)};return le(()=>{var i,y,m,A;_("Setting up game events"),(i=s.value)==null||i.on("game-room-invite",C=>{var I;C.from===l.partnerId&&(_(`Received invitation to join game room: ${C.roomId}`),$.value=C.roomId,a.value=C.gameType,r.value=!1,(I=s.value)==null||I.emit("game-join-room",{gameType:C.gameType,roomId:C.roomId,to:l.partnerId,isFirstPlayer:!1}))}),(y=s.value)==null||y.on("game-partner-joined",C=>{C.from===l.partnerId&&(_(`Partner joined the game: ${C.gameType}`),E.value=!0)}),(m=s.value)==null||m.on("game-error",C=>{(C.from==="system"||C.from===l.partnerId)&&(d.value=C.message||"An error occurred in the game.",_(`Game error: ${C.message}`))}),(A=s.value)==null||A.on("game-partner-left",C=>{a.value&&(d.value="Your partner left the game.",_("Partner left the game"),a.value=null)})}),Se(()=>{var i,y,m,A,C;(i=s.value)==null||i.off("game-room-invite"),(y=s.value)==null||y.off("game-partner-joined"),(m=s.value)==null||m.off("game-error"),(A=s.value)==null||A.off("game-partner-left"),$.value&&((C=s.value)==null||C.emit("game-leave-room",{roomId:$.value,to:l.partnerId}))}),K(()=>l.isOpen,i=>{i||P()}),(i,y)=>n.isOpen?(h(),w("div",tn,[e("div",on,[e("div",nn,[y[2]||(y[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-purple-400 text-xl"},"🎮"),e("h2",{class:"text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),e("button",{onClick:y[0]||(y[0]=m=>i.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),U("",!0),a.value?d.value?(h(),w("div",cn,[e("div",un,[y[8]||(y[8]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⚠️")],-1)),y[9]||(y[9]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",dn,M(d.value),1)]),e("button",{onClick:P,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):(h(),w("div",fn,[a.value==="tic-tac-toe"?(h(),Et(en,{key:0,partnerId:n.partnerId,isFirstPlayer:r.value,partnerReady:E.value,onBack:P,onError:V},null,8,["partnerId","isFirstPlayer","partnerReady"])):U("",!0)])):(h(),w("div",an,[e("div",ln,[e("button",{class:G(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!n.isConnected}]),disabled:!n.isConnected},y[3]||(y[3]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-yellow-500 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>👊</div><div class="text-white font-medium" data-v-823f908a>Rock Paper Scissors</div><div class="text-xs text-gray-400" data-v-823f908a>vs Partner</div>',4)]),10,sn),e("button",{class:G(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},y[4]||(y[4]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>🎵</div><div class="text-white font-medium" data-v-823f908a>Sound Game</div><div class="text-xs text-gray-400" data-v-823f908a>Voice Challenge</div>',4)])),e("button",{class:G(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!n.isConnected}]),disabled:!n.isConnected,onClick:y[1]||(y[1]=m=>L("tic-tac-toe"))},y[5]||(y[5]=[e("div",{class:"bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"⭕",-1),e("div",{class:"text-white font-medium"},"Tic-Tac-Toe",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,rn),e("button",{class:G(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},y[6]||(y[6]=[me('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>💬</div><div class="text-white font-medium" data-v-823f908a>Word Galaxy</div><div class="text-xs text-gray-400" data-v-823f908a>Brain Game</div>',4)]))]),y[7]||(y[7]=e("p",{class:"text-center text-sm text-gray-400 mt-2"}," Connect to play with others ",-1))]))])])):U("",!0)}});const vn=ce(gn,[["__scopeId","data-v-823f908a"]]),mn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},pn={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},bn={class:"flex items-center justify-between mb-6"},yn={class:"grid grid-cols-3 gap-4 mb-6"},hn=te({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:v}){const s=v,T=b(15),l=d=>{T.value=d},a=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${T.value}`,"_blank"),s("close")};return(d,r)=>n.isOpen?(h(),w("div",mn,[e("div",pn,[e("div",bn,[r[4]||(r[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-red-400 text-xl"},"❤️"),e("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),e("button",{onClick:r[0]||(r[0]=$=>d.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),r[8]||(r[8]=e("div",{class:"mb-6 text-center"},[e("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),e("div",yn,[e("button",{class:G(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",T.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[1]||(r[1]=$=>l(5))},r[5]||(r[5]=[e("div",{class:"text-lg font-bold text-white"},"$5",-1),e("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),e("button",{class:G(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",T.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[2]||(r[2]=$=>l(15))},r[6]||(r[6]=[e("div",{class:"text-lg font-bold text-white"},"$15",-1),e("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),e("button",{class:G(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",T.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[3]||(r[3]=$=>l(50))},r[7]||(r[7]=[e("div",{class:"text-lg font-bold text-white"},"$50",-1),e("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),r[9]||(r[9]=e("div",{class:"flex justify-center items-center gap-1 mb-6"},[e("span",{class:"text-yellow-400"},"⭐"),e("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),e("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:a}," Donate via PayPal "),r[10]||(r[10]=e("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):U("",!0)}}),xn={class:"relative w-full"},Cn={class:"py-1"},wn=te({__name:"select",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Select an option"},options:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(n,{emit:v}){const s=n,T=b(!1),l=b(null),a=b(null),d=ae(()=>{if(s.options&&s.options.length){const E=s.options.find(x=>x.value===s.modelValue);return E?E.label:""}return s.modelValue}),r=()=>{T.value=!T.value},$=E=>{T.value&&l.value&&a.value&&!l.value.contains(E.target)&&!a.value.contains(E.target)&&(T.value=!1)};return le(()=>{document.addEventListener("click",$)}),Me(()=>{document.removeEventListener("click",$)}),(E,x)=>(h(),w("div",xn,[e("button",{type:"button",ref_key:"triggerRef",ref:l,onClick:r,class:"w-full flex items-center justify-between bg-purple-500/20 border-purple-500/30 rounded-full h-8 px-3 text-xs shadow-lg shadow-purple-500/20 text-white"},[e("span",null,M(d.value||n.placeholder),1),x[0]||(x[0]=e("span",{class:"ml-1"},"▼",-1))],512),Z(Ot,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:At(()=>[T.value?(h(),w("div",{key:0,ref_key:"contentRef",ref:a,class:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto"},[e("div",Cn,[Ge(E.$slots,"default",{},()=>[Ge(E.$slots,"placeholder",{},()=>[x[1]||(x[1]=e("div",{class:"px-3 py-2 text-xs text-gray-400"},"No items",-1))],!0)],!0)])],512)):U("",!0)]),_:3})]))}});const Ee=ce(wn,[["__scopeId","data-v-9f96ce6c"]]),Tn={class:"fixed inset-0 overflow-hidden pointer-events-none"},kn=te({__name:"starfield",setup(n){const v=b([]);le(()=>{s()});const s=()=>{const l=[];for(let a=0;a<50;a++)l.push({id:a,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});v.value=l};return(T,l)=>(h(),w("div",Tn,[(h(!0),w(re,null,ie(v.value,a=>(h(),w("div",{key:a.id,class:"absolute rounded-full bg-white",style:jt({width:`${a.size}px`,height:`${a.size}px`,top:`${a.y}%`,left:`${a.x}%`,opacity:a.opacity,boxShadow:`0 0 ${a.size*2}px rgba(255, 255, 255, ${a.opacity})`,animation:`twinkle ${a.duration}s infinite ease-in-out`})},null,4))),128))]))}});const Rn=ce(kn,[["__scopeId","data-v-f4bff5a3"]]),Ae=!1,Sn=10,_n=te({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(n){const{remoteStream:v,connectionState:s,partnerId:T,isAudioMuted:l}=De(),a=b(null),d=b(.8),r=b(!1),$=b(0),E=ae(()=>(v.value!==null&&v.value?v.value.getAudioTracks().length>0:!1)&&v.value?v.value.getAudioTracks().some(I=>I.enabled):!1);ae(()=>v.value?v.value.getAudioTracks().filter(m=>m.enabled&&m.readyState==="live").length:0),ae(()=>r.value&&E.value?"connected":(s.value==="connected"&&!E.value&&!r.value&&setTimeout(V,500),s.value)),K(()=>v.value,m=>{V(),$.value=0,setTimeout(i,500)}),K(()=>l.value,m=>{!m&&v.value&&a.value&&setTimeout(()=>{a.value&&a.value.paused&&a.value.play().catch(A=>{})},300)}),K(()=>s.value,m=>{m==="connected"?setTimeout(()=>{V(),i()},1e3):m==="new"||m==="connecting"?$.value=0:(m==="disconnected"||m==="failed")&&y()}),K(()=>T.value,m=>{r.value=!1,$.value=0,m||a.value&&(a.value.srcObject=null)}),le(()=>{V(),a.value&&(a.value.onplaying=()=>{r.value=!0},a.value.onpause=()=>{r.value=!1},a.value.onended=()=>{r.value=!1},a.value.onerror=m=>{console.error("[AudioOutput] Audio error:",m),r.value=!1},a.value.volume=d.value),document.addEventListener("visibilitychange",P),_()}),Me(()=>{a.value&&(a.value.srcObject=null),document.removeEventListener("visibilitychange",P),L()});let x=null;function _(){L(),x=window.setInterval(()=>{!r.value&&E.value&&s.value==="connected"&&(V(),i())},5e3)}function L(){x&&(clearInterval(x),x=null)}function P(){document.visibilityState==="visible"&&(V(),setTimeout(()=>{!r.value&&E.value&&i()},500))}function V(){a.value&&(v.value?(a.value.srcObject=v.value,v.value.getAudioTracks().forEach(m=>{m.enabled=!0}),i()):(a.value.srcObject=null,r.value=!1))}async function i(){if(!(!a.value||!a.value.srcObject))try{const m=v.value&&v.value.getAudioTracks().length>0;await a.value.play(),r.value=!0,$.value=0}catch(m){if(console.error("[AudioOutput] Error playing audio:",m),r.value=!1,m instanceof DOMException&&m.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),$.value<Sn){$.value++;const A=$.value*1e3;setTimeout(i,A)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function y(){$.value=0,a.value&&(a.value.srcObject=null),setTimeout(()=>{V(),i()},500)}return(m,A)=>(h(),w("div",null,[e("audio",{ref_key:"audioElement",ref:a,autoplay:"",playsinline:"",class:"hidden"},null,512),U("",!0)]))}});const $n=ce(_n,[["__scopeId","data-v-f63dc209"]]),Wn={class:"min-h-screen font-sans"},In={class:"relative min-h-screen z-10 text-white"},En={class:"p-4 border-b border-white/10"},An={class:"max-w-4xl mx-auto"},On={class:"flex justify-center gap-2 mb-3"},jn={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},Dn={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},Mn={class:"grid grid-cols-2 gap-2 text-xs relative"},Pn={class:"flex items-center"},Nn={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Fn={class:"py-1"},Ln=["onClick"],Vn={class:"text-sm"},Un={class:"flex-1 p-4"},Gn={class:"max-w-md mx-auto space-y-6"},Bn={class:"flex items-center justify-center gap-2 mb-4"},zn={class:"text-center"},qn={class:"text-xs text-gray-400 italic"},Hn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Xn={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},Yn={class:"flex justify-between items-center mb-4"},Kn={class:"space-y-3"},Jn={key:0,class:"text-center py-8"},Qn={class:"flex items-center gap-3"},Zn={class:"text-2xl"},ea={class:"text-white text-sm font-medium"},ta={class:"text-gray-400 text-xs"},oa={class:"text-xs text-gray-500"},na={key:0,class:"text-xs text-gray-500 text-center mt-4"},aa={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},la={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},sa={class:"flex justify-between items-center mb-4"},ra={class:"space-y-4"},ia={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},ca={key:0,class:"text-xs text-gray-400 p-2"},ua={key:1,class:"flex flex-wrap gap-1"},da=["onClick"],fa={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},ga={key:0,class:"text-xs text-gray-400 p-2"},va={key:1,class:"flex flex-wrap gap-1"},ma=["onClick"],pa={key:2,class:"hidden"},ba=te({__name:"HomeView",setup(n){const v=b("disconnected"),s=b(null),T=b(null),l=b(""),a=b(!1),d=b(!1),r=b(!1),$=b(!1),E=b(!1),x=b(!1),_=b(0),L=b(0),P=b(!1),V=b([]),i=b([]),y=b("any"),m=b(!1),A=b(""),C=b([]),I=b([]),O=b("off"),N=b(""),z=b(""),pe=[{value:"any",text:"Any Vibe",emoji:"🌟"},{value:"chill",text:"Chill",emoji:"😌"},{value:"fun",text:"Fun",emoji:"🎉"},{value:"curious",text:"Curious",emoji:"🤔"},{value:"creative",text:"Creative",emoji:"🎨"}],be=[{value:"off",label:"⏰ Disabled"},{value:"30",label:"30 seconds"},{value:"60",label:"60 seconds"},{value:"90",label:"90 seconds"}],se=[{value:"any",label:"🌍 Any Country"},{value:"us",label:"🇺🇸 United States"},{value:"gb",label:"🇬🇧 United Kingdom"},{value:"ca",label:"🇨🇦 Canada"},{value:"au",label:"🇦🇺 Australia"},{value:"de",label:"🇩🇪 Germany"},{value:"fr",label:"🇫🇷 France"},{value:"it",label:"🇮🇹 Italy"},{value:"es",label:"🇪🇸 Spain"},{value:"jp",label:"🇯🇵 Japan"}],Te=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],_e=b(Te[Math.floor(Math.random()*Te.length)]),o=we().socket,{remoteStream:f,localStream:p,connectionState:k,createOffer:q,handleOffer:oe,handleAnswer:tt,handleIceCandidate:ot,closeConnection:Pe,toggleMicrophone:nt,initializeLocalStream:at}=De(),lt=Jt(),st=Mt(),Ne=b(st.params.roomId||null);K(()=>Ne.value,u=>{u&&(r.value=!0)},{immediate:!0});const rt=ae(()=>se.filter(u=>u.value!=="any"&&!C.value.includes(u.value)&&!I.value.includes(u.value))),it=ae(()=>se.filter(u=>u.value!=="any"&&!I.value.includes(u.value)&&!C.value.includes(u.value))),ct=async()=>{const u=await nt();a.value!==!u&&(a.value=!u),v.value==="connected"&&setTimeout(()=>{const c=document.querySelector("audio");c&&c.paused&&c.play().catch(()=>{})},300)},Fe=async()=>{if(!p.value)try{await at(),console.log("Microphone initialized")}catch(u){console.error("Failed to access microphone",u),alert("Please allow microphone access to use voice chat");return}o.value&&(v.value="searching",s.value&&(console.log("Disconnecting from current partner"),o.value.emit("disconnect-partner"),s.value=null,T.value=null,V.value=[],Pe()),console.log("Finding new partner with preferences"),o.value.emit("join-queue",{vibe:y.value,preferences:{preferredCountries:C.value.length?C.value:void 0,blockedCountries:I.value.length?I.value:void 0,interests:A.value?A.value.split(",").map(u=>u.trim()):void 0}}),L.value++)},ut=()=>{d.value=!d.value,d.value&&s.value&&lt.markAsRead(s.value)},dt=u=>{o.value&&s.value&&(o.value.emit("chat-message",{message:u,to:s.value}),V.value.push({id:Date.now().toString(),message:u,isOwn:!0,timestamp:Date.now()}))},ft=u=>{console.log(`Selected game: ${u}`),o.value&&s.value&&o.value.emit("game-invite",{game:u,to:s.value})},gt=()=>{N.value&&!C.value.includes(N.value)&&(C.value.push(N.value),N.value="")},vt=u=>{C.value=C.value.filter(c=>c!==u)},mt=()=>{z.value&&!I.value.includes(z.value)&&(I.value.push(z.value),z.value="")},pt=u=>{I.value=I.value.filter(c=>c!==u)},bt=()=>{A.value="",C.value=[],I.value=[],O.value="off"},yt=()=>{x.value=!1},Le=u=>{const c=se.find(S=>S.value===u);return c?c.label.split(" ")[0]:"🏳️"},Ve=u=>{const c=se.find(S=>S.value===u);return c?c.label.split(" ").slice(1).join(" "):"Unknown"},ht=u=>new Date(u).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),xt=()=>{m.value=!m.value},Ct=u=>{y.value=u,m.value=!1},wt=u=>{const c=pe.find(S=>S.value===u);return c?c.emoji:"🌟"},Tt=u=>{const c=pe.find(S=>S.value===u);return c?c.text:"Any Vibe"};le(async()=>{console.log("Home view mounted"),o.value&&(o.value.on("online-count",u=>{_.value=u}),o.value.on("matched",u=>{if(console.log("Partner matched with event:",u),v.value="matched",l.value="",s.value=u.partnerId,T.value={id:u.partnerId,country:u.country||"Unknown",flag:u.flag||"🌍",vibe:u.vibe||"any"},i.value.unshift({id:Date.now().toString(),country:T.value.country,flag:T.value.flag,timestamp:Date.now()}),i.value.length>3&&(i.value=i.value.slice(0,3)),console.log("Partner matched:",u),u.partnerId){console.log("Initiating WebRTC connection with partner immediately");const{createOffer:c}=De();c(u.partnerId),setTimeout(()=>{v.value==="matched"&&k.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),v.value="connected")},2e3)}}),o.value.on("direct-connection-established",u=>{console.log("Direct connection established:",u),v.value="connected",s.value=u.partnerId,T.value={id:u.partnerId,country:u.country||"Unknown",flag:u.flag||"🌍"}}),o.value.on("partner-disconnected",()=>{v.value="disconnected",s.value=null,T.value=null,V.value=[],P.value&&setTimeout(()=>{v.value==="disconnected"&&P.value&&Fe()},2e3)}),o.value.on("chat-message",u=>{V.value.push({id:Date.now().toString(),message:u.message,isOwn:!1,timestamp:Date.now()})}),o.value.on("error",u=>{console.error("Socket error:",u.message),u.type==="matching"&&(v.value="disconnected")}),o.value.on("voice-offer",kt),o.value.on("voice-answer",Rt),o.value.on("ice-candidate",St),o.value.emit("get-online-count")),document.addEventListener("click",Ue)}),Me(()=>{console.log("Home view unmounting, cleaning up connection"),Pe(),o.value&&(o.value.off("online-count"),o.value.off("matched"),o.value.off("direct-connection-established"),o.value.off("partner-disconnected"),o.value.off("chat-message"),o.value.off("error"),o.value.off("voice-offer"),o.value.off("voice-answer"),o.value.off("ice-candidate")),document.removeEventListener("click",Ue)});const kt=async u=>{console.log("Received voice offer - forwarding to WebRTC service"),oe(u.offer,u.from)},Rt=async u=>{console.log("Received voice answer - forwarding to WebRTC service"),tt(u.answer)},St=async u=>{console.log("Received ICE candidate - forwarding to WebRTC service"),ot(u.candidate)};K(k,(u,c)=>{console.log(`[HomeView] WebRTC connection state changed: ${c} -> ${u}`),u==="connected"&&v.value==="matched"?setTimeout(()=>{k.value==="connected"&&v.value==="matched"&&(v.value="connected",l.value="",console.log("[HomeView] Successfully transitioned from matched to connected"))},1e3):u==="failed"?(l.value="",setTimeout(()=>{k.value==="failed"&&(v.value==="matched"||v.value==="connected")&&(l.value='Connection failed. Press "Next" to find a new partner.')},6e4)):u==="disconnected"&&(v.value==="connected"||v.value==="matched")&&(l.value="",setTimeout(()=>{k.value==="disconnected"&&(v.value==="connected"||v.value==="matched")&&(l.value="Connection lost. Trying to reconnect...")},6e4))});const $e=b(null),Ue=u=>{const c=u.target;$e.value&&!$e.value.contains(c)&&(m.value=!1)};return(u,c)=>(h(),w("div",Wn,[c[26]||(c[26]=me('<div class="fixed inset-0 pointer-events-none" data-v-d136ba69><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-d136ba69></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-d136ba69></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-d136ba69></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-d136ba69></div></div>',1)),Z(Rn),e("div",In,[e("header",En,[e("div",An,[c[15]||(c[15]=me('<div class="text-center mb-4" data-v-d136ba69><div class="inline-flex items-center gap-2" data-v-d136ba69><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-d136ba69><span class="text-white text-xs" data-v-d136ba69>✨</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-d136ba69> SpaceTalk.live </h1></div></div>',1)),e("div",On,[e("div",jn,[c[14]||(c[14]=e("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),e("span",null,M(_.value)+" online",1)]),L.value>0?(h(),w("div",Dn," Today: "+M(L.value)+" voices ",1)):U("",!0)]),e("div",Mn,[e("div",{class:"relative",ref_key:"vibeDropdownRef",ref:$e},[e("div",{onClick:xt,class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[e("span",Pn,M(wt(y.value))+" "+M(Tt(y.value)),1),e("span",{class:G(["ml-2 text-xs transition-transform duration-300",{"rotate-180":m.value}])},"▼",2)]),m.value?(h(),w("div",Nn,[e("div",Fn,[(h(),w(re,null,ie(pe,S=>e("div",{key:S.value,onClick:ke=>Ct(S.value),class:G(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":y.value===S.value}])},[e("span",Vn,M(S.emoji),1),e("span",null,M(S.text),1)],10,Ln)),64))])])):U("",!0)],512),e("button",{onClick:c[0]||(c[0]=S=>x.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," 🔍 Filters ")])])]),e("main",Un,[e("div",Gn,[Z(vo,{status:v.value,"partner-info":T.value,"error-message":l.value,"show-status":!0},null,8,["status","partner-info","error-message"]),e("div",Bn,[Oe(e("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":c[1]||(c[1]=S=>P.value=S),class:"w-3 h-3 rounded border-gray-600 bg-gray-700 text-emerald-500 focus:ring-emerald-500 focus:ring-1"},null,512),[[Dt,P.value]]),c[16]||(c[16]=e("label",{for:"auto-reconnect",class:"text-xs text-gray-400 cursor-pointer"}," Auto-reconnect to others ",-1))]),Z(ko,{"is-muted":a.value,"is-disabled":v.value!=="connected",onToggleMute:ct,onFindNext:Fe,onToggleChat:ut,onToggleGames:c[2]||(c[2]=S=>r.value=!0),onToggleHistory:c[3]||(c[3]=S=>E.value=!0),onToggleDonation:c[4]||(c[4]=S=>$.value=!0)},null,8,["is-muted","is-disabled"]),e("div",zn,[e("p",qn,'"'+M(_e.value)+'"',1)])])]),c[17]||(c[17]=me('<footer class="p-4 border-t border-white/10" data-v-d136ba69><div class="max-w-md mx-auto text-center space-y-2" data-v-d136ba69><h3 class="text-sm font-semibold text-emerald-400" data-v-d136ba69>Community Guidelines</h3><div class="text-xs text-gray-300 space-y-1" data-v-d136ba69><p data-v-d136ba69>• Must be 18+ years old to use this service</p><p data-v-d136ba69>• Be respectful and kind to other users</p><p data-v-d136ba69>• No harassment, hate speech, or inappropriate content</p><p data-v-d136ba69>• Report any misconduct using the report feature</p><p data-v-d136ba69>• Your privacy and safety are our priority</p></div><p class="text-xs text-gray-400 mt-3" data-v-d136ba69> By using SpaceTalk.live, you agree to follow these guidelines </p><div class="flex justify-center gap-3 mt-4 text-xs" data-v-d136ba69><a href="#" class="bg-cyan-500/20 border border-cyan-500/30 rounded-full px-3 py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20" data-v-d136ba69> ℹ️ About </a><a href="https://instagram.com" target="_blank" class="bg-pink-500/20 border border-pink-500/30 rounded-full px-3 py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20" data-v-d136ba69> 📷 Instagram </a><a href="https://facebook.com" target="_blank" class="bg-blue-500/20 border border-blue-500/30 rounded-full px-3 py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20" data-v-d136ba69> 📘 Facebook </a><a href="mailto:contact@spacetalk.live" class="bg-emerald-500/20 border border-emerald-500/30 rounded-full px-3 py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20" data-v-d136ba69> 📧 Contact </a></div></div></footer>',1))]),E.value?(h(),w("div",Hn,[e("div",Xn,[e("div",Yn,[c[18]||(c[18]=e("h2",{class:"text-lg font-semibold text-indigo-400"},"📞 Call History",-1)),e("button",{onClick:c[5]||(c[5]=S=>E.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",Kn,[i.value.length===0?(h(),w("div",Jn,c[19]||(c[19]=[e("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),e("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(h(!0),w(re,{key:1},ie(i.value,(S,ke)=>(h(),w("div",{key:S.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[e("div",Qn,[e("span",Zn,M(S.flag),1),e("div",null,[e("p",ea,M(S.country),1),e("p",ta,M(ht(S.timestamp)),1)])]),e("div",oa," #"+M(ke+1),1)]))),128))]),i.value.length>0?(h(),w("p",na," History clears when you leave the page ")):U("",!0)])])):U("",!0),x.value?(h(),w("div",aa,[e("div",la,[e("div",sa,[c[20]||(c[20]=e("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),e("button",{onClick:c[6]||(c[6]=S=>x.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",ra,[e("div",null,[c[21]||(c[21]=e("label",{class:"block text-sm font-medium mb-2 text-teal-400"},"Interest Keywords",-1)),Oe(e("input",{"onUpdate:modelValue":c[7]||(c[7]=S=>A.value=S),type:"text",placeholder:"e.g., music, travel, technology...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-emerald-500 focus:outline-none"},null,512),[[Je,A.value]]),c[22]||(c[22]=e("p",{class:"text-xs text-gray-400 mt-1"},"Separate with commas",-1))]),e("div",null,[c[23]||(c[23]=e("label",{class:"block text-sm font-medium mb-2 text-emerald-400"},"Preferred Countries",-1)),e("div",ia,[C.value.length===0?(h(),w("p",ca,"No countries selected")):(h(),w("div",ua,[(h(!0),w(re,null,ie(C.value,S=>(h(),w("span",{key:S,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[je(M(Le(S))+" "+M(Ve(S))+" ",1),e("button",{onClick:ke=>vt(S),class:"text-emerald-200 hover:text-white ml-1"}," ✕ ",8,da)]))),128))]))]),Z(Ee,{modelValue:N.value,"onUpdate:modelValue":c[8]||(c[8]=S=>N.value=S),options:rt.value,placeholder:"Add preferred country...",class:"mt-2",onChange:gt},null,8,["modelValue","options"])]),e("div",null,[c[24]||(c[24]=e("label",{class:"block text-sm font-medium mb-2 text-red-400"},"Blocked Countries",-1)),e("div",fa,[I.value.length===0?(h(),w("p",ga,"No countries blocked")):(h(),w("div",va,[(h(!0),w(re,null,ie(I.value,S=>(h(),w("span",{key:S,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[je(M(Le(S))+" "+M(Ve(S))+" ",1),e("button",{onClick:ke=>pt(S),class:"text-red-200 hover:text-white ml-1"}," ✕ ",8,ma)]))),128))]))]),Z(Ee,{modelValue:z.value,"onUpdate:modelValue":c[9]||(c[9]=S=>z.value=S),options:it.value,placeholder:"Add blocked country...",class:"mt-2",onChange:mt},null,8,["modelValue","options"])]),e("div",null,[c[25]||(c[25]=e("label",{class:"block text-sm font-medium mb-2 text-orange-400"},"Auto-Next Timer",-1)),Z(Ee,{modelValue:O.value,"onUpdate:modelValue":c[10]||(c[10]=S=>O.value=S),options:be,placeholder:"Select timer"},null,8,["modelValue"])])]),e("div",{class:"flex gap-2 mt-6"},[e("button",{onClick:bt,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Clear All "),e("button",{onClick:yt,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):U("",!0),Z(Mo,{"is-open":d.value,onClose:c[11]||(c[11]=S=>d.value=!1),messages:V.value,onSendMessage:dt,"is-connected":v.value==="connected"},null,8,["is-open","messages","is-connected"]),Z(vn,{"is-open":r.value,onClose:c[12]||(c[12]=S=>r.value=!1),"is-connected":v.value==="connected",onSelectGame:ft,"partner-id":s.value||"","initial-game-room-id":Ne.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),Z(hn,{"is-open":$.value,onClose:c[13]||(c[13]=S=>$.value=!1)},null,8,["is-open"]),v.value==="connected"?(h(),w("div",pa,[Z($n,{showControls:!1})])):U("",!0)]))}});const Ke=ce(ba,[["__scopeId","data-v-d136ba69"]]),ya=Pt({history:Nt("/"),routes:[{path:"/",name:"home",component:Ke},{path:"/game/:roomId",name:"game",component:Ke,props:!0}]}),et=Ft(Ut);et.use(ya);et.mount("#app");
//# sourceMappingURL=index-6bf23ead.js.map
