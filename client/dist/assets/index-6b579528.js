import{d as oe,c as T,a as ee,u as Wt,o as x,R as It,r as y,b as le,e as _e,s as Ie,w as K,f as ae,g as e,t as P,h as G,n as B,F as ue,i as de,j as Et,k as De,v as Qe,l as At,m as je,p as pe,q as Ot,x as Pe,y as Dt,T as jt,z as Be,A as Mt,B as Pt,C as Nt,D as Ft,E as Lt,G as Vt}from"./vue-vendor-21d667bf.js";import{l as Ut}from"./socket-vendor-d9998155.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))k(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const g of a.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&k(g)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function k(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();const Gt={class:"app-container"},Bt=oe({__name:"App",setup(n){return(m,s)=>(x(),T("div",Gt,[ee(Wt(It))]))}});const zt=()=>window.location.origin,M=y(null),ge=y(null),he=y(!1);function Te(){le(()=>{M.value||n()}),_e(()=>{M.value&&s()});function n(){const l=zt();console.log(`Connecting to socket server at: ${l}`),M.value=Ut(l,{autoConnect:!0,reconnection:!0,reconnectionAttempts:1/0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:3e4,transports:["websocket","polling"],extraHeaders:{"X-Client-Version":"1.0.0"},forceNew:!1,rememberUpgrade:!0,withCredentials:!0}),m()}function m(){M.value&&(M.value.on("connect",()=>{var l,a;console.log("Socket connected"),he.value=!0,(l=M.value)==null||l.emit("user:identify",{},g=>{console.log("Identified with server, user ID:",g),ge.value=g}),(a=M.value)==null||a.emit("get-online-count")}),M.value.on("disconnect",()=>{console.log("Socket disconnected"),he.value=!1}),M.value.on("reconnect",l=>{var a;console.log(`Socket reconnected after ${l} attempts`),he.value=!0,ge.value&&((a=M.value)==null||a.emit("user:identify",{prevUserId:ge.value},g=>{var r;console.log("Re-identified with server after reconnection, user ID:",g),ge.value=g,(r=M.value)==null||r.emit("get-online-count")}))}),M.value.on("reconnect_attempt",l=>{console.log(`Socket reconnection attempt ${l}`)}),M.value.on("reconnect_error",l=>{console.error("Socket reconnection error:",l)}),M.value.on("reconnect_failed",()=>{console.error("Socket reconnection failed"),setTimeout(()=>{he.value||(console.log("Attempting to reinitialize socket connection..."),s(),n())},5e3)}),M.value.on("error",l=>{console.error("Socket error:",l)}),M.value.on("user-id",l=>{console.log("Received user ID from server:",l),ge.value=l}))}function s(){M.value&&(M.value.off("connect"),M.value.off("disconnect"),M.value.off("reconnect"),M.value.off("reconnect_attempt"),M.value.off("reconnect_error"),M.value.off("reconnect_failed"),M.value.off("error"),M.value.off("user-id"))}function k(){M.value?(console.log("Forcing socket reconnection..."),M.value.disconnect(),M.value.connect()):n()}return{socket:M,isConnected:he,userId:ge,reconnect:k}}const qt=86400,Ze=`${Date.now()+qt}:spacechat`,et="openrelayproject",tt={iceServers:[{urls:["turns:global.relay.metered.ca:443","turn:global.relay.metered.ca:443?transport=tcp","turn:global.relay.metered.ca:80?transport=tcp","turn:global.relay.metered.ca:80"],username:Ze,credential:et},{urls:["turn:relay.metered.ca:80","turn:relay.metered.ca:443","turns:relay.metered.ca:443"],username:"dbc12a",credential:"c84ded89b281ae42"},{urls:["turn:global.turn.twilio.com:3478?transport=tcp","turn:global.turn.twilio.com:3478?transport=udp","turns:global.turn.twilio.com:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"},{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"},{urls:"stun:stun4.l.google.com:19302"},{urls:"stun:stun.cloudflare.com:3478"},{urls:"stun:openrelay.metered.ca:80"}],iceCandidatePoolSize:10,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},ze={iceServers:[{urls:["turns:global.relay.metered.ca:443","turn:global.relay.metered.ca:443?transport=tcp","turn:global.relay.metered.ca:80?transport=tcp","turns:relay.metered.ca:443"],username:Ze,credential:et},{urls:["turn:relay.metered.ca:443?transport=tcp","turns:relay.metered.ca:443"],username:"dbc12a",credential:"c84ded89b281ae42"},{urls:["turns:global.turn.twilio.com:443?transport=tcp"],username:"openrelayproject",credential:"openrelayproject"}],iceCandidatePoolSize:10,iceTransportPolicy:"relay",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},qe={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:stun.cloudflare.com:3478"]},{urls:["turn:relay.metered.ca:443?transport=tcp"],username:"dbc12a",credential:"c84ded89b281ae42"}],iceCandidatePoolSize:5,iceTransportPolicy:"all",bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"};let me=tt;const Ht=me;let u=null,E=null,O=null;const q=y("new"),ie=y(!1),xe=y(null),R=!0;let Y="",te="",He=null,z=!1,ce=!1,L=0;const Z=15;let Q=[],ve=null;const Xt=8e3,Yt=1e3;async function ot(){if(!u)return{error:"No peer connection available"};try{const n={};return(await u.getStats()).forEach(s=>{s.type==="transport"?n.transport={bytesReceived:s.bytesReceived,bytesSent:s.bytesSent,dtlsState:s.dtlsState,selectedCandidatePairId:s.selectedCandidatePairId}:s.type==="candidate-pair"&&s.selected?n.selectedCandidatePair={localCandidateId:s.localCandidateId,remoteCandidateId:s.remoteCandidateId,state:s.state,availableOutgoingBitrate:s.availableOutgoingBitrate}:s.type==="local-candidate"||s.type==="remote-candidate"?(n.candidates||(n.candidates=[]),n.candidates.push({type:s.type,id:s.id,ip:s.ip,port:s.port,protocol:s.protocol,candidateType:s.candidateType})):(s.type==="media-source"||s.type==="track"||s.type==="media-playout")&&(n.media||(n.media=[]),n.media.push({type:s.type,id:s.id,kind:s.kind,audioLevel:s.audioLevel,trackIdentifier:s.trackIdentifier}))}),n}catch(n){return console.error("[WebRTC] Error getting stats:",n),{error:"Failed to get stats: "+n}}}function Kt(){Xe();const n=setInterval(async()=>{u&&(q.value==="connected"||q.value==="connecting")?(He=await ot(),console.log("[WebRTC] Connection stats:",He)):Xe()},5e3);window.__webrtcStatsTimer=n}function Xe(){const n=window.__webrtcStatsTimer;n&&(clearInterval(n),window.__webrtcStatsTimer=null)}function Me(){const{socket:n,userId:m}=Te(),s=Ie(u),k=Ie(E),l=Ie(O),a=q,g=ie,r=xe;y({echoCancellation:!0,noiseSuppression:!0});const $=async()=>{try{if(E){R&&console.log("[WebRTC] Using existing local stream");const o=E.getAudioTracks();if(o.length===0||!o[0].enabled)R&&console.log("[WebRTC] Existing stream has no active audio tracks, requesting new stream"),E.getTracks().forEach(p=>p.stop()),E=null;else return E}R&&console.log("[WebRTC] Requesting access to microphone with specific constraints");const t=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:48e3,channelCount:2},video:!1});if(t.getAudioTracks().length===0)throw console.error("[WebRTC] No audio tracks found in stream"),new Error("No audio tracks available");return R&&(console.log("[WebRTC] Local stream acquired successfully"),console.log("[WebRTC] Audio tracks:",t.getAudioTracks().length),t.getAudioTracks().forEach(p=>{console.log(`[WebRTC] Track: ${p.label}, enabled: ${p.enabled}, muted: ${p.muted}, readyState: ${p.readyState}`),console.log("[WebRTC] Track settings:",JSON.stringify(p.getSettings()))})),t.getTracks().forEach(o=>{o.enabled=!0}),E=t,k.value=t,t}catch(t){console.error("[WebRTC] Error accessing microphone:",t);try{R&&console.log("[WebRTC] Trying fallback with simpler constraints");const o=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");return E=o,k.value=o,o}catch(o){throw console.error("[WebRTC] Fallback also failed:",o),new Error("Could not access microphone. Please check permissions.")}}},A=()=>{if(u)try{u.close(),u=null,O&&(O.getTracks().forEach(t=>{t.stop()}),O=null)}catch(t){console.error("[WebRTC] Error cleaning up old peer connection:",t)}try{const t=new RTCPeerConnection(Ht);return t.onnegotiationneeded=async o=>{if(R&&console.log("[WebRTC] Negotiation needed event",o),!Jt(t)||z){R&&console.log("[WebRTC] Skipping negotiation - already in progress or not in stable state");return}z=!0;try{R&&console.log("[WebRTC] Starting negotiation"),re()}catch(p){console.error("[WebRTC] Negotiation error:",p),te=`Negotiation error: ${p}`,z=!1}},t.oniceconnectionstatechange=()=>{R&&console.log("[WebRTC] ICE Connection state changed to:",t.iceConnectionState),t.iceConnectionState==="connected"||t.iceConnectionState==="completed"?(te="",L=0,F(),Kt(),Ce("connected")):(t.iceConnectionState==="failed"||t.iceConnectionState==="disconnected"||t.iceConnectionState==="closed")&&(t.iceConnectionState==="failed"&&(te="ICE connection failed",console.error("[WebRTC] ICE Connection failed")),t.iceConnectionState!=="closed"?!ce&&L<Z?(console.log(`[WebRTC] Attempting ICE restart, attempt ${L+1} of ${Z}`),I()):L>=Z&&(console.error("[WebRTC] Max connection retry attempts reached, giving up"),Ce("failed"),L=0,te="Max retries reached, connection failed",i()):Ce("closed")),q.value=t.iceConnectionState},t.onicecandidate=o=>{var p;o.candidate?(R&&console.log("[WebRTC] New ICE candidate:",o.candidate),window.__localIceCandidates||(window.__localIceCandidates=[]),window.__localIceCandidates.push(o.candidate),r.value?(p=n.value)==null||p.emit("webrtc-signal",{type:"ice-candidate",candidate:o.candidate,to:r.value}):(Q.push(o.candidate),R&&console.log("[WebRTC] Storing ICE candidate for later. Total pending:",Q.length))):(R&&console.log("[WebRTC] ICE gathering complete"),Q.length>0&&r.value&&(Q.forEach(v=>{var c;(c=n.value)==null||c.emit("webrtc-signal",{type:"ice-candidate",candidate:v,to:r.value})}),R&&console.log(`[WebRTC] Sent ${Q.length} pending ICE candidates`),Q=[]))},t.onicegatheringstatechange=()=>{R&&console.log("[WebRTC] ICE gathering state changed to:",t.iceGatheringState)},t.onconnectionstatechange=()=>{R&&console.log("[WebRTC] Connection state changed to:",t.connectionState),Ce(t.connectionState),t.connectionState==="connected"?(te="",L=0):(t.connectionState==="failed"||t.connectionState==="disconnected"||t.connectionState==="closed")&&t.connectionState==="failed"&&!te&&(te="PeerConnection failed")},t.onsignalingstatechange=()=>{R&&console.log("[WebRTC] Signaling state changed to:",t.signalingState),t.signalingState==="stable"&&(z=!1)},t.ontrack=o=>{R&&console.log("[WebRTC] Track received:",o.track),O||(O=new MediaStream,l.value=O,console.log("[WebRTC] Created new remote stream")),O.addTrack(o.track),console.log(`[WebRTC] Added ${o.track.kind} track to remote stream, now has ${O.getTracks().length} tracks`),setTimeout(()=>{if(O){const p=O.getTracks();console.log(`[WebRTC] Remote stream has ${p.length} tracks after adding`),p.forEach(v=>{console.log(`[WebRTC] Track: ${v.kind}, enabled: ${v.enabled}, muted: ${v.muted}, readyState: ${v.readyState}`),v.kind==="audio"&&(!v.enabled||v.muted)&&(console.log("[WebRTC] 🔴 Found disabled or muted audio track, enabling it"),v.enabled=!0)})}},500),R&&(o.track.onunmute=()=>{console.log("[WebRTC] Track unmuted:",o.track.kind)},o.track.onmute=()=>{console.log("[WebRTC] Track muted:",o.track.kind),o.track.enabled=!0},o.track.onended=()=>{console.log("[WebRTC] Track ended:",o.track.kind)})},ye(t),u=t,t}catch(t){throw console.error("[WebRTC] Error creating peer connection:",t),Y=`Creation error: ${t}`,te="Failed to create connection",Ce("failed"),t}},C=async t=>{if(window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout),!t){const o="Cannot create offer: No target partner ID provided";return console.error(`[WebRTC] ${o}`),Y=o,{error:o}}if(!n.value){const o="Cannot create offer: socket not available";return console.error(`[WebRTC] ${o}`),Y=o,{error:o}}if(!E)try{R&&console.log("[WebRTC] Initializing local stream before creating offer"),await $()}catch(o){return console.error("[WebRTC] Failed to initialize local stream:",o),Y=`Failed to access microphone: ${o}`,{error:`Failed to access microphone: ${o}`}}if(console.log(`[WebRTC] Creating offer for partner: ${t}`),z)return console.warn("[WebRTC] Negotiation already in progress, deferring new offer"),new Promise(o=>{setTimeout(async()=>{o(z?{waiting:"Negotiation in progress"}:await C(t))},1e3)});z=!0,xe.value=t,r.value=t;try{R&&console.log(`[WebRTC] Setting partner ID: ${t}`);const o=A();if(E){R&&(console.log("[WebRTC] Adding local tracks to connection"),console.log(`[WebRTC] Local stream has ${E.getTracks().length} tracks`));const v=E;if(o.getSenders().length>0){R&&console.log("[WebRTC] Replacing existing senders");let c=0;v.getTracks().forEach(S=>{o.getSenders()[c]?(o.getSenders()[c].replaceTrack(S),c++):o.addTrack(S,v)})}else v.getTracks().forEach(c=>{o.addTrack(c,v)})}else if(console.error("[WebRTC] No local stream to add tracks from"),await $(),E){const v=E;v.getTracks().forEach(c=>{o.addTrack(c,v)})}q.value="connecting",a.value="connecting",R&&console.log("[WebRTC] Creating offer");const p=await o.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1});return R&&console.log("[WebRTC] Setting local description"),await o.setLocalDescription(p),n.value&&t&&(R&&console.log("[WebRTC] Sending immediate offer using Trickle ICE"),n.value.emit("voice-offer",{offer:o.localDescription,to:t}),n.value.emit("webrtc-signal",{type:"offer",offer:o.localDescription,to:t})),ye(o),F(),R&&console.log("[WebRTC] Offer creation complete"),{success:!0}}catch(o){return console.error("[WebRTC] Error creating offer:",o),Y=`Error creating offer: ${o}`,z=!1,{error:`Failed to create offer: ${o}`}}finally{setTimeout(()=>{z=!1},2e3)}},W=t=>t.iceGatheringState==="complete"?(console.log("[WebRTC] ICE gathering already complete"),Promise.resolve()):new Promise(o=>{const p=()=>{t.iceGatheringState==="complete"&&(t.removeEventListener("icegatheringstatechange",p),o())};t.addEventListener("icegatheringstatechange",p),setTimeout(()=>{t.removeEventListener("icegatheringstatechange",p),console.log("[WebRTC] ICE gathering timed out, but continuing anyway"),o()},1e3)}),V=async(t,o)=>{if(!n.value){console.error("[WebRTC] Cannot handle offer: socket not available");return}console.log("[WebRTC] Received offer from:",o),console.log("[WebRTC] Offer SDP:",t.sdp),xe.value=o,r.value=o;try{E||(R&&console.log("[WebRTC] Initializing local stream before handling offer"),await $());const p=A();if(E&&(p.getSenders().length===0?(R&&console.log("[WebRTC] Adding local tracks to connection"),E.getTracks().forEach(S=>{p.addTrack(S,E)})):R&&console.log("[WebRTC] Senders already exist, not adding tracks again")),q.value="connecting",a.value="connecting",R&&console.log("[WebRTC] Setting remote description (offer)"),await p.setRemoteDescription(new RTCSessionDescription(t)),Q.length>0){R&&console.log(`[WebRTC] Adding ${Q.length} pending ICE candidates`);for(const c of Q)try{await p.addIceCandidate(c)}catch(S){console.error("[WebRTC] Error adding pending ICE candidate:",S)}Q=[]}R&&console.log("[WebRTC] Creating answer");const v=await p.createAnswer({offerToReceiveAudio:!0});R&&console.log("[WebRTC] Answer SDP:",v.sdp),R&&console.log("[WebRTC] Setting local description (answer)"),await p.setLocalDescription(v),p.getTransceivers().forEach(c=>{if(c.receiver.track.kind==="audio"&&(console.log("[WebRTC] Ensuring audio transceiver is set to receive"),c.direction!=="sendrecv"&&c.direction!=="recvonly"))try{c.direction="sendrecv"}catch(S){console.error("[WebRTC] Could not update transceiver direction:",S)}}),await W(p),R&&console.log("[WebRTC] Sending answer to:",o),n.value.emit("voice-answer",{answer:p.localDescription,to:o}),n.value.emit("webrtc-signal",{type:"answer",answer:p.localDescription,to:o}),ye(p),F(),R&&console.log("[WebRTC] Offer handling and answer creation complete")}catch(p){console.error("[WebRTC] Error handling offer:",p),Y=`Error handling offer: ${p}`,setTimeout(()=>{n.value&&r.value&&(console.log("[WebRTC] Re-negotiating after offer error"),C(r.value))},2e3)}},N=async t=>{try{if(!u){R&&console.log("[WebRTC] Cannot handle answer: no peer connection available");return}const o=u.signalingState;if(R&&console.log(`[WebRTC] Current signaling state before handling answer: ${o}`),o==="have-local-offer"){R&&console.log("[WebRTC] Setting remote description from answer");try{await u.setRemoteDescription(new RTCSessionDescription(t)),R&&console.log("[WebRTC] Remote description set successfully, signaling state now: "+u.signalingState)}catch(p){if(console.error("[WebRTC] Error setting remote description:",p),p.toString().includes("InvalidStateError"))if(console.warn("[WebRTC] Invalid state error, attempting to recover"),await new Promise(v=>setTimeout(v,1e3)),u.signalingState==="have-local-offer")try{R&&console.log("[WebRTC] Retrying set remote description after delay"),await u.setRemoteDescription(new RTCSessionDescription(t)),R&&console.log("[WebRTC] Remote description set successfully on retry")}catch(v){console.error("[WebRTC] Final error setting remote description:",v)}else console.warn(`[WebRTC] Cannot set remote answer, wrong state: ${u.signalingState}`)}}else console.warn(`[WebRTC] Cannot set remote description: wrong signaling state: ${o}`),o==="stable"?R&&console.log("[WebRTC] Already in stable state, ignoring answer"):o==="have-remote-offer"&&(console.warn("[WebRTC] We have a remote offer but received an answer - signaling confusion"),L<Z&&(L++,R&&console.log(`[WebRTC] Resetting connection due to signaling confusion (${L}/${Z})`),i(),setTimeout(()=>{r.value&&C(r.value)},2e3)))}catch(o){console.error("[WebRTC] Error handling answer:",o),Y=`Error handling answer: ${o}`,console.log("[WebRTC] Attempting to recover from answer error"),L<Z&&await I()}},U=async()=>{if(!ie.value)return console.log("[WebRTC] Muting microphone - stopping all tracks"),E&&(E.getAudioTracks().forEach(o=>{o.stop()}),E=null,k.value=null),ie.value=!0,!1;console.log("[WebRTC] Unmuting microphone - requesting new permission");try{E&&(E.getTracks().forEach(p=>p.stop()),E=null,k.value=null);const o=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0},video:!1});if(o.getAudioTracks().length===0)throw new Error("No audio tracks available");if(E=o,k.value=o,u&&o)try{const v=u.getSenders().find(c=>c.track&&c.track.kind==="audio");if(v){const c=o.getAudioTracks()[0];c&&v.replaceTrack(c)}else o.getAudioTracks().length>0&&o.getAudioTracks().forEach(c=>{u&&u.addTrack(c,o)})}catch(p){console.error("[WebRTC] Error adding audio tracks:",p)}return ie.value=!1,!0}catch(o){console.error("[WebRTC] Error unmuting microphone:",o);try{const p=await navigator.mediaDevices.getUserMedia({audio:!0});return E=p,k.value=p,ie.value=!1,!0}catch(p){return console.error("[WebRTC] Fallback microphone access also failed:",p),!1}}},i=()=>{if(console.log("[WebRTC] Closing connection"),H(),u){try{u.ontrack=null,u.onicecandidate=null,u.oniceconnectionstatechange=null,u.onicegatheringstatechange=null,u.onsignalingstatechange=null,u.onconnectionstatechange=null;try{u.getTransceivers&&u.getTransceivers().forEach(t=>{t.stop&&t.stop()})}catch{}u.close(),R&&console.log("[WebRTC] Peer connection closed")}catch(t){console.error("[WebRTC] Error closing peer connection:",t)}u=null}O&&(O.getTracks().forEach(t=>{t.stop()}),O=new MediaStream,l.value=O),q.value="closed",a.value="closed"},h=()=>{console.log("[WebRTC] Full cleanup initiated"),i(),E&&(console.log("[WebRTC] Stopping local stream tracks"),E.getTracks().forEach(t=>{t.stop()}),E=null,k.value=null),console.log("[WebRTC] Cleanup complete")};function b(){if(!n.value){console.log("[WebRTC] No socket available, cannot set up listeners");return}console.log("[WebRTC] Setting up socket listeners"),n.value.off("webrtc-signal"),n.value.off("ice-candidate"),n.value.off("partner-disconnected"),n.value.off("webrtc-connection-failed"),n.value.off("connection-timeout"),n.value.off("voice-offer"),n.value.off("voice-answer"),n.value.on("voice-offer",async t=>{console.log("[WebRTC] Received legacy voice-offer:",t),await V(t.offer,t.from)}),n.value.on("voice-answer",async t=>{console.log("[WebRTC] Received legacy voice-answer:",t),await N(t.answer)}),n.value.on("webrtc-signal",async t=>{if(console.log(`[WebRTC] Received ${t.type} signal from ${t.from}`),xe.value=t.from,r.value=t.from,t.type==="offer"&&t.offer)try{await V(t.offer,t.from)}catch(o){console.error("[WebRTC] Error handling offer:",o),Y=`Error handling offer: ${o}`,n.value&&n.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle offer: ${o}`})}else if(t.type==="answer"&&t.answer)try{await N(t.answer)}catch(o){console.error("[WebRTC] Error handling answer:",o),Y=`Error handling answer: ${o}`,n.value&&n.value.emit("webrtc-connection-failed",{to:t.from,reason:`Failed to handle answer: ${o}`})}}),n.value.on("ice-candidate",async t=>{if(console.log(`[WebRTC] Received ICE candidate from ${t.from}`),t.from!==r.value){console.log("[WebRTC] Ignoring ICE candidate from different partner");return}try{await se(t.candidate)}catch(o){console.error("[WebRTC] Error handling ICE candidate:",o),Y=`Error handling ICE candidate: ${o}`}}),n.value.on("webrtc-connection-failed",t=>{console.log(`[WebRTC] Connection failed notification from ${t.from}: ${t.reason}`),L<Z?(L++,console.log(`[WebRTC] Partner reported connection failure. Retry ${L}/${Z}`),t.from===r.value&&setTimeout(()=>{r.value&&n.value&&C(t.from)},Yt)):(q.value="failed",Y=`Partner reported failure: ${t.reason}`)}),n.value.on("partner-disconnected",()=>{console.log("[WebRTC] Partner disconnected"),i(),xe.value=null,r.value=null,q.value="closed",z=!1,ce=!1,L=0})}b(),_e(()=>{s.value=null,k.value=null,l.value=null});function D(){if(!u||!O)return console.log("[WebRTC] Cannot fix tracks: missing connection or stream"),!1;console.log("[WebRTC] Checking and fixing tracks");const t=u.getSenders();if(t.length===0&&E)console.log("[WebRTC] No senders found, re-adding local tracks"),E.getTracks().forEach(p=>{u==null||u.addTrack(p,E)});else if(t.length>0&&E){console.log(`[WebRTC] Found ${t.length} senders, checking state`);const p=E.getTracks();t.forEach(v=>{if(v.track&&v.track.readyState!=="live"){const c=p.find(S=>{var J;return S.kind===((J=v.track)==null?void 0:J.kind)});c&&(console.log("[WebRTC] Replacing inactive track with active one"),v.replaceTrack(c))}})}const o=u.getReceivers();if(o.length>0){console.log(`[WebRTC] Found ${o.length} receivers`);let p=!1;o.forEach(v=>{v.track&&v.track.kind==="audio"&&(p=!0,!(O!=null&&O.getTracks().some(S=>{var J;return S.id===((J=v.track)==null?void 0:J.id)}))&&O&&(console.log("[WebRTC] Adding missing track to remote stream"),O.addTrack(v.track)))}),p||console.log("[WebRTC] No audio receivers found!")}j(),w()}function w(){var p;if(console.log("[WebRTC] 🔍 Diagnosing audio connection issues"),!u)return console.log("[WebRTC] 🔴 No peer connection exists"),!1;console.log(`[WebRTC] Connection state: ${u.connectionState}`),console.log(`[WebRTC] ICE connection state: ${u.iceConnectionState}`),console.log(`[WebRTC] Signaling state: ${u.signalingState}`);const t=u.getReceivers();console.log(`[WebRTC] Connection has ${t.length} receivers`);let o=!1;if(u.getStats().then(v=>{v.forEach(c=>{c.type==="inbound-rtp"&&c.kind==="audio"&&(console.log("[WebRTC] Audio receiver stats:",c),c.packetsReceived===0||c.bytesReceived===0?console.log("[WebRTC] 🔴 Warning: No audio packets received!"):console.log(`[WebRTC] ✅ Receiving audio: ${c.packetsReceived} packets, ${c.bytesReceived} bytes`))})}).catch(v=>console.error("[WebRTC] Error getting stats:",v)),t.forEach((v,c)=>{const S=v.track;S&&S.kind==="audio"&&(o=!0,console.log(`[WebRTC] Audio receiver ${c} - Track: ${S.label}, enabled: ${S.enabled}, muted: ${S.muted}, readyState: ${S.readyState}`),(!S.enabled||S.muted)&&(console.log("[WebRTC] 🟠 Found disabled/muted audio track, enabling it"),S.enabled=!0),S.onmute=()=>{console.log("[WebRTC] Track muted event - automatically unmuting"),S.enabled=!0},S.onended=()=>{console.log("[WebRTC] Track ended event - attempting to recreate connection"),!ce&&u&&u.connectionState==="connected"&&I()})}),!o){console.log("[WebRTC] 🔴 No audio receivers found. Remote party may not be sending audio.");const v=u.getTransceivers();let c=!1;v.forEach(S=>{if(console.log(`[WebRTC] Transceiver direction: ${S.direction}, currentDirection: ${S.currentDirection}`),S.direction==="sendonly"||S.direction==="inactive")try{console.log("[WebRTC] 🟠 Fixing transceiver direction to sendrecv"),S.direction="sendrecv",c=!0}catch(J){console.error("[WebRTC] Error updating transceiver direction:",J)}}),c&&!z&&(console.log("[WebRTC] Triggering renegotiation after fixing transceivers"),re()),u.connectionState==="connected"&&(console.log("[WebRTC] 🟠 Connection is established but no audio receivers. Checking SDP parameters..."),!z&&r.value&&(console.log("[WebRTC] Trying to recover audio by sending refresh signal"),(p=n.value)==null||p.emit("webrtc-signal",{type:"refresh-tracks",to:r.value})))}if(E){const v=E.getAudioTracks();console.log(`[WebRTC] Local stream has ${v.length} audio tracks`),v.length===0?(console.log("[WebRTC] 🔴 No local audio tracks! Trying to reinitialize microphone..."),$().then(()=>{u&&u.connectionState==="connected"&&(console.log("[WebRTC] Added new local audio tracks, restarting connection"),re())}).catch(c=>console.error("[WebRTC] Failed to reinitialize local stream:",c))):v.forEach((c,S)=>{console.log(`[WebRTC] Local audio track ${S}: ${c.label}, enabled: ${c.enabled}, muted: ${c.muted}, readyState: ${c.readyState}`),!c.enabled&&!ie.value&&(console.log("[WebRTC] 🟠 Local track disabled but not muted by user, enabling it"),c.enabled=!0)})}else console.log("[WebRTC] 🔴 No local stream available");if(O){const v=O.getAudioTracks();if(console.log(`[WebRTC] Remote stream has ${v.length} audio tracks`),v.forEach((c,S)=>{console.log(`[WebRTC] Remote audio track ${S}: ${c.label}, enabled: ${c.enabled}, muted: ${c.muted}, readyState: ${c.readyState}`),(!c.enabled||c.muted)&&(console.log("[WebRTC] 🟠 Found disabled remote audio track, enabling it"),c.enabled=!0),c.readyState!=="live"&&(console.log("[WebRTC] 🔴 Remote track not live! ReadyState:",c.readyState),u&&Array.from(u.getReceivers()).find(ke=>ke.track&&ke.track.id===c.id)||(console.log("[WebRTC] Remote track not found in receivers, attempting to recreate connection"),u&&u.connectionState==="connected"&&!z&&re()))}),v.length===0){console.log("[WebRTC] 🔴 No audio tracks in remote stream. Checking for receivers...");const c=u?Array.from(u.getReceivers()).filter(S=>S.track&&S.track.kind==="audio"):[];c.length>0&&(console.log("[WebRTC] Found audio receivers but they are not in remote stream. Adding them now."),c.forEach(S=>{S.track&&O&&(console.log("[WebRTC] Adding track from receiver to remote stream:",S.track.id),O.addTrack(S.track))}),l.value=O)}}else if(u&&u.getReceivers().length>0){console.log("[WebRTC] 🔴 No remote stream but receivers exist! Creating new remote stream"),O=new MediaStream;const v=Array.from(u.getReceivers()).filter(c=>c.track&&c.track.kind==="audio");v.length>0&&v.forEach(c=>{c.track&&O&&(console.log("[WebRTC] Adding track to new remote stream:",c.track.id),O.addTrack(c.track))}),l.value=O}else console.log("[WebRTC] 🔴 No remote stream or receivers available");return setTimeout(()=>{const v=document.querySelectorAll("audio");v.length>0&&O&&(console.log(`[WebRTC] Found ${v.length} audio elements, ensuring they use remote stream`),Array.from(v).forEach((c,S)=>{c.srcObject!==O&&(console.log(`[WebRTC] Audio element ${S} not using correct stream, updating`),c.srcObject=O,c.muted=!1,c.volume=1,c.play().catch(J=>console.log("[WebRTC] Error playing audio:",J)))}))},100),setTimeout(D,3e3),!0}async function I(){if(!(!u||!r.value)){console.log("[WebRTC] Attempting connection recovery");try{if(ce=!0,me===tt?(me=qe,console.log("[WebRTC] Switching to fast configuration for quicker connection")):L>5&&(me=ze,console.log("[WebRTC] Switching to TURN-only configuration")),u.restartIce){u.restartIce();const t=await u.createOffer({iceRestart:!0,offerToReceiveAudio:!0});await u.setLocalDescription(t),n.value&&(n.value.emit("offer",{offer:u.localDescription,to:r.value}),n.value.emit("webrtc-signal",{type:"offer",offer:u.localDescription,to:r.value}))}setTimeout(()=>{ce=!1},500)}catch(t){console.error("[WebRTC] Recovery attempt failed:",t),ce=!1,L<Z&&setTimeout(()=>{i(),r.value&&C(r.value)},200)}}}function j(){typeof window<"u"&&(window.__webrtc_debug={connectionState:q.value,connectionRetryCount:L,lastConnectionError:Y,failureReason:te,isNegotiating:z,isRestartingIce:ce,pendingCandidates:Q.length,hasLocalTracks:E?E.getAudioTracks().length>0:!1,hasRemoteTracks:O?O.getAudioTracks().length>0:!1})}K(()=>q.value,()=>{j()});function F(){ve&&clearInterval(ve),typeof window<"u"&&(window.__localIceCandidates=[],window.__remoteIceCandidates=[],window.__iceCandidatePairs=[]),u&&(u.onicecandidate=t=>{t.candidate&&(console.log("[WebRTC] ICE candidate generated:",t.candidate.candidate),typeof window<"u"&&(window.__localIceCandidates=window.__localIceCandidates||[],window.__localIceCandidates.push({candidate:t.candidate.candidate,timestamp:Date.now()})),n.value&&r.value&&(console.log("[WebRTC] Sending ICE candidate to partner"),n.value.emit("ice-candidate",{candidate:t.candidate,to:r.value})))}),ve=window.setInterval(async()=>{if(!u||q.value!=="connecting"&&q.value!=="connected"){H();return}try{const t=await ot();t&&t.iceCandidatePairs&&typeof window<"u"&&(window.__iceCandidatePairs=t.iceCandidatePairs),be(t)}catch(t){console.error("[WebRTC] Error monitoring connection:",t)}},Xt)}function H(){ve&&(clearInterval(ve),ve=null)}function be(t){if(!t||t.error)return;const o=!t.media||t.media.length===0||!t.media.some(v=>v.kind==="audio"&&v.audioLevel>0),p=!t.selectedCandidatePair||t.selectedCandidatePair.state!=="succeeded";(o||p)&&(console.log("[WebRTC] Connection health issues detected, trying to fix..."),D(),q.value==="connected"&&L<Z&&(L++,console.log(`[WebRTC] Attempting connection improvement (${L}/${Z})`),u&&u.getTransceivers&&u.getTransceivers().forEach(v=>{v.sender&&v.sender.track&&v.sender.track.kind==="audio"&&v.sender.setParameters({...v.sender.getParameters(),degradationPreference:"maintain-framerate"})})))}function ye(t){if(!r.value)return;window.__webrtcConnectionTimeout&&clearTimeout(window.__webrtcConnectionTimeout);const o=5e3;window.__webrtcConnectionTimeout=setTimeout(()=>{(t.connectionState==="connecting"||t.connectionState==="new")&&(console.log(`[WebRTC] Connection not established after ${o/1e3} seconds, trying fast config`),me=qe,r.value&&!z&&C(r.value),window.__webrtcConnectionTimeout=setTimeout(()=>{var p,v,c;if(t.connectionState==="connecting"||t.connectionState==="new"){console.log("[WebRTC] Connection still not established, trying TURN-only config");const S={localCandidates:((p=window.__localIceCandidates)==null?void 0:p.length)||0,remoteCandidates:((v=window.__remoteIceCandidates)==null?void 0:v.length)||0,iceCandidatePairsCount:((c=window.__iceCandidatePairs)==null?void 0:c.length)||0};console.log("[WebRTC] Connection diagnostic info:",JSON.stringify(S)),me=ze,i(),r.value&&setTimeout(()=>{C(r.value)},200)}},5e3))},o)}const se=async t=>{if(!u){console.log("[WebRTC] Received ICE candidate but no peer connection exists");return}try{if(R&&console.log("[WebRTC] Adding received ICE candidate:",t.candidate),window.__remoteIceCandidates||(window.__remoteIceCandidates=[]),window.__remoteIceCandidates.push(t),!u.remoteDescription||!u.localDescription){R&&console.log("[WebRTC] Delaying ICE candidate addition until descriptions are set"),setTimeout(async()=>{if(u&&u.remoteDescription){R&&console.log("[WebRTC] Adding delayed ICE candidate after timeout");try{await u.addIceCandidate(t)}catch(o){console.error("[WebRTC] Error adding delayed ICE candidate:",o)}}},1e3);return}await u.addIceCandidate(t),R&&console.log("[WebRTC] Successfully added ICE candidate")}catch(o){console.error("[WebRTC] Error adding ICE candidate:",o),Y=`Error adding ICE candidate: ${o}`,setTimeout(async()=>{if(u&&u.remoteDescription){console.log("[WebRTC] Retrying to add ICE candidate after error");try{await u.addIceCandidate(t),R&&console.log("[WebRTC] Successfully added ICE candidate on retry")}catch(p){console.error("[WebRTC] Error adding ICE candidate on retry:",p)}}},2e3)}};function re(){if(!u||!r.value||z){console.log("[WebRTC] Cannot start negotiation: missing connection, partner ID, or already negotiating");return}console.log("[WebRTC] Starting new negotiation"),z=!0;try{u.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!1}).then(t=>{if(u)return u.setLocalDescription(t)}).then(()=>{!u||!n.value||!r.value||(n.value.emit("voice-offer",{offer:u.localDescription,to:r.value}),R&&console.log("[WebRTC] Sent renegotiation offer"))}).catch(t=>{console.error("[WebRTC] Error during negotiation:",t)}).finally(()=>{setTimeout(()=>{z=!1},2e3)})}catch(t){console.error("[WebRTC] Failed to start negotiation:",t),z=!1}}const $e={connectionState:q.value,iceCandidatesGenerated:Q.length,localStreamActive:!!E&&E.active,remoteStreamActive:!!O&&O.active,localTracks:E?E.getAudioTracks().length:0,remoteTracks:O?O.getAudioTracks().length:0,connectionRetries:L,lastError:Y||te||"",isAudioMuted:ie.value,forceReconnect:()=>u&&q.value!=="new"?(I(),!0):!1};return{socket:n,peerConnection:s,remoteStream:l,localStream:k,connectionState:a,isAudioMuted:g,partnerId:r,createOffer:C,handleOffer:V,handleAnswer:N,handleIceCandidate:se,toggleMicrophone:U,closeConnection:i,initializeLocalStream:$,cleanup:h,diagnosticReport:$e}}function Jt(n){return n.signalingState==="stable"||n.signalingState==="have-remote-offer"}function Ce(n){q.value!==n&&(console.log(`[WebRTC] Connection state changing from ${q.value} to ${n}`),q.value=n,n==="connected"||n==="completed"?(te="",Y="",L=0,console.log("[WebRTC] Connection established successfully")):(n==="failed"||n==="disconnected")&&(console.warn(`[WebRTC] Connection ${n}: ${te||"Unknown reason"}`),n==="failed"&&(L++,console.log(`[WebRTC] Connection failure count: ${L}/${Z}`))))}function Qt(){const n="test";try{return localStorage.setItem(n,n),localStorage.removeItem(n),!0}catch(m){return console.error("localStorage is not available:",m),!1}}function Zt(){const n=y(Qt());function m(a,g){if(!n.value){console.warn("localStorage is not available, cannot set item");return}try{localStorage.setItem(a,g)}catch(r){console.error("Failed to set localStorage item:",r)}}function s(a){if(!n.value)return console.warn("localStorage is not available, cannot get item"),null;try{return localStorage.getItem(a)}catch(g){return console.error("Failed to get localStorage item:",g),null}}function k(a){if(!n.value){console.warn("localStorage is not available, cannot remove item");return}try{localStorage.removeItem(a)}catch(g){console.error("Failed to remove localStorage item:",g)}}function l(){if(!n.value){console.warn("localStorage is not available, cannot clear storage");return}try{localStorage.clear()}catch(a){console.error("Failed to clear localStorage:",a)}}return{isAvailable:n,setItem:m,getItem:s,removeItem:k,clear:l}}const X=y({}),we=y(null),ne=y({}),Se=y(!1),Ee=!0;let Ye=!1;function eo(){const{socket:n,userId:m}=Te(),s=Zt();Ye?console.log("[ChatService] Using existing chat service instance"):(console.log("[ChatService] Initializing chat service"),k(),Ye=!0);function k(){l(),V(),K(X,()=>{W()},{deep:!0}),K(()=>n.value,i=>{i&&!Se.value&&(console.log("[ChatService] Socket reconnected, setting up listeners again"),l())})}function l(){if(!n.value){console.log("[ChatService] No socket available, cannot set up listeners");return}Se.value&&(console.log("[ChatService] Removing existing chat-message listener"),n.value.off("chat-message"),Se.value=!1),console.log("[ChatService] Setting up chat-message listener"),n.value.on("chat-message",i=>{console.log("[ChatService] Received chat message:",i);const h=i.from,b=C(h);console.log(`[ChatService] Conversation key: ${b}, current partner: ${we.value}`),X.value[b]||(X.value[b]=[]),X.value[b].push({sender:"partner",text:i.text,timestamp:i.timestamp||Date.now()}),h!==we.value&&(ne.value[h]=!0,console.log(`[ChatService] Marked message from ${h} as unread`)),W(),console.log("[ChatService] Updated messages:",X.value[b])}),Se.value=!0,console.log("[ChatService] Chat message listener setup complete")}function a(i){console.log(`[ChatService] Setting current partner: ${i}`),we.value=i,i&&(ne.value[i]=!1)}function g(i,h=null){const b=h||we.value;if(!b||!i.trim()||!n.value)return console.log(`[ChatService] Cannot send message: partnerId=${b}, text=${i.trim()?"present":"empty"}, socket=${n.value?"present":"not present"}`),!1;console.log(`[ChatService] Sending message to ${b}: ${i}`);const D=C(b);X.value[D]||(X.value[D]=[]);const w=Date.now();return X.value[D].push({sender:"me",text:i.trim(),timestamp:w}),n.value.emit("chat-message",{text:i.trim(),to:b}),console.log("[ChatService] Message sent, current messages:",X.value[D]),!0}function r(i){if(!i)return[];const h=C(i),b=X.value[h]||[];return console.log(`[ChatService] Getting messages for ${i}, found ${b.length} messages`),b}function $(i){if(!i)return!1;const h=!!ne.value[i];return console.log(`[ChatService] Checking unread for ${i}: ${h}`),h}function A(i){i&&(console.log(`[ChatService] Marking messages as read for ${i}`),ne.value[i]=!1)}function C(i){if(!m.value)return i;const h=[m.value,i].sort();return`${h[0]}_${h[1]}`}function W(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot save chats");return}try{s.setItem("chat_messages",JSON.stringify(X.value)),s.setItem("chat_unread",JSON.stringify(ne.value)),Ee&&console.log("[ChatService] Saved chats to localStorage")}catch(i){console.error("[ChatService] Failed to save chats:",i)}}function V(){if(!s.isAvailable.value){console.log("[ChatService] localStorage not available, cannot load chats");return}try{const i=s.getItem("chat_messages");i&&(X.value=JSON.parse(i),Ee&&console.log("[ChatService] Loaded messages from localStorage:",Object.keys(X.value).length,"conversations"));const h=s.getItem("chat_unread");h&&(ne.value=JSON.parse(h),Ee&&console.log("[ChatService] Loaded unread status from localStorage"))}catch(i){console.error("[ChatService] Failed to load chats:",i)}}function N(i){if(!i)return;const h=C(i);X.value[h]&&(X.value[h]=[],W(),console.log(`[ChatService] Cleared chat for ${i}`))}function U(){X.value={},ne.value={},W(),console.log("[ChatService] Cleared all chats")}return{messages:X,unreadMessages:ne,currentPartnerId:we,setCurrentPartner:a,sendMessage:g,getMessages:r,hasUnreadMessages:$,markAsRead:A,clearChat:N,clearAllChats:U}}const to={class:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 text-center border border-white/10"},oo={key:0},no={key:1},ao={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},lo={class:"text-xl"},so={class:"text-sm"},ro={key:2},io={key:0,class:"flex items-center justify-center gap-2 text-gray-300"},co={class:"text-xl"},uo={class:"text-sm"},fo={key:3},go={key:4,class:"mt-4 text-xs"},vo={class:"flex items-center justify-center gap-2"},mo={key:0,class:"text-red-400 mt-1 text-xs"},po=oe({__name:"connection-card",props:{status:{type:String,default:"disconnected"},partnerInfo:{type:Object,default:null},errorMessage:{type:String,default:""},showStatus:{type:Boolean,default:!0}},setup(n){const m=n,s=ae(()=>{switch(m.status){case"searching":return"Searching...";case"matched":return"Partner found, connecting...";case"connected":return"Connected";default:return"Disconnected"}});return(k,l)=>(x(),T("div",to,[n.status==="searching"?(x(),T("div",oo,l[0]||(l[0]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center animate-pulse"},[e("div",{class:"w-8 h-8 border-2 border-white border-t-transparent rounded-full animate-spin"})],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Searching...",-1),e("p",{class:"text-sm text-gray-300"},"Looking for someone to talk to",-1)]))):n.status==="matched"?(x(),T("div",no,[l[1]||(l[1]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-yellow-500 to-green-500 rounded-full flex items-center justify-center animate-pulse"},[e("span",{class:"text-2xl"},"🔄")],-1)),l[2]||(l[2]=e("h2",{class:"text-lg font-semibold mb-2 text-yellow-400"},"Match Found!",-1)),n.partnerInfo?(x(),T("div",ao,[e("span",lo,P(n.partnerInfo.flag),1),e("span",so,P(n.partnerInfo.country),1)])):G("",!0),l[3]||(l[3]=e("p",{class:"text-sm text-yellow-400 mt-2"},"Setting up voice connection...",-1)),l[4]||(l[4]=e("div",{class:"mt-3 relative h-1.5 w-3/4 mx-auto bg-gray-700 rounded-full overflow-hidden"},[e("div",{class:"absolute top-0 left-0 h-full bg-gradient-to-r from-yellow-500 to-green-500 rounded-full animate-progress"})],-1))])):n.status==="connected"?(x(),T("div",ro,[l[5]||(l[5]=e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"👥")],-1)),l[6]||(l[6]=e("h2",{class:"text-lg font-semibold mb-2"},"Connected!",-1)),n.partnerInfo?(x(),T("div",io,[e("span",co,P(n.partnerInfo.flag),1),e("span",uo,P(n.partnerInfo.country),1)])):G("",!0),l[7]||(l[7]=e("p",{class:"text-sm text-green-400 mt-2"},"You can talk now",-1))])):(x(),T("div",fo,l[8]||(l[8]=[e("div",{class:"w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-gray-600 to-gray-700 rounded-full flex items-center justify-center"},[e("span",{class:"text-2xl"},"🌟")],-1),e("h2",{class:"text-lg font-semibold mb-2"},"Ready to Connect",-1),e("p",{class:"text-sm text-gray-300"},'Press "Next" to find someone to talk with',-1)]))),n.showStatus&&n.status!=="disconnected"?(x(),T("div",go,[e("div",vo,[e("span",{class:B({"text-green-400":n.status==="connected","text-yellow-400":n.status==="matched","text-blue-400":n.status==="searching"})},"●",2),e("span",null,P(s.value),1)]),n.errorMessage?(x(),T("p",mo,P(n.errorMessage),1)):G("",!0)])):G("",!0)]))}});const fe=(n,m)=>{const s=n.__vccOpts||n;for(const[k,l]of m)s[k]=l;return s},bo=fe(po,[["__scopeId","data-v-911ccaff"]]),yo={class:"space-y-3 md:space-y-4 px-2"},ho={class:"flex justify-center items-center gap-3 md:gap-4"},xo=["disabled"],Co={class:"relative"},wo={key:0,class:"text-white text-lg md:text-xl"},To={key:1,class:"text-white text-lg md:text-xl"},ko={key:2,class:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-300 rounded-full animate-pulse"},Ro=["disabled"],So={class:"flex flex-wrap justify-center gap-2 md:gap-3"},_o=oe({__name:"control-buttons",props:{isMuted:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!0}},emits:["toggle-mute","find-next","toggle-chat","toggle-games","toggle-history","toggle-donation"],setup(n,{emit:m}){const s=m,k=y(!1);function l(){k.value||(k.value=!0,s("toggle-mute"),setTimeout(()=>{k.value=!1},200),setTimeout(()=>{try{const a=document.querySelector("audio");a&&a.paused&&a.play().catch(g=>{console.warn("Could not auto-play audio after mute toggle:",g)})}catch(a){console.error("Error trying to auto-play:",a)}},300))}return(a,g)=>(x(),T("div",yo,[e("div",ho,[e("button",{onClick:l,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center transition-all shadow-xl transform hover:scale-110",n.isMuted?"bg-gradient-to-r from-red-400 to-pink-400 shadow-red-400/70":"bg-gradient-to-r from-emerald-400 to-green-400 hover:from-green-400 hover:to-emerald-400 shadow-emerald-400/70"]),disabled:k.value},[e("div",Co,[n.isMuted?(x(),T("span",To,"🔇")):(x(),T("span",wo,"🎤")),k.value?(x(),T("span",ko)):G("",!0)])],10,xo),e("button",{onClick:g[0]||(g[0]=r=>a.$emit("find-next")),class:"w-16 h-16 md:w-20 md:h-20 bg-gradient-to-r from-orange-400 to-yellow-400 hover:from-yellow-400 hover:to-orange-400 rounded-full flex items-center justify-center shadow-2xl shadow-orange-400/80 transition-all transform hover:scale-110"},g[5]||(g[5]=[e("span",{class:"text-white text-2xl md:text-3xl"},"📞",-1)])),e("button",{onClick:g[1]||(g[1]=r=>a.$emit("toggle-chat")),disabled:n.isDisabled,class:B(["w-14 h-14 md:w-16 md:h-16 rounded-full flex items-center justify-center shadow-xl transition-all transform hover:scale-110",n.isDisabled?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-blue-400 to-cyan-400 hover:from-cyan-400 hover:to-blue-400 shadow-blue-400/70"])},g[6]||(g[6]=[e("span",{class:"text-white text-lg md:text-xl"},"💬",-1)]),10,Ro)]),e("div",So,[e("button",{onClick:g[2]||(g[2]=r=>a.$emit("toggle-games")),class:"bg-gradient-to-r from-purple-400 to-pink-400 hover:from-pink-400 hover:to-purple-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-purple-400/70 transition-all transform hover:scale-110"}," 🎮 Games "),e("button",{onClick:g[3]||(g[3]=r=>a.$emit("toggle-history")),class:"bg-gradient-to-r from-indigo-400 to-blue-400 hover:from-blue-400 hover:to-indigo-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-indigo-400/70 transition-all transform hover:scale-110"}," 📞 History "),e("button",{onClick:g[4]||(g[4]=r=>a.$emit("toggle-donation")),class:"bg-gradient-to-r from-yellow-400 to-orange-400 hover:from-orange-400 hover:to-yellow-400 rounded-full px-3 py-1.5 md:px-4 md:py-2 text-xs md:text-sm shadow-xl shadow-yellow-400/70 transition-all animate-pulse transform hover:scale-110"}," ❤️ Support ")])]))}}),$o={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50"},Wo={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto h-[80vh] flex flex-col"},Io={class:"flex items-center justify-between p-4 border-b border-gray-700"},Eo={key:0,class:"h-full flex items-center justify-center text-gray-500"},Ao={key:1,class:"space-y-2"},Oo={class:"flex justify-between gap-2"},Do={class:"text-xs text-gray-400"},jo={class:"mt-1 text-white break-words"},Mo={class:"p-3 border-t border-gray-700"},Po=["disabled"],No=["disabled"],Fo=oe({__name:"chat-modal",props:{isOpen:{type:Boolean,default:!1},isConnected:{type:Boolean,default:!1},messages:{type:Array,default:()=>[]}},emits:["close","send-message"],setup(n,{emit:m}){const s=n,k=m,l=y(""),a=y(null),g=()=>{l.value.trim()&&s.isConnected&&(k("send-message",l.value),l.value="")},r=async()=>{await At(),a.value&&(a.value.scrollTop=a.value.scrollHeight)},$=A=>new Date(A).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return K(()=>s.messages,()=>{r()},{deep:!0}),K(()=>s.isOpen,A=>{A&&r()}),le(()=>{s.isOpen&&r()}),(A,C)=>n.isOpen?(x(),T("div",$o,[e("div",Wo,[e("div",Io,[C[2]||(C[2]=e("div",{class:"flex items-center"},[e("span",{class:"text-white text-lg font-medium"},"💬 Chat")],-1)),e("button",{onClick:C[0]||(C[0]=W=>A.$emit("close")),class:"text-gray-400 hover:text-white"}," ✕ ")]),e("div",{class:"flex-1 p-4 overflow-y-auto",ref_key:"messagesContainerRef",ref:a},[n.messages.length===0?(x(),T("div",Eo,C[3]||(C[3]=[e("div",{class:"text-center"},[e("p",null,"No messages yet"),e("p",{class:"text-sm mt-1"},"Send a message to start the conversation")],-1)]))):(x(),T("div",Ao,[(x(!0),T(ue,null,de(n.messages,W=>(x(),T("div",{key:W.id,class:B(["rounded-lg p-3 max-w-[80%]",W.isOwn?"bg-blue-700 ml-auto":"bg-gray-700 mr-auto"])},[e("div",Oo,[e("span",{class:B(["text-sm",W.isOwn?"text-blue-200":"text-gray-200"])},P(W.isOwn?"You":"Partner"),3),e("span",Do,P($(W.timestamp)),1)]),e("p",jo,P(W.message),1)],2))),128))]))],512),e("div",Mo,[e("form",{onSubmit:Et(g,["prevent"]),class:"flex gap-2"},[De(e("input",{"onUpdate:modelValue":C[1]||(C[1]=W=>l.value=W),type:"text",placeholder:"Type a message...",class:"flex-1 bg-gray-800 border border-gray-700 rounded-md p-2 text-white focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!n.isConnected},null,8,Po),[[Qe,l.value]]),e("button",{type:"submit",class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md disabled:opacity-50 disabled:cursor-not-allowed",disabled:!n.isConnected||!l.value.trim()}," Send ",8,No)],32)])])])):G("",!0)}}),Lo={class:"w-full p-2"},Vo={class:"flex justify-between items-center mb-4"},Uo={key:0,class:"text-yellow-300 animate-pulse"},Go={key:1},Bo={key:2},zo={class:"bg-gray-800/60 backdrop-blur-sm rounded-lg p-4 mb-4"},qo={class:"mb-4 text-center"},Ho={class:"flex items-center justify-center gap-4"},Xo={class:"text-center"},Yo={class:"grid grid-cols-3 gap-3 mb-4"},Ko=["onClick","disabled"],Jo={key:0,class:"text-blue-400"},Qo={key:1,class:"text-green-400"},Zo={key:0,class:"text-center mt-4 animate__animated animate__fadeIn"},en={key:1,class:"text-center mt-4"},tn={class:"flex justify-between"},Ke=3e4,on=oe({__name:"TicTacToe",props:{partnerId:{type:String,required:!0},isFirstPlayer:{type:Boolean,default:!0}},emits:["back","error"],setup(n,{emit:m}){const s=n,k=m,{socket:l}=Te(),a=y("waiting"),g=y(["","","","","","","","",""]),r=y(s.isFirstPlayer?"X":"O"),$=y(s.isFirstPlayer?"O":"X"),A=y("X"),C=y(null),W=y(null),V=y(Date.now()),N=ae(()=>A.value===r.value),U=w=>{var I;if(!(a.value!=="playing"||g.value[w]!==""||!N.value||C.value!==null))try{g.value[w]=r.value,A.value=$.value,V.value=Date.now(),(I=l.value)==null||I.emit("game-move",{gameType:"tic-tac-toe",move:w,to:s.partnerId}),i(),D()}catch{b("Failed to make a move. Please try again.")}},i=()=>{const w=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const I of w){const[j,F,H]=I;if(g.value[j]&&g.value[j]===g.value[F]&&g.value[j]===g.value[H]){C.value=g.value[j],a.value="finished",W.value&&(clearTimeout(W.value),W.value=null);return}}g.value.includes("")||(C.value="tie",a.value="finished",W.value&&(clearTimeout(W.value),W.value=null))},h=()=>{var w;try{g.value=["","","","","","","","",""],A.value="X",C.value=null,a.value="playing",V.value=Date.now(),(w=l.value)==null||w.emit("game-reset",{gameType:"tic-tac-toe",to:s.partnerId}),D()}catch{b("Failed to reset the game. Please try again.")}},b=w=>{console.error(`Tic-Tac-Toe Error: ${w}`),k("error",w)},D=()=>{W.value&&clearTimeout(W.value),a.value==="playing"&&!C.value&&(W.value=window.setTimeout(()=>{Date.now()-V.value>Ke&&(b("Connection with your partner appears to be lost. The game will be closed."),k("back"))},Ke))};return K(()=>s.isFirstPlayer,w=>{r.value=w?"X":"O",$.value=w?"O":"X",w||(a.value="playing")}),le(()=>{var w,I,j;try{(w=l.value)==null||w.on("game-partner-joined",F=>{F.from===s.partnerId&&F.gameType==="tic-tac-toe"&&(console.log("Partner joined the game!",F),a.value="playing",V.value=Date.now(),D())}),(I=l.value)==null||I.on("game-move",F=>{if(F.from===s.partnerId&&F.gameType==="tic-tac-toe"){const H=F.move;typeof H=="number"&&H>=0&&H<9&&g.value[H]===""?(g.value[H]=$.value,A.value=r.value,V.value=Date.now(),i(),D()):b("Received invalid move from partner.")}}),(j=l.value)==null||j.on("game-reset",F=>{F.from===s.partnerId&&F.gameType==="tic-tac-toe"&&(g.value=["","","","","","","","",""],A.value="X",C.value=null,a.value="playing",V.value=Date.now(),D())}),s.isFirstPlayer||(a.value="playing")}catch{b("Failed to initialize game connection.")}}),_e(()=>{var w,I,j;(w=l.value)==null||w.off("game-partner-joined"),(I=l.value)==null||I.off("game-move"),(j=l.value)==null||j.off("game-reset"),W.value&&(clearTimeout(W.value),W.value=null)}),(w,I)=>(x(),T("div",Lo,[e("div",Vo,[I[1]||(I[1]=e("h2",{class:"text-xl font-bold text-purple-400"},"Tic Tac Toe",-1)),e("div",{class:B(["text-white text-sm px-3 py-1 rounded-full",{"bg-yellow-600/30":a.value==="waiting","bg-green-600/30":N.value&&a.value==="playing","bg-red-600/30":!N.value&&a.value==="playing","bg-purple-600/30":C.value}])},[a.value==="waiting"?(x(),T("span",Uo," Waiting for partner... ")):C.value?(x(),T("span",Go,P(C.value===r.value?"You Won! 🎉":C.value==="tie"?"It's a Tie! 🤝":"You Lost! 😢"),1)):(x(),T("span",Bo,P(N.value?"Your Turn":"Partner's Turn"),1))],2)]),e("div",zo,[e("div",{class:B(["flex flex-col items-center",{"opacity-70":a.value==="waiting"||!N.value&&!C.value}])},[e("div",qo,[e("div",Ho,[e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="X"},"w-10 h-10 rounded-full bg-blue-600 flex items-center justify-center text-lg font-bold"])}," X ",2),e("div",Xo,[I[2]||(I[2]=e("p",{class:"text-gray-300 text-sm"},"You are",-1)),e("p",{class:B(["font-bold text-lg",{"text-blue-400":r.value==="X","text-green-400":r.value==="O"}])},P(r.value),3)]),e("div",{class:B([{"ring-2 ring-purple-500 ring-offset-2 ring-offset-gray-800":r.value==="O"},"w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-lg font-bold"])}," O ",2)])]),e("div",Yo,[(x(!0),T(ue,null,de(g.value,(j,F)=>(x(),T("button",{key:F,onClick:H=>U(F),disabled:j!==""||!N.value||C.value!==null||a.value==="waiting",class:B(["w-20 h-20 rounded-lg flex items-center justify-center text-3xl font-bold transition-all duration-300",{"bg-gray-700 hover:bg-gray-600":j===""&&N.value&&!C.value&&a.value!=="waiting","bg-gray-700/50":j===""&&(!N.value||C.value!==null||a.value==="waiting"),"bg-blue-600/20":j==="X","bg-green-600/20":j==="O","cursor-not-allowed":j!==""||!N.value||C.value!==null||a.value==="waiting","hover:bg-purple-700/50":N.value&&j===""&&!C.value&&a.value==="playing"}])},[j==="X"?(x(),T("span",Jo,"X")):j==="O"?(x(),T("span",Qo,"O")):G("",!0)],10,Ko))),128))]),C.value?(x(),T("div",Zo,[e("button",{onClick:h,class:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-2 rounded-lg text-sm transition-colors mb-2"}," Play Again ")])):G("",!0),a.value==="waiting"?(x(),T("div",en,I[3]||(I[3]=[e("div",{class:"bg-yellow-600/20 rounded-lg p-4 animate-pulse"},[e("p",{class:"text-yellow-300 mb-1"},"Waiting for your partner to join..."),e("p",{class:"text-sm text-gray-300"},[je("You'll play as "),e("span",{class:"font-bold text-blue-400"},"X")])],-1)]))):G("",!0)],2)]),e("div",tn,[e("button",{onClick:I[0]||(I[0]=j=>w.$emit("back")),class:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg text-sm transition-colors"}," Back to Games ")])]))}});const nn=fe(on,[["__scopeId","data-v-98a0628f"]]),an={key:0,class:"fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-4"},ln={class:"bg-[#1e1e2e] rounded-lg w-full max-w-md mx-auto shadow-2xl relative overflow-hidden"},sn={class:"flex items-center justify-between p-3 border-b border-gray-800"},rn={key:1,class:"p-4"},cn={class:"grid grid-cols-2 gap-4 mb-4"},un=["disabled"],dn=["disabled"],fn={key:2,class:"text-center p-6"},gn={class:"mb-4"},vn={class:"text-gray-300"},mn={key:3},pn=oe({__name:"games-modal",props:{isOpen:{type:Boolean,default:!1},partnerId:{type:String,required:!0},isConnected:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:m}){const{socket:s,userId:k}=Te(),l=n,a=y(null),g=y(null),r=y(!0),$=y(null),A=y(!1),C=y(""),W=i=>{console.log(`[Game Debug] ${i}`),C.value=i},V=i=>{var b;if(!l.isConnected)return;W(`Starting game: ${i} with partner: ${l.partnerId}`),g.value=null,a.value=i,r.value=!0,A.value=!1;const h=[k.value,l.partnerId].sort();$.value=`${i}-${h[0]}-${h[1]}`,W(`Created game room: ${$.value}`),(b=s.value)==null||b.emit("game-join-room",{gameType:i,roomId:$.value,to:l.partnerId,isFirstPlayer:!0})},N=()=>{var i;$.value&&((i=s.value)==null||i.emit("game-leave-room",{roomId:$.value,to:l.partnerId})),a.value=null,g.value=null,r.value=!0,$.value=null,A.value=!1},U=i=>{g.value=i,W(`Error: ${i}`)};return le(()=>{var i,h,b,D;W("Setting up game events"),(i=s.value)==null||i.on("game-room-invite",w=>{var I;w.from===l.partnerId&&(W(`Received invitation to join game room: ${w.roomId}`),$.value=w.roomId,a.value=w.gameType,r.value=!1,(I=s.value)==null||I.emit("game-join-room",{gameType:w.gameType,roomId:w.roomId,to:l.partnerId,isFirstPlayer:!1}))}),(h=s.value)==null||h.on("game-partner-joined",w=>{w.from===l.partnerId&&(W(`Partner joined the game: ${w.gameType}`),A.value=!0)}),(b=s.value)==null||b.on("game-error",w=>{(w.from==="system"||w.from===l.partnerId)&&(g.value=w.message||"An error occurred in the game.",W(`Game error: ${w.message}`))}),(D=s.value)==null||D.on("game-partner-left",w=>{a.value&&(g.value="Your partner left the game.",W("Partner left the game"),a.value=null)})}),_e(()=>{var i,h,b,D,w;(i=s.value)==null||i.off("game-room-invite"),(h=s.value)==null||h.off("game-partner-joined"),(b=s.value)==null||b.off("game-error"),(D=s.value)==null||D.off("game-partner-left"),$.value&&((w=s.value)==null||w.emit("game-leave-room",{roomId:$.value,to:l.partnerId}))}),K(()=>l.isOpen,i=>{i||N()}),(i,h)=>n.isOpen?(x(),T("div",an,[e("div",ln,[e("div",sn,[h[2]||(h[2]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-purple-400 text-xl"},"🎮"),e("h2",{class:"text-xl font-semibold text-[#a881fc]"},"Space Games")],-1)),e("button",{onClick:h[0]||(h[0]=b=>i.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),G("",!0),a.value?g.value?(x(),T("div",fn,[e("div",gn,[h[8]||(h[8]=e("div",{class:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-2"},[e("span",{class:"text-2xl"},"⚠️")],-1)),h[9]||(h[9]=e("h3",{class:"text-xl font-bold mb-2 text-red-400"},"Game Error",-1)),e("p",vn,P(g.value),1)]),e("button",{onClick:N,class:"px-4 py-2 bg-gray-700 rounded-full hover:bg-gray-600 transition-colors mt-2"}," Back to Games ")])):(x(),T("div",mn,[a.value==="tic-tac-toe"?(x(),Ot(nn,{key:0,partnerId:n.partnerId,isFirstPlayer:r.value,partnerReady:A.value,onBack:N,onError:U},null,8,["partnerId","isFirstPlayer","partnerReady"])):G("",!0)])):(x(),T("div",rn,[e("div",cn,[e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!n.isConnected}]),disabled:!n.isConnected},h[3]||(h[3]=[pe('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-yellow-500 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>👊</div><div class="text-white font-medium" data-v-823f908a>Rock Paper Scissors</div><div class="text-xs text-gray-400" data-v-823f908a>vs Partner</div>',4)]),10,un),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},h[4]||(h[4]=[pe('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-indigo-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>🎵</div><div class="text-white font-medium" data-v-823f908a>Sound Game</div><div class="text-xs text-gray-400" data-v-823f908a>Voice Challenge</div>',4)])),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center hover:bg-[#3a3a52] transition-colors relative",{"opacity-50 cursor-not-allowed":!n.isConnected}]),disabled:!n.isConnected,onClick:h[1]||(h[1]=b=>V("tic-tac-toe"))},h[5]||(h[5]=[e("div",{class:"bg-red-600 text-white w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl"},"⭕",-1),e("div",{class:"text-white font-medium"},"Tic-Tac-Toe",-1),e("div",{class:"text-xs text-gray-400"},"vs Partner",-1)]),10,dn),e("button",{class:B(["bg-[#2e2e42] p-4 rounded-lg flex flex-col items-center text-center relative",{"opacity-50 cursor-not-allowed":!0}]),disabled:""},h[6]||(h[6]=[pe('<div class="absolute inset-0 flex items-center justify-center bg-[#2e2e42]/80 rounded-lg" data-v-823f908a><span class="bg-purple-500 text-white text-xs px-2 py-1 rounded-md font-medium" data-v-823f908a>Coming Soon</span></div><div class="bg-white text-gray-800 w-12 h-12 rounded-full flex items-center justify-center mb-3 text-xl" data-v-823f908a>💬</div><div class="text-white font-medium" data-v-823f908a>Word Galaxy</div><div class="text-xs text-gray-400" data-v-823f908a>Brain Game</div>',4)]))]),h[7]||(h[7]=e("p",{class:"text-center text-sm text-gray-400 mt-2"}," Connect to play with others ",-1))]))])])):G("",!0)}});const bn=fe(pn,[["__scopeId","data-v-823f908a"]]),yn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},hn={class:"bg-gray-900 rounded-lg w-full max-w-md mx-auto p-6"},xn={class:"flex items-center justify-between mb-6"},Cn={class:"grid grid-cols-3 gap-4 mb-6"},wn=oe({__name:"donation-modal",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:m}){const s=m,k=y(15),l=g=>{k.value=g},a=()=>{window.open(`https://www.paypal.com/paypalme/spacetalk/${k.value}`,"_blank"),s("close")};return(g,r)=>n.isOpen?(x(),T("div",yn,[e("div",hn,[e("div",xn,[r[4]||(r[4]=e("div",{class:"flex items-center gap-2"},[e("span",{class:"text-red-400 text-xl"},"❤️"),e("h2",{class:"text-lg font-semibold text-violet-400"},"Support SpaceTalk")],-1)),e("button",{onClick:r[0]||(r[0]=$=>g.$emit("close")),class:"text-gray-400 hover:text-white text-lg"}," ✕ ")]),r[8]||(r[8]=e("div",{class:"mb-6 text-center"},[e("p",{class:"text-gray-300"},"Keep SpaceTalk free for everyone")],-1)),e("div",Cn,[e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",k.value===5?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[1]||(r[1]=$=>l(5))},r[5]||(r[5]=[e("div",{class:"text-lg font-bold text-white"},"$5",-1),e("div",{class:"text-sm text-gray-400"},"Coffee",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",k.value===15?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[2]||(r[2]=$=>l(15))},r[6]||(r[6]=[e("div",{class:"text-lg font-bold text-white"},"$15",-1),e("div",{class:"text-sm text-gray-400"},"Fuel",-1)]),2),e("button",{class:B(["bg-gray-800 hover:bg-gray-700 rounded-lg p-4 text-center transition-colors duration-200 transform",k.value===50?"ring-2 ring-emerald-500 scale-105":""]),onClick:r[3]||(r[3]=$=>l(50))},r[7]||(r[7]=[e("div",{class:"text-lg font-bold text-white"},"$50",-1),e("div",{class:"text-sm text-gray-400"},"Rocket",-1)]),2)]),r[9]||(r[9]=e("div",{class:"flex justify-center items-center gap-1 mb-6"},[e("span",{class:"text-yellow-400"},"⭐"),e("span",{class:"text-sm text-gray-300"},"Boost development")],-1)),e("button",{class:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-medium py-3 rounded-lg transition-colors mb-2 active:scale-95 transform duration-150",onClick:a}," Donate via PayPal "),r[10]||(r[10]=e("div",{class:"text-xs text-gray-500 text-center"}," Secure payments via PayPal ",-1))])])):G("",!0)}}),Tn={class:"relative w-full"},kn={class:"py-1"},Rn=oe({__name:"select",props:{modelValue:{type:[String,Number],default:""},placeholder:{type:String,default:"Select an option"},options:{type:Array,default:()=>[]}},emits:["update:modelValue","change"],setup(n,{emit:m}){const s=n,k=y(!1),l=y(null),a=y(null),g=ae(()=>{if(s.options&&s.options.length){const A=s.options.find(C=>C.value===s.modelValue);return A?A.label:""}return s.modelValue}),r=()=>{k.value=!k.value},$=A=>{k.value&&l.value&&a.value&&!l.value.contains(A.target)&&!a.value.contains(A.target)&&(k.value=!1)};return le(()=>{document.addEventListener("click",$)}),Pe(()=>{document.removeEventListener("click",$)}),(A,C)=>(x(),T("div",Tn,[e("button",{type:"button",ref_key:"triggerRef",ref:l,onClick:r,class:"w-full flex items-center justify-between bg-purple-500/20 border-purple-500/30 rounded-full h-8 px-3 text-xs shadow-lg shadow-purple-500/20 text-white"},[e("span",null,P(g.value||n.placeholder),1),C[0]||(C[0]=e("span",{class:"ml-1"},"▼",-1))],512),ee(jt,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"opacity-0 translate-y-1","enter-to-class":"opacity-100 translate-y-0","leave-active-class":"transition duration-150 ease-in","leave-from-class":"opacity-100 translate-y-0","leave-to-class":"opacity-0 translate-y-1"},{default:Dt(()=>[k.value?(x(),T("div",{key:0,ref_key:"contentRef",ref:a,class:"absolute z-50 w-full mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg max-h-48 overflow-y-auto"},[e("div",kn,[Be(A.$slots,"default",{},()=>[Be(A.$slots,"placeholder",{},()=>[C[1]||(C[1]=e("div",{class:"px-3 py-2 text-xs text-gray-400"},"No items",-1))],!0)],!0)])],512)):G("",!0)]),_:3})]))}});const Ae=fe(Rn,[["__scopeId","data-v-9f96ce6c"]]),Sn={class:"fixed inset-0 overflow-hidden pointer-events-none"},_n=oe({__name:"starfield",setup(n){const m=y([]);le(()=>{s()});const s=()=>{const l=[];for(let a=0;a<50;a++)l.push({id:a,x:Math.random()*100,y:Math.random()*100,size:Math.random()*2+1,opacity:Math.random()*.7+.3,duration:Math.random()*8+2});m.value=l};return(k,l)=>(x(),T("div",Sn,[(x(!0),T(ue,null,de(m.value,a=>(x(),T("div",{key:a.id,class:"absolute rounded-full bg-white",style:Mt({width:`${a.size}px`,height:`${a.size}px`,top:`${a.y}%`,left:`${a.x}%`,opacity:a.opacity,boxShadow:`0 0 ${a.size*2}px rgba(255, 255, 255, ${a.opacity})`,animation:`twinkle ${a.duration}s infinite ease-in-out`})},null,4))),128))]))}});const $n=fe(_n,[["__scopeId","data-v-f4bff5a3"]]),Oe=!1,Wn=10,In=oe({__name:"AudioOutput",props:{showControls:{type:Boolean,default:!0}},setup(n){const{remoteStream:m,connectionState:s,partnerId:k,isAudioMuted:l}=Me(),a=y(null),g=y(.8),r=y(!1),$=y(0),A=ae(()=>(m.value!==null&&m.value?m.value.getAudioTracks().length>0:!1)&&m.value?m.value.getAudioTracks().some(I=>I.enabled):!1);ae(()=>m.value?m.value.getAudioTracks().filter(b=>b.enabled&&b.readyState==="live").length:0),ae(()=>r.value&&A.value?"connected":(s.value==="connected"&&!A.value&&!r.value&&setTimeout(U,500),s.value)),K(()=>m.value,b=>{U(),$.value=0,setTimeout(i,500)}),K(()=>l.value,b=>{!b&&m.value&&a.value&&setTimeout(()=>{a.value&&a.value.paused&&a.value.play().catch(D=>{})},300)}),K(()=>s.value,b=>{b==="connected"?setTimeout(()=>{U(),i()},1e3):b==="new"||b==="connecting"?$.value=0:(b==="disconnected"||b==="failed")&&h()}),K(()=>k.value,b=>{r.value=!1,$.value=0,b||a.value&&(a.value.srcObject=null)}),le(()=>{U(),a.value&&(a.value.onplaying=()=>{r.value=!0},a.value.onpause=()=>{r.value=!1},a.value.onended=()=>{r.value=!1},a.value.onerror=b=>{console.error("[AudioOutput] Audio error:",b),r.value=!1},a.value.volume=g.value),document.addEventListener("visibilitychange",N),W()}),Pe(()=>{a.value&&(a.value.srcObject=null),document.removeEventListener("visibilitychange",N),V()});let C=null;function W(){V(),C=window.setInterval(()=>{!r.value&&A.value&&s.value==="connected"&&(U(),i())},5e3)}function V(){C&&(clearInterval(C),C=null)}function N(){document.visibilityState==="visible"&&(U(),setTimeout(()=>{!r.value&&A.value&&i()},500))}function U(){a.value&&(m.value?(a.value.srcObject=m.value,m.value.getAudioTracks().forEach(b=>{b.enabled=!0}),i()):(a.value.srcObject=null,r.value=!1))}async function i(){if(!(!a.value||!a.value.srcObject))try{const b=m.value&&m.value.getAudioTracks().length>0;await a.value.play(),r.value=!0,$.value=0}catch(b){if(console.error("[AudioOutput] Error playing audio:",b),r.value=!1,b instanceof DOMException&&b.name==="NotAllowedError"&&console.warn("[AudioOutput] Audio play was blocked by browser policy, user interaction needed"),$.value<Wn){$.value++;const D=$.value*1e3;setTimeout(i,D)}else console.warn("[AudioOutput] Max retry attempts reached, manual play required")}}function h(){$.value=0,a.value&&(a.value.srcObject=null),setTimeout(()=>{U(),i()},500)}return(b,D)=>(x(),T("div",null,[e("audio",{ref_key:"audioElement",ref:a,autoplay:"",playsinline:"",class:"hidden"},null,512),G("",!0)]))}});const En=fe(In,[["__scopeId","data-v-f63dc209"]]),An={class:"min-h-screen font-sans"},On={class:"relative min-h-screen z-10 text-white"},Dn={class:"p-4 border-b border-white/10"},jn={class:"max-w-4xl mx-auto"},Mn={class:"flex justify-center gap-2 mb-3"},Pn={class:"bg-green-500/20 rounded-full px-2 py-1 text-xs flex items-center gap-1"},Nn={key:0,class:"bg-purple-500/20 rounded-full px-2 py-1 text-xs"},Fn={class:"grid grid-cols-2 gap-2 text-xs relative"},Ln={class:"flex items-center"},Vn={key:0,class:"absolute top-full left-0 mt-1 w-full bg-gray-800/95 backdrop-blur-md border border-gray-700 rounded-xl shadow-xl z-20 overflow-hidden transition-all duration-200 animate-dropdown"},Un={class:"py-1"},Gn=["onClick"],Bn={class:"text-sm"},zn={class:"flex-1 p-4"},qn={class:"max-w-md mx-auto space-y-6"},Hn={class:"flex items-center justify-center gap-2 mb-4"},Xn={class:"text-center"},Yn={class:"text-xs text-gray-400 italic"},Kn={key:0,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},Jn={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-sm"},Qn={class:"flex justify-between items-center mb-4"},Zn={class:"space-y-3"},ea={key:0,class:"text-center py-8"},ta={class:"flex items-center gap-3"},oa={class:"text-2xl"},na={class:"text-white text-sm font-medium"},aa={class:"text-gray-400 text-xs"},la={class:"text-xs text-gray-500"},sa={key:0,class:"text-xs text-gray-500 text-center mt-4"},ra={key:1,class:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4"},ia={class:"bg-gray-800 rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto"},ca={class:"flex justify-between items-center mb-4"},ua={class:"space-y-4"},da={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},fa={key:0,class:"text-xs text-gray-400 p-2"},ga={key:1,class:"flex flex-wrap gap-1"},va=["onClick"],ma={class:"bg-gray-700 border border-gray-600 rounded-lg p-2 min-h-[60px] max-h-32 overflow-y-auto"},pa={key:0,class:"text-xs text-gray-400 p-2"},ba={key:1,class:"flex flex-wrap gap-1"},ya=["onClick"],ha={key:2,class:"hidden"},xa=oe({__name:"HomeView",setup(n){const m=y("disconnected"),s=y(null),k=y(null),l=y(""),a=y(!1),g=y(!1),r=y(!1),$=y(!1),A=y(!1),C=y(!1),W=y(0),V=y(0),N=y(!1),U=y([]),i=y([]),h=y("any"),b=y(!1),D=y(""),w=y([]),I=y([]),j=y("off"),F=y(""),H=y(""),be=[{value:"any",text:"Any Vibe",emoji:"🌟"},{value:"chill",text:"Chill",emoji:"😌"},{value:"fun",text:"Fun",emoji:"🎉"},{value:"curious",text:"Curious",emoji:"🤔"},{value:"creative",text:"Creative",emoji:"🎨"}],ye=[{value:"off",label:"⏰ Disabled"},{value:"30",label:"30 seconds"},{value:"60",label:"60 seconds"},{value:"90",label:"90 seconds"}],se=[{value:"any",label:"🌍 Any Country"},{value:"us",label:"🇺🇸 United States"},{value:"gb",label:"🇬🇧 United Kingdom"},{value:"ca",label:"🇨🇦 Canada"},{value:"au",label:"🇦🇺 Australia"},{value:"de",label:"🇩🇪 Germany"},{value:"fr",label:"🇫🇷 France"},{value:"it",label:"🇮🇹 Italy"},{value:"es",label:"🇪🇸 Spain"},{value:"jp",label:"🇯🇵 Japan"}],re=["You're not alone in the universe.","Every voice carries a story from across the stars.","Connection transcends distance in the cosmic web.","Discover new worlds through conversation.","In space, every voice matters."],$e=y(re[Math.floor(Math.random()*re.length)]),o=Te().socket,{remoteStream:p,localStream:v,connectionState:c,createOffer:S,handleOffer:J,handleAnswer:ke,handleIceCandidate:at,closeConnection:Ne,toggleMicrophone:lt,initializeLocalStream:st}=Me(),rt=eo(),it=Nt(),Fe=y(it.params.roomId||null);K(()=>Fe.value,f=>{f&&(r.value=!0)},{immediate:!0});const ct=ae(()=>se.filter(f=>f.value!=="any"&&!w.value.includes(f.value)&&!I.value.includes(f.value))),ut=ae(()=>se.filter(f=>f.value!=="any"&&!I.value.includes(f.value)&&!w.value.includes(f.value))),dt=async()=>{const f=await lt();a.value!==!f&&(a.value=!f),m.value==="connected"&&setTimeout(()=>{const d=document.querySelector("audio");d&&d.paused&&d.play().catch(()=>{})},300)},Le=async()=>{if(!v.value)try{await st(),console.log("Microphone initialized")}catch(f){console.error("Failed to access microphone",f),alert("Please allow microphone access to use voice chat");return}o.value&&(m.value="searching",s.value&&(console.log("Disconnecting from current partner"),o.value.emit("disconnect-partner"),s.value=null,k.value=null,U.value=[],Ne()),console.log("Finding new partner with preferences"),o.value.emit("join-queue",{vibe:h.value,preferences:{preferredCountries:w.value.length?w.value:void 0,blockedCountries:I.value.length?I.value:void 0,interests:D.value?D.value.split(",").map(f=>f.trim()):void 0}}),V.value++)},ft=()=>{g.value=!g.value,g.value&&s.value&&rt.markAsRead(s.value)},gt=f=>{o.value&&s.value&&(o.value.emit("chat-message",{message:f,to:s.value}),U.value.push({id:Date.now().toString(),message:f,isOwn:!0,timestamp:Date.now()}))},vt=f=>{console.log(`Selected game: ${f}`),o.value&&s.value&&o.value.emit("game-invite",{game:f,to:s.value})},mt=()=>{F.value&&!w.value.includes(F.value)&&(w.value.push(F.value),F.value="")},pt=f=>{w.value=w.value.filter(d=>d!==f)},bt=()=>{H.value&&!I.value.includes(H.value)&&(I.value.push(H.value),H.value="")},yt=f=>{I.value=I.value.filter(d=>d!==f)},ht=()=>{D.value="",w.value=[],I.value=[],j.value="off"},xt=()=>{C.value=!1},Ve=f=>{const d=se.find(_=>_.value===f);return d?d.label.split(" ")[0]:"🏳️"},Ue=f=>{const d=se.find(_=>_.value===f);return d?d.label.split(" ").slice(1).join(" "):"Unknown"},Ct=f=>new Date(f).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),wt=()=>{b.value=!b.value},Tt=f=>{h.value=f,b.value=!1},kt=f=>{const d=be.find(_=>_.value===f);return d?d.emoji:"🌟"},Rt=f=>{const d=be.find(_=>_.value===f);return d?d.text:"Any Vibe"};le(async()=>{console.log("Home view mounted"),o.value&&(o.value.on("online-count",f=>{W.value=f}),o.value.on("matched",f=>{if(console.log("Partner matched with event:",f),m.value="matched",l.value="",s.value=f.partnerId,k.value={id:f.partnerId,country:f.country||"Unknown",flag:f.flag||"🌍",vibe:f.vibe||"any"},i.value.unshift({id:Date.now().toString(),country:k.value.country,flag:k.value.flag,timestamp:Date.now()}),i.value.length>3&&(i.value=i.value.slice(0,3)),console.log("Partner matched:",f),f.partnerId){console.log("Initiating WebRTC connection with partner immediately");const{createOffer:d}=Me();d(f.partnerId),setTimeout(()=>{m.value==="matched"&&c.value==="connected"&&(console.log("WebRTC connection established, updating UI state"),m.value="connected")},2e3)}}),o.value.on("direct-connection-established",f=>{console.log("Direct connection established:",f),m.value="connected",s.value=f.partnerId,k.value={id:f.partnerId,country:f.country||"Unknown",flag:f.flag||"🌍"}}),o.value.on("partner-disconnected",()=>{m.value="disconnected",s.value=null,k.value=null,U.value=[],N.value&&setTimeout(()=>{m.value==="disconnected"&&N.value&&Le()},2e3)}),o.value.on("chat-message",f=>{U.value.push({id:Date.now().toString(),message:f.message,isOwn:!1,timestamp:Date.now()})}),o.value.on("error",f=>{console.error("Socket error:",f.message),f.type==="matching"&&(m.value="disconnected")}),o.value.on("voice-offer",St),o.value.on("voice-answer",_t),o.value.on("ice-candidate",$t),o.value.emit("get-online-count")),document.addEventListener("click",Ge)}),Pe(()=>{console.log("Home view unmounting, cleaning up connection"),Ne(),o.value&&(o.value.off("online-count"),o.value.off("matched"),o.value.off("direct-connection-established"),o.value.off("partner-disconnected"),o.value.off("chat-message"),o.value.off("error"),o.value.off("voice-offer"),o.value.off("voice-answer"),o.value.off("ice-candidate")),document.removeEventListener("click",Ge)});const St=async f=>{console.log("Received voice offer - forwarding to WebRTC service"),J(f.offer,f.from)},_t=async f=>{console.log("Received voice answer - forwarding to WebRTC service"),ke(f.answer)},$t=async f=>{console.log("Received ICE candidate - forwarding to WebRTC service"),at(f.candidate)};K(c,(f,d)=>{console.log(`[HomeView] WebRTC connection state changed: ${d} -> ${f}`),f==="connected"&&m.value==="matched"?setTimeout(()=>{c.value==="connected"&&m.value==="matched"&&(m.value="connected",l.value="",console.log("[HomeView] Successfully transitioned from matched to connected"))},1e3):f==="failed"?(l.value="",setTimeout(()=>{c.value==="failed"&&(m.value==="matched"||m.value==="connected")&&(l.value='Connection failed. Press "Next" to find a new partner.')},6e4)):f==="disconnected"&&(m.value==="connected"||m.value==="matched")&&(l.value="",setTimeout(()=>{c.value==="disconnected"&&(m.value==="connected"||m.value==="matched")&&(l.value="Connection lost. Trying to reconnect...")},6e4))});const We=y(null),Ge=f=>{const d=f.target;We.value&&!We.value.contains(d)&&(b.value=!1)};return(f,d)=>(x(),T("div",An,[d[26]||(d[26]=pe('<div class="fixed inset-0 pointer-events-none" data-v-d136ba69><div class="absolute top-1/4 left-1/4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse" data-v-d136ba69></div><div class="absolute top-1/3 right-1/3 w-24 h-24 bg-violet-500/20 rounded-full blur-2xl animate-pulse delay-1000" data-v-d136ba69></div><div class="absolute bottom-1/4 left-1/3 w-28 h-28 bg-indigo-500/20 rounded-full blur-3xl animate-pulse delay-2000" data-v-d136ba69></div><div class="absolute top-1/2 right-1/4 w-20 h-20 bg-fuchsia-500/20 rounded-full blur-2xl animate-pulse delay-500" data-v-d136ba69></div></div>',1)),ee($n),e("div",On,[e("header",Dn,[e("div",jn,[d[15]||(d[15]=pe('<div class="text-center mb-4" data-v-d136ba69><div class="inline-flex items-center gap-2" data-v-d136ba69><div class="w-6 h-6 bg-gradient-to-r from-cyan-500 to-blue-500 rounded-full flex items-center justify-center shadow-lg shadow-cyan-500/50" data-v-d136ba69><span class="text-white text-xs" data-v-d136ba69>✨</span></div><h1 class="text-lg font-bold bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent drop-shadow-lg" data-v-d136ba69> SpaceTalk.live </h1></div></div>',1)),e("div",Mn,[e("div",Pn,[d[14]||(d[14]=e("div",{class:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"},null,-1)),e("span",null,P(W.value)+" online",1)]),V.value>0?(x(),T("div",Nn," Today: "+P(V.value)+" voices ",1)):G("",!0)]),e("div",Fn,[e("div",{class:"relative",ref_key:"vibeDropdownRef",ref:We},[e("div",{onClick:wt,class:"cursor-pointer bg-purple-500/20 border border-purple-500/30 rounded-full h-8 flex items-center justify-between px-3 text-xs shadow-lg shadow-purple-500/20 text-white hover:bg-purple-500/30 active:scale-95 transition-all duration-150"},[e("span",Ln,P(kt(h.value))+" "+P(Rt(h.value)),1),e("span",{class:B(["ml-2 text-xs transition-transform duration-300",{"rotate-180":b.value}])},"▼",2)]),b.value?(x(),T("div",Vn,[e("div",Un,[(x(),T(ue,null,de(be,_=>e("div",{key:_.value,onClick:Re=>Tt(_.value),class:B(["px-3 py-2 hover:bg-gray-700/80 cursor-pointer transition-colors flex items-center gap-2",{"bg-gray-700/70":h.value===_.value}])},[e("span",Bn,P(_.emoji),1),e("span",null,P(_.text),1)],10,Gn)),64))])])):G("",!0)],512),e("button",{onClick:d[0]||(d[0]=_=>C.value=!0),class:"bg-violet-500/20 border border-violet-500/30 rounded-full h-8 px-3 text-xs hover:bg-violet-500/30 active:scale-95 transition-all duration-150 shadow-lg shadow-violet-500/20"}," 🔍 Filters ")])])]),e("main",zn,[e("div",qn,[ee(bo,{status:m.value,"partner-info":k.value,"error-message":l.value,"show-status":!0},null,8,["status","partner-info","error-message"]),e("div",Hn,[De(e("input",{type:"checkbox",id:"auto-reconnect","onUpdate:modelValue":d[1]||(d[1]=_=>N.value=_),class:"w-3 h-3 rounded border-gray-600 bg-gray-700 text-emerald-500 focus:ring-emerald-500 focus:ring-1"},null,512),[[Pt,N.value]]),d[16]||(d[16]=e("label",{for:"auto-reconnect",class:"text-xs text-gray-400 cursor-pointer"}," Auto-reconnect to others ",-1))]),ee(_o,{"is-muted":a.value,"is-disabled":m.value!=="connected",onToggleMute:dt,onFindNext:Le,onToggleChat:ft,onToggleGames:d[2]||(d[2]=_=>r.value=!0),onToggleHistory:d[3]||(d[3]=_=>A.value=!0),onToggleDonation:d[4]||(d[4]=_=>$.value=!0)},null,8,["is-muted","is-disabled"]),e("div",Xn,[e("p",Yn,'"'+P($e.value)+'"',1)])])]),d[17]||(d[17]=pe('<footer class="p-4 border-t border-white/10" data-v-d136ba69><div class="max-w-md mx-auto text-center space-y-2" data-v-d136ba69><h3 class="text-sm font-semibold text-emerald-400" data-v-d136ba69>Community Guidelines</h3><div class="text-xs text-gray-300 space-y-1" data-v-d136ba69><p data-v-d136ba69>• Must be 18+ years old to use this service</p><p data-v-d136ba69>• Be respectful and kind to other users</p><p data-v-d136ba69>• No harassment, hate speech, or inappropriate content</p><p data-v-d136ba69>• Report any misconduct using the report feature</p><p data-v-d136ba69>• Your privacy and safety are our priority</p></div><p class="text-xs text-gray-400 mt-3" data-v-d136ba69> By using SpaceTalk.live, you agree to follow these guidelines </p><div class="flex justify-center gap-3 mt-4 text-xs" data-v-d136ba69><a href="#" class="bg-cyan-500/20 border border-cyan-500/30 rounded-full px-3 py-1.5 text-cyan-300 hover:text-cyan-200 hover:bg-cyan-500/30 transition-all shadow-lg shadow-cyan-500/20" data-v-d136ba69> ℹ️ About </a><a href="https://instagram.com" target="_blank" class="bg-pink-500/20 border border-pink-500/30 rounded-full px-3 py-1.5 text-pink-300 hover:text-pink-200 hover:bg-pink-500/30 transition-all shadow-lg shadow-pink-500/20" data-v-d136ba69> 📷 Instagram </a><a href="https://facebook.com" target="_blank" class="bg-blue-500/20 border border-blue-500/30 rounded-full px-3 py-1.5 text-blue-300 hover:text-blue-200 hover:bg-blue-500/30 transition-all shadow-lg shadow-blue-500/20" data-v-d136ba69> 📘 Facebook </a><a href="mailto:contact@spacetalk.live" class="bg-emerald-500/20 border border-emerald-500/30 rounded-full px-3 py-1.5 text-emerald-300 hover:text-emerald-200 hover:bg-emerald-500/30 transition-all shadow-lg shadow-emerald-500/20" data-v-d136ba69> 📧 Contact </a></div></div></footer>',1))]),A.value?(x(),T("div",Kn,[e("div",Jn,[e("div",Qn,[d[18]||(d[18]=e("h2",{class:"text-lg font-semibold text-indigo-400"},"📞 Call History",-1)),e("button",{onClick:d[5]||(d[5]=_=>A.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",Zn,[i.value.length===0?(x(),T("div",ea,d[19]||(d[19]=[e("p",{class:"text-gray-400 text-sm"},"No recent calls",-1),e("p",{class:"text-xs text-gray-500 mt-1"},"Your last 3 conversations will appear here",-1)]))):(x(!0),T(ue,{key:1},de(i.value,(_,Re)=>(x(),T("div",{key:_.id,class:"bg-gray-700 rounded-lg p-3 flex items-center justify-between hover:bg-gray-600 transition-colors"},[e("div",ta,[e("span",oa,P(_.flag),1),e("div",null,[e("p",na,P(_.country),1),e("p",aa,P(Ct(_.timestamp)),1)])]),e("div",la," #"+P(Re+1),1)]))),128))]),i.value.length>0?(x(),T("p",sa," History clears when you leave the page ")):G("",!0)])])):G("",!0),C.value?(x(),T("div",ra,[e("div",ia,[e("div",ca,[d[20]||(d[20]=e("h2",{class:"text-lg font-semibold text-emerald-400"},"Filters & Preferences",-1)),e("button",{onClick:d[6]||(d[6]=_=>C.value=!1),class:"text-gray-400 hover:text-white text-xl"}," ✕ ")]),e("div",ua,[e("div",null,[d[21]||(d[21]=e("label",{class:"block text-sm font-medium mb-2 text-teal-400"},"Interest Keywords",-1)),De(e("input",{"onUpdate:modelValue":d[7]||(d[7]=_=>D.value=_),type:"text",placeholder:"e.g., music, travel, technology...",class:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white placeholder-gray-400 focus:border-emerald-500 focus:outline-none"},null,512),[[Qe,D.value]]),d[22]||(d[22]=e("p",{class:"text-xs text-gray-400 mt-1"},"Separate with commas",-1))]),e("div",null,[d[23]||(d[23]=e("label",{class:"block text-sm font-medium mb-2 text-emerald-400"},"Preferred Countries",-1)),e("div",da,[w.value.length===0?(x(),T("p",fa,"No countries selected")):(x(),T("div",ga,[(x(!0),T(ue,null,de(w.value,_=>(x(),T("span",{key:_,class:"bg-emerald-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[je(P(Ve(_))+" "+P(Ue(_))+" ",1),e("button",{onClick:Re=>pt(_),class:"text-emerald-200 hover:text-white ml-1"}," ✕ ",8,va)]))),128))]))]),ee(Ae,{modelValue:F.value,"onUpdate:modelValue":d[8]||(d[8]=_=>F.value=_),options:ct.value,placeholder:"Add preferred country...",class:"mt-2",onChange:mt},null,8,["modelValue","options"])]),e("div",null,[d[24]||(d[24]=e("label",{class:"block text-sm font-medium mb-2 text-red-400"},"Blocked Countries",-1)),e("div",ma,[I.value.length===0?(x(),T("p",pa,"No countries blocked")):(x(),T("div",ba,[(x(!0),T(ue,null,de(I.value,_=>(x(),T("span",{key:_,class:"bg-red-600 text-white px-2 py-1 rounded text-xs flex items-center gap-1"},[je(P(Ve(_))+" "+P(Ue(_))+" ",1),e("button",{onClick:Re=>yt(_),class:"text-red-200 hover:text-white ml-1"}," ✕ ",8,ya)]))),128))]))]),ee(Ae,{modelValue:H.value,"onUpdate:modelValue":d[9]||(d[9]=_=>H.value=_),options:ut.value,placeholder:"Add blocked country...",class:"mt-2",onChange:bt},null,8,["modelValue","options"])]),e("div",null,[d[25]||(d[25]=e("label",{class:"block text-sm font-medium mb-2 text-orange-400"},"Auto-Next Timer",-1)),ee(Ae,{modelValue:j.value,"onUpdate:modelValue":d[10]||(d[10]=_=>j.value=_),options:ye,placeholder:"Select timer"},null,8,["modelValue"])])]),e("div",{class:"flex gap-2 mt-6"},[e("button",{onClick:ht,class:"flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Clear All "),e("button",{onClick:xt,class:"flex-1 bg-emerald-600 hover:bg-emerald-700 text-white py-2 px-4 rounded-lg text-sm transition-colors"}," Apply Filters ")])])])):G("",!0),ee(Fo,{"is-open":g.value,onClose:d[11]||(d[11]=_=>g.value=!1),messages:U.value,onSendMessage:gt,"is-connected":m.value==="connected"},null,8,["is-open","messages","is-connected"]),ee(bn,{"is-open":r.value,onClose:d[12]||(d[12]=_=>r.value=!1),"is-connected":m.value==="connected",onSelectGame:vt,"partner-id":s.value||"","initial-game-room-id":Fe.value},null,8,["is-open","is-connected","partner-id","initial-game-room-id"]),ee(wn,{"is-open":$.value,onClose:d[13]||(d[13]=_=>$.value=!1)},null,8,["is-open"]),m.value==="connected"?(x(),T("div",ha,[ee(En,{showControls:!1})])):G("",!0)]))}});const Je=fe(xa,[["__scopeId","data-v-d136ba69"]]),Ca=Ft({history:Lt("/"),routes:[{path:"/",name:"home",component:Je},{path:"/game/:roomId",name:"game",component:Je,props:!0}]}),nt=Vt(Bt);nt.use(Ca);nt.mount("#app");
//# sourceMappingURL=index-6b579528.js.map
